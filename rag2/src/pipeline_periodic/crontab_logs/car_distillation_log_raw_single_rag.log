[2024-08-29 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-27/2024-08-27_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-29 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-27/2024-08-27_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-08-27
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-27/2024-08-27_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-27/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-27/raw/single_True_rag_True/split_data/chunk_1.csv
Saved chunk 2 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-27/raw/single_True_rag_True/split_data/chunk_2.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 500 / 500
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:13<1:55:26, 13.88s/it]  0%|          | 2/500 [00:18<1:09:47,  8.41s/it]  1%|          | 4/500 [00:21<33:40,  4.07s/it]    1%|          | 6/500 [00:22<20:41,  2.51s/it]  1%|▏         | 7/500 [00:25<19:42,  2.40s/it]  2%|▏         | 9/500 [00:27<14:52,  1.82s/it]  2%|▏         | 11/500 [00:31<15:39,  1.92s/it]  3%|▎         | 13/500 [00:36<17:23,  2.14s/it]  3%|▎         | 14/500 [00:51<37:48,  4.67s/it]  4%|▎         | 18/500 [00:53<20:19,  2.53s/it]  4%|▍         | 21/500 [01:16<34:48,  4.36s/it]  6%|▌         | 28/500 [01:18<16:55,  2.15s/it]  6%|▌         | 29/500 [01:19<16:01,  2.04s/it]  6%|▌         | 30/500 [01:20<15:06,  1.93s/it]  6%|▌         | 31/500 [01:26<18:47,  2.40s/it]  7%|▋         | 33/500 [01:30<18:35,  2.39s/it]  7%|▋         | 34/500 [01:31<16:01,  2.06s/it]  7%|▋         | 36/500 [01:33<12:59,  1.68s/it]  7%|▋         | 37/500 [01:40<20:42,  2.68s/it]  8%|▊         | 39/500 [02:08<52:55,  6.89s/it]  9%|▉         | 47/500 [02:10<17:51,  2.37s/it] 10%|▉         | 49/500 [02:14<17:37,  2.34s/it] 10%|█         | 50/500 [02:15<16:02,  2.14s/it] 10%|█         | 51/500 [02:21<20:46,  2.78s/it] 11%|█         | 53/500 [02:33<27:23,  3.68s/it] 11%|█▏        | 57/500 [02:44<23:46,  3.22s/it] 12%|█▏        | 59/500 [02:47<20:49,  2.83s/it] 12%|█▏        | 60/500 [02:52<23:12,  3.16s/it] 12%|█▏        | 61/500 [02:53<21:02,  2.88s/it] 13%|█▎        | 63/500 [03:01<22:53,  3.14s/it] 13%|█▎        | 65/500 [03:06<21:06,  2.91s/it] 13%|█▎        | 66/500 [03:10<23:08,  3.20s/it] 13%|█▎        | 67/500 [03:24<39:23,  5.46s/it] 14%|█▍        | 72/500 [03:47<35:19,  4.95s/it] 16%|█▌        | 79/500 [03:51<17:46,  2.53s/it] 16%|█▌        | 81/500 [03:57<18:15,  2.61s/it] 17%|█▋        | 85/500 [04:03<15:32,  2.25s/it] 17%|█▋        | 86/500 [04:03<14:03,  2.04s/it] 18%|█▊        | 88/500 [04:15<19:56,  2.90s/it] 18%|█▊        | 89/500 [04:23<25:23,  3.71s/it] 18%|█▊        | 91/500 [04:24<19:20,  2.84s/it] 18%|█▊        | 92/500 [04:39<32:43,  4.81s/it] 19%|█▊        | 93/500 [04:46<36:00,  5.31s/it] 19%|█▉        | 94/500 [04:56<43:30,  6.43s/it] 19%|█▉        | 96/500 [04:57<27:15,  4.05s/it] 20%|█▉        | 98/500 [05:01<22:22,  3.34s/it] 20%|█▉        | 99/500 [05:13<33:51,  5.07s/it] 20%|██        | 102/500 [05:24<29:26,  4.44s/it] 21%|██        | 106/500 [05:24<15:41,  2.39s/it] 21%|██▏       | 107/500 [05:28<16:56,  2.59s/it] 22%|██▏       | 108/500 [05:30<15:54,  2.43s/it] 22%|██▏       | 109/500 [05:39<24:46,  3.80s/it] 22%|██▏       | 111/500 [05:40<16:15,  2.51s/it] 23%|██▎       | 113/500 [05:48<19:44,  3.06s/it] 24%|██▎       | 118/500 [05:54<13:20,  2.10s/it] 24%|██▍       | 119/500 [05:57<13:47,  2.17s/it] 24%|██▍       | 122/500 [06:00<11:15,  1.79s/it] 25%|██▍       | 123/500 [06:02<10:32,  1.68s/it] 25%|██▌       | 125/500 [06:14<19:00,  3.04s/it] 25%|██▌       | 126/500 [06:17<18:43,  3.00s/it] 26%|██▌       | 128/500 [06:21<16:56,  2.73s/it] 26%|██▌       | 130/500 [06:25<14:40,  2.38s/it] 26%|██▌       | 131/500 [06:42<32:03,  5.21s/it] 27%|██▋       | 133/500 [06:46<25:00,  4.09s/it] 27%|██▋       | 137/500 [06:49<14:41,  2.43s/it] 28%|██▊       | 140/500 [06:55<13:44,  2.29s/it] 28%|██▊       | 141/500 [07:03<18:10,  3.04s/it] 29%|██▉       | 144/500 [07:11<17:32,  2.96s/it] 29%|██▉       | 147/500 [07:12<12:07,  2.06s/it] 30%|██▉       | 148/500 [07:16<13:04,  2.23s/it] 30%|██▉       | 149/500 [07:17<12:14,  2.09s/it] 30%|███       | 150/500 [07:21<13:59,  2.40s/it] 30%|███       | 151/500 [07:28<19:48,  3.41s/it] 31%|███       | 154/500 [07:31<13:36,  2.36s/it] 31%|███       | 155/500 [07:38<17:45,  3.09s/it] 31%|███▏      | 157/500 [07:40<13:59,  2.45s/it] 32%|███▏      | 158/500 [07:41<12:12,  2.14s/it] 32%|███▏      | 159/500 [07:47<16:33,  2.91s/it] 32%|███▏      | 160/500 [07:47<13:33,  2.39s/it] 32%|███▏      | 161/500 [07:53<17:34,  3.11s/it] 32%|███▏      | 162/500 [08:00<23:41,  4.21s/it] 33%|███▎      | 166/500 [08:02<10:38,  1.91s/it] 33%|███▎      | 167/500 [08:09<15:37,  2.82s/it] 34%|███▎      | 168/500 [08:25<31:07,  5.63s/it] 35%|███▌      | 175/500 [08:26<10:39,  1.97s/it] 35%|███▌      | 176/500 [08:29<10:59,  2.04s/it] 35%|███▌      | 177/500 [08:31<10:45,  2.00s/it] 36%|███▌      | 179/500 [08:49<22:16,  4.16s/it] 36%|███▋      | 182/500 [09:12<28:45,  5.43s/it] 38%|███▊      | 191/500 [09:15<11:39,  2.26s/it] 38%|███▊      | 192/500 [09:17<11:43,  2.28s/it] 39%|███▉      | 195/500 [09:21<10:19,  2.03s/it] 39%|███▉      | 197/500 [09:23<09:07,  1.81s/it] 40%|███▉      | 199/500 [09:29<10:18,  2.06s/it] 40%|████      | 201/500 [09:33<09:58,  2.00s/it] 41%|████      | 203/500 [09:36<09:19,  1.88s/it] 41%|████      | 204/500 [09:38<09:15,  1.88s/it] 41%|████      | 205/500 [09:40<09:37,  1.96s/it] 41%|████      | 206/500 [09:44<11:43,  2.39s/it] 41%|████▏     | 207/500 [09:49<13:56,  2.85s/it] 42%|████▏     | 211/500 [09:54<09:37,  2.00s/it] 43%|████▎     | 213/500 [10:31<32:21,  6.77s/it] 45%|████▍     | 223/500 [10:32<10:33,  2.29s/it] 45%|████▍     | 224/500 [10:52<17:44,  3.86s/it] 46%|████▌     | 230/500 [10:58<11:42,  2.60s/it] 46%|████▋     | 232/500 [10:59<10:15,  2.30s/it] 47%|████▋     | 234/500 [11:01<08:39,  1.95s/it] 47%|████▋     | 235/500 [11:01<07:53,  1.79s/it] 47%|████▋     | 236/500 [11:09<11:45,  2.67s/it] 48%|████▊     | 238/500 [11:11<09:42,  2.23s/it] 48%|████▊     | 240/500 [11:19<11:45,  2.71s/it] 49%|████▉     | 244/500 [11:23<08:13,  1.93s/it] 49%|████▉     | 246/500 [11:32<10:53,  2.57s/it] 50%|█████     | 250/500 [11:34<07:13,  1.73s/it] 50%|█████     | 251/500 [11:35<06:49,  1.65s/it] 50%|█████     | 252/500 [11:42<10:06,  2.45s/it] 51%|█████     | 254/500 [11:46<09:19,  2.27s/it] 51%|█████     | 256/500 [11:50<09:06,  2.24s/it] 51%|█████▏    | 257/500 [11:54<10:27,  2.58s/it] 52%|█████▏    | 259/500 [11:57<08:39,  2.16s/it] 52%|█████▏    | 261/500 [12:06<11:42,  2.94s/it] 53%|█████▎    | 263/500 [12:07<08:13,  2.08s/it] 53%|█████▎    | 264/500 [12:10<09:16,  2.36s/it] 53%|█████▎    | 265/500 [12:42<33:16,  8.49s/it] 55%|█████▍    | 273/500 [12:43<09:46,  2.58s/it] 55%|█████▍    | 274/500 [12:43<08:47,  2.33s/it] 55%|█████▌    | 275/500 [12:45<08:44,  2.33s/it] 55%|█████▌    | 276/500 [12:49<09:21,  2.51s/it] 55%|█████▌    | 277/500 [12:51<09:16,  2.50s/it] 56%|█████▌    | 279/500 [13:04<14:31,  3.94s/it] 56%|█████▌    | 280/500 [13:12<16:54,  4.61s/it] 57%|█████▋    | 283/500 [13:18<12:19,  3.41s/it] 57%|█████▋    | 286/500 [13:36<15:56,  4.47s/it] 58%|█████▊    | 291/500 [13:37<08:28,  2.43s/it] 58%|█████▊    | 292/500 [13:44<10:09,  2.93s/it] 59%|█████▊    | 293/500 [13:55<14:28,  4.19s/it] 60%|██████    | 300/500 [14:02<07:25,  2.23s/it] 60%|██████    | 302/500 [14:10<08:28,  2.57s/it] 61%|██████    | 303/500 [14:20<11:36,  3.54s/it] 61%|██████    | 306/500 [14:22<08:11,  2.53s/it] 62%|██████▏   | 308/500 [14:23<06:38,  2.08s/it] 62%|██████▏   | 309/500 [14:39<13:06,  4.12s/it] 63%|██████▎   | 313/500 [14:40<07:12,  2.31s/it] 63%|██████▎   | 315/500 [14:41<05:58,  1.94s/it] 63%|██████▎   | 316/500 [14:47<07:50,  2.56s/it] 64%|██████▎   | 318/500 [14:56<09:17,  3.06s/it] 64%|██████▍   | 319/500 [14:56<07:46,  2.58s/it] 64%|██████▍   | 320/500 [15:00<08:10,  2.72s/it] 64%|██████▍   | 321/500 [15:03<08:54,  2.99s/it] 65%|██████▍   | 323/500 [15:15<11:52,  4.03s/it] 65%|██████▌   | 327/500 [15:20<07:23,  2.56s/it] 66%|██████▌   | 330/500 [15:21<05:12,  1.84s/it] 66%|██████▌   | 331/500 [15:27<06:42,  2.38s/it] 66%|██████▋   | 332/500 [15:30<07:10,  2.56s/it] 67%|██████▋   | 334/500 [15:37<07:38,  2.76s/it] 67%|██████▋   | 335/500 [15:40<08:05,  2.94s/it] 67%|██████▋   | 337/500 [15:41<05:26,  2.00s/it] 68%|██████▊   | 338/500 [15:44<06:03,  2.24s/it] 68%|██████▊   | 339/500 [15:49<07:49,  2.91s/it] 68%|██████▊   | 342/500 [15:53<05:20,  2.03s/it] 69%|██████▊   | 343/500 [16:03<09:12,  3.52s/it] 69%|██████▉   | 346/500 [16:05<05:49,  2.27s/it] 69%|██████▉   | 347/500 [16:06<05:21,  2.10s/it] 70%|██████▉   | 348/500 [16:13<07:50,  3.10s/it] 70%|███████   | 352/500 [16:15<04:14,  1.72s/it] 71%|███████   | 353/500 [16:17<04:08,  1.69s/it] 71%|███████   | 354/500 [16:21<05:06,  2.10s/it] 71%|███████   | 355/500 [16:22<04:45,  1.97s/it] 71%|███████▏  | 357/500 [16:24<03:36,  1.52s/it] 72%|███████▏  | 358/500 [16:28<04:54,  2.08s/it] 72%|███████▏  | 360/500 [16:38<07:34,  3.24s/it] 72%|███████▏  | 362/500 [16:45<07:22,  3.21s/it] 73%|███████▎  | 364/500 [16:51<07:24,  3.27s/it] 73%|███████▎  | 366/500 [16:54<05:53,  2.64s/it] 74%|███████▎  | 368/500 [17:02<06:55,  3.15s/it] 74%|███████▍  | 369/500 [17:07<07:21,  3.37s/it] 74%|███████▍  | 372/500 [17:16<06:47,  3.18s/it] 75%|███████▍  | 374/500 [17:16<04:58,  2.37s/it] 75%|███████▌  | 376/500 [17:19<04:05,  1.98s/it] 75%|███████▌  | 377/500 [17:34<08:45,  4.27s/it] 77%|███████▋  | 383/500 [17:36<03:44,  1.92s/it] 77%|███████▋  | 385/500 [17:42<04:13,  2.20s/it] 77%|███████▋  | 386/500 [17:47<04:46,  2.51s/it] 78%|███████▊  | 390/500 [17:51<03:30,  1.92s/it] 79%|███████▊  | 393/500 [17:55<02:59,  1.68s/it] 79%|███████▉  | 394/500 [17:57<03:07,  1.76s/it] 79%|███████▉  | 395/500 [17:59<03:06,  1.77s/it] 79%|███████▉  | 396/500 [18:02<03:32,  2.04s/it] 80%|███████▉  | 398/500 [18:03<02:33,  1.50s/it] 80%|███████▉  | 399/500 [18:14<05:41,  3.38s/it] 80%|████████  | 402/500 [18:15<03:10,  1.94s/it] 81%|████████  | 403/500 [18:29<06:34,  4.07s/it] 82%|████████▏ | 408/500 [18:33<03:32,  2.31s/it] 82%|████████▏ | 409/500 [18:34<03:08,  2.08s/it] 82%|████████▏ | 411/500 [18:42<03:54,  2.63s/it] 83%|████████▎ | 413/500 [19:11<08:51,  6.11s/it] 85%|████████▍ | 423/500 [19:15<02:51,  2.23s/it] 85%|████████▌ | 425/500 [19:18<02:38,  2.11s/it] 85%|████████▌ | 426/500 [19:21<02:44,  2.22s/it] 86%|████████▌ | 428/500 [19:21<02:05,  1.74s/it] 86%|████████▌ | 429/500 [19:29<02:59,  2.53s/it] 86%|████████▌ | 431/500 [19:33<02:52,  2.51s/it] 87%|████████▋ | 433/500 [19:38<02:41,  2.42s/it] 87%|████████▋ | 434/500 [19:57<05:46,  5.25s/it] 88%|████████▊ | 438/500 [19:58<02:57,  2.86s/it] 88%|████████▊ | 440/500 [20:00<02:21,  2.36s/it] 88%|████████▊ | 441/500 [20:16<04:22,  4.45s/it] 89%|████████▉ | 446/500 [20:23<02:31,  2.80s/it] 89%|████████▉ | 447/500 [20:36<03:41,  4.18s/it] 90%|█████████ | 451/500 [20:40<02:16,  2.79s/it] 91%|█████████ | 453/500 [20:40<01:41,  2.15s/it] 91%|█████████ | 454/500 [20:49<02:25,  3.16s/it] 91%|█████████ | 456/500 [20:49<01:40,  2.28s/it] 91%|█████████▏| 457/500 [20:52<01:37,  2.28s/it] 92%|█████████▏| 458/500 [20:57<01:58,  2.83s/it] 92%|█████████▏| 460/500 [21:10<02:48,  4.20s/it] 93%|█████████▎| 464/500 [21:12<01:22,  2.30s/it] 93%|█████████▎| 466/500 [21:16<01:17,  2.27s/it] 94%|█████████▍| 469/500 [21:17<00:50,  1.61s/it] 94%|█████████▍| 470/500 [21:28<01:27,  2.90s/it] 95%|█████████▍| 473/500 [21:29<00:50,  1.87s/it] 95%|█████████▌| 475/500 [21:42<01:20,  3.22s/it] 95%|█████████▌| 477/500 [21:44<00:58,  2.53s/it] 96%|█████████▌| 478/500 [21:46<00:52,  2.40s/it] 96%|█████████▌| 479/500 [21:48<00:52,  2.48s/it] 96%|█████████▌| 481/500 [21:50<00:36,  1.91s/it] 96%|█████████▋| 482/500 [21:51<00:32,  1.80s/it] 97%|█████████▋| 483/500 [21:57<00:45,  2.69s/it] 97%|█████████▋| 485/500 [22:11<01:04,  4.32s/it] 98%|█████████▊| 489/500 [22:20<00:35,  3.27s/it] 98%|█████████▊| 492/500 [22:22<00:18,  2.27s/it] 99%|█████████▊| 493/500 [22:22<00:13,  1.95s/it] 99%|█████████▉| 494/500 [22:31<00:18,  3.11s/it] 99%|█████████▉| 496/500 [22:34<00:10,  2.64s/it]100%|█████████▉| 498/500 [22:41<00:05,  2.97s/it]100%|██████████| 500/500 [22:41<00:00,  2.72s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
Regenerating missing GPT-4 file for split data file: chunk_2.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 147 / 147
  0%|          | 0/147 [00:00<?, ?it/s]  1%|          | 1/147 [00:07<18:01,  7.41s/it]  1%|▏         | 2/147 [00:10<11:26,  4.74s/it]  3%|▎         | 5/147 [00:18<07:45,  3.28s/it]  4%|▍         | 6/147 [00:22<07:57,  3.38s/it]  6%|▌         | 9/147 [00:23<04:17,  1.86s/it]  7%|▋         | 10/147 [00:26<04:52,  2.14s/it]  7%|▋         | 11/147 [00:41<10:56,  4.83s/it]  9%|▉         | 13/147 [00:44<08:06,  3.63s/it] 10%|█         | 15/147 [00:45<05:39,  2.57s/it] 11%|█         | 16/147 [00:48<05:30,  2.52s/it] 12%|█▏        | 17/147 [00:59<09:34,  4.42s/it] 13%|█▎        | 19/147 [01:05<08:34,  4.02s/it] 16%|█▋        | 24/147 [01:10<04:27,  2.18s/it] 18%|█▊        | 26/147 [01:10<03:28,  1.73s/it] 18%|█▊        | 27/147 [01:15<04:10,  2.09s/it] 20%|█▉        | 29/147 [01:20<04:27,  2.27s/it] 20%|██        | 30/147 [01:23<04:51,  2.49s/it] 21%|██        | 31/147 [01:25<04:29,  2.32s/it] 22%|██▏       | 32/147 [01:32<06:26,  3.36s/it] 23%|██▎       | 34/147 [01:57<12:55,  6.86s/it] 27%|██▋       | 39/147 [02:00<05:44,  3.19s/it] 28%|██▊       | 41/147 [02:16<07:56,  4.49s/it] 29%|██▉       | 43/147 [02:20<06:33,  3.78s/it] 30%|██▉       | 44/147 [02:38<10:19,  6.01s/it] 32%|███▏      | 47/147 [02:41<06:36,  3.96s/it] 33%|███▎      | 48/147 [02:57<09:49,  5.96s/it] 36%|███▌      | 53/147 [02:59<04:41,  3.00s/it] 37%|███▋      | 54/147 [03:11<06:33,  4.23s/it] 37%|███▋      | 55/147 [03:12<05:37,  3.67s/it] 39%|███▉      | 57/147 [03:26<07:02,  4.70s/it] 42%|████▏     | 62/147 [03:29<03:36,  2.55s/it] 43%|████▎     | 63/147 [03:30<03:18,  2.36s/it] 44%|████▎     | 64/147 [03:37<04:13,  3.06s/it] 44%|████▍     | 65/147 [03:42<04:34,  3.35s/it] 46%|████▌     | 67/147 [03:45<03:37,  2.72s/it] 46%|████▋     | 68/147 [03:57<05:57,  4.53s/it] 48%|████▊     | 71/147 [03:59<03:38,  2.88s/it] 50%|████▉     | 73/147 [04:02<02:57,  2.40s/it] 50%|█████     | 74/147 [04:10<04:03,  3.33s/it] 52%|█████▏    | 76/147 [04:11<02:48,  2.37s/it] 52%|█████▏    | 77/147 [04:12<02:31,  2.16s/it] 53%|█████▎    | 78/147 [04:16<02:54,  2.54s/it] 54%|█████▎    | 79/147 [04:24<04:28,  3.95s/it] 56%|█████▌    | 82/147 [04:25<02:20,  2.17s/it] 56%|█████▋    | 83/147 [04:26<01:56,  1.82s/it] 57%|█████▋    | 84/147 [04:39<04:29,  4.28s/it] 59%|█████▊    | 86/147 [04:42<03:12,  3.16s/it] 60%|█████▉    | 88/147 [04:43<02:15,  2.30s/it] 61%|██████    | 89/147 [04:43<01:49,  1.88s/it] 61%|██████    | 90/147 [04:47<02:03,  2.17s/it] 62%|██████▏   | 91/147 [05:00<04:39,  5.00s/it] 65%|██████▌   | 96/147 [05:22<03:50,  4.52s/it] 67%|██████▋   | 99/147 [05:33<03:23,  4.23s/it] 71%|███████   | 104/147 [05:33<01:39,  2.32s/it] 71%|███████▏  | 105/147 [05:42<02:08,  3.05s/it] 73%|███████▎  | 108/147 [05:45<01:34,  2.42s/it] 74%|███████▍  | 109/147 [05:46<01:21,  2.16s/it] 75%|███████▍  | 110/147 [05:48<01:22,  2.24s/it] 76%|███████▌  | 111/147 [05:49<01:12,  2.02s/it] 77%|███████▋  | 113/147 [05:53<01:06,  1.97s/it] 78%|███████▊  | 115/147 [05:58<01:06,  2.06s/it] 80%|███████▉  | 117/147 [05:59<00:48,  1.63s/it] 80%|████████  | 118/147 [06:04<01:07,  2.34s/it] 81%|████████  | 119/147 [06:20<02:22,  5.09s/it] 85%|████████▌ | 125/147 [06:30<01:03,  2.90s/it] 86%|████████▋ | 127/147 [06:31<00:46,  2.33s/it] 87%|████████▋ | 128/147 [06:36<00:50,  2.67s/it] 88%|████████▊ | 129/147 [06:39<00:50,  2.79s/it] 90%|████████▉ | 132/147 [06:40<00:27,  1.82s/it] 91%|█████████ | 134/147 [06:46<00:27,  2.10s/it] 92%|█████████▏| 135/147 [06:50<00:29,  2.45s/it] 93%|█████████▎| 137/147 [06:51<00:17,  1.71s/it] 94%|█████████▍| 138/147 [07:03<00:33,  3.72s/it] 96%|█████████▌| 141/147 [07:03<00:12,  2.14s/it] 97%|█████████▋| 142/147 [07:07<00:11,  2.33s/it] 97%|█████████▋| 143/147 [07:07<00:08,  2.02s/it] 98%|█████████▊| 144/147 [07:14<00:09,  3.08s/it]100%|██████████| 147/147 [07:23<00:00,  3.00s/it]100%|██████████| 147/147 [07:23<00:00,  3.02s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 2
[INFO] end_time: 2024-08-29 20:33:31
[INFO] duration: 33 min 
[2024-08-30 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-28/2024-08-28_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-30 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-28/2024-08-28_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-08-28
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-28/2024-08-28_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-28/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-28/raw/single_True_rag_True/split_data/chunk_1.csv
Saved chunk 2 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-28/raw/single_True_rag_True/split_data/chunk_2.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 500 / 500
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:08<1:09:26,  8.35s/it]  1%|          | 3/500 [00:09<22:27,  2.71s/it]    1%|          | 4/500 [00:28<1:09:12,  8.37s/it]  2%|▏         | 9/500 [00:36<28:12,  3.45s/it]    2%|▏         | 10/500 [00:39<28:30,  3.49s/it]  3%|▎         | 13/500 [00:40<17:02,  2.10s/it]  3%|▎         | 14/500 [00:48<24:50,  3.07s/it]  3%|▎         | 16/500 [00:50<20:05,  2.49s/it]  3%|▎         | 17/500 [00:53<19:36,  2.44s/it]  4%|▎         | 18/500 [00:56<21:08,  2.63s/it]  4%|▍         | 20/500 [01:02<22:05,  2.76s/it]  4%|▍         | 21/500 [01:03<18:37,  2.33s/it]  5%|▍         | 24/500 [01:06<14:26,  1.82s/it]  5%|▌         | 25/500 [01:08<13:41,  1.73s/it]  5%|▌         | 27/500 [01:10<12:36,  1.60s/it]  6%|▌         | 28/500 [01:15<17:00,  2.16s/it]  6%|▌         | 29/500 [01:18<18:51,  2.40s/it]  6%|▌         | 31/500 [01:18<12:01,  1.54s/it]  6%|▋         | 32/500 [01:23<16:27,  2.11s/it]  7%|▋         | 33/500 [01:25<17:34,  2.26s/it]  7%|▋         | 36/500 [01:28<12:23,  1.60s/it]  7%|▋         | 37/500 [01:35<19:32,  2.53s/it]  8%|▊         | 40/500 [01:36<12:35,  1.64s/it]  8%|▊         | 41/500 [01:40<14:43,  1.93s/it]  9%|▊         | 43/500 [01:43<14:14,  1.87s/it]  9%|▉         | 44/500 [01:44<12:21,  1.63s/it]  9%|▉         | 45/500 [01:45<11:17,  1.49s/it]  9%|▉         | 46/500 [01:47<12:12,  1.61s/it]  9%|▉         | 47/500 [01:53<20:30,  2.72s/it] 10%|▉         | 49/500 [01:54<13:34,  1.81s/it] 10%|█         | 51/500 [02:01<18:46,  2.51s/it] 10%|█         | 52/500 [02:02<16:20,  2.19s/it] 11%|█         | 53/500 [02:04<15:52,  2.13s/it] 11%|█         | 54/500 [02:17<35:39,  4.80s/it] 12%|█▏        | 59/500 [02:19<14:29,  1.97s/it] 12%|█▏        | 60/500 [02:20<13:50,  1.89s/it] 12%|█▏        | 61/500 [02:23<14:51,  2.03s/it] 12%|█▏        | 62/500 [02:30<22:16,  3.05s/it] 13%|█▎        | 65/500 [02:32<14:25,  1.99s/it] 13%|█▎        | 66/500 [02:36<16:45,  2.32s/it] 13%|█▎        | 67/500 [02:37<14:47,  2.05s/it] 14%|█▎        | 68/500 [02:52<36:10,  5.02s/it] 14%|█▍        | 71/500 [02:54<20:17,  2.84s/it] 14%|█▍        | 72/500 [02:54<17:01,  2.39s/it] 15%|█▍        | 73/500 [02:59<20:51,  2.93s/it] 15%|█▌        | 76/500 [03:09<21:03,  2.98s/it] 15%|█▌        | 77/500 [03:09<18:03,  2.56s/it] 16%|█▌        | 79/500 [03:12<14:32,  2.07s/it] 16%|█▌        | 80/500 [03:14<15:29,  2.21s/it] 16%|█▋        | 82/500 [03:18<15:02,  2.16s/it] 17%|█▋        | 84/500 [03:27<19:59,  2.88s/it] 18%|█▊        | 88/500 [03:32<14:10,  2.07s/it] 18%|█▊        | 90/500 [03:41<18:51,  2.76s/it] 19%|█▉        | 96/500 [03:53<15:26,  2.29s/it] 19%|█▉        | 97/500 [03:55<15:16,  2.27s/it] 20%|█▉        | 98/500 [03:55<13:40,  2.04s/it] 20%|█▉        | 99/500 [04:02<19:00,  2.84s/it] 20%|██        | 100/500 [04:03<16:07,  2.42s/it] 20%|██        | 101/500 [04:04<13:37,  2.05s/it] 20%|██        | 102/500 [04:21<37:28,  5.65s/it] 21%|██        | 105/500 [04:27<24:45,  3.76s/it] 22%|██▏       | 108/500 [04:28<15:22,  2.35s/it] 22%|██▏       | 110/500 [04:30<13:01,  2.01s/it] 22%|██▏       | 111/500 [04:31<12:08,  1.87s/it] 22%|██▏       | 112/500 [04:36<16:11,  2.50s/it] 23%|██▎       | 114/500 [04:39<13:19,  2.07s/it] 23%|██▎       | 116/500 [04:44<14:23,  2.25s/it] 23%|██▎       | 117/500 [04:53<22:36,  3.54s/it] 24%|██▍       | 121/500 [04:56<13:05,  2.07s/it] 25%|██▍       | 123/500 [05:00<12:41,  2.02s/it] 25%|██▍       | 124/500 [05:02<12:22,  1.97s/it] 25%|██▌       | 126/500 [05:14<20:52,  3.35s/it] 26%|██▌       | 129/500 [05:14<12:35,  2.04s/it] 26%|██▌       | 131/500 [05:24<16:45,  2.72s/it] 27%|██▋       | 134/500 [05:34<18:41,  3.06s/it] 27%|██▋       | 135/500 [05:36<17:31,  2.88s/it] 28%|██▊       | 138/500 [05:39<12:53,  2.14s/it] 28%|██▊       | 139/500 [05:51<22:20,  3.71s/it] 28%|██▊       | 142/500 [05:53<14:20,  2.40s/it] 29%|██▉       | 144/500 [05:56<12:40,  2.14s/it] 29%|██▉       | 146/500 [05:58<11:03,  1.87s/it] 29%|██▉       | 147/500 [06:00<10:57,  1.86s/it] 30%|██▉       | 148/500 [06:11<21:12,  3.62s/it] 30%|███       | 152/500 [06:11<10:16,  1.77s/it] 31%|███       | 153/500 [06:12<08:55,  1.54s/it] 31%|███       | 154/500 [06:15<10:29,  1.82s/it] 31%|███       | 155/500 [06:16<09:29,  1.65s/it] 31%|███▏      | 157/500 [06:19<09:15,  1.62s/it] 32%|███▏      | 158/500 [06:19<07:26,  1.31s/it] 32%|███▏      | 160/500 [06:24<09:44,  1.72s/it] 32%|███▏      | 162/500 [06:29<11:40,  2.07s/it] 33%|███▎      | 164/500 [06:30<08:21,  1.49s/it] 33%|███▎      | 166/500 [06:34<09:12,  1.66s/it] 33%|███▎      | 167/500 [06:37<11:11,  2.02s/it] 34%|███▍      | 169/500 [06:40<09:40,  1.75s/it] 34%|███▍      | 171/500 [06:42<08:05,  1.48s/it] 34%|███▍      | 172/500 [06:44<08:29,  1.55s/it] 35%|███▍      | 173/500 [06:45<08:29,  1.56s/it] 35%|███▍      | 174/500 [06:53<16:15,  2.99s/it] 36%|███▌      | 179/500 [07:11<18:11,  3.40s/it] 37%|███▋      | 186/500 [07:13<08:41,  1.66s/it] 37%|███▋      | 187/500 [07:23<13:02,  2.50s/it] 38%|███▊      | 190/500 [07:28<11:53,  2.30s/it] 38%|███▊      | 191/500 [07:34<13:47,  2.68s/it] 39%|███▉      | 195/500 [07:36<08:57,  1.76s/it] 39%|███▉      | 197/500 [07:37<07:50,  1.55s/it] 40%|███▉      | 198/500 [07:39<08:14,  1.64s/it] 40%|███▉      | 199/500 [07:40<07:12,  1.44s/it] 40%|████      | 200/500 [07:42<08:01,  1.60s/it] 40%|████      | 201/500 [07:43<07:10,  1.44s/it] 41%|████      | 203/500 [07:46<06:42,  1.35s/it] 41%|████      | 204/500 [07:47<06:59,  1.42s/it] 41%|████      | 205/500 [07:54<13:01,  2.65s/it] 42%|████▏     | 208/500 [07:58<09:57,  2.04s/it] 42%|████▏     | 211/500 [08:01<07:20,  1.52s/it] 42%|████▏     | 212/500 [08:05<09:17,  1.94s/it] 43%|████▎     | 215/500 [08:05<05:57,  1.26s/it] 43%|████▎     | 216/500 [08:11<08:59,  1.90s/it] 44%|████▍     | 219/500 [08:16<08:41,  1.85s/it] 44%|████▍     | 220/500 [08:21<10:42,  2.29s/it] 45%|████▍     | 224/500 [08:21<05:49,  1.26s/it] 45%|████▌     | 225/500 [08:29<10:16,  2.24s/it] 46%|████▌     | 228/500 [08:30<06:30,  1.43s/it] 46%|████▌     | 229/500 [08:32<07:12,  1.60s/it] 46%|████▌     | 230/500 [08:34<07:11,  1.60s/it] 46%|████▌     | 231/500 [08:36<08:11,  1.83s/it] 46%|████▋     | 232/500 [08:40<09:49,  2.20s/it] 47%|████▋     | 233/500 [08:43<10:56,  2.46s/it] 47%|████▋     | 235/500 [08:47<10:17,  2.33s/it] 47%|████▋     | 236/500 [09:05<25:59,  5.91s/it] 48%|████▊     | 241/500 [09:08<11:18,  2.62s/it] 49%|████▊     | 243/500 [09:20<14:46,  3.45s/it] 50%|████▉     | 249/500 [09:28<09:56,  2.37s/it] 50%|█████     | 251/500 [09:29<07:59,  1.93s/it] 50%|█████     | 252/500 [09:35<10:19,  2.50s/it] 51%|█████     | 254/500 [09:45<12:44,  3.11s/it] 52%|█████▏    | 259/500 [09:46<06:47,  1.69s/it] 52%|█████▏    | 260/500 [09:48<06:49,  1.71s/it] 52%|█████▏    | 261/500 [09:49<06:35,  1.65s/it] 52%|█████▏    | 262/500 [09:51<06:49,  1.72s/it] 53%|█████▎    | 263/500 [09:59<11:55,  3.02s/it] 53%|█████▎    | 264/500 [10:01<10:30,  2.67s/it] 53%|█████▎    | 266/500 [10:06<10:26,  2.68s/it] 53%|█████▎    | 267/500 [10:06<08:24,  2.16s/it] 54%|█████▎    | 268/500 [10:13<12:06,  3.13s/it] 54%|█████▍    | 270/500 [10:21<13:40,  3.57s/it] 55%|█████▌    | 276/500 [10:25<06:23,  1.71s/it] 56%|█████▌    | 280/500 [10:36<07:39,  2.09s/it] 57%|█████▋    | 286/500 [10:42<05:48,  1.63s/it] 58%|█████▊    | 289/500 [10:44<04:46,  1.36s/it] 58%|█████▊    | 290/500 [10:46<05:05,  1.46s/it] 58%|█████▊    | 292/500 [10:47<04:12,  1.22s/it] 59%|█████▊    | 293/500 [10:51<05:43,  1.66s/it] 59%|█████▉    | 294/500 [10:54<06:41,  1.95s/it] 59%|█████▉    | 296/500 [10:56<05:30,  1.62s/it] 59%|█████▉    | 297/500 [10:57<04:56,  1.46s/it] 60%|█████▉    | 298/500 [11:04<09:03,  2.69s/it] 60%|██████    | 300/500 [11:06<06:26,  1.93s/it] 60%|██████    | 301/500 [11:09<07:40,  2.32s/it] 61%|██████    | 304/500 [11:12<05:26,  1.66s/it] 61%|██████▏   | 307/500 [11:20<06:26,  2.00s/it] 62%|██████▏   | 310/500 [11:23<05:21,  1.69s/it] 63%|██████▎   | 313/500 [11:27<04:53,  1.57s/it] 63%|██████▎   | 316/500 [11:28<03:34,  1.16s/it] 63%|██████▎   | 317/500 [11:30<03:57,  1.30s/it] 64%|██████▎   | 318/500 [11:32<03:57,  1.30s/it] 64%|██████▍   | 319/500 [11:39<07:25,  2.46s/it] 64%|██████▍   | 320/500 [11:44<08:57,  2.99s/it] 64%|██████▍   | 322/500 [11:48<07:35,  2.56s/it] 65%|██████▍   | 323/500 [11:52<08:32,  2.89s/it] 65%|██████▌   | 326/500 [11:58<06:56,  2.39s/it] 65%|██████▌   | 327/500 [12:02<08:08,  2.82s/it] 66%|██████▌   | 329/500 [12:03<05:45,  2.02s/it] 66%|██████▌   | 330/500 [12:10<08:24,  2.97s/it] 67%|██████▋   | 333/500 [12:11<04:41,  1.69s/it] 67%|██████▋   | 335/500 [12:12<04:00,  1.46s/it] 67%|██████▋   | 336/500 [12:16<05:07,  1.88s/it] 68%|██████▊   | 338/500 [12:17<03:45,  1.39s/it] 68%|██████▊   | 339/500 [12:22<05:26,  2.03s/it] 68%|██████▊   | 340/500 [12:24<05:31,  2.07s/it] 68%|██████▊   | 342/500 [12:30<06:35,  2.51s/it] 69%|██████▉   | 344/500 [12:33<05:18,  2.04s/it] 69%|██████▉   | 345/500 [12:35<05:23,  2.08s/it] 69%|██████▉   | 347/500 [12:39<05:10,  2.03s/it] 70%|██████▉   | 348/500 [12:40<04:30,  1.78s/it] 70%|██████▉   | 349/500 [13:02<16:02,  6.37s/it] 71%|███████   | 356/500 [13:02<04:43,  1.97s/it] 71%|███████▏  | 357/500 [13:12<06:56,  2.91s/it] 72%|███████▏  | 358/500 [13:12<05:53,  2.49s/it] 72%|███████▏  | 360/500 [13:14<05:02,  2.16s/it] 72%|███████▏  | 362/500 [13:15<03:45,  1.64s/it] 73%|███████▎  | 363/500 [13:20<04:55,  2.16s/it] 73%|███████▎  | 364/500 [13:24<05:49,  2.57s/it] 74%|███████▎  | 368/500 [13:25<02:58,  1.36s/it] 74%|███████▍  | 369/500 [13:33<05:13,  2.39s/it] 74%|███████▍  | 372/500 [13:40<04:59,  2.34s/it] 75%|███████▌  | 376/500 [13:56<06:18,  3.05s/it] 76%|███████▌  | 381/500 [14:03<04:36,  2.32s/it] 77%|███████▋  | 384/500 [14:06<03:53,  2.01s/it] 77%|███████▋  | 386/500 [14:07<03:14,  1.71s/it] 77%|███████▋  | 387/500 [14:10<03:33,  1.89s/it] 78%|███████▊  | 389/500 [14:11<02:40,  1.45s/it] 78%|███████▊  | 390/500 [14:17<03:59,  2.18s/it] 78%|███████▊  | 392/500 [14:22<04:05,  2.27s/it] 79%|███████▉  | 394/500 [14:22<02:50,  1.60s/it] 79%|███████▉  | 396/500 [14:24<02:17,  1.32s/it] 79%|███████▉  | 397/500 [14:29<03:39,  2.13s/it] 80%|████████  | 400/500 [14:32<02:41,  1.62s/it] 80%|████████  | 402/500 [14:44<04:44,  2.90s/it] 81%|████████  | 406/500 [14:45<02:33,  1.63s/it] 81%|████████▏ | 407/500 [14:47<02:42,  1.75s/it] 82%|████████▏ | 408/500 [14:51<03:09,  2.06s/it] 82%|████████▏ | 411/500 [14:53<02:09,  1.45s/it] 82%|████████▏ | 412/500 [14:54<02:11,  1.49s/it] 83%|████████▎ | 414/500 [14:59<02:36,  1.83s/it] 83%|████████▎ | 415/500 [15:03<03:03,  2.16s/it] 83%|████████▎ | 416/500 [15:04<02:37,  1.87s/it] 83%|████████▎ | 417/500 [15:10<04:02,  2.92s/it] 84%|████████▎ | 418/500 [15:21<06:36,  4.83s/it] 84%|████████▍ | 421/500 [15:26<04:17,  3.26s/it] 85%|████████▍ | 424/500 [15:27<02:30,  1.98s/it] 85%|████████▌ | 425/500 [15:30<02:46,  2.22s/it] 85%|████████▌ | 427/500 [15:32<02:07,  1.74s/it] 86%|████████▌ | 428/500 [15:34<02:14,  1.86s/it] 86%|████████▌ | 430/500 [15:34<01:26,  1.24s/it] 86%|████████▌ | 431/500 [15:40<02:31,  2.20s/it] 86%|████████▋ | 432/500 [15:49<04:11,  3.70s/it] 88%|████████▊ | 438/500 [15:51<01:30,  1.46s/it] 88%|████████▊ | 439/500 [15:55<01:48,  1.78s/it] 88%|████████▊ | 441/500 [16:00<01:56,  1.97s/it] 89%|████████▊ | 443/500 [16:22<04:21,  4.59s/it] 90%|████████▉ | 449/500 [16:25<01:59,  2.35s/it] 90%|█████████ | 451/500 [16:33<02:11,  2.68s/it] 91%|█████████ | 453/500 [16:34<01:45,  2.24s/it] 91%|█████████ | 455/500 [16:43<02:02,  2.71s/it] 92%|█████████▏| 459/500 [16:46<01:18,  1.92s/it] 92%|█████████▏| 460/500 [16:46<01:09,  1.73s/it] 92%|█████████▏| 461/500 [16:50<01:19,  2.04s/it] 92%|█████████▏| 462/500 [16:51<01:06,  1.74s/it] 93%|█████████▎| 464/500 [16:55<01:09,  1.94s/it] 93%|█████████▎| 466/500 [16:59<01:05,  1.93s/it] 93%|█████████▎| 467/500 [17:04<01:19,  2.42s/it] 94%|█████████▍| 470/500 [17:10<01:10,  2.35s/it] 95%|█████████▍| 473/500 [17:12<00:43,  1.61s/it] 95%|█████████▍| 474/500 [17:17<00:58,  2.24s/it] 95%|█████████▌| 475/500 [17:20<00:56,  2.28s/it] 95%|█████████▌| 477/500 [17:25<00:53,  2.32s/it] 96%|█████████▌| 478/500 [17:25<00:42,  1.94s/it] 96%|█████████▌| 479/500 [17:28<00:46,  2.21s/it] 96%|█████████▌| 480/500 [17:28<00:34,  1.74s/it] 96%|█████████▌| 481/500 [17:32<00:42,  2.24s/it] 97%|█████████▋| 483/500 [17:46<01:10,  4.15s/it] 98%|█████████▊| 488/500 [17:49<00:24,  2.04s/it] 98%|█████████▊| 491/500 [17:50<00:12,  1.43s/it] 98%|█████████▊| 492/500 [17:54<00:15,  1.90s/it] 99%|█████████▉| 494/500 [18:01<00:13,  2.32s/it] 99%|█████████▉| 495/500 [18:05<00:12,  2.59s/it] 99%|█████████▉| 496/500 [18:08<00:10,  2.65s/it]100%|█████████▉| 498/500 [18:12<00:05,  2.51s/it]100%|█████████▉| 499/500 [18:17<00:02,  2.87s/it]100%|██████████| 500/500 [18:17<00:00,  2.35s/it]100%|██████████| 500/500 [18:17<00:00,  2.20s/it]
Parsing GPT-4 response
Regenerating missing GPT-4 file for split data file: chunk_2.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 88 / 88
  0%|          | 0/88 [00:00<?, ?it/s]  1%|          | 1/88 [00:08<12:38,  8.72s/it]  2%|▏         | 2/88 [00:10<07:03,  4.93s/it]  3%|▎         | 3/88 [00:12<05:05,  3.59s/it]  6%|▌         | 5/88 [00:16<03:42,  2.68s/it]  7%|▋         | 6/88 [00:17<02:49,  2.07s/it]  8%|▊         | 7/88 [00:22<03:52,  2.87s/it] 11%|█▏        | 10/88 [00:31<03:51,  2.97s/it] 14%|█▎        | 12/88 [00:32<02:47,  2.20s/it] 15%|█▍        | 13/88 [00:34<02:40,  2.15s/it] 16%|█▌        | 14/88 [00:38<03:08,  2.54s/it] 19%|█▉        | 17/88 [00:42<02:13,  1.89s/it] 22%|██▏       | 19/88 [00:52<03:18,  2.88s/it] 25%|██▌       | 22/88 [00:54<02:09,  1.96s/it] 27%|██▋       | 24/88 [00:59<02:13,  2.08s/it] 31%|███       | 27/88 [00:59<01:24,  1.38s/it] 32%|███▏      | 28/88 [01:08<02:29,  2.50s/it] 33%|███▎      | 29/88 [01:13<02:56,  3.00s/it] 36%|███▋      | 32/88 [01:22<02:49,  3.02s/it] 43%|████▎     | 38/88 [01:26<01:24,  1.69s/it] 45%|████▌     | 40/88 [01:29<01:17,  1.62s/it] 47%|████▋     | 41/88 [01:34<01:35,  2.03s/it] 49%|████▉     | 43/88 [01:36<01:18,  1.75s/it] 50%|█████     | 44/88 [01:37<01:16,  1.74s/it] 52%|█████▏    | 46/88 [01:39<01:00,  1.43s/it] 53%|█████▎    | 47/88 [01:40<00:56,  1.38s/it] 55%|█████▍    | 48/88 [01:44<01:14,  1.86s/it] 56%|█████▌    | 49/88 [01:49<01:39,  2.54s/it] 59%|█████▉    | 52/88 [01:50<00:54,  1.50s/it] 61%|██████▏   | 54/88 [01:55<01:00,  1.78s/it] 64%|██████▎   | 56/88 [01:55<00:40,  1.25s/it] 65%|██████▍   | 57/88 [02:02<01:10,  2.27s/it] 66%|██████▌   | 58/88 [02:02<00:55,  1.85s/it] 68%|██████▊   | 60/88 [02:10<01:17,  2.76s/it] 72%|███████▏  | 63/88 [02:12<00:43,  1.74s/it] 73%|███████▎  | 64/88 [02:12<00:35,  1.47s/it] 74%|███████▍  | 65/88 [02:21<01:09,  3.01s/it] 77%|███████▋  | 68/88 [02:22<00:34,  1.73s/it] 78%|███████▊  | 69/88 [02:22<00:27,  1.47s/it] 80%|███████▉  | 70/88 [02:31<00:54,  3.04s/it] 81%|████████  | 71/88 [02:40<01:15,  4.41s/it] 86%|████████▋ | 76/88 [02:42<00:21,  1.82s/it] 89%|████████▊ | 78/88 [02:45<00:17,  1.80s/it] 91%|█████████ | 80/88 [02:50<00:15,  1.94s/it] 92%|█████████▏| 81/88 [03:17<00:42,  6.11s/it]100%|██████████| 88/88 [03:17<00:00,  2.25s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 2
[INFO] end_time: 2024-08-30 20:25:05
[INFO] duration: 25 min 
[2024-08-31 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-29/2024-08-29_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-31 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-29/2024-08-29_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-08-29
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-29/2024-08-29_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-29/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-29/raw/single_True_rag_True/split_data/chunk_1.csv
Saved chunk 2 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-29/raw/single_True_rag_True/split_data/chunk_2.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 500 / 500
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:13<1:55:33, 13.89s/it]  0%|          | 2/500 [00:18<1:11:31,  8.62s/it]  1%|▏         | 7/500 [00:21<16:41,  2.03s/it]    2%|▏         | 8/500 [00:21<13:44,  1.68s/it]  2%|▏         | 9/500 [00:22<13:29,  1.65s/it]  2%|▏         | 10/500 [00:26<16:35,  2.03s/it]  3%|▎         | 13/500 [00:31<16:01,  1.97s/it]  3%|▎         | 14/500 [00:36<19:21,  2.39s/it]  4%|▍         | 20/500 [00:38<09:42,  1.21s/it]  4%|▍         | 21/500 [00:39<08:32,  1.07s/it]  5%|▍         | 23/500 [00:42<10:05,  1.27s/it]  5%|▌         | 25/500 [00:44<09:06,  1.15s/it]  5%|▌         | 26/500 [00:44<07:45,  1.02it/s]  5%|▌         | 27/500 [00:44<06:35,  1.20it/s]  6%|▌         | 28/500 [00:49<12:47,  1.63s/it]  6%|▌         | 29/500 [00:49<10:21,  1.32s/it]  6%|▌         | 31/500 [00:51<08:59,  1.15s/it]  6%|▋         | 32/500 [00:54<12:43,  1.63s/it]  7%|▋         | 34/500 [00:55<08:12,  1.06s/it]  7%|▋         | 36/500 [01:00<13:04,  1.69s/it]  8%|▊         | 40/500 [01:02<08:15,  1.08s/it]  8%|▊         | 41/500 [01:04<09:19,  1.22s/it]  8%|▊         | 42/500 [01:05<09:22,  1.23s/it]  9%|▊         | 43/500 [01:06<07:51,  1.03s/it]  9%|▉         | 44/500 [01:08<10:34,  1.39s/it]  9%|▉         | 45/500 [01:10<10:22,  1.37s/it]  9%|▉         | 46/500 [01:18<23:17,  3.08s/it] 10%|▉         | 49/500 [01:18<11:32,  1.54s/it] 10%|█         | 50/500 [01:23<17:15,  2.30s/it] 11%|█         | 53/500 [01:27<13:21,  1.79s/it] 11%|█         | 55/500 [01:27<09:28,  1.28s/it] 11%|█         | 56/500 [01:31<12:42,  1.72s/it] 11%|█▏        | 57/500 [01:31<10:36,  1.44s/it] 12%|█▏        | 58/500 [01:37<18:18,  2.49s/it] 12%|█▏        | 59/500 [01:38<15:50,  2.16s/it] 12%|█▏        | 61/500 [01:41<13:54,  1.90s/it] 12%|█▏        | 62/500 [01:42<11:04,  1.52s/it] 13%|█▎        | 63/500 [01:44<12:24,  1.70s/it] 13%|█▎        | 64/500 [01:49<18:46,  2.58s/it] 13%|█▎        | 67/500 [01:55<16:40,  2.31s/it] 14%|█▎        | 68/500 [02:01<22:15,  3.09s/it] 14%|█▍        | 72/500 [02:04<12:49,  1.80s/it] 15%|█▍        | 73/500 [02:06<13:23,  1.88s/it] 15%|█▍        | 74/500 [02:09<14:43,  2.07s/it] 15%|█▌        | 75/500 [02:14<18:18,  2.59s/it] 16%|█▌        | 79/500 [02:17<10:57,  1.56s/it] 16%|█▌        | 80/500 [02:20<13:09,  1.88s/it] 16%|█▋        | 82/500 [02:22<10:38,  1.53s/it] 17%|█▋        | 83/500 [02:26<14:16,  2.05s/it] 17%|█▋        | 85/500 [02:26<09:25,  1.36s/it] 17%|█▋        | 86/500 [02:30<13:07,  1.90s/it] 17%|█▋        | 87/500 [02:39<23:47,  3.46s/it] 18%|█▊        | 90/500 [02:48<22:07,  3.24s/it] 18%|█▊        | 92/500 [02:55<22:01,  3.24s/it] 19%|█▉        | 94/500 [03:00<20:42,  3.06s/it] 19%|█▉        | 96/500 [03:04<18:06,  2.69s/it] 20%|█▉        | 99/500 [03:07<13:20,  2.00s/it] 20%|██        | 101/500 [03:10<12:39,  1.90s/it] 20%|██        | 102/500 [03:17<17:45,  2.68s/it] 21%|██        | 106/500 [03:21<12:39,  1.93s/it] 21%|██▏       | 107/500 [03:22<11:42,  1.79s/it] 22%|██▏       | 108/500 [03:23<10:14,  1.57s/it] 22%|██▏       | 109/500 [03:27<14:11,  2.18s/it] 22%|██▏       | 112/500 [03:28<08:49,  1.36s/it] 23%|██▎       | 113/500 [03:29<08:09,  1.27s/it] 23%|██▎       | 114/500 [03:40<20:01,  3.11s/it] 24%|██▎       | 118/500 [03:42<10:48,  1.70s/it] 24%|██▍       | 119/500 [03:44<11:45,  1.85s/it] 24%|██▍       | 120/500 [03:46<11:32,  1.82s/it] 24%|██▍       | 121/500 [03:47<10:40,  1.69s/it] 24%|██▍       | 122/500 [03:47<08:30,  1.35s/it] 25%|██▍       | 123/500 [03:51<11:56,  1.90s/it] 25%|██▌       | 125/500 [03:53<09:37,  1.54s/it] 25%|██▌       | 126/500 [03:58<13:56,  2.24s/it] 25%|██▌       | 127/500 [04:01<16:30,  2.66s/it] 26%|██▌       | 128/500 [04:06<20:01,  3.23s/it] 26%|██▋       | 132/500 [04:14<15:01,  2.45s/it] 27%|██▋       | 136/500 [04:17<10:04,  1.66s/it] 28%|██▊       | 138/500 [04:18<08:05,  1.34s/it] 28%|██▊       | 139/500 [04:22<10:29,  1.74s/it] 28%|██▊       | 141/500 [04:23<08:22,  1.40s/it] 28%|██▊       | 142/500 [04:27<11:40,  1.96s/it] 29%|██▉       | 145/500 [04:29<07:46,  1.31s/it] 29%|██▉       | 146/500 [04:32<09:16,  1.57s/it] 30%|██▉       | 149/500 [04:39<11:08,  1.91s/it] 30%|███       | 152/500 [04:40<07:43,  1.33s/it] 31%|███       | 154/500 [04:43<07:50,  1.36s/it] 31%|███       | 155/500 [04:43<06:58,  1.21s/it] 31%|███       | 156/500 [04:48<10:32,  1.84s/it] 32%|███▏      | 159/500 [04:48<06:19,  1.11s/it] 32%|███▏      | 160/500 [04:56<12:20,  2.18s/it] 32%|███▏      | 161/500 [04:57<11:41,  2.07s/it] 33%|███▎      | 164/500 [05:00<08:51,  1.58s/it] 33%|███▎      | 165/500 [05:01<08:07,  1.46s/it] 33%|███▎      | 167/500 [05:05<08:42,  1.57s/it] 34%|███▎      | 168/500 [05:05<07:07,  1.29s/it] 34%|███▍      | 170/500 [05:09<08:15,  1.50s/it] 34%|███▍      | 171/500 [05:12<10:19,  1.88s/it] 35%|███▍      | 173/500 [05:13<07:10,  1.32s/it] 35%|███▍      | 174/500 [05:17<10:47,  1.99s/it] 35%|███▌      | 175/500 [05:18<09:18,  1.72s/it] 35%|███▌      | 177/500 [05:21<09:09,  1.70s/it] 36%|███▌      | 179/500 [05:23<06:58,  1.30s/it] 36%|███▌      | 181/500 [05:26<07:41,  1.45s/it] 36%|███▋      | 182/500 [05:27<07:32,  1.42s/it] 37%|███▋      | 184/500 [05:28<05:41,  1.08s/it] 37%|███▋      | 185/500 [05:29<04:40,  1.12it/s] 37%|███▋      | 186/500 [05:31<06:29,  1.24s/it] 37%|███▋      | 187/500 [05:32<06:36,  1.27s/it] 38%|███▊      | 189/500 [05:36<07:38,  1.47s/it] 38%|███▊      | 191/500 [05:36<05:19,  1.04s/it] 38%|███▊      | 192/500 [05:39<07:21,  1.43s/it] 39%|███▉      | 194/500 [05:43<08:21,  1.64s/it] 39%|███▉      | 195/500 [05:47<10:47,  2.12s/it] 39%|███▉      | 197/500 [05:53<12:33,  2.49s/it] 40%|████      | 200/500 [05:59<11:09,  2.23s/it] 41%|████      | 203/500 [06:06<11:09,  2.25s/it] 41%|████▏     | 207/500 [06:08<07:14,  1.48s/it] 42%|████▏     | 208/500 [06:10<07:36,  1.56s/it] 42%|████▏     | 209/500 [06:11<07:05,  1.46s/it] 42%|████▏     | 210/500 [06:13<07:18,  1.51s/it] 42%|████▏     | 211/500 [06:14<07:40,  1.59s/it] 43%|████▎     | 213/500 [06:16<06:23,  1.34s/it] 43%|████▎     | 214/500 [06:19<07:49,  1.64s/it] 43%|████▎     | 217/500 [06:28<10:48,  2.29s/it] 44%|████▎     | 218/500 [06:33<12:50,  2.73s/it] 44%|████▍     | 221/500 [06:38<10:46,  2.32s/it] 45%|████▍     | 224/500 [06:42<08:36,  1.87s/it] 45%|████▌     | 226/500 [06:43<07:22,  1.61s/it] 45%|████▌     | 227/500 [06:51<11:50,  2.60s/it] 46%|████▌     | 229/500 [06:52<08:20,  1.85s/it] 46%|████▌     | 230/500 [07:05<17:36,  3.91s/it] 47%|████▋     | 234/500 [07:07<09:40,  2.18s/it] 47%|████▋     | 235/500 [07:11<11:05,  2.51s/it] 47%|████▋     | 237/500 [07:12<08:07,  1.85s/it] 48%|████▊     | 238/500 [07:15<09:16,  2.13s/it] 48%|████▊     | 239/500 [07:19<10:16,  2.36s/it] 48%|████▊     | 241/500 [07:22<09:31,  2.21s/it] 49%|████▊     | 243/500 [07:26<08:46,  2.05s/it] 49%|████▉     | 245/500 [07:27<06:49,  1.61s/it] 49%|████▉     | 246/500 [07:32<09:29,  2.24s/it] 50%|████▉     | 249/500 [07:34<06:15,  1.50s/it] 50%|█████     | 250/500 [07:37<06:59,  1.68s/it] 50%|█████     | 252/500 [07:45<10:11,  2.47s/it] 51%|█████     | 256/500 [07:47<06:30,  1.60s/it] 51%|█████▏    | 257/500 [07:48<05:35,  1.38s/it] 52%|█████▏    | 258/500 [07:49<05:40,  1.41s/it] 52%|█████▏    | 259/500 [07:51<06:15,  1.56s/it] 52%|█████▏    | 260/500 [08:05<16:50,  4.21s/it] 53%|█████▎    | 265/500 [08:06<06:57,  1.78s/it] 53%|█████▎    | 267/500 [08:09<06:26,  1.66s/it] 54%|█████▎    | 268/500 [08:12<07:15,  1.88s/it] 54%|█████▍    | 270/500 [08:12<05:05,  1.33s/it] 54%|█████▍    | 271/500 [08:14<05:28,  1.43s/it] 54%|█████▍    | 272/500 [08:14<04:49,  1.27s/it] 55%|█████▍    | 273/500 [08:16<05:29,  1.45s/it] 55%|█████▌    | 275/500 [08:18<04:28,  1.19s/it] 55%|█████▌    | 276/500 [08:24<07:58,  2.14s/it] 56%|█████▌    | 279/500 [08:27<05:55,  1.61s/it] 56%|█████▌    | 280/500 [08:27<04:52,  1.33s/it] 56%|█████▋    | 282/500 [08:35<08:33,  2.35s/it] 57%|█████▋    | 285/500 [08:42<08:01,  2.24s/it] 57%|█████▋    | 287/500 [08:47<08:40,  2.44s/it] 58%|█████▊    | 290/500 [08:50<06:24,  1.83s/it] 58%|█████▊    | 291/500 [08:51<06:10,  1.77s/it] 58%|█████▊    | 292/500 [08:57<08:45,  2.53s/it] 59%|█████▊    | 293/500 [08:58<07:26,  2.16s/it] 59%|█████▉    | 295/500 [09:01<06:31,  1.91s/it] 59%|█████▉    | 297/500 [09:02<05:01,  1.48s/it] 60%|█████▉    | 298/500 [09:05<05:47,  1.72s/it] 60%|██████    | 300/500 [09:10<06:48,  2.04s/it] 60%|██████    | 301/500 [09:11<05:55,  1.79s/it] 60%|██████    | 302/500 [09:13<05:35,  1.70s/it] 61%|██████    | 303/500 [09:17<07:26,  2.27s/it] 61%|██████    | 304/500 [09:19<07:17,  2.23s/it] 61%|██████    | 306/500 [09:20<05:11,  1.61s/it] 61%|██████▏   | 307/500 [09:21<04:37,  1.44s/it] 62%|██████▏   | 308/500 [09:25<06:48,  2.13s/it] 62%|██████▏   | 310/500 [09:26<04:03,  1.28s/it] 62%|██████▏   | 311/500 [09:29<05:49,  1.85s/it] 63%|██████▎   | 313/500 [09:30<03:52,  1.24s/it] 63%|██████▎   | 314/500 [09:35<06:29,  2.09s/it] 63%|██████▎   | 316/500 [09:36<04:37,  1.51s/it] 64%|██████▎   | 318/500 [09:44<07:25,  2.45s/it] 64%|██████▍   | 321/500 [09:46<04:47,  1.60s/it] 65%|██████▍   | 323/500 [09:48<04:08,  1.40s/it] 65%|██████▍   | 324/500 [09:51<04:58,  1.69s/it] 65%|██████▌   | 326/500 [09:52<03:38,  1.26s/it] 65%|██████▌   | 327/500 [09:54<04:05,  1.42s/it] 66%|██████▌   | 328/500 [09:54<03:27,  1.21s/it] 66%|██████▌   | 330/500 [09:58<04:08,  1.46s/it] 66%|██████▋   | 332/500 [10:00<03:27,  1.23s/it] 67%|██████▋   | 333/500 [10:09<08:13,  2.95s/it] 67%|██████▋   | 337/500 [10:22<08:14,  3.03s/it] 69%|██████▉   | 344/500 [10:25<04:04,  1.57s/it] 69%|██████▉   | 347/500 [10:26<03:06,  1.22s/it] 70%|██████▉   | 348/500 [10:33<04:50,  1.91s/it] 70%|███████   | 350/500 [10:37<04:43,  1.89s/it] 71%|███████   | 353/500 [10:41<04:19,  1.76s/it] 71%|███████   | 356/500 [10:59<07:29,  3.12s/it] 73%|███████▎  | 364/500 [11:01<03:30,  1.55s/it] 73%|███████▎  | 365/500 [11:06<04:02,  1.79s/it] 73%|███████▎  | 366/500 [11:06<03:36,  1.62s/it] 74%|███████▎  | 368/500 [11:11<04:01,  1.83s/it] 74%|███████▍  | 369/500 [11:12<03:47,  1.74s/it] 74%|███████▍  | 370/500 [11:14<03:43,  1.72s/it] 74%|███████▍  | 371/500 [11:16<03:51,  1.80s/it] 74%|███████▍  | 372/500 [11:17<03:16,  1.54s/it] 75%|███████▍  | 373/500 [11:19<03:44,  1.77s/it] 75%|███████▍  | 374/500 [11:23<05:00,  2.38s/it] 75%|███████▌  | 376/500 [11:30<05:55,  2.86s/it] 76%|███████▌  | 380/500 [11:31<02:55,  1.47s/it] 76%|███████▋  | 382/500 [11:36<03:24,  1.73s/it] 77%|███████▋  | 386/500 [11:38<02:08,  1.13s/it] 77%|███████▋  | 387/500 [11:40<02:27,  1.30s/it] 78%|███████▊  | 389/500 [11:46<03:10,  1.72s/it] 78%|███████▊  | 391/500 [11:48<02:42,  1.49s/it] 78%|███████▊  | 392/500 [11:49<02:36,  1.45s/it] 79%|███████▊  | 393/500 [11:52<03:12,  1.80s/it] 79%|███████▉  | 394/500 [11:58<04:42,  2.67s/it] 79%|███████▉  | 397/500 [11:58<02:25,  1.41s/it] 80%|███████▉  | 398/500 [12:07<04:55,  2.90s/it] 81%|████████  | 404/500 [12:09<02:00,  1.25s/it] 81%|████████  | 405/500 [12:12<02:22,  1.50s/it] 81%|████████  | 406/500 [12:15<02:40,  1.71s/it] 82%|████████▏ | 409/500 [12:33<05:12,  3.43s/it] 83%|████████▎ | 416/500 [12:33<02:05,  1.49s/it] 84%|████████▎ | 418/500 [12:44<03:02,  2.22s/it] 85%|████████▍ | 423/500 [12:48<02:06,  1.64s/it] 85%|████████▍ | 424/500 [12:50<02:06,  1.67s/it] 85%|████████▌ | 425/500 [12:57<02:55,  2.34s/it] 86%|████████▌ | 428/500 [13:04<02:51,  2.39s/it] 86%|████████▌ | 429/500 [13:09<03:15,  2.76s/it] 87%|████████▋ | 434/500 [13:12<01:47,  1.62s/it] 87%|████████▋ | 435/500 [13:13<01:43,  1.59s/it] 87%|████████▋ | 437/500 [13:18<01:56,  1.86s/it] 88%|████████▊ | 441/500 [13:21<01:22,  1.41s/it] 89%|████████▉ | 444/500 [13:25<01:16,  1.37s/it] 89%|████████▉ | 446/500 [13:27<01:09,  1.29s/it] 89%|████████▉ | 447/500 [13:29<01:09,  1.31s/it] 90%|████████▉ | 449/500 [13:33<01:16,  1.50s/it] 90%|█████████ | 450/500 [13:35<01:21,  1.64s/it] 90%|█████████ | 452/500 [13:37<01:10,  1.47s/it] 91%|█████████ | 454/500 [13:39<00:58,  1.27s/it] 91%|█████████ | 455/500 [13:41<01:02,  1.40s/it] 91%|█████████▏| 457/500 [13:43<00:54,  1.28s/it] 92%|█████████▏| 459/500 [13:45<00:47,  1.16s/it] 92%|█████████▏| 461/500 [13:49<00:54,  1.39s/it] 93%|█████████▎| 463/500 [13:50<00:44,  1.20s/it] 93%|█████████▎| 464/500 [13:50<00:36,  1.01s/it] 93%|█████████▎| 465/500 [13:51<00:33,  1.05it/s] 93%|█████████▎| 466/500 [13:54<00:46,  1.37s/it] 93%|█████████▎| 467/500 [13:55<00:45,  1.38s/it] 94%|█████████▍| 469/500 [13:57<00:34,  1.13s/it] 94%|█████████▍| 470/500 [13:59<00:43,  1.44s/it] 94%|█████████▍| 471/500 [14:07<01:27,  3.00s/it] 94%|█████████▍| 472/500 [14:09<01:20,  2.86s/it] 95%|█████████▌| 475/500 [14:10<00:34,  1.37s/it] 95%|█████████▌| 476/500 [14:14<00:46,  1.92s/it] 95%|█████████▌| 477/500 [14:14<00:38,  1.67s/it] 96%|█████████▌| 478/500 [14:16<00:36,  1.68s/it] 96%|█████████▌| 479/500 [14:23<01:03,  3.00s/it] 97%|█████████▋| 483/500 [14:25<00:25,  1.48s/it] 97%|█████████▋| 484/500 [14:33<00:41,  2.61s/it] 97%|█████████▋| 487/500 [14:37<00:27,  2.14s/it] 98%|█████████▊| 490/500 [14:38<00:13,  1.39s/it] 98%|█████████▊| 491/500 [14:43<00:17,  1.94s/it] 98%|█████████▊| 492/500 [14:44<00:13,  1.73s/it] 99%|█████████▉| 494/500 [14:45<00:08,  1.34s/it] 99%|█████████▉| 495/500 [14:49<00:09,  1.91s/it] 99%|█████████▉| 496/500 [14:53<00:09,  2.29s/it]100%|██████████| 500/500 [15:00<00:00,  2.04s/it]100%|██████████| 500/500 [15:00<00:00,  1.80s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
Regenerating missing GPT-4 file for split data file: chunk_2.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 163 / 163
  0%|          | 0/163 [00:00<?, ?it/s]  1%|          | 1/163 [00:07<21:23,  7.92s/it]  1%|          | 2/163 [00:09<11:58,  4.46s/it]  2%|▏         | 3/163 [00:11<08:24,  3.15s/it]  2%|▏         | 4/163 [00:13<07:06,  2.68s/it]  3%|▎         | 5/163 [00:25<16:03,  6.10s/it]  7%|▋         | 11/163 [00:43<09:18,  3.68s/it] 11%|█         | 18/163 [00:47<04:50,  2.00s/it] 12%|█▏        | 20/163 [00:48<04:01,  1.69s/it] 13%|█▎        | 21/163 [00:54<05:07,  2.17s/it] 14%|█▍        | 23/163 [00:56<04:34,  1.96s/it] 15%|█▍        | 24/163 [01:09<08:18,  3.59s/it] 19%|█▉        | 31/163 [01:16<04:30,  2.05s/it] 20%|██        | 33/163 [01:17<03:41,  1.70s/it] 21%|██        | 34/163 [01:21<04:13,  1.97s/it] 21%|██▏       | 35/163 [01:21<03:44,  1.75s/it] 22%|██▏       | 36/163 [01:23<03:49,  1.81s/it] 23%|██▎       | 37/163 [01:25<03:38,  1.73s/it] 24%|██▍       | 39/163 [01:27<02:57,  1.43s/it] 25%|██▍       | 40/163 [01:27<02:25,  1.18s/it] 25%|██▌       | 41/163 [01:31<03:44,  1.84s/it] 26%|██▌       | 42/163 [01:34<04:18,  2.13s/it] 27%|██▋       | 44/163 [01:35<03:00,  1.52s/it] 28%|██▊       | 46/163 [01:36<02:14,  1.15s/it] 29%|██▉       | 47/163 [01:43<04:32,  2.35s/it] 30%|███       | 49/163 [01:43<02:54,  1.53s/it] 31%|███       | 50/163 [01:46<03:06,  1.65s/it] 31%|███▏      | 51/163 [01:55<06:35,  3.53s/it] 33%|███▎      | 54/163 [01:56<03:25,  1.89s/it] 34%|███▎      | 55/163 [02:02<04:40,  2.60s/it] 36%|███▌      | 58/163 [02:03<02:51,  1.63s/it] 36%|███▌      | 59/163 [02:09<04:06,  2.37s/it] 37%|███▋      | 61/163 [02:12<03:36,  2.12s/it] 38%|███▊      | 62/163 [02:18<04:56,  2.93s/it] 40%|████      | 66/163 [02:19<02:21,  1.46s/it] 41%|████      | 67/163 [02:29<04:38,  2.90s/it] 44%|████▎     | 71/163 [02:33<03:02,  1.99s/it] 45%|████▌     | 74/163 [02:35<02:16,  1.53s/it] 46%|████▌     | 75/163 [02:36<02:01,  1.39s/it] 47%|████▋     | 76/163 [02:36<01:47,  1.23s/it] 47%|████▋     | 77/163 [02:40<02:36,  1.82s/it] 48%|████▊     | 78/163 [02:42<02:27,  1.74s/it] 49%|████▉     | 80/163 [02:52<04:00,  2.90s/it] 51%|█████     | 83/163 [02:56<03:05,  2.31s/it] 52%|█████▏    | 85/163 [02:57<02:09,  1.66s/it] 53%|█████▎    | 86/163 [03:02<02:55,  2.28s/it] 55%|█████▍    | 89/163 [03:04<01:59,  1.61s/it] 55%|█████▌    | 90/163 [03:07<02:11,  1.80s/it] 56%|█████▋    | 92/163 [03:07<01:29,  1.25s/it] 57%|█████▋    | 93/163 [03:11<02:01,  1.73s/it] 59%|█████▉    | 96/163 [03:13<01:30,  1.35s/it] 60%|█████▉    | 97/163 [03:17<01:57,  1.79s/it] 61%|██████▏   | 100/163 [03:21<01:42,  1.63s/it] 62%|██████▏   | 101/163 [03:22<01:29,  1.44s/it] 63%|██████▎   | 103/163 [03:23<01:10,  1.18s/it] 64%|██████▍   | 104/163 [03:29<02:00,  2.05s/it] 65%|██████▌   | 106/163 [03:30<01:22,  1.44s/it] 66%|██████▋   | 108/163 [03:33<01:22,  1.50s/it] 67%|██████▋   | 109/163 [03:34<01:13,  1.37s/it] 67%|██████▋   | 110/163 [03:36<01:27,  1.65s/it] 68%|██████▊   | 111/163 [03:37<01:15,  1.44s/it] 69%|██████▊   | 112/163 [03:42<01:59,  2.33s/it] 69%|██████▉   | 113/163 [03:44<01:55,  2.31s/it] 71%|███████   | 115/163 [03:45<01:13,  1.54s/it] 71%|███████   | 116/163 [03:46<01:06,  1.42s/it] 72%|███████▏  | 117/163 [03:47<00:56,  1.24s/it] 72%|███████▏  | 118/163 [03:51<01:27,  1.94s/it] 74%|███████▎  | 120/163 [03:53<01:02,  1.45s/it] 75%|███████▍  | 122/163 [03:54<00:50,  1.24s/it] 75%|███████▌  | 123/163 [04:01<01:31,  2.29s/it] 77%|███████▋  | 125/163 [04:02<01:02,  1.65s/it] 78%|███████▊  | 127/163 [04:09<01:24,  2.36s/it] 80%|████████  | 131/163 [04:15<01:02,  1.94s/it] 82%|████████▏ | 134/163 [04:20<00:52,  1.81s/it] 83%|████████▎ | 136/163 [04:20<00:38,  1.43s/it] 84%|████████▍ | 137/163 [04:21<00:35,  1.35s/it] 85%|████████▍ | 138/163 [04:22<00:30,  1.22s/it] 85%|████████▌ | 139/163 [04:23<00:26,  1.11s/it] 86%|████████▌ | 140/163 [04:28<00:49,  2.17s/it] 88%|████████▊ | 143/163 [04:30<00:28,  1.43s/it] 88%|████████▊ | 144/163 [04:32<00:26,  1.38s/it] 89%|████████▉ | 145/163 [04:32<00:20,  1.12s/it] 90%|████████▉ | 146/163 [04:32<00:15,  1.11it/s] 90%|█████████ | 147/163 [04:35<00:21,  1.35s/it] 91%|█████████ | 148/163 [04:41<00:41,  2.76s/it] 93%|█████████▎| 152/163 [04:43<00:15,  1.38s/it] 94%|█████████▍| 153/163 [04:47<00:17,  1.78s/it] 96%|█████████▌| 156/163 [04:51<00:10,  1.56s/it] 96%|█████████▋| 157/163 [04:53<00:10,  1.75s/it] 98%|█████████▊| 160/163 [04:59<00:05,  1.87s/it] 99%|█████████▉| 161/163 [05:00<00:03,  1.61s/it]100%|██████████| 163/163 [05:02<00:00,  1.46s/it]100%|██████████| 163/163 [05:02<00:00,  1.86s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 2
[INFO] end_time: 2024-08-31 20:23:34
[INFO] duration: 23 min 
[2024-09-01 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-30/2024-08-30_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-01 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-30/2024-08-30_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-08-30
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-30/2024-08-30_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-30/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-30/raw/single_True_rag_True/split_data/chunk_1.csv
Saved chunk 2 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-30/raw/single_True_rag_True/split_data/chunk_2.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 500 / 500
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:07<59:17,  7.13s/it]  0%|          | 2/500 [00:10<39:48,  4.80s/it]  1%|          | 4/500 [00:13<22:01,  2.66s/it]  1%|          | 6/500 [00:13<12:14,  1.49s/it]  1%|▏         | 7/500 [00:20<23:47,  2.89s/it]  2%|▏         | 9/500 [00:31<32:43,  4.00s/it]  3%|▎         | 15/500 [00:34<13:45,  1.70s/it]  3%|▎         | 16/500 [00:37<15:13,  1.89s/it]  4%|▍         | 19/500 [00:46<18:25,  2.30s/it]  5%|▍         | 24/500 [00:51<13:20,  1.68s/it]  5%|▌         | 25/500 [00:51<12:01,  1.52s/it]  5%|▌         | 27/500 [00:54<11:41,  1.48s/it]  6%|▌         | 28/500 [00:54<10:22,  1.32s/it]  6%|▌         | 30/500 [00:57<11:09,  1.42s/it]  6%|▌         | 31/500 [00:59<11:11,  1.43s/it]  6%|▋         | 32/500 [01:05<18:45,  2.41s/it]  7%|▋         | 36/500 [01:19<22:59,  2.97s/it]  8%|▊         | 42/500 [01:24<13:41,  1.79s/it]  9%|▉         | 45/500 [01:24<10:19,  1.36s/it]  9%|▉         | 46/500 [01:29<12:53,  1.70s/it] 10%|▉         | 49/500 [01:35<13:50,  1.84s/it] 10%|█         | 52/500 [01:39<13:00,  1.74s/it] 11%|█         | 54/500 [02:02<29:19,  3.95s/it] 13%|█▎        | 63/500 [02:02<11:48,  1.62s/it] 13%|█▎        | 64/500 [02:05<12:12,  1.68s/it] 13%|█▎        | 65/500 [02:10<14:48,  2.04s/it] 13%|█▎        | 67/500 [02:13<13:36,  1.88s/it] 14%|█▍        | 69/500 [02:16<13:02,  1.81s/it] 14%|█▍        | 70/500 [02:17<12:15,  1.71s/it] 14%|█▍        | 71/500 [02:18<11:32,  1.61s/it] 14%|█▍        | 72/500 [02:21<13:46,  1.93s/it] 15%|█▍        | 73/500 [02:22<11:19,  1.59s/it] 15%|█▍        | 74/500 [02:26<15:18,  2.16s/it] 15%|█▌        | 77/500 [02:28<10:12,  1.45s/it] 16%|█▌        | 78/500 [02:29<10:24,  1.48s/it] 16%|█▌        | 79/500 [02:30<09:06,  1.30s/it] 16%|█▌        | 80/500 [02:33<12:12,  1.74s/it] 16%|█▌        | 81/500 [02:36<14:14,  2.04s/it] 17%|█▋        | 83/500 [02:37<09:49,  1.41s/it] 17%|█▋        | 84/500 [02:41<14:01,  2.02s/it] 17%|█▋        | 86/500 [02:43<10:56,  1.59s/it] 17%|█▋        | 87/500 [02:44<09:20,  1.36s/it] 18%|█▊        | 88/500 [02:45<09:45,  1.42s/it] 18%|█▊        | 89/500 [02:46<07:33,  1.10s/it] 18%|█▊        | 90/500 [02:49<11:15,  1.65s/it] 18%|█▊        | 91/500 [02:53<15:38,  2.30s/it] 18%|█▊        | 92/500 [02:53<11:59,  1.76s/it] 19%|█▊        | 93/500 [02:57<16:42,  2.46s/it] 19%|█▉        | 95/500 [03:00<13:09,  1.95s/it] 19%|█▉        | 96/500 [03:06<20:14,  3.01s/it] 19%|█▉        | 97/500 [03:08<17:16,  2.57s/it] 20%|█▉        | 99/500 [03:09<12:09,  1.82s/it] 20%|██        | 100/500 [03:12<13:31,  2.03s/it] 20%|██        | 101/500 [03:13<12:16,  1.85s/it] 21%|██        | 103/500 [03:15<09:19,  1.41s/it] 21%|██        | 105/500 [03:16<06:55,  1.05s/it] 21%|██        | 106/500 [03:17<07:25,  1.13s/it] 21%|██▏       | 107/500 [03:24<16:25,  2.51s/it] 22%|██▏       | 109/500 [03:26<12:06,  1.86s/it] 22%|██▏       | 110/500 [03:32<18:14,  2.81s/it] 23%|██▎       | 114/500 [03:37<12:33,  1.95s/it] 23%|██▎       | 115/500 [03:39<12:27,  1.94s/it] 23%|██▎       | 117/500 [03:41<10:49,  1.69s/it] 24%|██▍       | 120/500 [03:50<14:04,  2.22s/it] 25%|██▍       | 123/500 [03:52<09:45,  1.55s/it] 25%|██▍       | 124/500 [03:55<11:24,  1.82s/it] 25%|██▌       | 125/500 [04:01<16:28,  2.64s/it] 26%|██▌       | 128/500 [04:02<10:11,  1.64s/it] 26%|██▌       | 129/500 [04:03<09:32,  1.54s/it] 26%|██▌       | 130/500 [04:06<10:15,  1.66s/it] 26%|██▌       | 131/500 [04:08<10:57,  1.78s/it] 27%|██▋       | 134/500 [04:15<12:24,  2.03s/it] 27%|██▋       | 137/500 [04:17<09:19,  1.54s/it] 28%|██▊       | 138/500 [04:18<08:20,  1.38s/it] 28%|██▊       | 139/500 [04:19<08:06,  1.35s/it] 28%|██▊       | 140/500 [04:23<11:49,  1.97s/it] 28%|██▊       | 141/500 [04:24<10:39,  1.78s/it] 29%|██▊       | 143/500 [04:26<08:48,  1.48s/it] 29%|██▉       | 144/500 [04:28<09:13,  1.56s/it] 29%|██▉       | 145/500 [04:33<14:26,  2.44s/it] 30%|██▉       | 148/500 [04:36<09:45,  1.66s/it] 30%|██▉       | 149/500 [04:40<11:53,  2.03s/it] 30%|███       | 151/500 [04:40<08:02,  1.38s/it] 30%|███       | 152/500 [04:41<06:57,  1.20s/it] 31%|███       | 153/500 [04:47<13:42,  2.37s/it] 31%|███       | 154/500 [04:49<12:33,  2.18s/it] 31%|███       | 156/500 [04:51<10:12,  1.78s/it] 32%|███▏      | 158/500 [04:54<09:41,  1.70s/it] 32%|███▏      | 159/500 [04:55<08:05,  1.42s/it] 32%|███▏      | 160/500 [05:01<14:34,  2.57s/it] 32%|███▏      | 162/500 [05:04<12:02,  2.14s/it] 33%|███▎      | 164/500 [05:07<10:31,  1.88s/it] 33%|███▎      | 165/500 [05:08<09:26,  1.69s/it] 33%|███▎      | 166/500 [05:12<12:03,  2.17s/it] 33%|███▎      | 167/500 [05:16<15:06,  2.72s/it] 34%|███▍      | 169/500 [05:17<10:00,  1.82s/it] 34%|███▍      | 170/500 [05:19<10:07,  1.84s/it] 34%|███▍      | 171/500 [05:21<10:05,  1.84s/it] 35%|███▍      | 173/500 [05:23<08:26,  1.55s/it] 35%|███▍      | 174/500 [05:24<07:53,  1.45s/it] 35%|███▌      | 175/500 [05:25<07:27,  1.38s/it] 35%|███▌      | 176/500 [05:28<09:37,  1.78s/it] 35%|███▌      | 177/500 [05:32<12:27,  2.32s/it] 36%|███▌      | 180/500 [05:35<08:15,  1.55s/it] 36%|███▌      | 181/500 [05:41<13:11,  2.48s/it] 37%|███▋      | 183/500 [05:43<10:00,  1.90s/it] 37%|███▋      | 185/500 [05:50<13:05,  2.49s/it] 37%|███▋      | 186/500 [05:55<15:59,  3.06s/it] 38%|███▊      | 189/500 [05:56<08:57,  1.73s/it] 38%|███▊      | 190/500 [05:59<10:00,  1.94s/it] 38%|███▊      | 191/500 [06:00<09:43,  1.89s/it] 38%|███▊      | 192/500 [06:08<16:49,  3.28s/it] 39%|███▉      | 196/500 [06:09<07:39,  1.51s/it] 39%|███▉      | 197/500 [06:16<12:11,  2.41s/it] 40%|████      | 200/500 [06:19<09:17,  1.86s/it] 40%|████      | 201/500 [06:23<11:15,  2.26s/it] 41%|████      | 204/500 [06:25<07:19,  1.48s/it] 41%|████      | 206/500 [06:29<08:24,  1.71s/it] 42%|████▏     | 208/500 [06:30<06:30,  1.34s/it] 42%|████▏     | 209/500 [06:36<10:06,  2.09s/it] 42%|████▏     | 211/500 [06:40<09:59,  2.07s/it] 43%|████▎     | 213/500 [06:47<12:39,  2.65s/it] 43%|████▎     | 217/500 [06:54<09:56,  2.11s/it] 44%|████▍     | 220/500 [07:02<11:00,  2.36s/it] 45%|████▍     | 223/500 [07:03<07:57,  1.72s/it] 45%|████▌     | 225/500 [07:06<07:22,  1.61s/it] 45%|████▌     | 227/500 [07:07<06:18,  1.39s/it] 46%|████▌     | 228/500 [07:10<07:30,  1.66s/it] 46%|████▌     | 230/500 [07:12<06:27,  1.44s/it] 46%|████▌     | 231/500 [07:12<05:26,  1.21s/it] 46%|████▋     | 232/500 [07:15<06:38,  1.49s/it] 47%|████▋     | 233/500 [07:17<07:35,  1.70s/it] 47%|████▋     | 234/500 [07:38<27:44,  6.26s/it] 48%|████▊     | 240/500 [07:42<10:54,  2.52s/it] 48%|████▊     | 241/500 [07:45<11:05,  2.57s/it] 49%|████▉     | 244/500 [07:48<08:24,  1.97s/it] 49%|████▉     | 245/500 [07:51<09:09,  2.15s/it] 49%|████▉     | 246/500 [07:55<10:13,  2.42s/it] 50%|████▉     | 248/500 [08:01<10:56,  2.61s/it] 50%|████▉     | 249/500 [08:02<09:46,  2.34s/it] 50%|█████     | 251/500 [08:04<07:23,  1.78s/it] 50%|█████     | 252/500 [08:24<23:16,  5.63s/it] 52%|█████▏    | 262/500 [08:30<07:25,  1.87s/it] 53%|█████▎    | 265/500 [08:33<06:30,  1.66s/it] 53%|█████▎    | 266/500 [08:34<06:14,  1.60s/it] 53%|█████▎    | 267/500 [08:35<05:47,  1.49s/it] 54%|█████▎    | 268/500 [08:37<06:13,  1.61s/it] 54%|█████▍    | 269/500 [08:41<07:32,  1.96s/it] 54%|█████▍    | 271/500 [08:42<05:54,  1.55s/it] 54%|█████▍    | 272/500 [08:47<08:21,  2.20s/it] 55%|█████▍    | 273/500 [08:48<07:32,  1.99s/it] 55%|█████▌    | 275/500 [08:49<05:10,  1.38s/it] 55%|█████▌    | 276/500 [08:50<04:25,  1.19s/it] 55%|█████▌    | 277/500 [08:52<05:26,  1.46s/it] 56%|█████▌    | 278/500 [08:55<06:29,  1.76s/it] 56%|█████▌    | 279/500 [08:59<09:06,  2.47s/it] 56%|█████▌    | 281/500 [09:00<05:52,  1.61s/it] 56%|█████▋    | 282/500 [09:04<07:53,  2.17s/it] 57%|█████▋    | 283/500 [09:17<17:47,  4.92s/it] 57%|█████▋    | 286/500 [09:17<08:40,  2.43s/it] 57%|█████▋    | 287/500 [09:18<07:24,  2.09s/it] 58%|█████▊    | 288/500 [09:37<20:15,  5.73s/it] 59%|█████▉    | 294/500 [09:37<06:55,  2.02s/it] 59%|█████▉    | 295/500 [09:42<08:02,  2.36s/it] 59%|█████▉    | 296/500 [09:42<07:03,  2.08s/it] 60%|█████▉    | 298/500 [09:52<10:12,  3.03s/it] 61%|██████    | 303/500 [09:54<05:10,  1.58s/it] 61%|██████    | 304/500 [09:57<05:46,  1.77s/it] 61%|██████    | 306/500 [10:01<05:48,  1.79s/it] 62%|██████▏   | 308/500 [10:02<04:55,  1.54s/it] 62%|██████▏   | 309/500 [10:06<05:48,  1.83s/it] 62%|██████▏   | 310/500 [10:08<06:03,  1.91s/it] 62%|██████▏   | 311/500 [10:09<05:30,  1.75s/it] 62%|██████▏   | 312/500 [10:10<04:34,  1.46s/it] 63%|██████▎   | 313/500 [10:14<07:11,  2.31s/it] 63%|██████▎   | 315/500 [10:16<05:02,  1.64s/it] 63%|██████▎   | 316/500 [10:20<07:07,  2.32s/it] 64%|██████▎   | 318/500 [10:27<08:00,  2.64s/it] 64%|██████▍   | 319/500 [10:27<06:17,  2.08s/it] 64%|██████▍   | 321/500 [10:35<08:26,  2.83s/it] 65%|██████▌   | 325/500 [10:42<06:43,  2.31s/it] 66%|██████▌   | 328/500 [10:44<04:58,  1.74s/it] 66%|██████▌   | 330/500 [10:48<04:52,  1.72s/it] 66%|██████▌   | 331/500 [10:49<04:35,  1.63s/it] 67%|██████▋   | 333/500 [10:58<07:00,  2.52s/it] 67%|██████▋   | 336/500 [11:02<05:44,  2.10s/it] 68%|██████▊   | 338/500 [11:03<04:14,  1.57s/it] 68%|██████▊   | 339/500 [11:05<04:40,  1.74s/it] 68%|██████▊   | 340/500 [11:08<05:09,  1.93s/it] 69%|██████▊   | 343/500 [11:13<04:53,  1.87s/it] 69%|██████▉   | 345/500 [11:15<04:01,  1.56s/it] 69%|██████▉   | 347/500 [11:19<04:09,  1.63s/it] 70%|██████▉   | 348/500 [11:22<04:59,  1.97s/it] 70%|███████   | 350/500 [11:25<04:33,  1.83s/it] 70%|███████   | 351/500 [11:28<04:46,  1.92s/it] 71%|███████   | 353/500 [11:29<03:27,  1.41s/it] 71%|███████   | 354/500 [11:31<04:06,  1.69s/it] 71%|███████   | 355/500 [11:36<05:28,  2.26s/it] 71%|███████▏  | 357/500 [11:37<03:58,  1.67s/it] 72%|███████▏  | 359/500 [11:40<03:56,  1.68s/it] 72%|███████▏  | 360/500 [11:42<03:45,  1.61s/it] 72%|███████▏  | 362/500 [11:44<03:08,  1.36s/it] 73%|███████▎  | 363/500 [11:45<03:14,  1.42s/it] 73%|███████▎  | 365/500 [11:47<02:44,  1.22s/it] 73%|███████▎  | 366/500 [11:59<07:54,  3.54s/it] 74%|███████▍  | 372/500 [12:00<02:46,  1.30s/it] 75%|███████▍  | 373/500 [12:05<03:56,  1.86s/it] 75%|███████▌  | 376/500 [12:19<05:51,  2.83s/it] 76%|███████▋  | 382/500 [12:23<03:25,  1.74s/it] 77%|███████▋  | 383/500 [12:28<04:00,  2.06s/it] 77%|███████▋  | 387/500 [12:30<02:49,  1.50s/it] 78%|███████▊  | 389/500 [12:33<02:40,  1.45s/it] 78%|███████▊  | 390/500 [12:34<02:34,  1.41s/it] 78%|███████▊  | 391/500 [12:36<02:48,  1.55s/it] 78%|███████▊  | 392/500 [12:37<02:46,  1.54s/it] 79%|███████▊  | 393/500 [12:45<05:05,  2.85s/it] 79%|███████▉  | 396/500 [12:48<03:27,  2.00s/it] 79%|███████▉  | 397/500 [12:50<03:26,  2.01s/it] 80%|███████▉  | 399/500 [12:55<03:37,  2.15s/it] 81%|████████  | 403/500 [13:02<03:08,  1.95s/it] 81%|████████  | 406/500 [13:03<02:10,  1.39s/it] 81%|████████▏ | 407/500 [13:06<02:22,  1.53s/it] 82%|████████▏ | 408/500 [13:11<03:13,  2.10s/it] 82%|████████▏ | 411/500 [13:14<02:28,  1.66s/it] 83%|████████▎ | 413/500 [13:16<02:10,  1.50s/it] 83%|████████▎ | 415/500 [13:18<01:59,  1.41s/it] 83%|████████▎ | 417/500 [13:30<03:40,  2.65s/it] 84%|████████▍ | 421/500 [13:30<01:56,  1.47s/it] 84%|████████▍ | 422/500 [13:32<01:57,  1.51s/it] 85%|████████▍ | 423/500 [13:32<01:47,  1.39s/it] 85%|████████▍ | 424/500 [13:33<01:40,  1.32s/it] 85%|████████▌ | 425/500 [13:38<02:30,  2.01s/it] 85%|████████▌ | 427/500 [13:44<02:55,  2.41s/it] 86%|████████▌ | 429/500 [13:45<02:02,  1.72s/it] 86%|████████▌ | 430/500 [13:50<02:46,  2.37s/it] 87%|████████▋ | 433/500 [13:56<02:24,  2.15s/it] 87%|████████▋ | 436/500 [14:06<02:49,  2.65s/it] 88%|████████▊ | 441/500 [14:12<01:54,  1.94s/it] 89%|████████▉ | 445/500 [14:20<01:47,  1.95s/it] 90%|████████▉ | 448/500 [14:22<01:26,  1.66s/it] 90%|████████▉ | 449/500 [14:23<01:18,  1.53s/it] 90%|█████████ | 450/500 [14:26<01:25,  1.71s/it] 90%|█████████ | 452/500 [14:31<01:37,  2.04s/it] 91%|█████████ | 454/500 [14:33<01:17,  1.68s/it] 91%|█████████ | 455/500 [14:35<01:15,  1.69s/it] 91%|█████████ | 456/500 [14:35<01:04,  1.47s/it] 92%|█████████▏| 458/500 [14:39<01:07,  1.60s/it] 92%|█████████▏| 459/500 [14:41<01:08,  1.67s/it] 92%|█████████▏| 461/500 [14:41<00:43,  1.12s/it] 92%|█████████▏| 462/500 [14:44<00:56,  1.49s/it] 93%|█████████▎| 464/500 [14:48<00:56,  1.57s/it] 93%|█████████▎| 465/500 [14:51<01:07,  1.93s/it] 94%|█████████▎| 468/500 [14:54<00:50,  1.57s/it] 94%|█████████▍| 470/500 [14:57<00:42,  1.41s/it] 94%|█████████▍| 471/500 [15:01<00:55,  1.91s/it] 94%|█████████▍| 472/500 [15:06<01:10,  2.53s/it] 95%|█████████▍| 474/500 [15:09<00:56,  2.18s/it] 95%|█████████▌| 476/500 [15:11<00:44,  1.86s/it] 95%|█████████▌| 477/500 [15:14<00:46,  2.03s/it] 96%|█████████▌| 478/500 [15:16<00:43,  1.99s/it] 96%|█████████▌| 479/500 [15:17<00:36,  1.72s/it] 96%|█████████▌| 480/500 [15:18<00:34,  1.71s/it] 96%|█████████▋| 482/500 [15:20<00:22,  1.27s/it] 97%|█████████▋| 483/500 [15:23<00:30,  1.81s/it] 97%|█████████▋| 485/500 [15:24<00:17,  1.17s/it] 97%|█████████▋| 486/500 [15:28<00:25,  1.81s/it] 98%|█████████▊| 488/500 [15:31<00:19,  1.64s/it] 98%|█████████▊| 490/500 [15:40<00:28,  2.81s/it] 99%|█████████▉| 494/500 [15:42<00:09,  1.65s/it] 99%|█████████▉| 495/500 [15:44<00:08,  1.63s/it] 99%|█████████▉| 496/500 [15:47<00:07,  1.85s/it]100%|█████████▉| 498/500 [15:50<00:03,  1.70s/it]100%|█████████▉| 499/500 [15:54<00:02,  2.18s/it]100%|██████████| 500/500 [15:54<00:00,  1.79s/it]100%|██████████| 500/500 [15:54<00:00,  1.91s/it]
Parsing GPT-4 response
Regenerating missing GPT-4 file for split data file: chunk_2.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 101 / 101
  0%|          | 0/101 [00:00<?, ?it/s]  1%|          | 1/101 [00:12<20:03, 12.04s/it]  2%|▏         | 2/101 [00:17<13:06,  7.94s/it]  7%|▋         | 7/101 [00:20<03:09,  2.01s/it]  8%|▊         | 8/101 [00:23<03:38,  2.35s/it] 10%|▉         | 10/101 [00:34<05:13,  3.44s/it] 15%|█▍        | 15/101 [00:35<02:13,  1.55s/it] 17%|█▋        | 17/101 [00:44<03:09,  2.26s/it] 18%|█▊        | 18/101 [00:49<03:42,  2.68s/it] 20%|█▉        | 20/101 [00:54<03:31,  2.61s/it] 22%|██▏       | 22/101 [00:56<02:55,  2.22s/it] 24%|██▍       | 24/101 [00:59<02:29,  1.94s/it] 26%|██▌       | 26/101 [01:00<01:51,  1.49s/it] 27%|██▋       | 27/101 [01:02<01:56,  1.57s/it] 28%|██▊       | 28/101 [01:04<02:03,  1.69s/it] 29%|██▊       | 29/101 [01:07<02:20,  1.96s/it] 30%|██▉       | 30/101 [01:08<02:12,  1.87s/it] 32%|███▏      | 32/101 [01:11<01:58,  1.72s/it] 33%|███▎      | 33/101 [01:20<03:39,  3.23s/it] 38%|███▊      | 38/101 [01:24<01:55,  1.83s/it] 41%|████      | 41/101 [01:26<01:22,  1.38s/it] 42%|████▏     | 42/101 [01:27<01:17,  1.31s/it] 43%|████▎     | 43/101 [01:27<01:08,  1.18s/it] 44%|████▎     | 44/101 [01:28<01:01,  1.08s/it] 45%|████▍     | 45/101 [01:32<01:36,  1.73s/it] 47%|████▋     | 47/101 [01:41<02:25,  2.69s/it] 48%|████▊     | 48/101 [01:44<02:25,  2.75s/it] 51%|█████▏    | 52/101 [01:45<01:09,  1.42s/it] 52%|█████▏    | 53/101 [01:51<01:42,  2.14s/it] 54%|█████▍    | 55/101 [02:10<03:26,  4.49s/it] 62%|██████▏   | 63/101 [02:15<01:15,  2.00s/it] 64%|██████▍   | 65/101 [02:18<01:10,  1.96s/it] 66%|██████▋   | 67/101 [02:20<00:57,  1.69s/it] 67%|██████▋   | 68/101 [02:20<00:49,  1.51s/it] 68%|██████▊   | 69/101 [02:22<00:52,  1.63s/it] 69%|██████▉   | 70/101 [02:28<01:12,  2.35s/it] 72%|███████▏  | 73/101 [02:30<00:44,  1.59s/it] 73%|███████▎  | 74/101 [02:33<00:48,  1.81s/it] 75%|███████▌  | 76/101 [02:33<00:32,  1.31s/it] 76%|███████▌  | 77/101 [02:40<00:58,  2.44s/it] 79%|███████▉  | 80/101 [02:41<00:29,  1.39s/it] 80%|████████  | 81/101 [02:43<00:30,  1.50s/it] 81%|████████  | 82/101 [02:58<01:21,  4.27s/it] 87%|████████▋ | 88/101 [03:00<00:23,  1.78s/it] 89%|████████▉ | 90/101 [03:03<00:18,  1.69s/it] 90%|█████████ | 91/101 [03:04<00:15,  1.58s/it] 91%|█████████ | 92/101 [03:07<00:16,  1.84s/it] 92%|█████████▏| 93/101 [03:08<00:14,  1.79s/it] 94%|█████████▍| 95/101 [03:13<00:11,  1.93s/it] 95%|█████████▌| 96/101 [03:16<00:11,  2.21s/it] 97%|█████████▋| 98/101 [03:18<00:05,  1.78s/it] 99%|█████████▉| 100/101 [03:24<00:02,  2.14s/it]100%|██████████| 101/101 [03:24<00:00,  2.02s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 2
[INFO] end_time: 2024-09-01 20:22:48
[INFO] duration: 22 min 
[2024-09-02 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-31/2024-08-31_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-02 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-31/2024-08-31_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-08-31
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-08-31/2024-08-31_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-31/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-31/raw/single_True_rag_True/split_data/chunk_1.csv
Saved chunk 2 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-08-31/raw/single_True_rag_True/split_data/chunk_2.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 500 / 500
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:11<1:39:10, 11.92s/it]  0%|          | 2/500 [00:13<47:25,  5.71s/it]    1%|          | 5/500 [00:22<31:55,  3.87s/it]  2%|▏         | 9/500 [00:34<27:12,  3.33s/it]  3%|▎         | 14/500 [00:37<15:42,  1.94s/it]  3%|▎         | 16/500 [00:39<14:12,  1.76s/it]  4%|▎         | 18/500 [00:43<14:02,  1.75s/it]  4%|▍         | 20/500 [00:44<11:54,  1.49s/it]  4%|▍         | 21/500 [00:45<11:22,  1.42s/it]  4%|▍         | 22/500 [00:48<13:59,  1.76s/it]  5%|▍         | 23/500 [00:49<11:27,  1.44s/it]  5%|▌         | 25/500 [00:53<14:19,  1.81s/it]  5%|▌         | 27/500 [00:56<12:36,  1.60s/it]  6%|▌         | 30/500 [00:58<09:28,  1.21s/it]  6%|▌         | 31/500 [01:03<14:41,  1.88s/it]  7%|▋         | 34/500 [01:07<13:11,  1.70s/it]  7%|▋         | 35/500 [01:08<11:43,  1.51s/it]  7%|▋         | 36/500 [01:16<20:40,  2.67s/it]  8%|▊         | 40/500 [01:16<10:31,  1.37s/it]  8%|▊         | 41/500 [01:27<21:43,  2.84s/it]  9%|▉         | 45/500 [01:28<12:09,  1.60s/it]  9%|▉         | 46/500 [01:31<13:18,  1.76s/it]  9%|▉         | 47/500 [01:35<16:11,  2.14s/it] 10%|▉         | 49/500 [01:37<13:42,  1.82s/it] 10%|█         | 50/500 [01:43<19:40,  2.62s/it] 11%|█         | 54/500 [01:50<16:09,  2.17s/it] 11%|█▏        | 57/500 [01:51<11:07,  1.51s/it] 12%|█▏        | 58/500 [01:53<11:39,  1.58s/it] 12%|█▏        | 59/500 [01:55<12:45,  1.74s/it] 12%|█▏        | 60/500 [02:00<16:16,  2.22s/it] 13%|█▎        | 64/500 [02:08<15:07,  2.08s/it] 13%|█▎        | 66/500 [02:09<12:35,  1.74s/it] 13%|█▎        | 67/500 [02:10<11:29,  1.59s/it] 14%|█▎        | 68/500 [02:16<16:50,  2.34s/it] 14%|█▍        | 70/500 [02:16<11:51,  1.65s/it] 14%|█▍        | 72/500 [02:21<13:52,  1.94s/it] 15%|█▍        | 73/500 [02:22<11:24,  1.60s/it] 15%|█▍        | 74/500 [02:22<10:17,  1.45s/it] 15%|█▌        | 75/500 [02:27<16:03,  2.27s/it] 15%|█▌        | 77/500 [02:32<15:53,  2.25s/it] 16%|█▌        | 80/500 [02:41<18:07,  2.59s/it] 16%|█▋        | 82/500 [02:42<13:34,  1.95s/it] 17%|█▋        | 83/500 [02:44<13:22,  1.93s/it] 17%|█▋        | 84/500 [02:51<21:37,  3.12s/it] 17%|█▋        | 87/500 [02:53<13:32,  1.97s/it] 18%|█▊        | 89/500 [02:55<11:32,  1.69s/it] 18%|█▊        | 90/500 [03:01<16:12,  2.37s/it] 18%|█▊        | 91/500 [03:04<17:35,  2.58s/it] 19%|█▊        | 93/500 [03:06<12:43,  1.88s/it] 19%|█▉        | 94/500 [03:15<22:41,  3.35s/it] 19%|█▉        | 96/500 [03:16<15:43,  2.34s/it] 19%|█▉        | 97/500 [03:27<27:40,  4.12s/it] 20%|█▉        | 98/500 [03:31<27:47,  4.15s/it] 20%|██        | 100/500 [03:38<26:28,  3.97s/it] 20%|██        | 102/500 [03:42<20:58,  3.16s/it] 21%|██        | 103/500 [03:43<18:24,  2.78s/it] 21%|██        | 104/500 [03:47<19:52,  3.01s/it] 21%|██        | 106/500 [03:48<13:25,  2.04s/it] 21%|██▏       | 107/500 [03:49<11:32,  1.76s/it] 22%|██▏       | 108/500 [03:55<18:47,  2.88s/it] 22%|██▏       | 111/500 [04:02<16:57,  2.62s/it] 23%|██▎       | 113/500 [04:05<13:46,  2.13s/it] 23%|██▎       | 115/500 [04:10<15:12,  2.37s/it] 23%|██▎       | 117/500 [04:12<12:16,  1.92s/it] 24%|██▍       | 120/500 [04:20<13:32,  2.14s/it] 24%|██▍       | 122/500 [04:20<10:13,  1.62s/it] 25%|██▍       | 123/500 [04:23<11:43,  1.87s/it] 25%|██▌       | 126/500 [04:29<11:27,  1.84s/it] 26%|██▌       | 128/500 [04:41<18:55,  3.05s/it] 26%|██▌       | 131/500 [04:46<15:48,  2.57s/it] 27%|██▋       | 134/500 [04:49<12:03,  1.98s/it] 27%|██▋       | 135/500 [04:49<10:34,  1.74s/it] 27%|██▋       | 137/500 [05:01<17:27,  2.88s/it] 28%|██▊       | 140/500 [05:01<10:55,  1.82s/it] 28%|██▊       | 142/500 [05:06<12:07,  2.03s/it] 29%|██▉       | 144/500 [05:08<09:57,  1.68s/it] 29%|██▉       | 146/500 [05:13<11:40,  1.98s/it] 30%|██▉       | 149/500 [05:14<08:12,  1.40s/it] 30%|███       | 150/500 [05:26<17:39,  3.03s/it] 31%|███       | 155/500 [05:27<08:46,  1.53s/it] 31%|███       | 156/500 [05:30<09:31,  1.66s/it] 31%|███▏      | 157/500 [05:32<09:42,  1.70s/it] 32%|███▏      | 159/500 [05:35<09:11,  1.62s/it] 32%|███▏      | 160/500 [05:56<29:20,  5.18s/it] 33%|███▎      | 167/500 [05:56<10:30,  1.89s/it] 34%|███▎      | 168/500 [05:57<09:28,  1.71s/it] 34%|███▍      | 169/500 [06:04<13:58,  2.53s/it] 34%|███▍      | 172/500 [06:08<11:05,  2.03s/it] 35%|███▍      | 173/500 [06:15<15:44,  2.89s/it] 36%|███▌      | 178/500 [06:16<07:48,  1.45s/it] 36%|███▌      | 179/500 [06:28<14:48,  2.77s/it] 37%|███▋      | 183/500 [06:39<14:38,  2.77s/it] 38%|███▊      | 190/500 [06:42<08:13,  1.59s/it] 38%|███▊      | 192/500 [06:51<10:41,  2.08s/it] 39%|███▉      | 194/500 [06:58<12:02,  2.36s/it] 39%|███▉      | 197/500 [06:59<08:53,  1.76s/it] 40%|███▉      | 199/500 [07:09<12:17,  2.45s/it] 40%|████      | 201/500 [07:13<12:03,  2.42s/it] 41%|████      | 203/500 [07:16<10:44,  2.17s/it] 41%|████      | 205/500 [07:19<09:31,  1.94s/it] 41%|████▏     | 207/500 [07:20<07:40,  1.57s/it] 42%|████▏     | 208/500 [07:25<09:52,  2.03s/it] 42%|████▏     | 209/500 [07:32<14:44,  3.04s/it] 42%|████▏     | 212/500 [07:33<08:36,  1.79s/it] 43%|████▎     | 213/500 [07:33<07:41,  1.61s/it] 43%|████▎     | 214/500 [07:44<16:36,  3.49s/it] 44%|████▎     | 218/500 [07:45<07:47,  1.66s/it] 44%|████▍     | 219/500 [07:50<10:50,  2.32s/it] 44%|████▍     | 220/500 [07:54<11:38,  2.49s/it] 45%|████▍     | 223/500 [08:01<11:26,  2.48s/it] 45%|████▌     | 226/500 [08:02<07:20,  1.61s/it] 45%|████▌     | 227/500 [08:03<07:00,  1.54s/it] 46%|████▌     | 228/500 [08:06<08:28,  1.87s/it] 46%|████▌     | 230/500 [08:09<07:59,  1.78s/it] 46%|████▌     | 231/500 [08:11<07:41,  1.71s/it] 46%|████▋     | 232/500 [08:12<06:46,  1.52s/it] 47%|████▋     | 233/500 [08:13<06:55,  1.56s/it] 47%|████▋     | 234/500 [08:14<06:02,  1.36s/it] 47%|████▋     | 235/500 [08:16<06:23,  1.45s/it] 47%|████▋     | 236/500 [08:18<07:09,  1.63s/it] 47%|████▋     | 237/500 [08:21<09:07,  2.08s/it] 48%|████▊     | 239/500 [08:26<09:22,  2.16s/it] 48%|████▊     | 241/500 [08:28<07:29,  1.73s/it] 48%|████▊     | 242/500 [08:34<11:18,  2.63s/it] 49%|████▉     | 245/500 [08:41<11:03,  2.60s/it] 49%|████▉     | 246/500 [08:48<14:31,  3.43s/it] 50%|████▉     | 248/500 [09:04<20:50,  4.96s/it] 50%|████▉     | 249/500 [09:22<31:13,  7.46s/it] 52%|█████▏    | 258/500 [09:25<09:32,  2.36s/it] 52%|█████▏    | 260/500 [09:27<08:24,  2.10s/it] 52%|█████▏    | 261/500 [09:30<08:38,  2.17s/it] 52%|█████▏    | 262/500 [09:37<11:26,  2.89s/it] 53%|█████▎    | 264/500 [09:39<09:12,  2.34s/it] 53%|█████▎    | 266/500 [09:51<13:40,  3.51s/it] 54%|█████▍    | 270/500 [10:06<13:41,  3.57s/it] 55%|█████▍    | 274/500 [10:11<09:55,  2.63s/it] 55%|█████▌    | 276/500 [10:11<07:51,  2.10s/it] 55%|█████▌    | 277/500 [10:19<10:43,  2.89s/it] 56%|█████▌    | 280/500 [10:21<07:30,  2.05s/it] 56%|█████▋    | 282/500 [10:27<08:17,  2.28s/it] 57%|█████▋    | 283/500 [10:30<08:41,  2.40s/it] 57%|█████▋    | 285/500 [10:33<07:25,  2.07s/it] 57%|█████▋    | 286/500 [10:36<08:36,  2.41s/it] 57%|█████▋    | 287/500 [10:37<07:19,  2.06s/it] 58%|█████▊    | 289/500 [10:40<06:20,  1.80s/it] 58%|█████▊    | 290/500 [10:45<08:32,  2.44s/it] 59%|█████▉    | 294/500 [10:56<08:55,  2.60s/it] 59%|█████▉    | 295/500 [11:03<11:37,  3.40s/it] 60%|██████    | 302/500 [11:07<05:18,  1.61s/it] 61%|██████    | 303/500 [11:10<05:54,  1.80s/it] 61%|██████    | 305/500 [11:16<06:36,  2.03s/it] 61%|██████    | 306/500 [11:20<07:44,  2.39s/it] 62%|██████▏   | 309/500 [11:34<10:34,  3.32s/it] 62%|██████▏   | 312/500 [11:37<07:39,  2.44s/it] 63%|██████▎   | 314/500 [11:39<06:16,  2.02s/it] 63%|██████▎   | 315/500 [11:39<05:33,  1.80s/it] 63%|██████▎   | 316/500 [11:44<07:18,  2.38s/it] 64%|██████▎   | 318/500 [11:47<06:26,  2.12s/it] 64%|██████▍   | 319/500 [11:48<05:13,  1.73s/it] 64%|██████▍   | 320/500 [11:51<06:26,  2.15s/it] 64%|██████▍   | 321/500 [11:52<05:11,  1.74s/it] 64%|██████▍   | 322/500 [11:55<06:01,  2.03s/it] 65%|██████▍   | 323/500 [11:56<05:40,  1.92s/it] 65%|██████▍   | 324/500 [12:00<07:29,  2.56s/it] 65%|██████▌   | 326/500 [12:03<05:46,  1.99s/it] 65%|██████▌   | 327/500 [12:12<10:21,  3.59s/it] 66%|██████▋   | 332/500 [12:17<05:32,  1.98s/it] 67%|██████▋   | 334/500 [12:19<04:50,  1.75s/it] 67%|██████▋   | 335/500 [12:32<09:51,  3.58s/it] 68%|██████▊   | 340/500 [12:35<05:15,  1.97s/it] 68%|██████▊   | 341/500 [12:41<06:34,  2.48s/it] 69%|██████▉   | 344/500 [12:44<05:10,  1.99s/it] 69%|██████▉   | 346/500 [12:50<05:37,  2.19s/it] 70%|██████▉   | 349/500 [12:52<04:10,  1.66s/it] 70%|███████   | 350/500 [12:58<05:46,  2.31s/it] 70%|███████   | 351/500 [12:58<04:55,  1.98s/it] 70%|███████   | 352/500 [12:59<04:19,  1.75s/it] 71%|███████   | 353/500 [13:02<04:40,  1.91s/it] 71%|███████   | 354/500 [13:03<04:06,  1.69s/it] 71%|███████   | 355/500 [13:03<03:09,  1.30s/it] 71%|███████   | 356/500 [13:06<04:28,  1.86s/it] 72%|███████▏  | 359/500 [13:24<09:23,  4.00s/it] 73%|███████▎  | 364/500 [13:26<04:36,  2.03s/it] 73%|███████▎  | 365/500 [13:31<05:15,  2.34s/it] 73%|███████▎  | 366/500 [13:36<06:24,  2.87s/it] 74%|███████▍  | 369/500 [13:40<04:45,  2.18s/it] 74%|███████▍  | 370/500 [13:46<06:11,  2.85s/it] 74%|███████▍  | 372/500 [13:46<04:13,  1.98s/it] 75%|███████▍  | 373/500 [13:49<04:32,  2.15s/it] 75%|███████▍  | 374/500 [13:50<03:57,  1.88s/it] 75%|███████▌  | 375/500 [13:53<04:16,  2.05s/it] 75%|███████▌  | 376/500 [13:55<04:35,  2.22s/it] 76%|███████▌  | 378/500 [13:57<03:19,  1.63s/it] 76%|███████▌  | 379/500 [13:59<03:35,  1.78s/it] 76%|███████▌  | 380/500 [14:03<04:22,  2.19s/it] 77%|███████▋  | 383/500 [14:05<02:53,  1.48s/it] 77%|███████▋  | 384/500 [14:07<03:05,  1.60s/it] 77%|███████▋  | 386/500 [14:15<04:34,  2.41s/it] 77%|███████▋  | 387/500 [14:15<03:48,  2.02s/it] 78%|███████▊  | 389/500 [14:16<02:25,  1.31s/it] 78%|███████▊  | 390/500 [14:21<03:54,  2.14s/it] 78%|███████▊  | 391/500 [14:21<03:15,  1.79s/it] 79%|███████▊  | 393/500 [14:25<03:19,  1.86s/it] 79%|███████▉  | 395/500 [14:30<03:27,  1.98s/it] 79%|███████▉  | 396/500 [14:31<03:04,  1.77s/it] 80%|███████▉  | 398/500 [14:39<04:29,  2.65s/it] 80%|███████▉  | 399/500 [14:41<04:05,  2.43s/it] 80%|████████  | 402/500 [14:48<04:00,  2.45s/it] 81%|████████  | 405/500 [14:58<04:26,  2.80s/it] 82%|████████▏ | 409/500 [15:00<02:43,  1.80s/it] 82%|████████▏ | 410/500 [15:01<02:30,  1.67s/it] 82%|████████▏ | 411/500 [15:08<03:52,  2.61s/it] 83%|████████▎ | 414/500 [15:09<02:19,  1.62s/it] 83%|████████▎ | 415/500 [15:11<02:25,  1.71s/it] 83%|████████▎ | 417/500 [15:14<02:10,  1.57s/it] 84%|████████▎ | 418/500 [15:16<02:23,  1.76s/it] 84%|████████▍ | 419/500 [15:19<02:46,  2.06s/it] 84%|████████▍ | 421/500 [15:25<03:00,  2.28s/it] 85%|████████▍ | 424/500 [15:29<02:22,  1.88s/it] 85%|████████▌ | 425/500 [15:41<04:42,  3.76s/it] 86%|████████▌ | 428/500 [15:55<04:53,  4.08s/it] 87%|████████▋ | 434/500 [15:57<02:13,  2.02s/it] 87%|████████▋ | 435/500 [16:00<02:15,  2.09s/it] 87%|████████▋ | 437/500 [16:03<02:07,  2.03s/it] 88%|████████▊ | 438/500 [16:12<03:06,  3.01s/it] 88%|████████▊ | 440/500 [16:13<02:18,  2.31s/it] 89%|████████▊ | 443/500 [16:20<02:07,  2.23s/it] 89%|████████▉ | 445/500 [16:20<01:33,  1.71s/it] 89%|████████▉ | 446/500 [16:37<03:41,  4.10s/it] 90%|████████▉ | 448/500 [16:37<02:29,  2.88s/it] 90%|████████▉ | 449/500 [16:38<02:09,  2.55s/it] 90%|█████████ | 450/500 [16:47<03:10,  3.81s/it] 91%|█████████ | 453/500 [16:47<01:37,  2.07s/it] 91%|█████████ | 455/500 [16:51<01:32,  2.06s/it] 91%|█████████ | 456/500 [16:52<01:19,  1.81s/it] 92%|█████████▏| 458/500 [16:55<01:16,  1.81s/it] 92%|█████████▏| 459/500 [16:56<01:04,  1.57s/it] 92%|█████████▏| 460/500 [17:02<01:40,  2.51s/it] 93%|█████████▎| 463/500 [17:04<01:01,  1.67s/it] 93%|█████████▎| 465/500 [17:10<01:09,  1.97s/it] 93%|█████████▎| 466/500 [17:17<01:38,  2.90s/it] 94%|█████████▍| 470/500 [17:22<01:05,  2.17s/it] 94%|█████████▍| 472/500 [17:33<01:24,  3.03s/it] 95%|█████████▌| 477/500 [17:38<00:46,  2.04s/it] 96%|█████████▌| 480/500 [17:42<00:35,  1.77s/it] 96%|█████████▌| 481/500 [17:44<00:35,  1.85s/it] 96%|█████████▋| 482/500 [17:46<00:32,  1.83s/it] 97%|█████████▋| 483/500 [17:46<00:26,  1.53s/it] 97%|█████████▋| 484/500 [17:47<00:23,  1.50s/it] 97%|█████████▋| 485/500 [17:51<00:30,  2.04s/it] 97%|█████████▋| 486/500 [17:54<00:32,  2.31s/it] 97%|█████████▋| 487/500 [17:55<00:25,  1.92s/it] 98%|█████████▊| 488/500 [18:04<00:45,  3.80s/it] 98%|█████████▊| 491/500 [18:10<00:24,  2.77s/it] 99%|█████████▊| 493/500 [18:11<00:14,  2.14s/it] 99%|█████████▉| 495/500 [18:13<00:08,  1.69s/it] 99%|█████████▉| 496/500 [18:22<00:12,  3.02s/it]100%|█████████▉| 498/500 [18:26<00:05,  2.70s/it]100%|█████████▉| 499/500 [18:31<00:03,  3.11s/it]100%|██████████| 500/500 [18:54<00:00,  7.49s/it]100%|██████████| 500/500 [18:54<00:00,  2.27s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
Regenerating missing GPT-4 file for split data file: chunk_2.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 84 / 84
  0%|          | 0/84 [00:00<?, ?it/s]  1%|          | 1/84 [00:13<18:38, 13.47s/it]  2%|▏         | 2/84 [00:18<11:31,  8.43s/it]  5%|▍         | 4/84 [00:38<12:28,  9.36s/it] 15%|█▌        | 13/84 [00:41<02:34,  2.17s/it] 17%|█▋        | 14/84 [00:44<02:39,  2.27s/it] 18%|█▊        | 15/84 [00:56<04:06,  3.57s/it] 25%|██▌       | 21/84 [01:05<02:36,  2.48s/it] 29%|██▊       | 24/84 [01:07<01:55,  1.93s/it] 30%|██▉       | 25/84 [01:13<02:25,  2.47s/it] 35%|███▍      | 29/84 [01:29<02:45,  3.01s/it] 40%|████      | 34/84 [01:31<01:39,  1.98s/it] 43%|████▎     | 36/84 [01:33<01:26,  1.80s/it] 44%|████▍     | 37/84 [01:36<01:31,  1.95s/it] 45%|████▌     | 38/84 [01:37<01:19,  1.73s/it] 46%|████▋     | 39/84 [01:45<02:07,  2.83s/it] 50%|█████     | 42/84 [01:48<01:28,  2.11s/it] 51%|█████     | 43/84 [01:52<01:38,  2.40s/it] 54%|█████▎    | 45/84 [01:53<01:06,  1.70s/it] 56%|█████▌    | 47/84 [01:54<00:49,  1.33s/it] 57%|█████▋    | 48/84 [02:00<01:20,  2.23s/it] 60%|█████▉    | 50/84 [02:01<00:58,  1.71s/it] 62%|██████▏   | 52/84 [02:16<01:54,  3.57s/it] 69%|██████▉   | 58/84 [02:17<00:39,  1.54s/it] 70%|███████   | 59/84 [02:19<00:41,  1.65s/it] 71%|███████▏  | 60/84 [02:20<00:37,  1.58s/it] 73%|███████▎  | 61/84 [02:21<00:31,  1.35s/it] 74%|███████▍  | 62/84 [02:24<00:37,  1.70s/it] 75%|███████▌  | 63/84 [02:28<00:46,  2.22s/it] 76%|███████▌  | 64/84 [02:42<01:40,  5.00s/it] 82%|████████▏ | 69/84 [02:48<00:40,  2.71s/it] 86%|████████▌ | 72/84 [02:56<00:31,  2.63s/it] 87%|████████▋ | 73/84 [03:01<00:32,  2.94s/it] 89%|████████▉ | 75/84 [03:02<00:21,  2.34s/it] 92%|█████████▏| 77/84 [03:07<00:16,  2.30s/it] 94%|█████████▍| 79/84 [03:18<00:16,  3.26s/it] 99%|█████████▉| 83/84 [03:32<00:03,  3.33s/it]100%|██████████| 84/84 [03:32<00:00,  2.52s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 2
[INFO] end_time: 2024-09-02 20:25:56
[INFO] duration: 25 min 
[2024-09-03 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-01/2024-09-01_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-03 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-01/2024-09-01_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-01
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-01/2024-09-01_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-01/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-01/raw/single_True_rag_True/split_data/chunk_1.csv
Saved chunk 2 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-01/raw/single_True_rag_True/split_data/chunk_2.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 500 / 500
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:12<1:46:54, 12.85s/it]  1%|          | 5/500 [00:21<30:36,  3.71s/it]    1%|          | 6/500 [00:55<1:28:26, 10.74s/it]  4%|▍         | 19/500 [00:55<16:19,  2.04s/it]   4%|▍         | 22/500 [00:59<15:06,  1.90s/it]  5%|▍         | 24/500 [01:04<15:50,  2.00s/it]  5%|▌         | 26/500 [01:04<12:55,  1.64s/it]  5%|▌         | 27/500 [01:12<18:43,  2.38s/it]  6%|▌         | 30/500 [01:18<17:04,  2.18s/it]  6%|▌         | 31/500 [01:20<16:57,  2.17s/it]  7%|▋         | 33/500 [01:29<22:07,  2.84s/it]  8%|▊         | 38/500 [01:32<13:41,  1.78s/it]  8%|▊         | 39/500 [01:37<16:19,  2.12s/it]  8%|▊         | 41/500 [01:41<15:57,  2.09s/it]  9%|▊         | 43/500 [01:53<23:44,  3.12s/it]  9%|▉         | 46/500 [01:55<17:01,  2.25s/it] 10%|▉         | 48/500 [01:58<16:01,  2.13s/it] 10%|▉         | 49/500 [02:02<17:46,  2.37s/it] 10%|█         | 51/500 [02:09<20:36,  2.75s/it] 11%|█         | 54/500 [02:12<14:40,  1.97s/it] 11%|█         | 55/500 [02:13<13:59,  1.89s/it] 11%|█         | 56/500 [02:21<21:58,  2.97s/it] 12%|█▏        | 58/500 [02:46<46:34,  6.32s/it] 13%|█▎        | 65/500 [02:49<18:48,  2.60s/it] 13%|█▎        | 66/500 [02:49<16:51,  2.33s/it] 13%|█▎        | 67/500 [02:51<15:41,  2.17s/it] 14%|█▎        | 68/500 [02:55<18:35,  2.58s/it] 14%|█▍        | 69/500 [03:02<23:36,  3.29s/it] 14%|█▍        | 71/500 [03:03<16:21,  2.29s/it] 14%|█▍        | 72/500 [03:04<15:43,  2.20s/it] 15%|█▍        | 73/500 [03:21<39:06,  5.50s/it] 16%|█▌        | 78/500 [03:22<15:49,  2.25s/it] 16%|█▌        | 80/500 [03:27<15:33,  2.22s/it] 16%|█▌        | 81/500 [03:28<14:38,  2.10s/it] 16%|█▋        | 82/500 [03:30<13:58,  2.01s/it] 17%|█▋        | 83/500 [03:36<19:54,  2.86s/it] 17%|█▋        | 84/500 [03:39<20:19,  2.93s/it] 17%|█▋        | 86/500 [03:41<15:22,  2.23s/it] 17%|█▋        | 87/500 [03:57<35:46,  5.20s/it] 18%|█▊        | 91/500 [04:04<22:05,  3.24s/it] 18%|█▊        | 92/500 [04:04<18:58,  2.79s/it] 19%|█▉        | 94/500 [04:09<18:24,  2.72s/it] 19%|█▉        | 96/500 [04:13<16:22,  2.43s/it] 19%|█▉        | 97/500 [04:14<15:04,  2.24s/it] 20%|█▉        | 99/500 [04:25<22:23,  3.35s/it] 20%|██        | 102/500 [04:26<13:29,  2.03s/it] 21%|██        | 103/500 [04:26<11:35,  1.75s/it] 21%|██        | 104/500 [04:42<29:48,  4.52s/it] 22%|██▏       | 110/500 [04:46<13:14,  2.04s/it] 22%|██▏       | 112/500 [04:46<10:13,  1.58s/it] 23%|██▎       | 113/500 [04:48<10:36,  1.65s/it] 23%|██▎       | 114/500 [05:03<25:16,  3.93s/it] 23%|██▎       | 117/500 [05:27<35:21,  5.54s/it] 25%|██▌       | 125/500 [05:27<13:44,  2.20s/it] 25%|██▌       | 126/500 [05:31<14:40,  2.35s/it] 25%|██▌       | 127/500 [05:34<14:58,  2.41s/it] 26%|██▌       | 128/500 [05:53<30:45,  4.96s/it] 27%|██▋       | 134/500 [05:56<14:55,  2.45s/it] 27%|██▋       | 135/500 [06:02<17:25,  2.87s/it] 28%|██▊       | 139/500 [06:10<14:42,  2.44s/it] 28%|██▊       | 141/500 [06:11<12:13,  2.04s/it] 28%|██▊       | 142/500 [06:18<16:20,  2.74s/it] 29%|██▉       | 145/500 [06:24<14:59,  2.54s/it] 30%|██▉       | 148/500 [06:27<11:32,  1.97s/it] 30%|███       | 150/500 [06:35<14:35,  2.50s/it] 31%|███       | 153/500 [06:42<14:00,  2.42s/it] 31%|███       | 156/500 [06:43<09:57,  1.74s/it] 31%|███▏      | 157/500 [06:48<12:24,  2.17s/it] 32%|███▏      | 158/500 [06:51<13:00,  2.28s/it] 32%|███▏      | 160/500 [06:53<10:37,  1.88s/it] 32%|███▏      | 161/500 [06:54<09:47,  1.73s/it] 32%|███▏      | 162/500 [06:56<09:49,  1.74s/it] 33%|███▎      | 163/500 [07:04<17:18,  3.08s/it] 33%|███▎      | 166/500 [07:07<12:11,  2.19s/it] 33%|███▎      | 167/500 [07:11<14:05,  2.54s/it] 34%|███▍      | 169/500 [07:24<20:57,  3.80s/it] 35%|███▍      | 174/500 [07:32<14:12,  2.62s/it] 35%|███▌      | 177/500 [07:40<14:20,  2.66s/it] 36%|███▌      | 179/500 [07:45<14:08,  2.64s/it] 36%|███▌      | 180/500 [07:48<14:04,  2.64s/it] 36%|███▌      | 181/500 [07:50<13:09,  2.47s/it] 36%|███▋      | 182/500 [07:51<11:37,  2.19s/it] 37%|███▋      | 183/500 [07:54<13:18,  2.52s/it] 37%|███▋      | 184/500 [08:13<33:50,  6.43s/it] 38%|███▊      | 191/500 [08:14<09:51,  1.91s/it] 39%|███▊      | 193/500 [08:20<11:07,  2.17s/it] 39%|███▉      | 195/500 [08:25<11:37,  2.29s/it] 39%|███▉      | 196/500 [08:26<10:48,  2.13s/it] 39%|███▉      | 197/500 [08:27<09:23,  1.86s/it] 40%|███▉      | 198/500 [08:36<16:18,  3.24s/it] 40%|████      | 201/500 [08:40<12:25,  2.49s/it] 41%|████      | 203/500 [08:46<12:52,  2.60s/it] 41%|████      | 205/500 [08:51<12:30,  2.54s/it] 41%|████▏     | 207/500 [08:53<10:26,  2.14s/it] 42%|████▏     | 209/500 [08:54<07:26,  1.53s/it] 42%|████▏     | 210/500 [08:57<08:38,  1.79s/it] 42%|████▏     | 211/500 [09:08<18:16,  3.79s/it] 43%|████▎     | 215/500 [09:19<15:06,  3.18s/it] 44%|████▎     | 218/500 [09:21<10:46,  2.29s/it] 44%|████▍     | 219/500 [09:29<14:48,  3.16s/it] 44%|████▍     | 222/500 [09:32<10:29,  2.26s/it] 45%|████▍     | 223/500 [09:35<11:08,  2.41s/it] 45%|████▌     | 225/500 [09:36<08:32,  1.86s/it] 45%|████▌     | 226/500 [09:43<12:43,  2.79s/it] 45%|████▌     | 227/500 [09:45<11:53,  2.61s/it] 46%|████▌     | 229/500 [09:59<19:10,  4.24s/it] 47%|████▋     | 235/500 [10:19<16:08,  3.66s/it] 48%|████▊     | 241/500 [10:20<08:38,  2.00s/it] 49%|████▊     | 243/500 [10:29<10:46,  2.52s/it] 49%|████▉     | 244/500 [10:29<09:33,  2.24s/it] 49%|████▉     | 245/500 [10:33<10:33,  2.48s/it] 49%|████▉     | 246/500 [10:34<09:09,  2.16s/it] 49%|████▉     | 247/500 [10:41<12:50,  3.05s/it] 50%|████▉     | 249/500 [10:41<08:17,  1.98s/it] 50%|█████     | 250/500 [10:47<11:40,  2.80s/it] 50%|█████     | 252/500 [10:51<10:36,  2.57s/it] 51%|█████     | 253/500 [10:55<11:59,  2.91s/it] 51%|█████     | 254/500 [11:01<14:12,  3.47s/it] 51%|█████▏    | 257/500 [11:18<18:17,  4.52s/it] 52%|█████▏    | 262/500 [11:22<10:03,  2.53s/it] 53%|█████▎    | 263/500 [11:24<09:46,  2.48s/it] 53%|█████▎    | 264/500 [11:25<09:04,  2.31s/it] 53%|█████▎    | 265/500 [11:27<08:26,  2.15s/it] 53%|█████▎    | 266/500 [11:30<09:05,  2.33s/it] 53%|█████▎    | 267/500 [11:35<11:13,  2.89s/it] 54%|█████▎    | 268/500 [11:37<10:21,  2.68s/it] 54%|█████▍    | 270/500 [11:40<09:01,  2.36s/it] 54%|█████▍    | 272/500 [11:41<05:43,  1.51s/it] 55%|█████▍    | 273/500 [11:43<06:10,  1.63s/it] 55%|█████▍    | 274/500 [11:44<06:18,  1.68s/it] 55%|█████▌    | 275/500 [11:46<06:25,  1.71s/it] 55%|█████▌    | 277/500 [11:52<08:23,  2.26s/it] 56%|█████▌    | 278/500 [12:02<14:44,  3.98s/it] 56%|█████▌    | 281/500 [12:09<11:27,  3.14s/it] 57%|█████▋    | 284/500 [12:11<07:25,  2.06s/it] 57%|█████▋    | 285/500 [12:25<14:56,  4.17s/it] 58%|█████▊    | 290/500 [12:27<07:23,  2.11s/it] 58%|█████▊    | 291/500 [12:32<08:22,  2.40s/it] 58%|█████▊    | 292/500 [12:33<07:39,  2.21s/it] 59%|█████▉    | 294/500 [12:38<07:57,  2.32s/it] 59%|█████▉    | 295/500 [12:45<10:55,  3.20s/it] 60%|█████▉    | 298/500 [12:51<09:12,  2.73s/it] 60%|██████    | 301/500 [12:56<07:27,  2.25s/it] 60%|██████    | 302/500 [12:57<06:37,  2.01s/it] 61%|██████    | 303/500 [13:01<07:58,  2.43s/it] 61%|██████    | 304/500 [13:01<06:38,  2.03s/it] 61%|██████    | 306/500 [13:04<05:31,  1.71s/it] 61%|██████▏   | 307/500 [13:11<09:16,  2.88s/it] 62%|██████▏   | 308/500 [13:12<07:52,  2.46s/it] 62%|██████▏   | 310/500 [13:14<05:47,  1.83s/it] 62%|██████▏   | 311/500 [13:27<13:29,  4.29s/it] 63%|██████▎   | 313/500 [13:30<10:09,  3.26s/it] 63%|██████▎   | 316/500 [13:40<10:14,  3.34s/it] 64%|██████▍   | 319/500 [13:42<06:52,  2.28s/it] 64%|██████▍   | 320/500 [13:50<09:37,  3.21s/it] 65%|██████▍   | 324/500 [13:54<06:03,  2.07s/it] 65%|██████▌   | 325/500 [13:57<06:39,  2.28s/it] 65%|██████▌   | 327/500 [14:07<08:43,  3.03s/it] 66%|██████▌   | 330/500 [14:08<05:44,  2.03s/it] 66%|██████▌   | 331/500 [14:13<07:06,  2.52s/it] 67%|██████▋   | 333/500 [14:15<05:26,  1.96s/it] 67%|██████▋   | 334/500 [14:21<07:38,  2.76s/it] 67%|██████▋   | 336/500 [14:28<08:18,  3.04s/it] 68%|██████▊   | 339/500 [14:35<07:18,  2.72s/it] 68%|██████▊   | 342/500 [15:01<12:55,  4.91s/it] 70%|██████▉   | 348/500 [15:06<07:01,  2.77s/it] 70%|███████   | 351/500 [15:18<07:47,  3.13s/it] 71%|███████   | 355/500 [15:23<05:58,  2.47s/it] 71%|███████▏  | 357/500 [15:24<05:04,  2.13s/it] 72%|███████▏  | 358/500 [15:29<05:49,  2.46s/it] 72%|███████▏  | 359/500 [15:31<05:37,  2.39s/it] 72%|███████▏  | 360/500 [15:32<04:52,  2.09s/it] 72%|███████▏  | 361/500 [15:33<04:44,  2.05s/it] 72%|███████▏  | 362/500 [16:04<19:16,  8.38s/it] 74%|███████▍  | 370/500 [16:07<05:39,  2.61s/it] 74%|███████▍  | 371/500 [16:13<06:31,  3.03s/it] 75%|███████▍  | 374/500 [16:15<04:40,  2.23s/it] 75%|███████▌  | 375/500 [16:17<04:39,  2.24s/it] 75%|███████▌  | 377/500 [16:31<07:18,  3.56s/it] 76%|███████▋  | 382/500 [16:43<05:49,  2.96s/it] 78%|███████▊  | 388/500 [16:47<03:34,  1.91s/it] 78%|███████▊  | 390/500 [16:51<03:32,  1.93s/it] 78%|███████▊  | 391/500 [16:53<03:28,  1.91s/it] 79%|███████▊  | 393/500 [16:55<02:58,  1.67s/it] 79%|███████▉  | 394/500 [16:58<03:32,  2.00s/it] 79%|███████▉  | 397/500 [17:02<02:58,  1.74s/it] 80%|███████▉  | 398/500 [17:18<06:38,  3.91s/it] 81%|████████  | 404/500 [17:21<03:04,  1.92s/it] 81%|████████  | 405/500 [17:24<03:17,  2.08s/it] 81%|████████  | 406/500 [17:27<03:32,  2.26s/it] 82%|████████▏ | 408/500 [17:27<02:28,  1.61s/it] 82%|████████▏ | 409/500 [17:28<02:17,  1.51s/it] 82%|████████▏ | 410/500 [17:34<03:37,  2.42s/it] 83%|████████▎ | 413/500 [17:41<03:20,  2.31s/it] 83%|████████▎ | 416/500 [17:42<02:04,  1.48s/it] 83%|████████▎ | 417/500 [17:55<04:40,  3.38s/it] 84%|████████▍ | 421/500 [18:00<03:07,  2.38s/it] 84%|████████▍ | 422/500 [18:07<03:55,  3.02s/it] 85%|████████▍ | 424/500 [18:09<02:59,  2.36s/it] 85%|████████▌ | 425/500 [18:10<02:42,  2.16s/it] 85%|████████▌ | 426/500 [18:12<02:39,  2.15s/it] 85%|████████▌ | 427/500 [18:16<03:02,  2.50s/it] 86%|████████▌ | 428/500 [18:18<03:01,  2.52s/it] 86%|████████▌ | 430/500 [18:23<02:49,  2.43s/it] 86%|████████▋ | 432/500 [18:24<01:53,  1.67s/it] 87%|████████▋ | 433/500 [18:24<01:39,  1.49s/it] 87%|████████▋ | 434/500 [18:29<02:20,  2.13s/it] 87%|████████▋ | 435/500 [18:29<01:55,  1.78s/it] 87%|████████▋ | 437/500 [18:30<01:16,  1.21s/it] 88%|████████▊ | 438/500 [18:43<03:57,  3.83s/it] 89%|████████▊ | 443/500 [18:44<01:31,  1.60s/it] 89%|████████▉ | 444/500 [18:49<01:56,  2.08s/it] 89%|████████▉ | 446/500 [18:49<01:21,  1.51s/it] 89%|████████▉ | 447/500 [18:52<01:29,  1.68s/it] 90%|████████▉ | 448/500 [18:56<01:56,  2.24s/it] 90%|█████████ | 451/500 [18:59<01:23,  1.70s/it] 90%|█████████ | 452/500 [19:11<02:49,  3.53s/it] 91%|█████████▏| 457/500 [19:17<01:34,  2.20s/it] 92%|█████████▏| 458/500 [19:19<01:32,  2.19s/it] 92%|█████████▏| 459/500 [19:20<01:18,  1.92s/it] 92%|█████████▏| 460/500 [19:20<01:03,  1.59s/it] 92%|█████████▏| 461/500 [19:23<01:17,  2.00s/it] 92%|█████████▏| 462/500 [19:30<02:01,  3.21s/it] 93%|█████████▎| 466/500 [19:42<01:41,  2.99s/it] 94%|█████████▍| 469/500 [19:47<01:17,  2.51s/it] 94%|█████████▍| 471/500 [20:04<01:59,  4.11s/it] 95%|█████████▌| 475/500 [20:05<01:02,  2.49s/it] 95%|█████████▌| 476/500 [20:08<00:58,  2.45s/it] 95%|█████████▌| 477/500 [20:08<00:48,  2.09s/it] 96%|█████████▌| 478/500 [20:09<00:40,  1.86s/it] 96%|█████████▌| 479/500 [20:23<01:33,  4.47s/it] 96%|█████████▌| 480/500 [20:25<01:20,  4.02s/it] 97%|█████████▋| 483/500 [20:28<00:40,  2.39s/it] 97%|█████████▋| 485/500 [20:38<00:48,  3.22s/it] 98%|█████████▊| 488/500 [20:40<00:26,  2.21s/it] 98%|█████████▊| 490/500 [20:47<00:25,  2.59s/it] 98%|█████████▊| 491/500 [20:58<00:36,  4.02s/it] 99%|█████████▉| 495/500 [21:00<00:11,  2.23s/it] 99%|█████████▉| 497/500 [21:09<00:08,  2.83s/it]100%|█████████▉| 499/500 [21:20<00:03,  3.62s/it]100%|██████████| 500/500 [21:20<00:00,  2.56s/it]
Parsing GPT-4 response
Regenerating missing GPT-4 file for split data file: chunk_2.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 106 / 106
  0%|          | 0/106 [00:00<?, ?it/s]  1%|          | 1/106 [00:09<16:45,  9.58s/it]  3%|▎         | 3/106 [00:12<06:17,  3.66s/it]  5%|▍         | 5/106 [00:13<03:27,  2.06s/it]  6%|▌         | 6/106 [00:22<06:13,  3.74s/it]  8%|▊         | 8/106 [00:27<05:17,  3.24s/it]  8%|▊         | 9/106 [00:34<06:43,  4.16s/it] 10%|█         | 11/106 [00:39<05:30,  3.48s/it] 12%|█▏        | 13/106 [00:47<05:45,  3.71s/it] 16%|█▌        | 17/106 [00:48<02:54,  1.96s/it] 17%|█▋        | 18/106 [00:56<04:16,  2.92s/it] 19%|█▉        | 20/106 [01:02<04:03,  2.83s/it] 21%|██        | 22/106 [01:04<03:13,  2.31s/it] 22%|██▏       | 23/106 [01:06<03:02,  2.20s/it] 23%|██▎       | 24/106 [01:12<04:16,  3.13s/it] 25%|██▌       | 27/106 [01:14<02:32,  1.93s/it] 27%|██▋       | 29/106 [01:22<03:21,  2.61s/it] 28%|██▊       | 30/106 [01:25<03:12,  2.54s/it] 29%|██▉       | 31/106 [01:25<02:37,  2.10s/it] 30%|███       | 32/106 [01:29<03:04,  2.50s/it] 32%|███▏      | 34/106 [01:33<02:43,  2.27s/it] 34%|███▍      | 36/106 [01:42<03:36,  3.09s/it] 37%|███▋      | 39/106 [01:44<02:14,  2.00s/it] 39%|███▊      | 41/106 [01:46<01:58,  1.82s/it] 41%|████      | 43/106 [01:47<01:23,  1.33s/it] 42%|████▏     | 44/106 [01:51<02:00,  1.94s/it] 42%|████▏     | 45/106 [01:53<01:53,  1.86s/it] 44%|████▍     | 47/106 [01:58<02:08,  2.18s/it] 45%|████▌     | 48/106 [02:03<02:30,  2.60s/it] 49%|████▉     | 52/106 [02:10<01:54,  2.13s/it] 50%|█████     | 53/106 [02:18<02:42,  3.07s/it] 56%|█████▌    | 59/106 [02:22<01:20,  1.70s/it] 57%|█████▋    | 60/106 [02:26<01:34,  2.06s/it] 58%|█████▊    | 62/106 [02:30<01:25,  1.95s/it] 60%|██████    | 64/106 [02:36<01:33,  2.22s/it] 63%|██████▎   | 67/106 [02:44<01:35,  2.44s/it] 66%|██████▌   | 70/106 [02:49<01:19,  2.21s/it] 67%|██████▋   | 71/106 [02:51<01:15,  2.15s/it] 69%|██████▉   | 73/106 [02:55<01:06,  2.03s/it] 70%|██████▉   | 74/106 [02:59<01:16,  2.38s/it] 72%|███████▏  | 76/106 [03:00<00:53,  1.79s/it] 73%|███████▎  | 77/106 [03:05<01:07,  2.33s/it] 74%|███████▎  | 78/106 [03:05<00:52,  1.87s/it] 75%|███████▍  | 79/106 [03:06<00:44,  1.65s/it] 75%|███████▌  | 80/106 [03:14<01:29,  3.44s/it] 78%|███████▊  | 83/106 [03:19<00:55,  2.40s/it] 81%|████████  | 86/106 [03:23<00:39,  1.96s/it] 83%|████████▎ | 88/106 [03:24<00:26,  1.50s/it] 84%|████████▍ | 89/106 [03:30<00:40,  2.35s/it] 87%|████████▋ | 92/106 [03:36<00:30,  2.15s/it] 90%|████████▉ | 95/106 [03:45<00:27,  2.50s/it] 92%|█████████▏| 98/106 [03:51<00:18,  2.37s/it] 95%|█████████▌| 101/106 [03:52<00:08,  1.71s/it] 97%|█████████▋| 103/106 [04:03<00:07,  2.54s/it]100%|██████████| 106/106 [04:03<00:00,  2.29s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 2
[INFO] end_time: 2024-09-03 20:28:53
[INFO] duration: 28 min 
[2024-09-04 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-02/2024-09-02_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-04 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-02/2024-09-02_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-02
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-02/2024-09-02_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-02/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-02/raw/single_True_rag_True/split_data/chunk_1.csv
Saved chunk 2 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-02/raw/single_True_rag_True/split_data/chunk_2.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 500 / 500
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:09<1:18:51,  9.48s/it]  1%|          | 3/500 [00:13<31:20,  3.78s/it]    1%|          | 4/500 [00:16<29:40,  3.59s/it]  1%|          | 5/500 [00:20<31:35,  3.83s/it]  1%|▏         | 7/500 [00:30<35:48,  4.36s/it]  2%|▏         | 11/500 [00:40<27:13,  3.34s/it]  3%|▎         | 15/500 [00:44<18:00,  2.23s/it]  3%|▎         | 16/500 [00:49<20:57,  2.60s/it]  4%|▍         | 19/500 [00:50<14:05,  1.76s/it]  4%|▍         | 20/500 [00:52<14:55,  1.87s/it]  4%|▍         | 21/500 [00:56<17:14,  2.16s/it]  4%|▍         | 22/500 [01:04<26:05,  3.28s/it]  5%|▍         | 24/500 [01:09<24:17,  3.06s/it]  5%|▌         | 25/500 [01:13<26:06,  3.30s/it]  5%|▌         | 26/500 [01:14<21:55,  2.77s/it]  5%|▌         | 27/500 [01:29<45:16,  5.74s/it]  6%|▌         | 31/500 [01:35<25:42,  3.29s/it]  6%|▋         | 32/500 [01:44<33:37,  4.31s/it]  7%|▋         | 37/500 [01:48<18:08,  2.35s/it]  8%|▊         | 38/500 [01:55<23:16,  3.02s/it]  8%|▊         | 40/500 [01:56<17:45,  2.32s/it]  8%|▊         | 42/500 [02:00<17:03,  2.23s/it]  9%|▉         | 44/500 [02:01<12:28,  1.64s/it]  9%|▉         | 45/500 [02:03<12:32,  1.65s/it]  9%|▉         | 46/500 [02:17<31:57,  4.22s/it] 10%|█         | 51/500 [02:23<17:52,  2.39s/it] 11%|█         | 53/500 [02:24<14:28,  1.94s/it] 11%|█         | 54/500 [02:30<19:08,  2.58s/it] 11%|█▏        | 57/500 [02:34<15:06,  2.05s/it] 12%|█▏        | 58/500 [02:34<13:08,  1.78s/it] 12%|█▏        | 59/500 [02:39<16:42,  2.27s/it] 12%|█▏        | 61/500 [02:39<11:41,  1.60s/it] 12%|█▏        | 62/500 [02:44<16:01,  2.20s/it] 13%|█▎        | 63/500 [02:46<15:27,  2.12s/it] 13%|█▎        | 64/500 [02:59<34:18,  4.72s/it] 13%|█▎        | 67/500 [03:00<19:04,  2.64s/it] 14%|█▎        | 68/500 [03:08<25:47,  3.58s/it] 14%|█▍        | 70/500 [03:12<21:47,  3.04s/it] 14%|█▍        | 71/500 [03:21<30:08,  4.22s/it] 14%|█▍        | 72/500 [03:23<26:25,  3.70s/it] 15%|█▍        | 73/500 [03:29<30:45,  4.32s/it] 15%|█▍        | 74/500 [03:30<24:36,  3.47s/it] 15%|█▌        | 75/500 [03:35<26:43,  3.77s/it] 15%|█▌        | 76/500 [03:41<30:48,  4.36s/it] 16%|█▌        | 78/500 [03:47<26:50,  3.82s/it] 16%|█▌        | 79/500 [03:50<24:52,  3.55s/it] 16%|█▌        | 80/500 [03:53<24:11,  3.46s/it] 16%|█▌        | 81/500 [04:04<38:11,  5.47s/it] 17%|█▋        | 83/500 [04:06<25:30,  3.67s/it] 17%|█▋        | 84/500 [04:15<34:00,  4.90s/it] 17%|█▋        | 86/500 [04:16<21:41,  3.14s/it] 17%|█▋        | 87/500 [04:17<17:10,  2.49s/it] 18%|█▊        | 88/500 [04:24<25:09,  3.66s/it] 18%|█▊        | 91/500 [04:29<18:08,  2.66s/it] 18%|█▊        | 92/500 [04:31<17:27,  2.57s/it] 19%|█▊        | 93/500 [04:31<13:51,  2.04s/it] 19%|█▉        | 95/500 [04:49<31:29,  4.67s/it] 20%|█▉        | 99/500 [04:53<18:00,  2.70s/it] 20%|██        | 100/500 [05:28<51:48,  7.77s/it] 22%|██▏       | 110/500 [05:29<15:57,  2.45s/it] 22%|██▏       | 111/500 [05:39<20:20,  3.14s/it] 23%|██▎       | 114/500 [05:41<16:17,  2.53s/it] 23%|██▎       | 115/500 [05:45<16:46,  2.62s/it] 23%|██▎       | 116/500 [05:51<19:43,  3.08s/it] 24%|██▍       | 119/500 [05:55<15:24,  2.43s/it] 24%|██▍       | 120/500 [05:58<16:22,  2.59s/it] 24%|██▍       | 122/500 [06:13<25:29,  4.05s/it] 25%|██▍       | 124/500 [06:15<19:16,  3.08s/it] 25%|██▌       | 125/500 [06:16<17:10,  2.75s/it] 25%|██▌       | 126/500 [06:21<19:49,  3.18s/it] 25%|██▌       | 127/500 [06:28<26:06,  4.20s/it] 26%|██▌       | 131/500 [06:36<17:33,  2.85s/it] 27%|██▋       | 134/500 [06:39<13:16,  2.18s/it] 27%|██▋       | 136/500 [06:44<13:44,  2.27s/it] 27%|██▋       | 137/500 [06:56<22:50,  3.77s/it] 28%|██▊       | 141/500 [07:00<14:38,  2.45s/it] 28%|██▊       | 142/500 [07:03<15:53,  2.66s/it] 29%|██▉       | 144/500 [07:04<11:47,  1.99s/it] 29%|██▉       | 145/500 [07:14<19:25,  3.28s/it] 29%|██▉       | 146/500 [07:20<23:29,  3.98s/it] 30%|██▉       | 149/500 [07:23<15:03,  2.57s/it] 30%|███       | 150/500 [07:24<12:54,  2.21s/it] 30%|███       | 152/500 [07:35<19:05,  3.29s/it] 31%|███       | 154/500 [07:41<18:58,  3.29s/it] 31%|███       | 156/500 [07:46<16:52,  2.94s/it] 32%|███▏      | 158/500 [07:57<22:08,  3.88s/it] 32%|███▏      | 161/500 [07:58<13:27,  2.38s/it] 32%|███▏      | 162/500 [07:58<11:41,  2.08s/it] 33%|███▎      | 163/500 [08:06<17:33,  3.13s/it] 33%|███▎      | 167/500 [08:07<08:54,  1.61s/it] 34%|███▎      | 168/500 [08:14<13:57,  2.52s/it] 34%|███▍      | 171/500 [08:15<08:40,  1.58s/it] 34%|███▍      | 172/500 [08:23<14:11,  2.60s/it] 35%|███▌      | 176/500 [08:29<11:28,  2.13s/it] 35%|███▌      | 177/500 [08:32<11:50,  2.20s/it] 36%|███▌      | 178/500 [08:38<15:22,  2.86s/it] 36%|███▌      | 180/500 [08:39<11:02,  2.07s/it] 36%|███▌      | 181/500 [08:50<20:16,  3.81s/it] 37%|███▋      | 183/500 [08:58<20:31,  3.89s/it] 37%|███▋      | 185/500 [09:02<17:22,  3.31s/it] 37%|███▋      | 186/500 [09:03<14:39,  2.80s/it] 37%|███▋      | 187/500 [09:08<17:11,  3.30s/it] 38%|███▊      | 189/500 [09:11<13:22,  2.58s/it] 38%|███▊      | 190/500 [09:11<10:46,  2.09s/it] 38%|███▊      | 191/500 [09:14<11:01,  2.14s/it] 38%|███▊      | 192/500 [09:20<16:00,  3.12s/it] 39%|███▉      | 195/500 [09:33<19:41,  3.87s/it] 40%|████      | 200/500 [09:40<12:16,  2.46s/it] 40%|████      | 201/500 [09:40<10:44,  2.15s/it] 40%|████      | 202/500 [09:45<12:39,  2.55s/it] 41%|████      | 203/500 [09:46<11:39,  2.35s/it] 41%|████      | 204/500 [09:48<11:13,  2.27s/it] 41%|████      | 205/500 [09:53<13:41,  2.78s/it] 41%|████      | 206/500 [09:56<14:43,  3.01s/it] 42%|████▏     | 208/500 [10:04<16:25,  3.37s/it] 42%|████▏     | 210/500 [10:07<12:42,  2.63s/it] 42%|████▏     | 212/500 [10:13<13:22,  2.79s/it] 43%|████▎     | 213/500 [10:17<14:33,  3.04s/it] 43%|████▎     | 215/500 [10:22<13:05,  2.76s/it] 43%|████▎     | 217/500 [10:29<14:30,  3.08s/it] 44%|████▎     | 218/500 [10:33<15:23,  3.28s/it] 44%|████▍     | 220/500 [10:35<11:39,  2.50s/it] 44%|████▍     | 222/500 [10:37<09:09,  1.98s/it] 45%|████▍     | 223/500 [10:44<13:06,  2.84s/it] 45%|████▍     | 224/500 [10:49<15:46,  3.43s/it] 46%|████▌     | 228/500 [10:53<09:11,  2.03s/it] 46%|████▌     | 229/500 [10:55<09:03,  2.00s/it] 46%|████▌     | 230/500 [10:56<08:18,  1.85s/it] 46%|████▌     | 231/500 [11:15<25:02,  5.59s/it] 47%|████▋     | 235/500 [11:15<11:10,  2.53s/it] 47%|████▋     | 236/500 [11:24<15:55,  3.62s/it] 48%|████▊     | 239/500 [11:27<10:53,  2.50s/it] 48%|████▊     | 241/500 [11:31<10:18,  2.39s/it] 49%|████▊     | 243/500 [11:35<09:20,  2.18s/it] 49%|████▉     | 244/500 [11:36<08:49,  2.07s/it] 49%|████▉     | 245/500 [11:37<08:01,  1.89s/it] 49%|████▉     | 246/500 [11:38<07:12,  1.70s/it] 49%|████▉     | 247/500 [11:39<06:17,  1.49s/it] 50%|████▉     | 248/500 [12:05<32:10,  7.66s/it] 51%|█████     | 253/500 [12:18<18:20,  4.45s/it] 51%|█████     | 256/500 [12:20<12:19,  3.03s/it] 52%|█████▏    | 258/500 [12:27<13:03,  3.24s/it] 52%|█████▏    | 259/500 [12:31<13:13,  3.29s/it] 53%|█████▎    | 263/500 [12:35<08:54,  2.25s/it] 53%|█████▎    | 264/500 [12:41<11:02,  2.81s/it] 54%|█████▎    | 268/500 [12:48<08:54,  2.31s/it] 54%|█████▍    | 270/500 [12:49<07:09,  1.87s/it] 54%|█████▍    | 271/500 [12:50<06:19,  1.66s/it] 54%|█████▍    | 272/500 [12:52<06:27,  1.70s/it] 55%|█████▍    | 273/500 [13:00<11:42,  3.09s/it] 55%|█████▌    | 276/500 [13:02<07:19,  1.96s/it] 55%|█████▌    | 277/500 [13:07<09:10,  2.47s/it] 56%|█████▌    | 278/500 [13:08<07:42,  2.08s/it] 56%|█████▌    | 279/500 [18:18<4:24:11, 71.72s/it] 71%|███████▏  | 357/500 [18:26<06:46,  2.85s/it]   72%|███████▏  | 362/500 [18:27<06:02,  2.63s/it] 73%|███████▎  | 364/500 [18:34<06:01,  2.66s/it] 73%|███████▎  | 366/500 [18:43<06:10,  2.77s/it] 73%|███████▎  | 367/500 [18:46<06:07,  2.77s/it] 74%|███████▍  | 369/500 [18:49<05:50,  2.68s/it] 74%|███████▍  | 370/500 [18:50<05:25,  2.51s/it] 74%|███████▍  | 371/500 [19:03<07:27,  3.47s/it] 75%|███████▍  | 374/500 [19:04<05:23,  2.57s/it] 75%|███████▌  | 375/500 [19:15<07:37,  3.66s/it] 75%|███████▌  | 377/500 [19:47<13:43,  6.69s/it] 77%|███████▋  | 383/500 [19:55<07:40,  3.94s/it] 77%|███████▋  | 386/500 [19:55<05:30,  2.90s/it] 77%|███████▋  | 387/500 [19:56<04:58,  2.64s/it] 78%|███████▊  | 388/500 [20:09<07:37,  4.09s/it] 78%|███████▊  | 392/500 [20:19<06:02,  3.36s/it] 79%|███████▉  | 394/500 [20:32<07:23,  4.19s/it] 80%|███████▉  | 398/500 [20:36<04:53,  2.88s/it] 80%|███████▉  | 399/500 [20:39<04:46,  2.84s/it] 80%|████████  | 401/500 [20:41<03:51,  2.34s/it] 80%|████████  | 402/500 [20:52<06:08,  3.76s/it] 81%|████████  | 404/500 [20:52<04:10,  2.61s/it] 81%|████████▏ | 407/500 [21:00<04:06,  2.65s/it] 82%|████████▏ | 411/500 [21:02<02:27,  1.66s/it] 82%|████████▏ | 412/500 [21:11<03:56,  2.69s/it] 83%|████████▎ | 414/500 [21:12<02:53,  2.02s/it] 83%|████████▎ | 416/500 [21:28<05:20,  3.82s/it] 84%|████████▎ | 418/500 [21:30<03:58,  2.91s/it] 84%|████████▍ | 420/500 [21:32<03:13,  2.42s/it] 84%|████████▍ | 421/500 [21:38<04:03,  3.08s/it] 85%|████████▌ | 425/500 [21:46<03:09,  2.53s/it] 85%|████████▌ | 426/500 [21:50<03:20,  2.70s/it] 86%|████████▌ | 429/500 [21:52<02:15,  1.90s/it] 86%|████████▌ | 430/500 [21:53<02:00,  1.71s/it] 86%|████████▌ | 431/500 [21:55<02:04,  1.81s/it] 86%|████████▋ | 432/500 [21:55<01:44,  1.53s/it] 87%|████████▋ | 433/500 [21:57<01:48,  1.62s/it] 87%|████████▋ | 434/500 [22:02<02:32,  2.31s/it] 87%|████████▋ | 435/500 [22:11<04:34,  4.22s/it] 88%|████████▊ | 439/500 [22:14<02:08,  2.10s/it] 88%|████████▊ | 440/500 [22:17<02:09,  2.17s/it] 88%|████████▊ | 441/500 [22:22<02:42,  2.75s/it] 89%|████████▉ | 444/500 [22:28<02:18,  2.47s/it] 89%|████████▉ | 445/500 [22:34<02:51,  3.12s/it] 89%|████████▉ | 446/500 [22:35<02:18,  2.56s/it] 89%|████████▉ | 447/500 [22:40<02:47,  3.16s/it] 90%|████████▉ | 448/500 [22:48<03:47,  4.38s/it] 90%|████████▉ | 449/500 [22:51<03:25,  4.03s/it] 90%|█████████ | 451/500 [22:52<02:06,  2.58s/it] 90%|█████████ | 452/500 [23:00<03:03,  3.82s/it] 91%|█████████ | 454/500 [23:04<02:19,  3.04s/it] 91%|█████████ | 455/500 [23:05<02:01,  2.70s/it] 91%|█████████ | 456/500 [23:15<03:09,  4.30s/it] 91%|█████████▏| 457/500 [23:16<02:29,  3.47s/it] 92%|█████████▏| 458/500 [23:17<02:06,  3.01s/it] 92%|█████████▏| 459/500 [23:34<04:35,  6.72s/it] 93%|█████████▎| 465/500 [23:48<02:09,  3.69s/it] 93%|█████████▎| 467/500 [23:52<01:45,  3.20s/it] 94%|█████████▍| 470/500 [23:55<01:11,  2.39s/it] 94%|█████████▍| 471/500 [24:02<01:29,  3.10s/it] 94%|█████████▍| 472/500 [24:05<01:27,  3.13s/it] 95%|█████████▍| 474/500 [24:10<01:17,  2.97s/it] 95%|█████████▌| 475/500 [24:13<01:10,  2.83s/it] 95%|█████████▌| 477/500 [24:16<00:56,  2.45s/it] 96%|█████████▌| 479/500 [24:22<00:55,  2.66s/it] 96%|█████████▌| 481/500 [24:27<00:47,  2.52s/it] 97%|█████████▋| 484/500 [24:30<00:30,  1.90s/it] 97%|█████████▋| 485/500 [24:31<00:27,  1.81s/it] 97%|█████████▋| 486/500 [24:38<00:38,  2.74s/it] 98%|█████████▊| 488/500 [24:43<00:32,  2.68s/it] 98%|█████████▊| 489/500 [24:45<00:27,  2.51s/it] 98%|█████████▊| 490/500 [24:46<00:21,  2.16s/it] 98%|█████████▊| 491/500 [25:25<01:38, 10.99s/it] 99%|█████████▉| 497/500 [25:26<00:11,  3.77s/it]100%|█████████▉| 498/500 [25:32<00:08,  4.08s/it]100%|██████████| 500/500 [25:32<00:00,  3.07s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
Regenerating missing GPT-4 file for split data file: chunk_2.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 74 / 74
  0%|          | 0/74 [00:00<?, ?it/s]  1%|▏         | 1/74 [00:22<27:07, 22.29s/it]  5%|▌         | 4/74 [00:24<05:34,  4.78s/it]  7%|▋         | 5/74 [00:25<04:23,  3.82s/it]  8%|▊         | 6/74 [00:27<03:34,  3.16s/it]  9%|▉         | 7/74 [00:32<04:08,  3.71s/it] 12%|█▏        | 9/74 [00:36<03:19,  3.06s/it] 14%|█▎        | 10/74 [00:37<02:41,  2.52s/it] 16%|█▌        | 12/74 [00:40<02:09,  2.08s/it] 18%|█▊        | 13/74 [00:42<01:57,  1.93s/it] 19%|█▉        | 14/74 [00:44<02:06,  2.11s/it] 22%|██▏       | 16/74 [01:16<07:33,  7.81s/it] 31%|███       | 23/74 [01:17<02:16,  2.67s/it] 32%|███▏      | 24/74 [01:25<02:44,  3.29s/it] 36%|███▋      | 27/74 [01:28<01:55,  2.46s/it] 38%|███▊      | 28/74 [01:28<01:39,  2.17s/it] 39%|███▉      | 29/74 [01:32<01:54,  2.54s/it] 41%|████      | 30/74 [01:36<01:59,  2.73s/it] 43%|████▎     | 32/74 [01:46<02:26,  3.48s/it] 49%|████▊     | 36/74 [02:06<02:43,  4.29s/it] 57%|█████▋    | 42/74 [02:18<01:40,  3.13s/it] 62%|██████▏   | 46/74 [02:23<01:10,  2.50s/it] 65%|██████▍   | 48/74 [02:25<00:57,  2.20s/it] 66%|██████▌   | 49/74 [02:31<01:06,  2.64s/it] 69%|██████▉   | 51/74 [02:46<01:28,  3.86s/it] 76%|███████▌  | 56/74 [02:59<00:58,  3.24s/it] 81%|████████  | 60/74 [03:03<00:35,  2.50s/it] 82%|████████▏ | 61/74 [03:08<00:35,  2.71s/it] 84%|████████▍ | 62/74 [03:15<00:40,  3.38s/it] 85%|████████▌ | 63/74 [03:16<00:32,  2.97s/it] 86%|████████▋ | 64/74 [03:26<00:43,  4.34s/it] 91%|█████████ | 67/74 [03:27<00:17,  2.48s/it] 92%|█████████▏| 68/74 [03:29<00:14,  2.47s/it] 93%|█████████▎| 69/74 [03:30<00:10,  2.10s/it] 95%|█████████▍| 70/74 [03:32<00:07,  2.00s/it] 96%|█████████▌| 71/74 [03:37<00:08,  2.96s/it] 97%|█████████▋| 72/74 [03:40<00:05,  2.89s/it]100%|██████████| 74/74 [03:44<00:00,  2.39s/it]100%|██████████| 74/74 [03:44<00:00,  3.03s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 2
[INFO] end_time: 2024-09-04 20:33:00
[INFO] duration: 32 min 
[2024-09-05 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-03/2024-09-03_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-05 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_raw_log_distillation.py", line 49, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(query_ls, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py", line 177, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-03/2024-09-03_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-03
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-03/2024-09-03_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-03/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-03/2024-09-03_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-09-05 20:00:22
[INFO] duration: 0 min 
[2024-09-06 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-04/2024-09-04_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-06 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-04/2024-09-04_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-04
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-04/2024-09-04_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-04/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-04/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 352 / 352
  0%|          | 0/352 [00:00<?, ?it/s]  0%|          | 1/352 [01:19<7:46:09, 79.68s/it]  1%|▏         | 5/352 [02:05<2:05:13, 21.65s/it]  3%|▎         | 9/352 [02:50<1:30:53, 15.90s/it]  3%|▎         | 10/352 [03:12<1:36:46, 16.98s/it]  6%|▋         | 22/352 [04:21<47:37,  8.66s/it]    7%|▋         | 26/352 [05:13<53:18,  9.81s/it]  8%|▊         | 27/352 [05:23<53:02,  9.79s/it]  9%|▊         | 30/352 [07:10<1:29:46, 16.73s/it] 10%|▉         | 35/352 [07:11<54:35, 10.33s/it]   11%|█         | 38/352 [07:34<50:36,  9.67s/it] 11%|█         | 39/352 [07:53<55:13, 10.59s/it] 12%|█▏        | 42/352 [08:53<1:10:17, 13.60s/it] 12%|█▏        | 43/352 [12:44<3:35:09, 41.78s/it] 15%|█▌        | 54/352 [13:54<1:29:32, 18.03s/it] 17%|█▋        | 60/352 [14:18<1:04:18, 13.21s/it] 18%|█▊        | 64/352 [16:14<1:21:59, 17.08s/it] 20%|█▉        | 70/352 [17:39<1:15:37, 16.09s/it] 22%|██▏       | 79/352 [18:10<48:43, 10.71s/it]   23%|██▎       | 81/352 [19:25<1:02:37, 13.87s/it] 23%|██▎       | 82/352 [19:37<1:01:47, 13.73s/it] 24%|██▍       | 86/352 [25:05<2:34:37, 34.88s/it] 27%|██▋       | 96/352 [25:07<1:11:04, 16.66s/it] 28%|██▊       | 99/352 [25:54<1:09:36, 16.51s/it] 28%|██▊       | 100/352 [26:11<1:09:11, 16.47s/it] 29%|██▉       | 102/352 [27:18<1:21:58, 19.67s/it] 30%|██▉       | 104/352 [27:44<1:15:33, 18.28s/it] 31%|███       | 108/352 [28:05<54:23, 13.37s/it]   31%|███▏      | 110/352 [29:05<1:08:21, 16.95s/it] 32%|███▏      | 111/352 [29:05<59:13, 14.75s/it]   32%|███▏      | 112/352 [29:35<1:08:34, 17.14s/it] 32%|███▏      | 113/352 [30:33<1:37:50, 24.56s/it] 33%|███▎      | 117/352 [30:46<53:30, 13.66s/it]   36%|███▋      | 128/352 [31:59<33:27,  8.96s/it] 38%|███▊      | 135/352 [32:53<30:44,  8.50s/it] 41%|████      | 144/352 [34:12<29:49,  8.60s/it] 41%|████▏     | 146/352 [34:30<29:45,  8.67s/it] 42%|████▏     | 149/352 [34:59<30:04,  8.89s/it] 45%|████▍     | 157/352 [35:57<26:32,  8.17s/it] 46%|████▌     | 161/352 [37:15<34:29, 10.84s/it] 46%|████▌     | 162/352 [38:36<51:20, 16.22s/it] 48%|████▊     | 170/352 [38:49<28:32,  9.41s/it] 49%|████▊     | 171/352 [40:11<45:08, 14.96s/it] 50%|████▉     | 175/352 [40:28<34:33, 11.72s/it] 50%|█████     | 176/352 [40:58<39:39, 13.52s/it] 50%|█████     | 177/352 [42:09<1:00:07, 20.61s/it] 53%|█████▎    | 185/352 [42:36<29:15, 10.51s/it]   54%|█████▍    | 191/352 [42:44<18:48,  7.01s/it] 55%|█████▍    | 192/352 [42:46<17:23,  6.52s/it] 55%|█████▍    | 193/352 [44:28<44:37, 16.84s/it] 58%|█████▊    | 204/352 [44:29<15:32,  6.30s/it] 58%|█████▊    | 205/352 [46:08<32:37, 13.32s/it] 60%|█████▉    | 210/352 [49:43<55:57, 23.65s/it] 61%|██████    | 214/352 [52:33<1:06:47, 29.04s/it] 64%|██████▎   | 224/352 [53:03<33:56, 15.91s/it]   64%|██████▍   | 225/352 [54:23<42:49, 20.23s/it] 67%|██████▋   | 235/352 [54:48<22:30, 11.55s/it] 67%|██████▋   | 236/352 [55:40<27:21, 14.15s/it] 68%|██████▊   | 238/352 [56:25<29:23, 15.47s/it] 71%|███████   | 249/352 [57:24<16:57,  9.88s/it] 71%|███████   | 250/352 [58:07<20:34, 12.10s/it] 72%|███████▏  | 252/352 [58:14<17:54, 10.75s/it] 74%|███████▍  | 261/352 [58:16<08:10,  5.39s/it] 74%|███████▍  | 262/352 [58:16<07:33,  5.03s/it] 75%|███████▍  | 263/352 [58:19<07:07,  4.81s/it] 75%|███████▌  | 264/352 [59:55<23:13, 15.83s/it] 78%|███████▊  | 275/352 [1:00:00<07:23,  5.76s/it] 78%|███████▊  | 276/352 [1:01:29<15:32, 12.27s/it] 79%|███████▉  | 278/352 [1:01:39<13:29, 10.93s/it] 80%|████████  | 283/352 [1:01:54<08:59,  7.82s/it] 82%|████████▏ | 287/352 [1:01:56<05:57,  5.50s/it] 82%|████████▏ | 288/352 [1:01:56<05:17,  4.96s/it] 82%|████████▏ | 289/352 [1:02:03<05:31,  5.25s/it] 82%|████████▏ | 290/352 [1:02:05<04:51,  4.69s/it] 83%|████████▎ | 292/352 [1:02:13<04:36,  4.60s/it] 83%|████████▎ | 293/352 [1:03:28<16:43, 17.01s/it] 84%|████████▍ | 296/352 [1:03:42<10:53, 11.66s/it] 84%|████████▍ | 297/352 [1:07:08<41:04, 44.81s/it] 89%|████████▉ | 313/352 [1:07:11<06:03,  9.31s/it] 89%|████████▉ | 315/352 [1:07:38<06:04,  9.84s/it] 90%|████████▉ | 316/352 [1:08:31<08:00, 13.35s/it] 91%|█████████ | 320/352 [1:08:59<06:03, 11.37s/it] 93%|█████████▎| 326/352 [1:09:34<03:56,  9.11s/it] 93%|█████████▎| 327/352 [1:09:38<03:37,  8.69s/it] 93%|█████████▎| 328/352 [1:10:11<04:32, 11.34s/it] 93%|█████████▎| 329/352 [1:10:50<05:49, 15.19s/it] 94%|█████████▍| 331/352 [1:11:10<04:46, 13.63s/it] 95%|█████████▌| 336/352 [1:12:00<03:09, 11.87s/it] 97%|█████████▋| 342/352 [1:12:11<01:11,  7.18s/it]100%|█████████▉| 351/352 [1:14:05<00:09,  9.91s/it]100%|██████████| 352/352 [1:14:05<00:00, 12.63s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-06 21:16:32
[INFO] duration: 76 min 
[2024-09-07 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-05/2024-09-05_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-07 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-05/2024-09-05_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-05
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-05/2024-09-05_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-05/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-05/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 397 / 397
  0%|          | 0/397 [00:00<?, ?it/s]  0%|          | 1/397 [00:08<53:40,  8.13s/it]  1%|          | 2/397 [00:25<1:30:05, 13.68s/it]  3%|▎         | 12/397 [00:26<09:57,  1.55s/it]   3%|▎         | 13/397 [00:27<09:12,  1.44s/it]  4%|▎         | 14/397 [00:27<08:29,  1.33s/it]  4%|▍         | 15/397 [00:28<07:49,  1.23s/it]  4%|▍         | 16/397 [00:29<06:46,  1.07s/it]  4%|▍         | 17/397 [00:32<09:57,  1.57s/it]  5%|▌         | 20/397 [00:33<05:49,  1.08it/s]  5%|▌         | 21/397 [00:34<06:15,  1.00it/s]  6%|▌         | 22/397 [00:34<05:12,  1.20it/s]  6%|▌         | 23/397 [00:36<06:45,  1.08s/it]  6%|▌         | 24/397 [00:41<12:05,  1.95s/it]  7%|▋         | 27/397 [00:42<06:55,  1.12s/it]  7%|▋         | 28/397 [00:49<14:33,  2.37s/it]  7%|▋         | 29/397 [00:51<13:39,  2.23s/it]  8%|▊         | 32/397 [00:58<13:59,  2.30s/it]  9%|▉         | 36/397 [01:02<10:11,  1.69s/it]  9%|▉         | 37/397 [01:05<11:03,  1.84s/it] 10%|▉         | 39/397 [01:06<08:27,  1.42s/it] 10%|█         | 40/397 [01:16<17:40,  2.97s/it] 11%|█         | 43/397 [01:18<11:16,  1.91s/it] 11%|█▏        | 45/397 [01:21<10:30,  1.79s/it] 12%|█▏        | 46/397 [01:21<08:57,  1.53s/it] 12%|█▏        | 47/397 [01:22<08:51,  1.52s/it] 12%|█▏        | 48/397 [01:24<09:28,  1.63s/it] 12%|█▏        | 49/397 [01:26<09:16,  1.60s/it] 13%|█▎        | 51/397 [01:29<09:43,  1.69s/it] 13%|█▎        | 52/397 [01:32<11:28,  2.00s/it] 14%|█▎        | 54/397 [01:34<09:10,  1.60s/it] 14%|█▍        | 57/397 [01:35<05:46,  1.02s/it] 15%|█▍        | 58/397 [01:38<07:18,  1.29s/it] 15%|█▌        | 61/397 [01:42<06:58,  1.24s/it] 16%|█▌        | 63/397 [01:42<05:07,  1.08it/s] 16%|█▌        | 64/397 [01:45<07:30,  1.35s/it] 16%|█▋        | 65/397 [01:48<08:54,  1.61s/it] 17%|█▋        | 68/397 [01:54<09:43,  1.77s/it] 18%|█▊        | 71/397 [01:58<09:12,  1.69s/it] 19%|█▊        | 74/397 [01:59<06:12,  1.15s/it] 19%|█▉        | 75/397 [02:00<05:45,  1.07s/it] 19%|█▉        | 76/397 [02:00<05:26,  1.02s/it] 20%|█▉        | 78/397 [02:08<10:40,  2.01s/it] 20%|█▉        | 79/397 [02:09<09:38,  1.82s/it] 20%|██        | 81/397 [02:10<07:02,  1.34s/it] 21%|██        | 82/397 [02:18<13:40,  2.61s/it] 22%|██▏       | 86/397 [02:19<07:07,  1.37s/it] 22%|██▏       | 88/397 [02:22<07:18,  1.42s/it] 23%|██▎       | 91/397 [02:26<06:39,  1.31s/it] 23%|██▎       | 92/397 [02:27<06:30,  1.28s/it] 24%|██▎       | 94/397 [02:31<07:24,  1.47s/it] 24%|██▍       | 95/397 [02:33<08:14,  1.64s/it] 24%|██▍       | 97/397 [02:34<06:40,  1.33s/it] 25%|██▍       | 99/397 [02:41<09:20,  1.88s/it] 25%|██▌       | 100/397 [02:41<07:56,  1.60s/it] 25%|██▌       | 101/397 [02:42<07:13,  1.46s/it] 26%|██▌       | 102/397 [02:51<15:54,  3.24s/it] 27%|██▋       | 107/397 [02:53<06:53,  1.43s/it] 28%|██▊       | 110/397 [02:55<05:50,  1.22s/it] 28%|██▊       | 111/397 [02:56<05:17,  1.11s/it] 28%|██▊       | 112/397 [02:59<06:52,  1.45s/it] 29%|██▉       | 115/397 [03:00<04:38,  1.01it/s] 29%|██▉       | 116/397 [03:07<09:25,  2.01s/it] 30%|███       | 120/397 [03:08<05:07,  1.11s/it] 30%|███       | 121/397 [03:08<04:58,  1.08s/it] 31%|███       | 122/397 [03:09<04:19,  1.06it/s] 31%|███       | 123/397 [03:11<05:42,  1.25s/it] 31%|███▏      | 125/397 [03:14<05:52,  1.30s/it] 32%|███▏      | 126/397 [03:17<07:11,  1.59s/it] 32%|███▏      | 128/397 [03:17<04:42,  1.05s/it] 32%|███▏      | 129/397 [03:20<06:55,  1.55s/it] 33%|███▎      | 130/397 [03:26<11:26,  2.57s/it] 33%|███▎      | 132/397 [03:38<17:18,  3.92s/it] 36%|███▌      | 141/397 [03:40<05:08,  1.20s/it] 36%|███▌      | 142/397 [03:42<05:42,  1.34s/it] 36%|███▌      | 143/397 [03:49<08:44,  2.06s/it] 37%|███▋      | 146/397 [03:50<06:08,  1.47s/it] 37%|███▋      | 147/397 [03:57<09:09,  2.20s/it] 38%|███▊      | 151/397 [04:01<06:38,  1.62s/it] 38%|███▊      | 152/397 [04:02<06:32,  1.60s/it] 39%|███▉      | 154/397 [04:02<04:50,  1.20s/it] 39%|███▉      | 155/397 [04:06<06:38,  1.65s/it] 40%|███▉      | 157/397 [04:07<05:16,  1.32s/it] 40%|███▉      | 158/397 [04:09<05:15,  1.32s/it] 40%|████      | 160/397 [04:15<07:35,  1.92s/it] 41%|████      | 162/397 [04:17<06:25,  1.64s/it] 41%|████▏     | 164/397 [04:21<06:49,  1.76s/it] 42%|████▏     | 166/397 [04:35<12:50,  3.34s/it] 44%|████▎     | 173/397 [04:35<05:03,  1.36s/it] 44%|████▍     | 174/397 [04:40<06:31,  1.76s/it] 45%|████▍     | 177/397 [04:41<04:46,  1.30s/it] 45%|████▍     | 178/397 [04:43<04:44,  1.30s/it] 45%|████▌     | 179/397 [04:45<05:28,  1.51s/it] 46%|████▌     | 183/397 [04:49<04:15,  1.19s/it] 47%|████▋     | 185/397 [04:53<05:03,  1.43s/it] 47%|████▋     | 187/397 [04:54<04:17,  1.23s/it] 48%|████▊     | 189/397 [05:02<06:39,  1.92s/it] 49%|████▊     | 193/397 [05:04<04:37,  1.36s/it] 49%|████▉     | 196/397 [05:05<03:23,  1.01s/it] 50%|████▉     | 197/397 [05:05<03:04,  1.08it/s] 50%|████▉     | 198/397 [05:08<03:43,  1.12s/it] 50%|█████     | 199/397 [05:09<03:55,  1.19s/it] 50%|█████     | 200/397 [05:13<05:45,  1.75s/it] 51%|█████     | 201/397 [05:14<05:15,  1.61s/it] 51%|█████     | 203/397 [05:19<06:09,  1.90s/it] 52%|█████▏    | 205/397 [05:24<06:39,  2.08s/it] 52%|█████▏    | 207/397 [05:24<04:39,  1.47s/it] 53%|█████▎    | 209/397 [05:31<06:31,  2.08s/it] 53%|█████▎    | 210/397 [05:32<05:45,  1.85s/it] 53%|█████▎    | 212/397 [05:34<04:47,  1.55s/it] 54%|█████▍    | 214/397 [05:37<04:50,  1.59s/it] 55%|█████▍    | 217/397 [05:43<05:19,  1.78s/it] 55%|█████▌    | 220/397 [05:45<03:58,  1.35s/it] 56%|█████▌    | 222/397 [05:47<03:40,  1.26s/it] 56%|█████▌    | 223/397 [05:51<04:58,  1.71s/it] 56%|█████▋    | 224/397 [05:52<04:41,  1.63s/it] 57%|█████▋    | 226/397 [05:55<04:10,  1.47s/it] 57%|█████▋    | 227/397 [05:55<03:29,  1.23s/it] 58%|█████▊    | 229/397 [05:58<03:41,  1.32s/it] 58%|█████▊    | 230/397 [06:02<05:15,  1.89s/it] 59%|█████▉    | 234/397 [06:02<02:30,  1.08it/s] 59%|█████▉    | 235/397 [06:03<02:13,  1.21it/s] 59%|█████▉    | 236/397 [06:04<02:15,  1.19it/s] 60%|█████▉    | 237/397 [06:06<02:59,  1.12s/it] 60%|█████▉    | 238/397 [06:09<03:56,  1.48s/it] 61%|██████    | 241/397 [06:14<04:05,  1.58s/it] 61%|██████    | 243/397 [06:14<03:04,  1.20s/it] 61%|██████▏   | 244/397 [06:16<03:17,  1.29s/it] 62%|██████▏   | 245/397 [06:16<02:43,  1.08s/it] 62%|██████▏   | 246/397 [06:17<02:33,  1.01s/it] 62%|██████▏   | 247/397 [06:18<02:25,  1.03it/s] 62%|██████▏   | 248/397 [06:21<03:33,  1.43s/it] 63%|██████▎   | 249/397 [06:23<04:04,  1.65s/it] 63%|██████▎   | 251/397 [06:25<03:36,  1.49s/it] 64%|██████▎   | 253/397 [06:26<02:36,  1.08s/it] 64%|██████▍   | 254/397 [06:28<02:48,  1.18s/it] 64%|██████▍   | 255/397 [06:28<02:24,  1.02s/it] 64%|██████▍   | 256/397 [06:31<03:35,  1.53s/it] 65%|██████▍   | 257/397 [06:33<03:17,  1.41s/it] 65%|██████▌   | 259/397 [06:33<02:20,  1.02s/it] 65%|██████▌   | 260/397 [06:34<01:55,  1.18it/s] 66%|██████▌   | 261/397 [06:38<03:33,  1.57s/it] 66%|██████▌   | 262/397 [06:41<04:47,  2.13s/it] 67%|██████▋   | 266/397 [06:51<04:54,  2.25s/it] 68%|██████▊   | 269/397 [06:52<03:19,  1.56s/it] 68%|██████▊   | 271/397 [06:54<02:57,  1.41s/it] 69%|██████▊   | 272/397 [06:55<02:41,  1.29s/it] 69%|██████▉   | 274/397 [07:04<04:43,  2.31s/it] 70%|███████   | 278/397 [07:04<02:33,  1.29s/it] 70%|███████   | 279/397 [07:06<02:30,  1.28s/it] 71%|███████   | 280/397 [07:07<02:36,  1.34s/it] 71%|███████   | 281/397 [07:08<02:34,  1.33s/it] 71%|███████   | 282/397 [07:09<02:10,  1.14s/it] 71%|███████▏  | 283/397 [07:19<06:19,  3.33s/it] 73%|███████▎  | 288/397 [07:19<02:17,  1.26s/it] 73%|███████▎  | 289/397 [07:21<02:16,  1.26s/it] 73%|███████▎  | 290/397 [07:27<03:57,  2.22s/it] 73%|███████▎  | 291/397 [07:31<04:32,  2.57s/it] 74%|███████▍  | 295/397 [07:36<03:07,  1.84s/it] 75%|███████▍  | 297/397 [07:38<02:42,  1.63s/it] 76%|███████▌  | 300/397 [07:47<03:21,  2.08s/it] 76%|███████▋  | 303/397 [07:54<03:24,  2.18s/it] 78%|███████▊  | 308/397 [07:58<02:17,  1.54s/it] 78%|███████▊  | 311/397 [08:08<02:58,  2.07s/it] 79%|███████▉  | 315/397 [08:19<03:07,  2.29s/it] 81%|████████  | 322/397 [08:26<02:07,  1.70s/it] 81%|████████▏ | 323/397 [08:26<01:57,  1.59s/it] 82%|████████▏ | 325/397 [08:32<02:11,  1.83s/it] 83%|████████▎ | 328/397 [08:40<02:23,  2.08s/it] 83%|████████▎ | 331/397 [08:40<01:37,  1.48s/it] 84%|████████▎ | 332/397 [08:42<01:37,  1.50s/it] 84%|████████▍ | 333/397 [08:44<01:40,  1.57s/it] 84%|████████▍ | 335/397 [08:44<01:13,  1.18s/it] 85%|████████▍ | 336/397 [08:46<01:14,  1.22s/it] 85%|████████▍ | 337/397 [08:47<01:09,  1.15s/it] 85%|████████▌ | 338/397 [08:51<01:44,  1.77s/it] 85%|████████▌ | 339/397 [08:51<01:25,  1.48s/it] 86%|████████▌ | 340/397 [08:58<02:36,  2.75s/it] 87%|████████▋ | 345/397 [09:00<01:04,  1.24s/it] 87%|████████▋ | 346/397 [09:02<01:12,  1.42s/it] 88%|████████▊ | 348/397 [09:02<00:50,  1.03s/it] 88%|████████▊ | 349/397 [09:06<01:15,  1.57s/it] 89%|████████▉ | 354/397 [09:10<00:48,  1.14s/it] 90%|████████▉ | 357/397 [09:14<00:46,  1.16s/it] 90%|█████████ | 358/397 [09:16<00:49,  1.27s/it] 91%|█████████ | 360/397 [09:18<00:42,  1.15s/it] 91%|█████████ | 361/397 [09:24<01:14,  2.07s/it] 91%|█████████ | 362/397 [09:25<01:05,  1.86s/it] 92%|█████████▏| 364/397 [09:26<00:42,  1.29s/it] 92%|█████████▏| 366/397 [09:28<00:35,  1.15s/it] 92%|█████████▏| 367/397 [09:36<01:13,  2.45s/it] 93%|█████████▎| 369/397 [09:36<00:44,  1.60s/it] 93%|█████████▎| 370/397 [09:38<00:49,  1.82s/it] 93%|█████████▎| 371/397 [09:39<00:43,  1.66s/it] 94%|█████████▎| 372/397 [09:43<00:51,  2.06s/it] 94%|█████████▍| 373/397 [09:46<00:56,  2.34s/it] 95%|█████████▍| 376/397 [09:46<00:24,  1.16s/it] 95%|█████████▍| 377/397 [09:52<00:39,  2.00s/it] 96%|█████████▌| 380/397 [09:53<00:21,  1.26s/it] 96%|█████████▌| 381/397 [09:54<00:19,  1.20s/it] 96%|█████████▌| 382/397 [09:56<00:20,  1.34s/it] 96%|█████████▋| 383/397 [09:57<00:19,  1.38s/it] 97%|█████████▋| 384/397 [10:05<00:39,  3.02s/it] 97%|█████████▋| 387/397 [10:07<00:17,  1.77s/it] 98%|█████████▊| 389/397 [10:07<00:09,  1.21s/it] 98%|█████████▊| 390/397 [10:11<00:12,  1.80s/it] 98%|█████████▊| 391/397 [10:16<00:14,  2.38s/it] 99%|█████████▉| 394/397 [10:18<00:04,  1.56s/it]100%|█████████▉| 396/397 [10:19<00:01,  1.19s/it]100%|██████████| 397/397 [10:20<00:00,  1.26s/it]100%|██████████| 397/397 [10:20<00:00,  1.56s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-07 20:12:51
[INFO] duration: 12 min 
[2024-09-08 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-06/2024-09-06_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-08 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-06/2024-09-06_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-06
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-06/2024-09-06_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-06/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-06/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 411 / 411
  0%|          | 0/411 [00:00<?, ?it/s]  0%|          | 1/411 [00:08<58:24,  8.55s/it]  0%|          | 2/411 [00:22<1:21:35, 11.97s/it]  2%|▏         | 10/411 [00:34<19:07,  2.86s/it]   4%|▍         | 17/411 [00:42<12:34,  1.92s/it]  5%|▌         | 21/411 [00:43<09:09,  1.41s/it]  5%|▌         | 22/411 [00:44<09:02,  1.40s/it]  6%|▌         | 23/411 [00:44<08:20,  1.29s/it]  6%|▌         | 24/411 [00:47<09:54,  1.54s/it]  7%|▋         | 27/411 [00:52<09:45,  1.52s/it]  7%|▋         | 30/411 [00:58<10:26,  1.64s/it]  8%|▊         | 34/411 [01:02<08:57,  1.42s/it]  9%|▊         | 35/411 [01:02<07:53,  1.26s/it]  9%|▉         | 36/411 [01:03<07:30,  1.20s/it]  9%|▉         | 37/411 [01:09<12:35,  2.02s/it]  9%|▉         | 38/411 [01:09<10:48,  1.74s/it] 10%|▉         | 40/411 [01:17<15:08,  2.45s/it] 11%|█         | 46/411 [01:22<09:09,  1.51s/it] 12%|█▏        | 50/411 [01:24<06:44,  1.12s/it] 12%|█▏        | 51/411 [01:30<10:19,  1.72s/it] 13%|█▎        | 52/411 [01:34<11:46,  1.97s/it] 13%|█▎        | 54/411 [01:35<09:38,  1.62s/it] 13%|█▎        | 55/411 [01:47<19:34,  3.30s/it] 14%|█▎        | 56/411 [01:47<16:24,  2.77s/it] 15%|█▍        | 61/411 [01:50<08:30,  1.46s/it] 15%|█▌        | 62/411 [01:53<09:53,  1.70s/it] 16%|█▌        | 64/411 [01:54<07:38,  1.32s/it] 16%|█▌        | 65/411 [01:54<06:40,  1.16s/it] 16%|█▌        | 66/411 [01:58<09:23,  1.63s/it] 17%|█▋        | 69/411 [02:01<07:40,  1.35s/it] 17%|█▋        | 70/411 [02:01<06:44,  1.19s/it] 17%|█▋        | 71/411 [02:03<07:24,  1.31s/it] 18%|█▊        | 72/411 [02:08<11:59,  2.12s/it] 19%|█▊        | 77/411 [02:08<04:49,  1.15it/s] 19%|█▉        | 78/411 [02:11<06:08,  1.11s/it] 19%|█▉        | 79/411 [02:12<06:21,  1.15s/it] 19%|█▉        | 80/411 [02:13<06:00,  1.09s/it] 20%|█▉        | 82/411 [02:18<09:01,  1.65s/it] 20%|██        | 83/411 [02:20<08:49,  1.62s/it] 21%|██        | 86/411 [02:25<09:05,  1.68s/it] 22%|██▏       | 89/411 [02:26<06:23,  1.19s/it] 22%|██▏       | 92/411 [02:27<04:10,  1.27it/s] 23%|██▎       | 93/411 [02:28<04:40,  1.13it/s] 23%|██▎       | 94/411 [02:29<04:21,  1.21it/s] 23%|██▎       | 95/411 [02:31<05:29,  1.04s/it] 23%|██▎       | 96/411 [02:33<07:39,  1.46s/it] 24%|██▍       | 99/411 [02:35<05:10,  1.00it/s] 24%|██▍       | 100/411 [02:37<06:17,  1.22s/it] 25%|██▌       | 103/411 [02:39<04:38,  1.10it/s] 25%|██▌       | 104/411 [02:43<07:20,  1.43s/it] 26%|██▌       | 107/411 [02:45<05:57,  1.18s/it] 26%|██▋       | 108/411 [02:48<07:38,  1.51s/it] 27%|██▋       | 109/411 [02:53<10:20,  2.06s/it] 27%|██▋       | 112/411 [02:55<07:29,  1.50s/it] 27%|██▋       | 113/411 [02:56<06:56,  1.40s/it] 28%|██▊       | 114/411 [03:02<11:50,  2.39s/it] 29%|██▉       | 119/411 [03:05<06:06,  1.26s/it] 29%|██▉       | 121/411 [03:06<05:02,  1.04s/it] 30%|██▉       | 122/411 [03:13<10:05,  2.09s/it] 31%|███       | 126/411 [03:15<05:53,  1.24s/it] 31%|███       | 127/411 [03:16<06:05,  1.29s/it] 31%|███       | 128/411 [03:28<14:47,  3.14s/it] 33%|███▎      | 134/411 [03:32<07:42,  1.67s/it] 33%|███▎      | 136/411 [03:34<07:00,  1.53s/it] 34%|███▎      | 138/411 [03:35<05:42,  1.26s/it] 34%|███▍      | 139/411 [03:36<05:18,  1.17s/it] 34%|███▍      | 140/411 [03:40<07:49,  1.73s/it] 35%|███▍      | 143/411 [03:44<06:54,  1.55s/it] 35%|███▌      | 145/411 [03:52<10:00,  2.26s/it] 37%|███▋      | 152/411 [03:55<05:11,  1.20s/it] 37%|███▋      | 154/411 [03:58<05:11,  1.21s/it] 38%|███▊      | 155/411 [03:59<05:01,  1.18s/it] 38%|███▊      | 156/411 [04:00<04:49,  1.14s/it] 38%|███▊      | 157/411 [04:06<08:31,  2.01s/it] 39%|███▊      | 159/411 [04:20<15:22,  3.66s/it] 40%|███▉      | 163/411 [04:21<08:29,  2.05s/it] 40%|████      | 166/411 [04:30<09:46,  2.39s/it] 41%|████▏     | 170/411 [04:31<06:07,  1.52s/it] 42%|████▏     | 171/411 [04:32<05:51,  1.47s/it] 42%|████▏     | 172/411 [04:40<09:45,  2.45s/it] 43%|████▎     | 178/411 [04:41<04:26,  1.14s/it] 44%|████▎     | 179/411 [04:42<04:23,  1.14s/it] 44%|████▍     | 180/411 [04:42<03:59,  1.04s/it] 44%|████▍     | 181/411 [04:45<04:36,  1.20s/it] 44%|████▍     | 182/411 [04:48<06:21,  1.67s/it] 45%|████▌     | 185/411 [05:04<12:20,  3.28s/it] 47%|████▋     | 192/411 [05:11<07:08,  1.96s/it] 48%|████▊     | 197/411 [05:32<10:03,  2.82s/it] 48%|████▊     | 198/411 [05:49<14:42,  4.14s/it] 50%|████▉     | 205/411 [05:52<07:57,  2.32s/it] 50%|█████     | 207/411 [05:53<06:48,  2.00s/it] 51%|█████     | 208/411 [05:56<07:20,  2.17s/it] 51%|█████     | 210/411 [06:03<08:08,  2.43s/it] 52%|█████▏    | 214/411 [06:13<07:59,  2.43s/it] 54%|█████▎    | 220/411 [06:16<04:57,  1.56s/it] 54%|█████▍    | 223/411 [06:17<04:01,  1.29s/it] 55%|█████▍    | 224/411 [06:19<04:14,  1.36s/it] 55%|█████▍    | 225/411 [06:21<04:22,  1.41s/it] 55%|█████▍    | 226/411 [06:22<04:19,  1.40s/it] 55%|█████▌    | 227/411 [06:27<06:24,  2.09s/it] 56%|█████▌    | 230/411 [06:29<04:24,  1.46s/it] 56%|█████▌    | 231/411 [06:32<04:40,  1.56s/it] 57%|█████▋    | 234/411 [06:35<04:02,  1.37s/it] 57%|█████▋    | 236/411 [06:36<03:30,  1.20s/it] 58%|█████▊    | 238/411 [06:43<05:13,  1.81s/it] 59%|█████▉    | 243/411 [06:43<02:32,  1.10it/s] 59%|█████▉    | 244/411 [06:44<02:29,  1.12it/s] 60%|█████▉    | 245/411 [06:46<02:52,  1.04s/it] 60%|█████▉    | 246/411 [06:47<02:47,  1.01s/it] 60%|██████    | 248/411 [06:52<04:17,  1.58s/it] 61%|██████▏   | 252/411 [06:52<02:13,  1.19it/s] 62%|██████▏   | 253/411 [06:53<02:16,  1.16it/s] 62%|██████▏   | 254/411 [06:58<03:54,  1.49s/it] 63%|██████▎   | 257/411 [07:04<04:28,  1.74s/it] 64%|██████▎   | 261/411 [07:06<02:49,  1.13s/it] 64%|██████▎   | 262/411 [07:10<03:58,  1.60s/it] 64%|██████▍   | 264/411 [07:11<03:02,  1.24s/it] 65%|██████▍   | 266/411 [07:12<02:35,  1.07s/it] 65%|██████▍   | 267/411 [07:13<02:24,  1.00s/it] 65%|██████▌   | 268/411 [07:16<03:20,  1.40s/it] 66%|██████▌   | 270/411 [07:18<02:58,  1.26s/it] 66%|██████▌   | 272/411 [07:19<02:29,  1.07s/it] 66%|██████▋   | 273/411 [07:21<02:53,  1.26s/it] 67%|██████▋   | 274/411 [07:25<04:20,  1.90s/it] 67%|██████▋   | 276/411 [07:31<05:04,  2.25s/it] 68%|██████▊   | 281/411 [07:36<03:20,  1.54s/it] 69%|██████▉   | 283/411 [07:57<08:01,  3.76s/it] 72%|███████▏  | 295/411 [07:59<02:32,  1.31s/it] 72%|███████▏  | 296/411 [08:00<02:24,  1.26s/it] 72%|███████▏  | 297/411 [08:03<02:42,  1.42s/it] 73%|███████▎  | 298/411 [08:05<02:47,  1.48s/it] 73%|███████▎  | 300/411 [08:08<02:51,  1.54s/it] 73%|███████▎  | 302/411 [08:23<05:38,  3.10s/it] 74%|███████▍  | 306/411 [08:24<03:22,  1.93s/it] 75%|███████▍  | 307/411 [08:29<04:01,  2.32s/it] 75%|███████▌  | 310/411 [08:30<02:38,  1.57s/it] 76%|███████▌  | 311/411 [08:35<03:24,  2.04s/it] 76%|███████▌  | 313/411 [08:37<02:54,  1.78s/it] 76%|███████▋  | 314/411 [08:42<03:39,  2.26s/it] 77%|███████▋  | 318/411 [08:45<02:29,  1.61s/it] 78%|███████▊  | 321/411 [08:47<01:46,  1.19s/it] 79%|███████▊  | 323/411 [08:48<01:34,  1.07s/it] 79%|███████▉  | 324/411 [08:54<02:31,  1.74s/it] 80%|███████▉  | 327/411 [08:59<02:33,  1.82s/it] 80%|███████▉  | 328/411 [09:00<02:11,  1.59s/it] 80%|████████  | 330/411 [09:02<01:52,  1.39s/it] 81%|████████  | 332/411 [09:08<02:30,  1.90s/it] 82%|████████▏ | 335/411 [09:11<02:00,  1.58s/it] 82%|████████▏ | 338/411 [09:12<01:23,  1.14s/it] 83%|████████▎ | 340/411 [09:17<01:43,  1.46s/it] 83%|████████▎ | 343/411 [09:17<01:07,  1.00it/s] 84%|████████▎ | 344/411 [09:19<01:13,  1.10s/it] 84%|████████▍ | 345/411 [09:22<01:37,  1.48s/it] 84%|████████▍ | 346/411 [09:27<02:13,  2.05s/it] 85%|████████▍ | 348/411 [09:29<01:42,  1.63s/it] 85%|████████▍ | 349/411 [09:33<02:12,  2.14s/it] 86%|████████▌ | 352/411 [09:41<02:23,  2.43s/it] 87%|████████▋ | 358/411 [09:42<00:59,  1.11s/it] 87%|████████▋ | 359/411 [09:42<00:54,  1.05s/it] 88%|████████▊ | 360/411 [09:46<01:10,  1.39s/it] 88%|████████▊ | 361/411 [09:48<01:14,  1.50s/it] 88%|████████▊ | 362/411 [09:56<02:15,  2.76s/it] 89%|████████▉ | 366/411 [09:56<00:59,  1.31s/it] 90%|████████▉ | 368/411 [09:59<01:02,  1.45s/it] 90%|████████▉ | 369/411 [10:09<01:54,  2.74s/it] 91%|█████████ | 375/411 [10:11<00:47,  1.32s/it] 91%|█████████▏| 376/411 [10:13<00:50,  1.44s/it] 92%|█████████▏| 378/411 [10:20<01:04,  1.96s/it] 92%|█████████▏| 380/411 [10:23<00:59,  1.91s/it] 93%|█████████▎| 384/411 [10:24<00:31,  1.18s/it] 94%|█████████▎| 385/411 [10:26<00:34,  1.33s/it] 94%|█████████▍| 388/411 [10:33<00:38,  1.66s/it] 95%|█████████▌| 391/411 [10:45<00:48,  2.43s/it] 97%|█████████▋| 397/411 [10:52<00:25,  1.81s/it] 97%|█████████▋| 399/411 [10:57<00:23,  1.92s/it] 98%|█████████▊| 401/411 [11:01<00:19,  1.97s/it] 98%|█████████▊| 404/411 [11:01<00:09,  1.36s/it] 99%|█████████▊| 405/411 [11:03<00:08,  1.39s/it] 99%|█████████▉| 406/411 [11:06<00:08,  1.68s/it] 99%|█████████▉| 407/411 [11:07<00:06,  1.59s/it]100%|█████████▉| 410/411 [11:10<00:01,  1.31s/it]100%|██████████| 411/411 [11:12<00:00,  1.46s/it]100%|██████████| 411/411 [11:12<00:00,  1.64s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-08 20:13:41
[INFO] duration: 13 min 
[2024-09-09 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-07/2024-09-07_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-09 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-07/2024-09-07_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-07
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-07/2024-09-07_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-07/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-07/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 385 / 385
  0%|          | 0/385 [00:00<?, ?it/s]  0%|          | 1/385 [00:07<45:26,  7.10s/it]  1%|          | 2/385 [00:07<19:12,  3.01s/it]  1%|          | 3/385 [00:08<13:50,  2.17s/it]  1%|          | 4/385 [00:08<09:04,  1.43s/it]  2%|▏         | 6/385 [00:11<08:57,  1.42s/it]  2%|▏         | 8/385 [00:13<08:07,  1.29s/it]  3%|▎         | 10/385 [00:14<05:18,  1.18it/s]  3%|▎         | 11/385 [00:15<05:59,  1.04it/s]  3%|▎         | 13/385 [00:16<04:26,  1.40it/s]  4%|▎         | 14/385 [00:16<03:41,  1.67it/s]  4%|▍         | 15/385 [00:17<04:54,  1.26it/s]  4%|▍         | 16/385 [00:17<04:00,  1.54it/s]  4%|▍         | 17/385 [00:18<03:09,  1.94it/s]  5%|▍         | 18/385 [00:22<10:34,  1.73s/it]  6%|▌         | 22/385 [00:23<04:12,  1.44it/s]  6%|▌         | 24/385 [00:26<06:03,  1.01s/it]  6%|▋         | 25/385 [00:28<06:37,  1.11s/it]  7%|▋         | 26/385 [00:29<07:13,  1.21s/it]  7%|▋         | 27/385 [00:30<06:57,  1.17s/it]  7%|▋         | 28/385 [00:33<09:14,  1.55s/it]  8%|▊         | 29/385 [00:35<09:17,  1.56s/it]  8%|▊         | 32/385 [00:38<07:39,  1.30s/it]  9%|▉         | 34/385 [00:38<05:15,  1.11it/s]  9%|▉         | 35/385 [00:39<05:28,  1.07it/s]  9%|▉         | 36/385 [00:42<08:10,  1.41s/it] 10%|█         | 39/385 [00:46<07:22,  1.28s/it] 10%|█         | 40/385 [00:47<06:58,  1.21s/it] 11%|█         | 43/385 [00:48<05:24,  1.05it/s] 11%|█▏        | 44/385 [00:49<04:35,  1.24it/s] 12%|█▏        | 45/385 [00:49<03:52,  1.46it/s] 12%|█▏        | 46/385 [00:53<08:20,  1.48s/it] 12%|█▏        | 47/385 [00:54<07:31,  1.34s/it] 13%|█▎        | 49/385 [00:54<05:06,  1.09it/s] 13%|█▎        | 50/385 [00:56<05:29,  1.02it/s] 13%|█▎        | 51/385 [00:57<05:41,  1.02s/it] 14%|█▎        | 52/385 [00:58<05:30,  1.01it/s] 14%|█▍        | 53/385 [01:00<08:08,  1.47s/it] 14%|█▍        | 55/385 [01:01<05:35,  1.02s/it] 15%|█▍        | 56/385 [01:03<06:59,  1.28s/it] 15%|█▍        | 57/385 [01:04<06:03,  1.11s/it] 15%|█▌        | 58/385 [01:06<07:41,  1.41s/it] 16%|█▌        | 60/385 [01:07<04:42,  1.15it/s] 16%|█▌        | 61/385 [01:08<04:44,  1.14it/s] 16%|█▌        | 62/385 [01:08<04:45,  1.13it/s] 16%|█▋        | 63/385 [01:09<03:42,  1.45it/s] 17%|█▋        | 64/385 [01:13<08:53,  1.66s/it] 17%|█▋        | 67/385 [01:13<04:26,  1.20it/s] 18%|█▊        | 68/385 [01:14<04:25,  1.20it/s] 18%|█▊        | 69/385 [01:15<04:18,  1.22it/s] 18%|█▊        | 70/385 [01:17<06:01,  1.15s/it] 19%|█▊        | 72/385 [01:19<05:26,  1.04s/it] 19%|█▉        | 75/385 [01:21<04:39,  1.11it/s] 20%|██        | 77/385 [01:21<03:22,  1.52it/s] 20%|██        | 78/385 [01:23<04:33,  1.12it/s] 21%|██        | 80/385 [01:24<03:51,  1.32it/s] 21%|██        | 81/385 [01:25<03:56,  1.29it/s] 21%|██▏       | 82/385 [01:26<04:21,  1.16it/s] 22%|██▏       | 83/385 [01:28<05:25,  1.08s/it] 22%|██▏       | 84/385 [01:29<05:49,  1.16s/it] 22%|██▏       | 85/385 [01:30<05:32,  1.11s/it] 23%|██▎       | 87/385 [01:32<04:23,  1.13it/s] 23%|██▎       | 88/385 [01:33<05:05,  1.03s/it] 23%|██▎       | 90/385 [01:35<05:20,  1.09s/it] 24%|██▎       | 91/385 [01:36<04:48,  1.02it/s] 24%|██▍       | 93/385 [01:37<03:38,  1.33it/s] 24%|██▍       | 94/385 [01:38<04:28,  1.08it/s] 25%|██▍       | 95/385 [01:39<03:47,  1.28it/s] 25%|██▍       | 96/385 [01:41<05:24,  1.12s/it] 25%|██▌       | 97/385 [01:43<07:22,  1.54s/it] 26%|██▌       | 99/385 [01:46<06:31,  1.37s/it] 26%|██▌       | 101/385 [01:46<04:08,  1.14it/s] 26%|██▋       | 102/385 [01:48<04:58,  1.05s/it] 27%|██▋       | 104/385 [01:48<03:19,  1.41it/s] 27%|██▋       | 105/385 [01:49<04:10,  1.12it/s] 28%|██▊       | 106/385 [01:51<04:24,  1.06it/s] 28%|██▊       | 108/385 [01:53<04:45,  1.03s/it] 29%|██▉       | 111/385 [01:53<02:51,  1.60it/s] 29%|██▉       | 112/385 [01:54<02:46,  1.64it/s] 29%|██▉       | 113/385 [01:56<04:03,  1.12it/s] 30%|██▉       | 115/385 [01:57<03:13,  1.39it/s] 30%|███       | 116/385 [01:58<03:44,  1.20it/s] 30%|███       | 117/385 [01:59<03:32,  1.26it/s] 31%|███       | 118/385 [02:00<03:53,  1.14it/s] 31%|███       | 120/385 [02:00<02:37,  1.68it/s] 31%|███▏      | 121/385 [02:02<03:26,  1.28it/s] 32%|███▏      | 122/385 [02:02<02:47,  1.57it/s] 32%|███▏      | 124/385 [02:04<03:23,  1.28it/s] 33%|███▎      | 127/385 [02:05<02:47,  1.54it/s] 33%|███▎      | 128/385 [02:06<02:38,  1.62it/s] 34%|███▍      | 130/385 [02:09<04:16,  1.01s/it] 35%|███▍      | 134/385 [02:10<02:29,  1.68it/s] 35%|███▌      | 135/385 [02:11<02:48,  1.49it/s] 35%|███▌      | 136/385 [02:14<04:17,  1.03s/it] 36%|███▌      | 137/385 [02:14<04:01,  1.03it/s] 36%|███▋      | 140/385 [02:16<02:52,  1.42it/s] 37%|███▋      | 141/385 [02:17<03:08,  1.30it/s] 37%|███▋      | 143/385 [02:19<03:38,  1.11it/s] 37%|███▋      | 144/385 [02:21<04:10,  1.04s/it] 38%|███▊      | 146/385 [02:21<02:53,  1.37it/s] 38%|███▊      | 147/385 [02:22<02:58,  1.33it/s] 38%|███▊      | 148/385 [02:26<05:35,  1.42s/it] 39%|███▉      | 150/385 [02:28<05:33,  1.42s/it] 40%|███▉      | 153/385 [02:32<05:11,  1.34s/it] 41%|████      | 156/385 [02:34<04:15,  1.12s/it] 41%|████      | 157/385 [02:35<03:53,  1.02s/it] 41%|████      | 158/385 [02:35<03:31,  1.08it/s] 41%|████▏     | 159/385 [02:37<04:16,  1.14s/it] 42%|████▏     | 162/385 [02:39<03:19,  1.12it/s] 42%|████▏     | 163/385 [02:40<03:19,  1.11it/s] 43%|████▎     | 164/385 [02:40<02:42,  1.36it/s] 43%|████▎     | 165/385 [02:42<03:37,  1.01it/s] 43%|████▎     | 166/385 [02:44<04:01,  1.10s/it] 43%|████▎     | 167/385 [02:45<04:09,  1.15s/it] 44%|████▍     | 169/385 [02:46<03:14,  1.11it/s] 44%|████▍     | 170/385 [02:48<04:09,  1.16s/it] 44%|████▍     | 171/385 [02:49<03:48,  1.07s/it] 45%|████▍     | 173/385 [02:51<04:08,  1.17s/it] 45%|████▌     | 175/385 [02:52<02:41,  1.30it/s] 46%|████▌     | 176/385 [02:54<04:07,  1.18s/it] 46%|████▋     | 179/385 [02:56<03:06,  1.10it/s] 47%|████▋     | 180/385 [02:59<04:00,  1.17s/it] 47%|████▋     | 182/385 [02:59<02:46,  1.22it/s] 48%|████▊     | 183/385 [03:01<03:49,  1.13s/it] 48%|████▊     | 185/385 [03:03<03:16,  1.02it/s] 48%|████▊     | 186/385 [03:04<03:27,  1.04s/it] 49%|████▊     | 187/385 [03:05<03:26,  1.04s/it] 49%|████▉     | 188/385 [03:06<03:18,  1.01s/it] 49%|████▉     | 189/385 [03:07<03:07,  1.04it/s] 49%|████▉     | 190/385 [03:08<03:15,  1.00s/it] 50%|████▉     | 192/385 [03:09<02:41,  1.20it/s] 50%|█████     | 193/385 [03:10<02:26,  1.31it/s] 50%|█████     | 194/385 [03:10<02:27,  1.30it/s] 51%|█████     | 195/385 [03:11<02:13,  1.42it/s] 51%|█████     | 196/385 [03:16<05:35,  1.78s/it] 52%|█████▏    | 199/385 [03:16<02:40,  1.16it/s] 52%|█████▏    | 200/385 [03:17<02:40,  1.15it/s] 52%|█████▏    | 201/385 [03:18<02:57,  1.04it/s] 52%|█████▏    | 202/385 [03:19<02:47,  1.10it/s] 53%|█████▎    | 203/385 [03:19<02:26,  1.24it/s] 53%|█████▎    | 204/385 [03:19<01:54,  1.58it/s] 53%|█████▎    | 205/385 [03:21<03:02,  1.01s/it] 54%|█████▎    | 206/385 [03:22<02:32,  1.17it/s] 54%|█████▍    | 207/385 [03:22<01:54,  1.55it/s] 54%|█████▍    | 208/385 [03:25<03:44,  1.27s/it] 54%|█████▍    | 209/385 [03:26<03:34,  1.22s/it] 55%|█████▍    | 211/385 [03:28<03:34,  1.23s/it] 56%|█████▌    | 214/385 [03:30<02:19,  1.22it/s] 56%|█████▌    | 215/385 [03:32<03:08,  1.11s/it] 57%|█████▋    | 218/385 [03:33<02:00,  1.38it/s] 57%|█████▋    | 219/385 [03:34<02:26,  1.13it/s] 57%|█████▋    | 220/385 [03:36<02:47,  1.01s/it] 58%|█████▊    | 222/385 [03:38<02:47,  1.03s/it] 58%|█████▊    | 225/385 [03:40<02:10,  1.23it/s] 59%|█████▊    | 226/385 [03:40<01:59,  1.33it/s] 59%|█████▉    | 228/385 [03:43<02:42,  1.04s/it] 59%|█████▉    | 229/385 [03:43<02:16,  1.15it/s] 60%|█████▉    | 230/385 [03:44<02:09,  1.20it/s] 60%|██████    | 231/385 [03:46<03:04,  1.20s/it] 61%|██████    | 234/385 [03:49<02:31,  1.01s/it] 61%|██████▏   | 236/385 [03:51<02:25,  1.03it/s] 62%|██████▏   | 238/385 [03:52<02:04,  1.18it/s] 62%|██████▏   | 240/385 [03:52<01:32,  1.57it/s] 63%|██████▎   | 241/385 [03:53<01:48,  1.33it/s] 63%|██████▎   | 242/385 [03:54<01:45,  1.35it/s] 63%|██████▎   | 244/385 [03:57<02:08,  1.10it/s] 64%|██████▍   | 246/385 [03:58<01:46,  1.30it/s] 64%|██████▍   | 248/385 [03:58<01:18,  1.75it/s] 65%|██████▍   | 249/385 [04:01<02:17,  1.01s/it] 65%|██████▍   | 250/385 [04:02<02:20,  1.04s/it] 65%|██████▌   | 251/385 [04:02<01:57,  1.14it/s] 65%|██████▌   | 252/385 [04:03<01:43,  1.28it/s] 66%|██████▌   | 253/385 [04:06<02:55,  1.33s/it] 66%|██████▋   | 256/385 [04:07<01:49,  1.17it/s] 67%|██████▋   | 257/385 [04:07<01:31,  1.40it/s] 67%|██████▋   | 258/385 [04:11<03:06,  1.47s/it] 68%|██████▊   | 263/385 [04:15<02:10,  1.07s/it] 69%|██████▉   | 266/385 [04:16<01:28,  1.34it/s] 69%|██████▉   | 267/385 [04:17<01:34,  1.24it/s] 70%|██████▉   | 268/385 [04:18<01:41,  1.15it/s] 70%|██████▉   | 269/385 [04:20<02:11,  1.13s/it] 71%|███████   | 273/385 [04:22<01:19,  1.41it/s] 71%|███████▏  | 275/385 [04:23<01:21,  1.35it/s] 72%|███████▏  | 276/385 [04:24<01:15,  1.44it/s] 72%|███████▏  | 277/385 [04:24<01:04,  1.68it/s] 72%|███████▏  | 278/385 [04:25<01:07,  1.59it/s] 72%|███████▏  | 279/385 [04:26<01:37,  1.09it/s] 73%|███████▎  | 281/385 [04:27<01:12,  1.44it/s] 73%|███████▎  | 282/385 [04:27<01:00,  1.71it/s] 74%|███████▎  | 283/385 [04:30<02:02,  1.20s/it] 74%|███████▍  | 284/385 [04:31<01:34,  1.07it/s] 74%|███████▍  | 285/385 [04:31<01:11,  1.40it/s] 74%|███████▍  | 286/385 [04:35<02:54,  1.76s/it] 75%|███████▌  | 289/385 [04:35<01:20,  1.19it/s] 75%|███████▌  | 290/385 [04:39<02:03,  1.30s/it] 76%|███████▌  | 293/385 [04:40<01:19,  1.16it/s] 76%|███████▋  | 294/385 [04:41<01:21,  1.11it/s] 77%|███████▋  | 296/385 [04:41<01:01,  1.44it/s] 77%|███████▋  | 297/385 [04:43<01:27,  1.01it/s] 78%|███████▊  | 299/385 [04:45<01:12,  1.19it/s] 78%|███████▊  | 300/385 [04:46<01:17,  1.10it/s] 78%|███████▊  | 301/385 [04:47<01:25,  1.02s/it] 79%|███████▊  | 303/385 [04:50<01:30,  1.10s/it] 79%|███████▉  | 306/385 [04:52<01:10,  1.12it/s] 80%|████████  | 309/385 [04:54<01:01,  1.23it/s] 81%|████████  | 310/385 [04:56<01:21,  1.08s/it] 81%|████████▏ | 313/385 [04:57<00:55,  1.30it/s] 82%|████████▏ | 315/385 [05:02<01:27,  1.24s/it] 83%|████████▎ | 319/385 [05:04<00:59,  1.10it/s] 83%|████████▎ | 321/385 [05:06<01:00,  1.06it/s] 84%|████████▎ | 322/385 [05:08<01:04,  1.03s/it] 84%|████████▍ | 324/385 [05:11<01:12,  1.19s/it] 85%|████████▌ | 328/385 [05:13<00:48,  1.19it/s] 86%|████████▌ | 331/385 [05:15<00:45,  1.20it/s] 86%|████████▋ | 333/385 [05:16<00:40,  1.27it/s] 87%|████████▋ | 334/385 [05:17<00:41,  1.22it/s] 87%|████████▋ | 335/385 [05:18<00:38,  1.30it/s] 87%|████████▋ | 336/385 [05:21<01:00,  1.24s/it] 88%|████████▊ | 339/385 [05:22<00:39,  1.16it/s] 89%|████████▊ | 341/385 [05:24<00:39,  1.11it/s] 89%|████████▉ | 343/385 [05:25<00:28,  1.46it/s] 89%|████████▉ | 344/385 [05:26<00:32,  1.25it/s] 90%|████████▉ | 345/385 [05:27<00:32,  1.24it/s] 90%|████████▉ | 346/385 [05:28<00:36,  1.07it/s] 90%|█████████ | 347/385 [05:29<00:30,  1.23it/s] 90%|█████████ | 348/385 [05:29<00:23,  1.54it/s] 91%|█████████ | 349/385 [05:31<00:36,  1.01s/it] 91%|█████████ | 351/385 [05:32<00:28,  1.20it/s] 92%|█████████▏| 353/385 [05:32<00:19,  1.60it/s] 92%|█████████▏| 354/385 [05:34<00:26,  1.17it/s] 92%|█████████▏| 355/385 [05:35<00:28,  1.04it/s] 93%|█████████▎| 357/385 [05:36<00:20,  1.37it/s] 93%|█████████▎| 358/385 [05:37<00:17,  1.52it/s] 93%|█████████▎| 359/385 [05:43<00:54,  2.09s/it] 94%|█████████▍| 363/385 [05:44<00:21,  1.03it/s] 95%|█████████▍| 365/385 [05:45<00:16,  1.18it/s] 95%|█████████▌| 366/385 [05:46<00:17,  1.12it/s] 96%|█████████▌| 368/385 [05:49<00:17,  1.00s/it] 96%|█████████▌| 369/385 [05:49<00:13,  1.17it/s] 96%|█████████▌| 370/385 [05:49<00:10,  1.42it/s] 96%|█████████▋| 371/385 [05:51<00:13,  1.02it/s] 97%|█████████▋| 372/385 [05:53<00:15,  1.17s/it] 97%|█████████▋| 375/385 [05:53<00:06,  1.45it/s] 98%|█████████▊| 376/385 [05:57<00:10,  1.22s/it] 98%|█████████▊| 379/385 [05:58<00:04,  1.24it/s] 99%|█████████▉| 381/385 [05:59<00:03,  1.31it/s] 99%|█████████▉| 382/385 [06:00<00:02,  1.18it/s]100%|█████████▉| 384/385 [06:02<00:00,  1.15it/s]100%|██████████| 385/385 [06:02<00:00,  1.06it/s]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-09 20:08:30
[INFO] duration: 8 min 
[2024-09-10 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-08/2024-09-08_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-10 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-08/2024-09-08_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-08
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-08/2024-09-08_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-08/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-08/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 320 / 320
  0%|          | 0/320 [00:00<?, ?it/s]  0%|          | 1/320 [00:07<42:18,  7.96s/it]  1%|▏         | 4/320 [00:10<11:38,  2.21s/it]  2%|▏         | 6/320 [00:10<06:55,  1.32s/it]  2%|▏         | 7/320 [00:12<07:16,  1.39s/it]  2%|▎         | 8/320 [00:13<07:05,  1.36s/it]  3%|▎         | 10/320 [00:15<06:00,  1.16s/it]  4%|▍         | 13/320 [00:18<05:37,  1.10s/it]  5%|▌         | 16/320 [00:19<03:52,  1.31it/s]  5%|▌         | 17/320 [00:20<03:55,  1.29it/s]  6%|▌         | 18/320 [00:20<03:29,  1.44it/s]  6%|▌         | 19/320 [00:21<03:55,  1.28it/s]  6%|▋         | 20/320 [00:22<03:21,  1.49it/s]  7%|▋         | 21/320 [00:23<03:41,  1.35it/s]  7%|▋         | 22/320 [00:26<06:57,  1.40s/it]  8%|▊         | 25/320 [00:26<03:48,  1.29it/s]  8%|▊         | 26/320 [00:28<04:05,  1.20it/s]  8%|▊         | 27/320 [00:28<03:39,  1.34it/s]  9%|▉         | 28/320 [00:30<04:35,  1.06it/s]  9%|▉         | 29/320 [00:30<04:16,  1.13it/s]  9%|▉         | 30/320 [00:31<03:59,  1.21it/s] 10%|▉         | 31/320 [00:31<03:38,  1.33it/s] 10%|█         | 32/320 [00:33<04:13,  1.14it/s] 10%|█         | 33/320 [00:33<03:08,  1.52it/s] 11%|█         | 34/320 [00:37<08:14,  1.73s/it] 12%|█▏        | 38/320 [00:38<03:42,  1.27it/s] 12%|█▏        | 39/320 [00:40<04:39,  1.01it/s] 13%|█▎        | 41/320 [00:42<04:33,  1.02it/s] 13%|█▎        | 43/320 [00:43<04:09,  1.11it/s] 14%|█▍        | 44/320 [00:44<03:52,  1.19it/s] 14%|█▍        | 45/320 [00:47<06:11,  1.35s/it] 15%|█▌        | 48/320 [00:49<04:28,  1.01it/s] 15%|█▌        | 49/320 [00:50<04:18,  1.05it/s] 16%|█▌        | 51/320 [00:51<03:55,  1.14it/s] 16%|█▋        | 52/320 [00:52<04:09,  1.07it/s] 17%|█▋        | 54/320 [00:53<03:24,  1.30it/s] 18%|█▊        | 56/320 [00:54<03:03,  1.44it/s] 18%|█▊        | 57/320 [00:55<03:05,  1.42it/s] 18%|█▊        | 59/320 [00:57<03:27,  1.26it/s] 19%|█▉        | 60/320 [00:58<04:01,  1.08it/s] 19%|█▉        | 62/320 [01:00<03:51,  1.12it/s] 20%|█▉        | 63/320 [01:02<04:44,  1.11s/it] 21%|██        | 66/320 [01:03<03:02,  1.39it/s] 21%|██        | 67/320 [01:04<03:08,  1.34it/s] 21%|██▏       | 68/320 [01:04<02:59,  1.41it/s] 22%|██▏       | 69/320 [01:06<03:27,  1.21it/s] 22%|██▏       | 70/320 [01:07<03:37,  1.15it/s] 22%|██▎       | 72/320 [01:08<03:01,  1.37it/s] 23%|██▎       | 73/320 [01:10<04:34,  1.11s/it] 24%|██▍       | 76/320 [01:12<03:28,  1.17it/s] 24%|██▍       | 77/320 [01:12<03:12,  1.26it/s] 25%|██▍       | 79/320 [01:16<04:19,  1.08s/it] 26%|██▌       | 82/320 [01:16<02:44,  1.45it/s] 26%|██▌       | 83/320 [01:17<02:34,  1.53it/s] 26%|██▋       | 84/320 [01:17<02:13,  1.77it/s] 27%|██▋       | 85/320 [01:18<02:27,  1.59it/s] 27%|██▋       | 86/320 [01:19<03:09,  1.23it/s] 28%|██▊       | 88/320 [01:19<02:09,  1.80it/s] 28%|██▊       | 89/320 [01:22<03:56,  1.03s/it] 28%|██▊       | 91/320 [01:23<02:54,  1.31it/s] 29%|██▉       | 92/320 [01:24<03:10,  1.19it/s] 29%|██▉       | 93/320 [01:27<05:40,  1.50s/it] 30%|██▉       | 95/320 [01:28<03:46,  1.01s/it] 30%|███       | 96/320 [01:29<03:50,  1.03s/it] 30%|███       | 97/320 [01:30<03:41,  1.00it/s] 31%|███       | 98/320 [01:33<05:16,  1.43s/it] 31%|███       | 99/320 [01:33<04:12,  1.14s/it] 31%|███▏      | 100/320 [01:34<04:17,  1.17s/it] 32%|███▏      | 102/320 [01:36<03:33,  1.02it/s] 32%|███▏      | 103/320 [01:36<03:02,  1.19it/s] 32%|███▎      | 104/320 [01:37<02:44,  1.31it/s] 33%|███▎      | 105/320 [01:38<03:23,  1.05it/s] 33%|███▎      | 106/320 [01:39<03:18,  1.08it/s] 33%|███▎      | 107/320 [01:42<05:02,  1.42s/it] 34%|███▍      | 109/320 [01:42<03:00,  1.17it/s] 34%|███▍      | 110/320 [01:43<03:29,  1.00it/s] 35%|███▍      | 111/320 [01:44<03:07,  1.12it/s] 35%|███▌      | 112/320 [01:45<02:42,  1.28it/s] 35%|███▌      | 113/320 [01:50<07:01,  2.04s/it] 36%|███▋      | 116/320 [01:51<03:39,  1.08s/it] 37%|███▋      | 117/320 [01:51<03:00,  1.13it/s] 37%|███▋      | 118/320 [01:53<03:49,  1.14s/it] 38%|███▊      | 120/320 [01:53<02:27,  1.35it/s] 38%|███▊      | 121/320 [01:57<04:26,  1.34s/it] 39%|███▉      | 124/320 [01:59<03:39,  1.12s/it] 40%|███▉      | 127/320 [02:02<03:21,  1.05s/it] 40%|████      | 128/320 [02:05<04:12,  1.32s/it] 41%|████      | 130/320 [02:05<03:00,  1.05it/s] 41%|████      | 131/320 [02:07<03:32,  1.12s/it] 42%|████▏     | 134/320 [02:09<02:40,  1.16it/s] 42%|████▎     | 136/320 [02:11<03:05,  1.01s/it] 43%|████▎     | 139/320 [02:12<02:19,  1.30it/s] 44%|████▍     | 141/320 [02:14<02:06,  1.41it/s] 44%|████▍     | 142/320 [02:14<01:57,  1.52it/s] 45%|████▍     | 143/320 [02:15<02:24,  1.23it/s] 45%|████▌     | 144/320 [02:16<02:29,  1.18it/s] 45%|████▌     | 145/320 [02:17<02:08,  1.36it/s] 46%|████▌     | 146/320 [02:19<03:12,  1.11s/it] 46%|████▋     | 148/320 [02:20<02:38,  1.08it/s] 47%|████▋     | 150/320 [02:20<01:41,  1.67it/s] 47%|████▋     | 151/320 [02:22<02:14,  1.25it/s] 48%|████▊     | 152/320 [02:22<01:57,  1.43it/s] 48%|████▊     | 154/320 [02:24<02:06,  1.32it/s] 48%|████▊     | 155/320 [02:25<02:27,  1.12it/s] 49%|████▉     | 156/320 [02:27<02:36,  1.05it/s] 49%|████▉     | 157/320 [02:27<02:18,  1.18it/s] 49%|████▉     | 158/320 [02:27<01:57,  1.38it/s] 50%|████▉     | 159/320 [02:30<02:58,  1.11s/it] 50%|█████     | 160/320 [02:30<02:46,  1.04s/it] 51%|█████     | 162/320 [02:32<02:14,  1.18it/s] 51%|█████     | 163/320 [02:32<01:50,  1.42it/s] 51%|█████▏    | 164/320 [02:32<01:39,  1.57it/s] 52%|█████▏    | 165/320 [02:34<02:33,  1.01it/s] 52%|█████▎    | 168/320 [02:36<01:59,  1.27it/s] 53%|█████▎    | 169/320 [02:37<02:13,  1.13it/s] 53%|█████▎    | 171/320 [02:38<01:35,  1.56it/s] 54%|█████▍    | 172/320 [02:38<01:27,  1.69it/s] 54%|█████▍    | 173/320 [02:42<03:02,  1.24s/it] 54%|█████▍    | 174/320 [02:42<02:29,  1.02s/it] 55%|█████▍    | 175/320 [02:43<02:08,  1.13it/s] 55%|█████▌    | 176/320 [02:44<02:21,  1.02it/s] 55%|█████▌    | 177/320 [02:44<01:48,  1.31it/s] 56%|█████▌    | 178/320 [02:45<01:49,  1.29it/s] 56%|█████▌    | 179/320 [02:46<02:26,  1.04s/it] 57%|█████▋    | 181/320 [02:47<01:41,  1.37it/s] 57%|█████▋    | 182/320 [02:48<01:44,  1.33it/s] 57%|█████▋    | 183/320 [02:49<01:37,  1.40it/s] 57%|█████▊    | 184/320 [02:50<01:48,  1.26it/s] 58%|█████▊    | 185/320 [02:50<01:47,  1.26it/s] 58%|█████▊    | 186/320 [02:52<02:25,  1.09s/it] 58%|█████▊    | 187/320 [02:53<02:21,  1.06s/it] 59%|█████▉    | 189/320 [02:55<02:05,  1.05it/s] 60%|█████▉    | 191/320 [02:55<01:29,  1.45it/s] 60%|██████    | 192/320 [02:56<01:32,  1.39it/s] 60%|██████    | 193/320 [03:00<02:57,  1.40s/it] 61%|██████▏   | 196/320 [03:01<01:41,  1.23it/s] 62%|██████▏   | 197/320 [03:01<01:31,  1.34it/s] 62%|██████▏   | 198/320 [03:03<02:03,  1.01s/it] 62%|██████▏   | 199/320 [03:04<02:13,  1.10s/it] 63%|██████▎   | 201/320 [03:05<01:41,  1.18it/s] 63%|██████▎   | 202/320 [03:06<01:38,  1.20it/s] 63%|██████▎   | 203/320 [03:07<01:37,  1.19it/s] 64%|██████▍   | 204/320 [03:09<02:18,  1.19s/it] 64%|██████▍   | 206/320 [03:11<01:52,  1.01it/s] 65%|██████▍   | 207/320 [03:14<02:47,  1.48s/it] 66%|██████▌   | 211/320 [03:14<01:18,  1.38it/s] 66%|██████▋   | 212/320 [03:15<01:09,  1.55it/s] 67%|██████▋   | 213/320 [03:16<01:34,  1.13it/s] 67%|██████▋   | 215/320 [03:19<01:38,  1.06it/s] 68%|██████▊   | 216/320 [03:19<01:23,  1.25it/s] 68%|██████▊   | 217/320 [03:20<01:40,  1.03it/s] 68%|██████▊   | 218/320 [03:21<01:19,  1.28it/s] 68%|██████▊   | 219/320 [04:51<40:16, 23.92s/it] 90%|████████▉ | 287/320 [04:54<00:31,  1.05it/s] 90%|█████████ | 289/320 [04:54<00:28,  1.09it/s] 91%|█████████ | 291/320 [04:56<00:27,  1.07it/s] 92%|█████████▏| 293/320 [04:59<00:25,  1.05it/s] 92%|█████████▏| 295/320 [04:59<00:22,  1.13it/s] 92%|█████████▎| 296/320 [04:59<00:20,  1.18it/s] 93%|█████████▎| 297/320 [05:01<00:20,  1.11it/s] 93%|█████████▎| 298/320 [05:03<00:23,  1.07s/it] 94%|█████████▍| 301/320 [05:04<00:16,  1.17it/s] 94%|█████████▍| 302/320 [05:05<00:15,  1.17it/s] 95%|█████████▍| 303/320 [05:06<00:13,  1.29it/s] 95%|█████████▌| 304/320 [05:08<00:18,  1.14s/it] 96%|█████████▌| 306/320 [05:09<00:10,  1.28it/s] 96%|█████████▌| 307/320 [05:10<00:10,  1.23it/s] 96%|█████████▋| 308/320 [05:13<00:16,  1.36s/it] 97%|█████████▋| 310/320 [05:13<00:09,  1.11it/s] 97%|█████████▋| 311/320 [05:15<00:10,  1.12s/it] 98%|█████████▊| 314/320 [05:19<00:07,  1.18s/it] 99%|█████████▉| 317/320 [05:19<00:02,  1.37it/s] 99%|█████████▉| 318/320 [05:19<00:01,  1.49it/s]100%|█████████▉| 319/320 [05:21<00:00,  1.34it/s]100%|██████████| 320/320 [05:21<00:00,  1.55it/s]100%|██████████| 320/320 [05:21<00:00,  1.00s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-10 20:07:50
[INFO] duration: 7 min 
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh: line 7: cd: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/: No such file or directory
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh: line 8: common/periodical_job_template.sh: No such file or directory
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh: line 10: common/common_scripts.sh: No such file or directory
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh: line 25: PrintLog: command not found
[INFO] begin_time: 2024-09-11 20:00:02
python: can't open file '/root/get_raw_log_distillation.py': [Errno 2] No such file or directory
[INFO] end_time: 2024-09-11 20:00:02
[INFO] duration: 0 min 
[2024-09-12 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-10/2024-09-10_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-12 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-10/2024-09-10_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-10
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-10/2024-09-10_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-10/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-10/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 300 / 300
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:08<44:31,  8.93s/it]  1%|▏         | 4/300 [00:10<10:47,  2.19s/it]  2%|▏         | 5/300 [00:11<08:43,  1.77s/it]  2%|▏         | 7/300 [00:14<07:35,  1.55s/it]  3%|▎         | 9/300 [00:14<05:30,  1.13s/it]  3%|▎         | 10/300 [00:16<05:32,  1.15s/it]  4%|▎         | 11/300 [00:17<05:39,  1.18s/it]  4%|▍         | 12/300 [00:17<04:44,  1.01it/s]  4%|▍         | 13/300 [00:18<04:14,  1.13it/s]  5%|▍         | 14/300 [00:20<06:13,  1.31s/it]  6%|▌         | 17/300 [00:26<07:23,  1.57s/it]  7%|▋         | 21/300 [00:27<04:36,  1.01it/s]  7%|▋         | 22/300 [00:29<04:39,  1.00s/it]  8%|▊         | 23/300 [00:29<04:06,  1.12it/s]  8%|▊         | 24/300 [00:29<03:35,  1.28it/s]  8%|▊         | 25/300 [00:31<04:58,  1.08s/it]  9%|▉         | 28/300 [00:34<04:11,  1.08it/s] 10%|▉         | 29/300 [00:39<08:20,  1.85s/it] 11%|█         | 33/300 [00:41<04:34,  1.03s/it] 12%|█▏        | 35/300 [00:42<04:23,  1.00it/s] 12%|█▏        | 36/300 [00:44<04:33,  1.04s/it] 12%|█▏        | 37/300 [00:45<04:26,  1.01s/it] 13%|█▎        | 39/300 [00:46<03:52,  1.12it/s] 13%|█▎        | 40/300 [00:46<03:18,  1.31it/s] 14%|█▎        | 41/300 [00:56<12:01,  2.78s/it] 16%|█▌        | 48/300 [00:57<04:02,  1.04it/s] 16%|█▋        | 49/300 [00:57<03:41,  1.13it/s] 17%|█▋        | 50/300 [00:58<03:25,  1.21it/s] 17%|█▋        | 51/300 [01:01<04:51,  1.17s/it] 18%|█▊        | 53/300 [01:02<03:59,  1.03it/s] 18%|█▊        | 55/300 [01:04<04:13,  1.03s/it] 19%|█▉        | 58/300 [01:06<03:28,  1.16it/s] 20%|█▉        | 59/300 [01:07<03:20,  1.20it/s] 20%|██        | 60/300 [01:08<03:27,  1.16it/s] 20%|██        | 61/300 [01:08<02:56,  1.36it/s] 21%|██        | 62/300 [01:10<04:21,  1.10s/it] 21%|██        | 63/300 [01:11<04:28,  1.13s/it] 22%|██▏       | 65/300 [01:11<02:40,  1.46it/s] 22%|██▏       | 66/300 [01:13<03:15,  1.19it/s] 22%|██▏       | 67/300 [01:14<03:59,  1.03s/it] 23%|██▎       | 69/300 [01:15<02:40,  1.44it/s] 23%|██▎       | 70/300 [01:16<02:50,  1.35it/s] 24%|██▎       | 71/300 [01:16<02:21,  1.62it/s] 24%|██▍       | 72/300 [01:16<02:04,  1.83it/s] 24%|██▍       | 73/300 [01:18<03:36,  1.05it/s] 25%|██▍       | 74/300 [01:19<03:06,  1.21it/s] 25%|██▌       | 76/300 [01:23<05:08,  1.38s/it] 26%|██▋       | 79/300 [01:26<04:08,  1.12s/it] 27%|██▋       | 81/300 [01:28<04:19,  1.19s/it] 28%|██▊       | 84/300 [01:28<02:39,  1.36it/s] 28%|██▊       | 85/300 [01:33<05:03,  1.41s/it] 30%|██▉       | 89/300 [01:34<02:57,  1.19it/s] 30%|███       | 90/300 [01:36<03:26,  1.02it/s] 30%|███       | 91/300 [01:38<04:08,  1.19s/it] 31%|███▏      | 94/300 [01:39<02:54,  1.18it/s] 32%|███▏      | 95/300 [01:41<03:09,  1.08it/s] 32%|███▏      | 97/300 [01:43<03:37,  1.07s/it] 33%|███▎      | 98/300 [01:44<03:10,  1.06it/s] 33%|███▎      | 100/300 [01:45<02:36,  1.28it/s] 34%|███▎      | 101/300 [01:47<03:18,  1.01it/s] 34%|███▍      | 102/300 [01:48<03:39,  1.11s/it] 34%|███▍      | 103/300 [01:49<03:08,  1.05it/s] 35%|███▍      | 104/300 [01:49<02:31,  1.29it/s] 35%|███▌      | 105/300 [01:52<04:40,  1.44s/it] 35%|███▌      | 106/300 [01:53<03:54,  1.21s/it] 36%|███▌      | 108/300 [01:54<03:12,  1.00s/it] 36%|███▋      | 109/300 [01:55<02:37,  1.21it/s] 37%|███▋      | 110/300 [01:56<03:03,  1.03it/s] 37%|███▋      | 111/300 [01:56<02:43,  1.16it/s] 38%|███▊      | 113/300 [02:02<05:17,  1.70s/it] 39%|███▉      | 118/300 [02:08<04:20,  1.43s/it] 40%|████      | 121/300 [02:11<03:36,  1.21s/it] 41%|████      | 122/300 [02:11<03:11,  1.08s/it] 41%|████▏     | 124/300 [02:13<03:03,  1.04s/it] 42%|████▏     | 126/300 [02:14<02:35,  1.12it/s] 42%|████▏     | 127/300 [02:15<02:28,  1.17it/s] 43%|████▎     | 128/300 [02:16<02:28,  1.16it/s] 43%|████▎     | 129/300 [02:17<02:58,  1.05s/it] 44%|████▎     | 131/300 [02:19<02:46,  1.02it/s] 44%|████▍     | 132/300 [02:20<02:36,  1.07it/s] 45%|████▍     | 134/300 [02:22<02:57,  1.07s/it] 45%|████▌     | 135/300 [02:23<02:26,  1.13it/s] 45%|████▌     | 136/300 [02:25<03:19,  1.22s/it] 46%|████▌     | 137/300 [02:25<02:43,  1.00s/it] 46%|████▌     | 138/300 [02:26<02:18,  1.17it/s] 46%|████▋     | 139/300 [02:30<04:58,  1.86s/it] 47%|████▋     | 142/300 [02:32<03:11,  1.21s/it] 48%|████▊     | 144/300 [02:33<02:16,  1.14it/s] 48%|████▊     | 145/300 [02:34<02:38,  1.02s/it] 49%|████▊     | 146/300 [02:34<02:12,  1.16it/s] 49%|████▉     | 148/300 [02:36<01:57,  1.29it/s] 50%|████▉     | 149/300 [02:37<02:04,  1.21it/s] 50%|█████     | 150/300 [02:38<02:13,  1.12it/s] 51%|█████     | 152/300 [02:39<02:03,  1.20it/s] 51%|█████     | 153/300 [02:43<03:44,  1.53s/it] 52%|█████▏    | 157/300 [02:45<02:19,  1.02it/s] 53%|█████▎    | 158/300 [02:46<02:09,  1.10it/s] 53%|█████▎    | 159/300 [02:47<02:06,  1.11it/s] 53%|█████▎    | 160/300 [02:49<02:54,  1.24s/it] 54%|█████▍    | 162/300 [02:53<03:15,  1.41s/it] 55%|█████▍    | 164/300 [02:54<02:39,  1.18s/it] 55%|█████▌    | 166/300 [02:54<01:47,  1.25it/s] 56%|█████▌    | 167/300 [02:56<02:07,  1.04it/s] 56%|█████▌    | 168/300 [02:57<02:02,  1.08it/s] 56%|█████▋    | 169/300 [02:58<02:10,  1.00it/s] 57%|█████▋    | 170/300 [03:01<03:30,  1.62s/it] 58%|█████▊    | 174/300 [03:03<01:45,  1.20it/s] 58%|█████▊    | 175/300 [03:03<01:29,  1.40it/s] 59%|█████▊    | 176/300 [03:05<02:00,  1.03it/s] 60%|█████▉    | 179/300 [03:07<01:48,  1.12it/s] 61%|██████    | 182/300 [03:09<01:26,  1.36it/s] 61%|██████    | 183/300 [03:09<01:21,  1.44it/s] 61%|██████▏   | 184/300 [03:10<01:30,  1.29it/s] 62%|██████▏   | 186/300 [03:12<01:30,  1.26it/s] 62%|██████▏   | 187/300 [03:15<02:11,  1.16s/it] 63%|██████▎   | 190/300 [03:16<01:32,  1.20it/s] 64%|██████▍   | 192/300 [03:17<01:14,  1.46it/s] 64%|██████▍   | 193/300 [03:18<01:16,  1.39it/s] 65%|██████▍   | 194/300 [03:18<01:13,  1.44it/s] 65%|██████▌   | 195/300 [03:19<01:13,  1.43it/s] 65%|██████▌   | 196/300 [03:21<01:58,  1.14s/it] 66%|██████▋   | 199/300 [03:22<01:04,  1.56it/s] 67%|██████▋   | 200/300 [03:22<01:02,  1.60it/s] 67%|██████▋   | 201/300 [03:24<01:24,  1.17it/s] 67%|██████▋   | 202/300 [03:24<01:08,  1.44it/s] 68%|██████▊   | 203/300 [03:25<01:10,  1.37it/s] 68%|██████▊   | 204/300 [03:29<02:23,  1.50s/it] 69%|██████▊   | 206/300 [03:31<02:04,  1.32s/it] 70%|██████▉   | 209/300 [03:32<01:21,  1.12it/s] 70%|███████   | 210/300 [03:32<01:07,  1.32it/s] 70%|███████   | 211/300 [03:33<01:07,  1.32it/s] 71%|███████   | 212/300 [03:35<01:23,  1.05it/s] 71%|███████▏  | 214/300 [03:36<01:12,  1.19it/s] 72%|███████▏  | 216/300 [03:36<00:50,  1.66it/s] 72%|███████▏  | 217/300 [03:39<01:30,  1.09s/it] 73%|███████▎  | 220/300 [03:40<00:55,  1.44it/s] 74%|███████▍  | 222/300 [03:44<01:21,  1.04s/it] 75%|███████▌  | 225/300 [03:45<00:55,  1.34it/s] 75%|███████▌  | 226/300 [03:45<00:55,  1.34it/s] 76%|███████▌  | 227/300 [03:46<00:57,  1.26it/s] 76%|███████▌  | 228/300 [03:48<01:08,  1.05it/s] 77%|███████▋  | 230/300 [03:49<00:57,  1.22it/s] 77%|███████▋  | 231/300 [03:51<01:08,  1.01it/s] 78%|███████▊  | 233/300 [03:53<01:03,  1.05it/s] 78%|███████▊  | 234/300 [03:53<00:54,  1.21it/s] 79%|███████▊  | 236/300 [03:55<01:03,  1.01it/s] 79%|███████▉  | 238/300 [03:56<00:49,  1.26it/s] 80%|███████▉  | 239/300 [03:56<00:40,  1.50it/s] 80%|████████  | 240/300 [03:57<00:43,  1.38it/s] 80%|████████  | 241/300 [03:59<00:52,  1.13it/s] 81%|████████  | 242/300 [03:59<00:40,  1.42it/s] 81%|████████  | 243/300 [04:00<00:42,  1.35it/s] 81%|████████▏ | 244/300 [04:03<01:23,  1.49s/it] 82%|████████▏ | 246/300 [04:05<01:02,  1.15s/it] 83%|████████▎ | 248/300 [04:05<00:38,  1.34it/s] 83%|████████▎ | 249/300 [04:06<00:45,  1.12it/s] 83%|████████▎ | 250/300 [04:07<00:46,  1.08it/s] 84%|████████▍ | 252/300 [04:08<00:32,  1.46it/s] 84%|████████▍ | 253/300 [04:09<00:33,  1.41it/s] 85%|████████▌ | 255/300 [04:10<00:31,  1.41it/s] 85%|████████▌ | 256/300 [04:10<00:27,  1.63it/s] 86%|████████▌ | 257/300 [04:11<00:29,  1.47it/s] 86%|████████▌ | 258/300 [04:14<00:51,  1.23s/it] 87%|████████▋ | 260/300 [04:14<00:30,  1.30it/s] 87%|████████▋ | 262/300 [04:15<00:25,  1.49it/s] 88%|████████▊ | 263/300 [04:18<00:42,  1.14s/it] 89%|████████▊ | 266/300 [04:22<00:40,  1.18s/it] 89%|████████▉ | 268/300 [04:22<00:27,  1.16it/s] 90%|████████▉ | 269/300 [04:23<00:23,  1.30it/s] 90%|█████████ | 270/300 [04:26<00:35,  1.19s/it] 91%|█████████ | 273/300 [04:26<00:20,  1.34it/s] 91%|█████████▏| 274/300 [04:30<00:32,  1.24s/it] 92%|█████████▏| 277/300 [04:30<00:17,  1.28it/s] 93%|█████████▎| 278/300 [04:31<00:17,  1.29it/s] 93%|█████████▎| 279/300 [04:32<00:15,  1.34it/s] 93%|█████████▎| 280/300 [04:33<00:17,  1.14it/s] 94%|█████████▎| 281/300 [04:34<00:17,  1.12it/s] 94%|█████████▍| 283/300 [04:35<00:12,  1.40it/s] 95%|█████████▍| 284/300 [04:35<00:10,  1.59it/s] 95%|█████████▌| 285/300 [04:37<00:15,  1.02s/it] 96%|█████████▌| 287/300 [04:38<00:08,  1.54it/s] 96%|█████████▌| 288/300 [04:39<00:09,  1.30it/s] 96%|█████████▋| 289/300 [04:39<00:07,  1.44it/s] 97%|█████████▋| 290/300 [04:40<00:07,  1.25it/s] 97%|█████████▋| 291/300 [04:42<00:09,  1.00s/it] 98%|█████████▊| 293/300 [04:43<00:05,  1.25it/s] 98%|█████████▊| 294/300 [04:45<00:07,  1.19s/it] 99%|█████████▉| 297/300 [04:47<00:02,  1.19it/s] 99%|█████████▉| 298/300 [04:48<00:01,  1.18it/s]100%|█████████▉| 299/300 [04:49<00:00,  1.13it/s]100%|██████████| 300/300 [04:50<00:00,  1.01it/s]100%|██████████| 300/300 [04:50<00:00,  1.03it/s]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-12 20:07:20
[INFO] duration: 7 min 
[2024-09-13 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-11/2024-09-11_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-13 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-11/2024-09-11_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-11
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-11/2024-09-11_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-11/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-11/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 332 / 332
  0%|          | 0/332 [00:00<?, ?it/s]  0%|          | 1/332 [00:07<41:40,  7.56s/it]  1%|          | 2/332 [00:10<26:54,  4.89s/it]  1%|          | 4/332 [00:11<11:27,  2.10s/it]  2%|▏         | 6/332 [00:13<08:16,  1.52s/it]  2%|▏         | 8/332 [00:14<06:32,  1.21s/it]  3%|▎         | 10/332 [00:15<05:02,  1.06it/s]  3%|▎         | 11/332 [00:16<05:03,  1.06it/s]  4%|▎         | 12/332 [00:16<04:02,  1.32it/s]  4%|▍         | 13/332 [00:17<04:02,  1.32it/s]  4%|▍         | 14/332 [00:18<04:34,  1.16it/s]  5%|▍         | 15/332 [00:21<06:43,  1.27s/it]  5%|▌         | 17/332 [00:22<05:48,  1.11s/it]  6%|▌         | 19/332 [00:23<04:33,  1.14it/s]  6%|▌         | 20/332 [00:26<06:13,  1.20s/it]  7%|▋         | 23/332 [00:26<03:42,  1.39it/s]  7%|▋         | 24/332 [00:28<05:04,  1.01it/s]  8%|▊         | 26/332 [00:29<03:45,  1.36it/s]  8%|▊         | 27/332 [00:30<03:34,  1.42it/s]  8%|▊         | 28/332 [00:33<07:07,  1.41s/it]  9%|▉         | 31/332 [00:36<05:48,  1.16s/it] 10%|▉         | 33/332 [00:37<04:54,  1.01it/s] 10%|█         | 34/332 [00:38<04:51,  1.02it/s] 11%|█         | 35/332 [00:40<05:33,  1.12s/it] 11%|█         | 37/332 [00:41<04:29,  1.10it/s] 11%|█▏        | 38/332 [00:43<05:42,  1.16s/it] 12%|█▏        | 39/332 [00:44<04:48,  1.01it/s] 12%|█▏        | 40/332 [00:45<04:55,  1.01s/it] 12%|█▏        | 41/332 [00:48<07:46,  1.60s/it] 13%|█▎        | 44/332 [00:51<06:04,  1.27s/it] 14%|█▍        | 47/332 [00:53<04:59,  1.05s/it] 15%|█▍        | 49/332 [00:55<04:51,  1.03s/it] 15%|█▌        | 51/332 [00:59<06:05,  1.30s/it] 16%|█▋        | 54/332 [01:01<04:58,  1.07s/it] 17%|█▋        | 55/332 [01:02<05:05,  1.10s/it] 17%|█▋        | 57/332 [01:03<03:37,  1.26it/s] 17%|█▋        | 58/332 [01:04<04:25,  1.03it/s] 18%|█▊        | 59/332 [01:05<04:20,  1.05it/s] 18%|█▊        | 60/332 [01:05<03:32,  1.28it/s] 18%|█▊        | 61/332 [01:08<05:34,  1.23s/it] 19%|█▊        | 62/332 [01:10<06:08,  1.37s/it] 20%|█▉        | 65/332 [01:10<03:23,  1.31it/s] 20%|█▉        | 66/332 [01:11<03:17,  1.35it/s] 20%|██        | 67/332 [01:13<04:04,  1.09it/s] 20%|██        | 68/332 [01:14<03:57,  1.11it/s] 21%|██        | 69/332 [01:14<03:16,  1.34it/s] 21%|██        | 70/332 [01:15<03:50,  1.14it/s] 22%|██▏       | 72/332 [01:18<04:42,  1.09s/it] 23%|██▎       | 75/332 [01:20<04:12,  1.02it/s] 23%|██▎       | 77/332 [01:20<02:56,  1.45it/s] 23%|██▎       | 78/332 [01:23<04:32,  1.07s/it] 24%|██▍       | 79/332 [01:24<04:18,  1.02s/it] 24%|██▍       | 80/332 [01:25<03:51,  1.09it/s] 24%|██▍       | 81/332 [01:29<07:49,  1.87s/it] 26%|██▌       | 85/332 [01:30<03:18,  1.25it/s] 26%|██▌       | 86/332 [01:33<04:57,  1.21s/it] 27%|██▋       | 89/332 [01:34<03:17,  1.23it/s] 27%|██▋       | 90/332 [01:36<04:38,  1.15s/it] 28%|██▊       | 93/332 [01:38<03:30,  1.14it/s] 29%|██▊       | 95/332 [01:39<03:05,  1.28it/s] 29%|██▉       | 96/332 [01:41<03:40,  1.07it/s] 30%|██▉       | 98/332 [01:41<02:37,  1.49it/s] 30%|██▉       | 99/332 [01:43<03:21,  1.15it/s] 30%|███       | 100/332 [01:44<03:58,  1.03s/it] 30%|███       | 101/332 [01:47<05:50,  1.52s/it] 32%|███▏      | 105/332 [01:51<04:31,  1.19s/it] 32%|███▏      | 107/332 [01:52<03:39,  1.03it/s] 33%|███▎      | 108/332 [01:54<04:10,  1.12s/it] 33%|███▎      | 109/332 [01:55<04:18,  1.16s/it] 33%|███▎      | 111/332 [01:57<04:12,  1.14s/it] 34%|███▎      | 112/332 [01:58<04:00,  1.09s/it] 34%|███▍      | 114/332 [02:00<03:34,  1.02it/s] 35%|███▍      | 115/332 [02:00<03:03,  1.18it/s] 35%|███▍      | 116/332 [02:03<04:15,  1.18s/it] 35%|███▌      | 117/332 [02:03<03:41,  1.03s/it] 36%|███▌      | 119/332 [02:04<02:42,  1.31it/s] 36%|███▌      | 120/332 [02:11<07:34,  2.15s/it] 37%|███▋      | 124/332 [02:11<03:27,  1.00it/s] 38%|███▊      | 125/332 [02:15<05:08,  1.49s/it] 39%|███▊      | 128/332 [02:23<06:48,  2.00s/it] 40%|███▉      | 132/332 [02:25<04:16,  1.28s/it] 40%|████      | 134/332 [02:26<03:31,  1.07s/it] 41%|████      | 135/332 [02:26<03:03,  1.07it/s] 41%|████      | 136/332 [02:29<04:16,  1.31s/it] 41%|████▏     | 137/332 [02:29<03:47,  1.17s/it] 42%|████▏     | 139/332 [02:31<03:11,  1.01it/s] 42%|████▏     | 140/332 [02:32<03:23,  1.06s/it] 42%|████▏     | 141/332 [02:33<03:17,  1.03s/it] 43%|████▎     | 142/332 [02:36<04:40,  1.48s/it] 43%|████▎     | 144/332 [02:37<03:44,  1.19s/it] 44%|████▎     | 145/332 [02:38<03:09,  1.01s/it] 44%|████▍     | 146/332 [02:40<04:17,  1.39s/it] 44%|████▍     | 147/332 [02:41<03:45,  1.22s/it] 45%|████▍     | 149/332 [02:45<04:39,  1.53s/it] 46%|████▌     | 152/332 [02:49<04:07,  1.38s/it] 47%|████▋     | 155/332 [02:51<03:27,  1.17s/it] 47%|████▋     | 157/332 [02:52<02:50,  1.02it/s] 48%|████▊     | 158/332 [02:55<03:52,  1.33s/it] 48%|████▊     | 161/332 [02:58<03:09,  1.11s/it] 49%|████▉     | 163/332 [02:59<02:51,  1.01s/it] 50%|████▉     | 165/332 [03:01<02:52,  1.03s/it] 50%|█████     | 167/332 [03:02<02:13,  1.23it/s] 51%|█████     | 168/332 [03:07<04:15,  1.56s/it] 52%|█████▏    | 171/332 [03:08<02:49,  1.05s/it] 52%|█████▏    | 173/332 [03:09<02:08,  1.24it/s] 52%|█████▏    | 174/332 [03:11<02:57,  1.12s/it] 53%|█████▎    | 177/332 [03:13<02:08,  1.20it/s] 54%|█████▎    | 178/332 [03:13<01:56,  1.32it/s] 54%|█████▍    | 179/332 [03:16<03:01,  1.19s/it] 55%|█████▍    | 182/332 [03:18<02:30,  1.00s/it] 56%|█████▌    | 185/332 [03:22<02:31,  1.03s/it] 57%|█████▋    | 188/332 [03:23<01:57,  1.23it/s] 57%|█████▋    | 189/332 [03:24<01:58,  1.21it/s] 57%|█████▋    | 190/332 [03:26<02:25,  1.03s/it] 58%|█████▊    | 193/332 [03:28<02:10,  1.06it/s] 58%|█████▊    | 194/332 [03:29<02:00,  1.15it/s] 59%|█████▉    | 196/332 [03:31<02:09,  1.05it/s] 60%|█████▉    | 198/332 [03:32<01:48,  1.23it/s] 60%|█████▉    | 199/332 [03:32<01:38,  1.35it/s] 60%|██████    | 200/332 [03:35<02:23,  1.09s/it] 61%|██████    | 203/332 [03:37<01:54,  1.13it/s] 61%|██████▏   | 204/332 [03:37<01:48,  1.18it/s] 62%|██████▏   | 205/332 [03:40<02:25,  1.15s/it] 62%|██████▏   | 207/332 [03:41<02:08,  1.02s/it] 63%|██████▎   | 209/332 [03:42<01:32,  1.33it/s] 63%|██████▎   | 210/332 [03:44<02:06,  1.04s/it] 64%|██████▎   | 211/332 [03:46<02:37,  1.30s/it] 64%|██████▍   | 212/332 [03:48<02:43,  1.37s/it] 64%|██████▍   | 214/332 [03:49<02:15,  1.14s/it] 65%|██████▍   | 215/332 [03:52<02:45,  1.41s/it] 66%|██████▌   | 219/332 [03:56<02:14,  1.19s/it] 67%|██████▋   | 223/332 [03:58<01:43,  1.06it/s] 67%|██████▋   | 224/332 [04:02<02:27,  1.37s/it] 69%|██████▊   | 228/332 [04:04<01:38,  1.06it/s] 69%|██████▉   | 230/332 [04:06<01:30,  1.12it/s] 70%|██████▉   | 231/332 [04:06<01:23,  1.21it/s] 70%|██████▉   | 232/332 [04:07<01:30,  1.11it/s] 70%|███████   | 233/332 [04:08<01:24,  1.17it/s] 70%|███████   | 234/332 [04:10<01:46,  1.09s/it] 71%|███████   | 236/332 [04:12<01:36,  1.01s/it] 71%|███████▏  | 237/332 [04:14<02:05,  1.32s/it] 72%|███████▏  | 240/332 [04:15<01:16,  1.20it/s] 73%|███████▎  | 241/332 [04:16<01:20,  1.14it/s] 73%|███████▎  | 242/332 [04:19<01:56,  1.29s/it] 74%|███████▍  | 245/332 [04:20<01:14,  1.16it/s] 74%|███████▍  | 246/332 [04:23<01:49,  1.27s/it] 75%|███████▌  | 249/332 [04:24<01:07,  1.24it/s] 76%|███████▌  | 251/332 [04:25<01:05,  1.24it/s] 76%|███████▌  | 252/332 [04:25<00:55,  1.45it/s] 76%|███████▌  | 253/332 [04:30<01:50,  1.40s/it] 77%|███████▋  | 256/332 [04:31<01:08,  1.11it/s] 77%|███████▋  | 257/332 [04:32<01:17,  1.03s/it] 78%|███████▊  | 259/332 [04:33<01:02,  1.17it/s] 78%|███████▊  | 260/332 [04:35<01:13,  1.02s/it] 79%|███████▊  | 261/332 [04:36<01:07,  1.06it/s] 79%|███████▉  | 262/332 [04:37<01:09,  1.00it/s] 80%|███████▉  | 264/332 [04:38<01:01,  1.10it/s] 80%|███████▉  | 265/332 [04:39<00:50,  1.32it/s] 80%|████████  | 266/332 [04:39<00:45,  1.44it/s] 80%|████████  | 267/332 [04:42<01:17,  1.20s/it] 81%|████████  | 268/332 [04:43<01:07,  1.06s/it] 81%|████████▏ | 270/332 [04:45<01:15,  1.21s/it] 82%|████████▏ | 271/332 [04:48<01:41,  1.66s/it] 82%|████████▏ | 273/332 [04:49<01:10,  1.19s/it] 83%|████████▎ | 274/332 [04:50<00:57,  1.00it/s] 83%|████████▎ | 275/332 [04:56<02:07,  2.24s/it] 84%|████████▍ | 279/332 [04:57<01:00,  1.13s/it] 85%|████████▍ | 281/332 [05:00<01:02,  1.22s/it] 86%|████████▌ | 284/332 [05:02<00:45,  1.05it/s] 86%|████████▌ | 286/332 [05:03<00:39,  1.16it/s] 86%|████████▋ | 287/332 [05:05<00:48,  1.08s/it] 87%|████████▋ | 288/332 [05:06<00:45,  1.03s/it] 87%|████████▋ | 290/332 [05:09<00:52,  1.26s/it] 88%|████████▊ | 291/332 [05:11<00:51,  1.26s/it] 88%|████████▊ | 293/332 [05:13<00:48,  1.25s/it] 89%|████████▉ | 295/332 [05:14<00:35,  1.05it/s] 89%|████████▉ | 296/332 [05:16<00:46,  1.28s/it] 90%|████████▉ | 298/332 [05:19<00:45,  1.34s/it] 91%|█████████ | 301/332 [05:25<00:47,  1.53s/it] 92%|█████████▏| 305/332 [05:25<00:23,  1.14it/s] 92%|█████████▏| 306/332 [05:26<00:24,  1.06it/s] 92%|█████████▏| 307/332 [05:29<00:30,  1.22s/it] 93%|█████████▎| 308/332 [05:31<00:31,  1.30s/it] 93%|█████████▎| 310/332 [05:32<00:24,  1.14s/it] 94%|█████████▎| 311/332 [05:34<00:26,  1.28s/it] 94%|█████████▍| 313/332 [05:36<00:22,  1.20s/it] 95%|█████████▌| 316/332 [05:38<00:14,  1.14it/s] 95%|█████████▌| 317/332 [05:38<00:12,  1.19it/s] 96%|█████████▌| 318/332 [05:39<00:10,  1.30it/s] 96%|█████████▌| 319/332 [05:41<00:15,  1.15s/it] 96%|█████████▋| 320/332 [05:41<00:10,  1.10it/s] 97%|█████████▋| 321/332 [05:42<00:08,  1.23it/s] 97%|█████████▋| 322/332 [05:44<00:10,  1.07s/it] 97%|█████████▋| 323/332 [05:44<00:08,  1.06it/s] 98%|█████████▊| 324/332 [05:45<00:07,  1.08it/s] 98%|█████████▊| 325/332 [05:49<00:12,  1.82s/it] 99%|█████████▉| 329/332 [05:49<00:02,  1.38it/s] 99%|█████████▉| 330/332 [05:56<00:03,  1.70s/it]100%|██████████| 332/332 [05:56<00:00,  1.07s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-13 20:08:24
[INFO] duration: 8 min 
[2024-09-14 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-12/2024-09-12_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-14 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-12/2024-09-12_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-12
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-12/2024-09-12_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-12/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-12/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 322 / 322
  0%|          | 0/322 [00:00<?, ?it/s]  0%|          | 1/322 [00:08<45:17,  8.47s/it]  1%|          | 4/322 [00:09<10:02,  1.90s/it]  2%|▏         | 5/322 [00:12<12:05,  2.29s/it]  2%|▏         | 8/322 [00:13<05:43,  1.09s/it]  3%|▎         | 9/322 [00:13<04:54,  1.06it/s]  3%|▎         | 10/322 [00:16<07:13,  1.39s/it]  4%|▍         | 13/322 [00:18<05:07,  1.01it/s]  5%|▍         | 16/322 [00:20<04:44,  1.07it/s]  6%|▌         | 18/322 [00:21<03:36,  1.41it/s]  6%|▌         | 19/322 [00:23<04:49,  1.05it/s]  7%|▋         | 21/322 [00:23<03:26,  1.46it/s]  7%|▋         | 22/322 [00:26<06:07,  1.23s/it]  8%|▊         | 25/322 [00:28<04:31,  1.09it/s]  8%|▊         | 27/322 [00:30<04:43,  1.04it/s]  9%|▊         | 28/322 [00:30<04:07,  1.19it/s]  9%|▉         | 29/322 [00:31<04:14,  1.15it/s]  9%|▉         | 30/322 [00:34<05:47,  1.19s/it] 10%|▉         | 32/322 [00:34<04:03,  1.19it/s] 11%|█         | 34/322 [00:39<06:13,  1.30s/it] 11%|█▏        | 37/322 [00:39<03:57,  1.20it/s] 12%|█▏        | 38/322 [00:42<05:22,  1.13s/it] 13%|█▎        | 41/322 [00:42<03:28,  1.35it/s] 13%|█▎        | 42/322 [00:44<04:04,  1.15it/s] 13%|█▎        | 43/322 [00:44<03:26,  1.35it/s] 14%|█▎        | 44/322 [00:45<03:01,  1.53it/s] 14%|█▍        | 45/322 [00:47<05:18,  1.15s/it] 15%|█▍        | 48/322 [00:49<04:00,  1.14it/s] 16%|█▌        | 50/322 [00:53<05:51,  1.29s/it] 16%|█▋        | 53/322 [00:54<03:42,  1.21it/s] 17%|█▋        | 55/322 [00:57<04:44,  1.07s/it] 18%|█▊        | 59/322 [00:58<03:01,  1.45it/s] 19%|█▊        | 60/322 [00:58<02:49,  1.55it/s] 19%|█▉        | 61/322 [01:00<03:13,  1.35it/s] 19%|█▉        | 62/322 [01:01<03:20,  1.30it/s] 20%|█▉        | 63/322 [01:01<02:50,  1.52it/s] 20%|█▉        | 64/322 [01:04<05:10,  1.20s/it] 21%|██        | 67/322 [01:06<03:49,  1.11it/s] 21%|██        | 68/322 [01:07<03:55,  1.08it/s] 22%|██▏       | 70/322 [01:08<03:13,  1.30it/s] 22%|██▏       | 72/322 [01:09<03:09,  1.32it/s] 23%|██▎       | 73/322 [01:11<04:23,  1.06s/it] 23%|██▎       | 74/322 [01:12<03:45,  1.10it/s] 24%|██▎       | 76/322 [01:15<04:26,  1.08s/it] 24%|██▍       | 78/322 [01:15<03:05,  1.32it/s] 25%|██▍       | 79/322 [01:17<04:10,  1.03s/it] 25%|██▍       | 80/322 [01:17<03:40,  1.10it/s] 25%|██▌       | 82/322 [01:19<03:33,  1.12it/s] 26%|██▌       | 83/322 [01:21<04:26,  1.12s/it] 26%|██▋       | 85/322 [01:22<03:37,  1.09it/s] 27%|██▋       | 86/322 [01:23<03:28,  1.13it/s] 27%|██▋       | 87/322 [01:24<03:28,  1.13it/s] 27%|██▋       | 88/322 [01:27<05:06,  1.31s/it] 28%|██▊       | 90/322 [01:29<04:33,  1.18s/it] 28%|██▊       | 91/322 [01:29<04:06,  1.07s/it] 29%|██▉       | 93/322 [01:31<03:41,  1.03it/s] 30%|██▉       | 95/322 [01:33<03:43,  1.01it/s] 30%|███       | 97/322 [01:34<03:22,  1.11it/s] 30%|███       | 98/322 [01:36<04:05,  1.09s/it] 31%|███▏      | 101/322 [01:37<02:50,  1.30it/s] 32%|███▏      | 102/322 [01:39<03:02,  1.21it/s] 32%|███▏      | 104/322 [01:41<03:32,  1.02it/s] 33%|███▎      | 106/322 [01:43<03:23,  1.06it/s] 33%|███▎      | 107/322 [01:46<04:40,  1.30s/it] 34%|███▍      | 109/322 [01:47<03:51,  1.09s/it] 34%|███▍      | 110/322 [01:56<09:05,  2.57s/it] 36%|███▌      | 116/322 [01:56<03:23,  1.01it/s] 37%|███▋      | 118/322 [01:58<03:22,  1.01it/s] 37%|███▋      | 119/322 [01:58<02:55,  1.15it/s] 37%|███▋      | 120/322 [01:58<02:29,  1.35it/s] 38%|███▊      | 121/322 [02:00<03:18,  1.01it/s] 38%|███▊      | 123/322 [02:02<03:04,  1.08it/s] 39%|███▊      | 124/322 [02:02<02:45,  1.19it/s] 39%|███▉      | 125/322 [02:03<02:51,  1.15it/s] 39%|███▉      | 126/322 [02:05<03:24,  1.04s/it] 39%|███▉      | 127/322 [02:05<02:40,  1.21it/s] 40%|███▉      | 128/322 [02:06<02:21,  1.37it/s] 40%|████      | 129/322 [02:07<03:18,  1.03s/it] 41%|████      | 132/322 [02:09<02:11,  1.45it/s] 41%|████▏     | 133/322 [02:10<02:54,  1.08it/s] 42%|████▏     | 134/322 [02:11<02:28,  1.27it/s] 42%|████▏     | 136/322 [02:13<02:39,  1.16it/s] 43%|████▎     | 139/322 [02:15<02:23,  1.27it/s] 44%|████▍     | 142/322 [02:22<04:05,  1.37s/it] 45%|████▌     | 146/322 [02:22<02:23,  1.23it/s] 46%|████▌     | 148/322 [02:25<02:49,  1.03it/s] 47%|████▋     | 151/322 [02:31<03:42,  1.30s/it] 49%|████▉     | 157/322 [02:32<02:12,  1.25it/s] 49%|████▉     | 158/322 [02:33<02:02,  1.34it/s] 49%|████▉     | 159/322 [02:37<03:07,  1.15s/it] 50%|█████     | 162/322 [02:37<02:12,  1.21it/s] 51%|█████     | 163/322 [02:38<02:04,  1.28it/s] 51%|█████     | 164/322 [02:38<01:59,  1.32it/s] 51%|█████     | 165/322 [02:40<02:21,  1.11it/s] 52%|█████▏    | 166/322 [02:41<02:18,  1.12it/s] 52%|█████▏    | 168/322 [02:43<02:22,  1.08it/s] 53%|█████▎    | 170/322 [02:44<02:04,  1.22it/s] 53%|█████▎    | 171/322 [02:46<02:37,  1.04s/it] 54%|█████▎    | 173/322 [02:46<01:41,  1.46it/s] 54%|█████▍    | 174/322 [02:47<01:43,  1.42it/s] 54%|█████▍    | 175/322 [02:48<02:04,  1.18it/s] 55%|█████▍    | 176/322 [02:51<03:25,  1.41s/it] 56%|█████▌    | 180/322 [02:54<02:17,  1.03it/s] 56%|█████▌    | 181/322 [02:55<02:24,  1.02s/it] 57%|█████▋    | 183/322 [02:55<01:42,  1.35it/s] 57%|█████▋    | 184/322 [02:57<02:08,  1.08it/s] 57%|█████▋    | 185/322 [02:57<01:45,  1.29it/s] 58%|█████▊    | 187/322 [02:58<01:23,  1.62it/s] 58%|█████▊    | 188/322 [03:02<02:56,  1.32s/it] 59%|█████▉    | 191/322 [03:03<01:40,  1.30it/s] 60%|█████▉    | 192/322 [03:04<01:50,  1.18it/s] 60%|█████▉    | 193/322 [03:06<02:38,  1.23s/it] 60%|██████    | 194/322 [03:07<02:22,  1.11s/it] 61%|██████    | 196/322 [03:07<01:31,  1.37it/s] 61%|██████    | 197/322 [03:10<02:12,  1.06s/it] 61%|██████▏   | 198/322 [03:11<02:32,  1.23s/it] 62%|██████▏   | 200/322 [03:13<02:02,  1.01s/it] 62%|██████▏   | 201/322 [03:13<01:48,  1.11it/s] 63%|██████▎   | 202/322 [03:15<02:13,  1.12s/it] 63%|██████▎   | 204/322 [03:18<02:33,  1.30s/it] 64%|██████▍   | 207/322 [03:21<02:04,  1.08s/it] 65%|██████▍   | 209/322 [03:21<01:36,  1.17it/s] 65%|██████▌   | 210/322 [03:22<01:27,  1.28it/s] 66%|██████▌   | 211/322 [03:23<01:41,  1.09it/s] 66%|██████▌   | 212/322 [03:24<01:27,  1.25it/s] 66%|██████▌   | 213/322 [03:24<01:21,  1.33it/s] 66%|██████▋   | 214/322 [03:27<02:26,  1.36s/it] 67%|██████▋   | 217/322 [03:28<01:26,  1.22it/s] 68%|██████▊   | 218/322 [03:29<01:25,  1.21it/s] 68%|██████▊   | 219/322 [03:30<01:18,  1.31it/s] 68%|██████▊   | 220/322 [03:33<02:06,  1.24s/it] 70%|██████▉   | 224/322 [03:37<01:49,  1.11s/it] 70%|███████   | 227/322 [03:38<01:18,  1.21it/s] 71%|███████   | 228/322 [03:39<01:26,  1.08it/s] 71%|███████   | 229/322 [03:39<01:14,  1.25it/s] 71%|███████▏  | 230/322 [03:40<01:07,  1.36it/s] 72%|███████▏  | 231/322 [03:42<01:24,  1.07it/s] 72%|███████▏  | 232/322 [03:42<01:07,  1.33it/s] 72%|███████▏  | 233/322 [03:43<01:28,  1.01it/s] 73%|███████▎  | 235/322 [03:44<00:57,  1.50it/s] 73%|███████▎  | 236/322 [03:46<01:26,  1.00s/it] 74%|███████▍  | 239/322 [03:47<00:51,  1.60it/s] 75%|███████▍  | 240/322 [03:47<00:44,  1.83it/s] 75%|███████▍  | 241/322 [03:48<01:02,  1.29it/s] 75%|███████▌  | 242/322 [03:51<01:32,  1.16s/it] 76%|███████▌  | 244/322 [03:52<01:05,  1.20it/s] 76%|███████▌  | 245/322 [03:52<00:53,  1.44it/s] 76%|███████▋  | 246/322 [03:53<01:02,  1.22it/s] 77%|███████▋  | 247/322 [03:54<00:58,  1.29it/s] 77%|███████▋  | 248/322 [03:56<01:18,  1.06s/it] 77%|███████▋  | 249/322 [03:56<01:06,  1.09it/s] 78%|███████▊  | 250/322 [03:57<01:11,  1.00it/s] 78%|███████▊  | 251/322 [03:58<01:04,  1.10it/s] 78%|███████▊  | 252/322 [03:58<00:51,  1.35it/s] 79%|███████▊  | 253/322 [04:02<01:58,  1.72s/it] 80%|███████▉  | 257/322 [04:05<01:08,  1.06s/it] 81%|████████  | 260/322 [04:07<00:52,  1.19it/s] 81%|████████  | 261/322 [04:08<00:58,  1.05it/s] 81%|████████▏ | 262/322 [04:10<01:05,  1.10s/it] 82%|████████▏ | 263/322 [04:14<01:37,  1.66s/it] 83%|████████▎ | 267/322 [04:14<00:43,  1.27it/s] 83%|████████▎ | 268/322 [04:16<00:55,  1.02s/it] 84%|████████▍ | 271/322 [04:18<00:45,  1.12it/s] 84%|████████▍ | 272/322 [04:19<00:39,  1.26it/s] 85%|████████▍ | 273/322 [04:20<00:49,  1.01s/it] 85%|████████▌ | 275/322 [04:22<00:40,  1.16it/s] 86%|████████▌ | 276/322 [04:22<00:37,  1.22it/s] 86%|████████▌ | 277/322 [04:25<00:54,  1.22s/it] 87%|████████▋ | 279/322 [04:25<00:36,  1.19it/s] 87%|████████▋ | 280/322 [04:26<00:33,  1.27it/s] 87%|████████▋ | 281/322 [04:28<00:42,  1.05s/it] 88%|████████▊ | 282/322 [04:32<01:12,  1.82s/it] 89%|████████▉ | 286/322 [04:33<00:34,  1.05it/s] 90%|████████▉ | 289/322 [04:36<00:29,  1.10it/s] 91%|█████████ | 292/322 [04:38<00:24,  1.22it/s] 91%|█████████▏| 294/322 [04:42<00:30,  1.09s/it] 93%|█████████▎| 298/322 [04:42<00:16,  1.47it/s] 93%|█████████▎| 299/322 [04:43<00:14,  1.54it/s] 93%|█████████▎| 300/322 [04:44<00:16,  1.30it/s] 93%|█████████▎| 301/322 [04:46<00:19,  1.05it/s] 94%|█████████▍| 303/322 [04:47<00:16,  1.18it/s] 94%|█████████▍| 304/322 [04:47<00:14,  1.28it/s] 95%|█████████▌| 306/322 [04:49<00:13,  1.20it/s] 95%|█████████▌| 307/322 [04:49<00:10,  1.46it/s] 96%|█████████▌| 309/322 [04:52<00:12,  1.03it/s] 96%|█████████▋| 310/322 [04:53<00:11,  1.07it/s] 97%|█████████▋| 311/322 [04:54<00:09,  1.22it/s] 97%|█████████▋| 313/322 [04:56<00:07,  1.14it/s] 98%|█████████▊| 314/322 [04:57<00:07,  1.03it/s] 98%|█████████▊| 316/322 [04:59<00:05,  1.04it/s] 98%|█████████▊| 317/322 [04:59<00:04,  1.10it/s] 99%|█████████▉| 319/322 [05:01<00:02,  1.14it/s] 99%|█████████▉| 320/322 [05:02<00:01,  1.16it/s]100%|█████████▉| 321/322 [05:06<00:01,  1.52s/it]100%|██████████| 322/322 [05:06<00:00,  1.05it/s]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-14 20:07:33
[INFO] duration: 7 min 
[2024-09-15 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-13/2024-09-13_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-16 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-14/2024-09-14_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-17 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-15/2024-09-15_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-18 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-16/2024-09-16_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-19 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-17/2024-09-17_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-20 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-18/2024-09-18_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-20 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-18/2024-09-18_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-18
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-18/2024-09-18_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-18/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-18/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 384 / 384
  0%|          | 0/384 [00:00<?, ?it/s]  0%|          | 1/384 [00:08<52:50,  8.28s/it]  1%|          | 2/384 [00:08<22:47,  3.58s/it]  1%|          | 4/384 [00:11<13:59,  2.21s/it]  1%|▏         | 5/384 [00:12<12:48,  2.03s/it]  2%|▏         | 7/384 [00:14<08:46,  1.40s/it]  2%|▏         | 9/384 [00:15<06:20,  1.01s/it]  3%|▎         | 10/384 [00:15<05:36,  1.11it/s]  3%|▎         | 11/384 [00:16<05:29,  1.13it/s]  3%|▎         | 12/384 [00:21<11:07,  1.79s/it]  4%|▍         | 15/384 [00:22<06:35,  1.07s/it]  4%|▍         | 16/384 [00:23<07:02,  1.15s/it]  4%|▍         | 17/384 [00:25<07:56,  1.30s/it]  5%|▍         | 18/384 [00:27<08:13,  1.35s/it]  5%|▌         | 20/384 [00:29<07:24,  1.22s/it]  6%|▌         | 23/384 [00:34<08:33,  1.42s/it]  7%|▋         | 26/384 [00:35<05:52,  1.02it/s]  7%|▋         | 27/384 [00:35<05:37,  1.06it/s]  7%|▋         | 28/384 [00:37<06:11,  1.04s/it]  8%|▊         | 29/384 [00:39<07:04,  1.19s/it]  8%|▊         | 31/384 [00:40<05:57,  1.01s/it]  8%|▊         | 32/384 [00:42<07:11,  1.23s/it]  9%|▊         | 33/384 [00:43<06:49,  1.17s/it]  9%|▉         | 34/384 [00:46<08:57,  1.54s/it]  9%|▉         | 36/384 [00:46<05:36,  1.03it/s] 10%|▉         | 37/384 [00:51<11:13,  1.94s/it] 10%|▉         | 38/384 [00:52<08:57,  1.55s/it] 11%|█         | 41/384 [00:55<07:56,  1.39s/it] 11%|█▏        | 44/384 [00:56<05:21,  1.06it/s] 12%|█▏        | 45/384 [00:57<04:45,  1.19it/s] 12%|█▏        | 46/384 [00:58<05:08,  1.09it/s] 12%|█▏        | 47/384 [00:59<05:10,  1.09it/s] 12%|█▎        | 48/384 [01:03<09:02,  1.62s/it] 13%|█▎        | 51/384 [01:04<05:34,  1.01s/it] 14%|█▎        | 52/384 [01:06<07:18,  1.32s/it] 14%|█▍        | 54/384 [01:07<05:17,  1.04it/s] 14%|█▍        | 55/384 [01:09<06:40,  1.22s/it] 15%|█▍        | 56/384 [01:10<06:15,  1.15s/it] 15%|█▍        | 57/384 [01:13<07:57,  1.46s/it] 15%|█▌        | 58/384 [01:16<10:37,  1.95s/it] 16%|█▌        | 60/384 [01:17<07:20,  1.36s/it] 16%|█▋        | 63/384 [01:22<07:48,  1.46s/it] 17%|█▋        | 66/384 [01:22<04:44,  1.12it/s] 17%|█▋        | 67/384 [01:27<07:49,  1.48s/it] 18%|█▊        | 70/384 [01:27<04:42,  1.11it/s] 18%|█▊        | 71/384 [01:29<05:49,  1.12s/it] 19%|█▉        | 73/384 [01:29<04:16,  1.21it/s] 19%|█▉        | 74/384 [01:35<09:09,  1.77s/it] 20%|██        | 77/384 [01:35<05:08,  1.01s/it] 21%|██        | 79/384 [01:37<04:40,  1.09it/s] 21%|██        | 80/384 [01:41<07:22,  1.45s/it] 21%|██        | 81/384 [01:42<06:38,  1.31s/it] 21%|██▏       | 82/384 [01:44<07:30,  1.49s/it] 22%|██▏       | 83/384 [01:44<06:15,  1.25s/it] 22%|██▏       | 84/384 [01:45<05:34,  1.12s/it] 22%|██▏       | 85/384 [01:46<04:58,  1.00it/s] 22%|██▏       | 86/384 [01:47<06:03,  1.22s/it] 23%|██▎       | 87/384 [01:50<08:01,  1.62s/it] 23%|██▎       | 90/384 [01:56<08:32,  1.74s/it] 24%|██▎       | 91/384 [01:56<07:29,  1.53s/it] 24%|██▍       | 94/384 [01:59<06:11,  1.28s/it] 25%|██▍       | 95/384 [02:00<05:36,  1.16s/it] 25%|██▌       | 97/384 [02:02<05:44,  1.20s/it] 26%|██▌       | 98/384 [02:03<04:55,  1.03s/it] 26%|██▌       | 100/384 [02:05<05:09,  1.09s/it] 26%|██▋       | 101/384 [02:07<05:57,  1.26s/it] 27%|██▋       | 103/384 [02:08<04:52,  1.04s/it] 27%|██▋       | 104/384 [02:10<05:49,  1.25s/it] 27%|██▋       | 105/384 [02:12<05:39,  1.22s/it] 28%|██▊       | 107/384 [02:12<03:52,  1.19it/s] 28%|██▊       | 108/384 [02:13<03:35,  1.28it/s] 28%|██▊       | 109/384 [02:14<03:46,  1.21it/s] 29%|██▊       | 110/384 [02:15<04:13,  1.08it/s] 29%|██▉       | 111/384 [02:19<08:43,  1.92s/it] 30%|██▉       | 115/384 [02:21<04:06,  1.09it/s] 30%|███       | 117/384 [02:22<03:44,  1.19it/s] 31%|███       | 118/384 [02:23<03:34,  1.24it/s] 31%|███       | 119/384 [02:28<07:35,  1.72s/it] 32%|███▏      | 123/384 [02:29<04:20,  1.00it/s] 32%|███▏      | 124/384 [02:30<03:48,  1.14it/s] 33%|███▎      | 125/384 [02:32<04:46,  1.10s/it] 33%|███▎      | 126/384 [02:34<06:10,  1.44s/it] 33%|███▎      | 128/384 [02:40<08:17,  1.94s/it] 34%|███▍      | 131/384 [02:42<05:39,  1.34s/it] 34%|███▍      | 132/384 [02:46<07:54,  1.88s/it] 35%|███▌      | 136/384 [02:49<05:28,  1.33s/it] 36%|███▌      | 139/384 [02:50<03:47,  1.08it/s] 36%|███▋      | 140/384 [02:52<04:44,  1.17s/it] 37%|███▋      | 141/384 [02:53<04:29,  1.11s/it] 37%|███▋      | 143/384 [02:56<04:50,  1.20s/it] 38%|███▊      | 144/384 [02:57<04:49,  1.21s/it] 38%|███▊      | 146/384 [02:59<04:04,  1.03s/it] 39%|███▊      | 148/384 [03:00<03:43,  1.06it/s] 39%|███▉      | 149/384 [03:02<04:29,  1.14s/it] 39%|███▉      | 150/384 [03:03<03:47,  1.03it/s] 39%|███▉      | 151/384 [03:03<03:12,  1.21it/s] 40%|███▉      | 152/384 [03:04<03:38,  1.06it/s] 40%|███▉      | 153/384 [03:12<10:58,  2.85s/it] 41%|████      | 157/384 [03:14<04:59,  1.32s/it] 41%|████▏     | 159/384 [03:14<03:54,  1.04s/it] 42%|████▏     | 160/384 [03:16<04:13,  1.13s/it] 42%|████▏     | 161/384 [03:18<05:05,  1.37s/it] 42%|████▏     | 162/384 [03:20<05:33,  1.50s/it] 43%|████▎     | 165/384 [03:29<07:47,  2.14s/it] 44%|████▍     | 170/384 [03:30<03:59,  1.12s/it] 45%|████▍     | 171/384 [03:32<04:34,  1.29s/it] 45%|████▌     | 174/384 [03:34<03:33,  1.02s/it] 46%|████▌     | 175/384 [03:34<03:19,  1.05it/s] 46%|████▌     | 177/384 [03:36<03:18,  1.04it/s] 47%|████▋     | 179/384 [03:39<03:26,  1.01s/it] 47%|████▋     | 181/384 [03:39<02:42,  1.25it/s] 47%|████▋     | 182/384 [03:43<04:38,  1.38s/it] 48%|████▊     | 183/384 [03:45<05:01,  1.50s/it] 48%|████▊     | 185/384 [03:45<03:15,  1.02it/s] 48%|████▊     | 186/384 [03:47<03:51,  1.17s/it] 49%|████▊     | 187/384 [03:50<04:56,  1.51s/it] 49%|████▉     | 190/384 [03:52<03:42,  1.15s/it] 50%|████▉     | 191/384 [03:53<03:19,  1.04s/it] 50%|█████     | 193/384 [03:55<03:29,  1.10s/it] 51%|█████     | 194/384 [03:57<03:34,  1.13s/it] 51%|█████     | 196/384 [03:57<02:35,  1.21it/s] 51%|█████▏    | 197/384 [04:01<04:50,  1.55s/it] 52%|█████▏    | 200/384 [04:03<03:03,  1.00it/s] 52%|█████▏    | 201/384 [04:05<03:45,  1.23s/it] 53%|█████▎    | 203/384 [04:08<04:00,  1.33s/it] 53%|█████▎    | 204/384 [04:08<03:18,  1.10s/it] 53%|█████▎    | 205/384 [04:09<03:24,  1.14s/it] 54%|█████▎    | 206/384 [04:11<03:46,  1.27s/it] 54%|█████▍    | 208/384 [04:12<02:42,  1.09it/s] 54%|█████▍    | 209/384 [04:14<03:36,  1.24s/it] 55%|█████▍    | 210/384 [04:15<03:01,  1.04s/it] 55%|█████▌    | 212/384 [04:19<04:33,  1.59s/it] 56%|█████▌    | 215/384 [04:20<02:29,  1.13it/s] 56%|█████▋    | 216/384 [04:22<02:59,  1.07s/it] 57%|█████▋    | 217/384 [04:22<02:34,  1.08it/s] 57%|█████▋    | 219/384 [04:24<02:43,  1.01it/s] 58%|█████▊    | 221/384 [04:26<02:39,  1.02it/s] 58%|█████▊    | 222/384 [04:28<03:01,  1.12s/it] 58%|█████▊    | 224/384 [04:28<02:04,  1.28it/s] 59%|█████▊    | 225/384 [04:33<04:18,  1.63s/it] 60%|█████▉    | 229/384 [04:34<02:24,  1.07it/s] 60%|█████▉    | 230/384 [04:35<02:21,  1.09it/s] 60%|██████    | 231/384 [04:38<03:17,  1.29s/it] 60%|██████    | 232/384 [04:40<03:27,  1.36s/it] 61%|██████    | 233/384 [04:42<04:06,  1.63s/it] 61%|██████    | 234/384 [04:44<04:11,  1.67s/it] 61%|██████▏   | 236/384 [04:54<07:18,  2.97s/it] 64%|██████▎   | 244/384 [04:56<02:30,  1.07s/it] 64%|██████▍   | 247/384 [04:57<02:05,  1.09it/s] 65%|██████▍   | 248/384 [04:58<01:53,  1.20it/s] 65%|██████▍   | 249/384 [05:03<03:17,  1.46s/it] 66%|██████▌   | 252/384 [05:03<02:11,  1.00it/s] 66%|██████▌   | 253/384 [05:05<02:19,  1.07s/it] 66%|██████▌   | 254/384 [05:06<02:08,  1.01it/s] 66%|██████▋   | 255/384 [05:08<02:38,  1.23s/it] 67%|██████▋   | 256/384 [05:13<04:34,  2.14s/it] 68%|██████▊   | 260/384 [05:15<02:25,  1.18s/it] 68%|██████▊   | 262/384 [05:16<02:07,  1.05s/it] 68%|██████▊   | 263/384 [05:16<01:49,  1.11it/s] 69%|██████▉   | 264/384 [05:17<01:33,  1.28it/s] 69%|██████▉   | 265/384 [05:18<01:54,  1.04it/s] 70%|██████▉   | 267/384 [05:21<02:13,  1.14s/it] 70%|███████   | 269/384 [05:22<01:49,  1.05it/s] 71%|███████   | 271/384 [05:23<01:18,  1.44it/s] 71%|███████   | 272/384 [05:23<01:10,  1.59it/s] 71%|███████   | 273/384 [05:26<02:00,  1.09s/it] 72%|███████▏  | 276/384 [05:27<01:22,  1.31it/s] 72%|███████▏  | 277/384 [05:30<02:07,  1.19s/it] 73%|███████▎  | 280/384 [05:31<01:20,  1.29it/s] 73%|███████▎  | 281/384 [05:31<01:14,  1.37it/s] 73%|███████▎  | 282/384 [05:33<01:35,  1.07it/s] 74%|███████▍  | 284/384 [05:35<01:29,  1.11it/s] 74%|███████▍  | 285/384 [05:35<01:13,  1.36it/s] 74%|███████▍  | 286/384 [05:36<01:15,  1.29it/s] 75%|███████▍  | 287/384 [05:37<01:18,  1.24it/s] 75%|███████▌  | 288/384 [05:38<01:40,  1.05s/it] 75%|███████▌  | 289/384 [05:42<02:41,  1.70s/it] 76%|███████▌  | 292/384 [05:43<01:36,  1.05s/it] 76%|███████▋  | 293/384 [05:45<01:41,  1.11s/it] 77%|███████▋  | 294/384 [05:48<02:32,  1.69s/it] 77%|███████▋  | 297/384 [05:51<01:52,  1.30s/it] 78%|███████▊  | 298/384 [05:52<01:44,  1.21s/it] 78%|███████▊  | 299/384 [05:52<01:25,  1.00s/it] 78%|███████▊  | 300/384 [05:54<01:48,  1.29s/it] 79%|███████▉  | 303/384 [05:56<01:11,  1.13it/s] 79%|███████▉  | 304/384 [05:58<01:37,  1.22s/it] 79%|███████▉  | 305/384 [06:06<03:23,  2.57s/it] 81%|████████  | 310/384 [06:08<01:29,  1.21s/it] 81%|████████  | 311/384 [06:09<01:31,  1.25s/it] 81%|████████▏ | 312/384 [06:10<01:27,  1.21s/it] 82%|████████▏ | 314/384 [06:15<01:47,  1.54s/it] 83%|████████▎ | 317/384 [06:15<01:07,  1.01s/it] 83%|████████▎ | 318/384 [06:17<01:17,  1.18s/it] 83%|████████▎ | 320/384 [06:20<01:18,  1.23s/it] 84%|████████▎ | 321/384 [06:21<01:10,  1.12s/it] 84%|████████▍ | 323/384 [06:22<01:00,  1.00it/s] 84%|████████▍ | 324/384 [06:23<00:53,  1.12it/s] 85%|████████▍ | 326/384 [06:25<00:53,  1.08it/s] 85%|████████▌ | 328/384 [06:26<00:44,  1.26it/s] 86%|████████▌ | 329/384 [06:27<00:52,  1.05it/s] 86%|████████▌ | 330/384 [06:31<01:26,  1.60s/it] 87%|████████▋ | 333/384 [06:33<00:55,  1.09s/it] 88%|████████▊ | 336/384 [06:34<00:37,  1.29it/s] 88%|████████▊ | 337/384 [06:35<00:40,  1.16it/s] 88%|████████▊ | 338/384 [06:36<00:41,  1.11it/s] 88%|████████▊ | 339/384 [06:36<00:33,  1.34it/s] 89%|████████▊ | 340/384 [06:37<00:35,  1.22it/s] 89%|████████▉ | 341/384 [06:41<01:06,  1.55s/it] 89%|████████▉ | 343/384 [06:45<01:06,  1.62s/it] 90%|████████▉ | 345/384 [06:48<01:05,  1.67s/it] 91%|█████████ | 349/384 [06:49<00:34,  1.02it/s] 91%|█████████ | 350/384 [06:53<00:45,  1.34s/it] 92%|█████████▏| 352/384 [06:53<00:31,  1.00it/s] 92%|█████████▏| 354/384 [06:57<00:38,  1.28s/it] 93%|█████████▎| 357/384 [07:00<00:31,  1.16s/it] 94%|█████████▍| 360/384 [07:03<00:26,  1.12s/it] 95%|█████████▍| 363/384 [07:06<00:23,  1.12s/it] 95%|█████████▌| 365/384 [07:09<00:20,  1.10s/it] 96%|█████████▌| 367/384 [07:09<00:14,  1.21it/s] 96%|█████████▌| 368/384 [07:09<00:13,  1.22it/s] 96%|█████████▌| 369/384 [07:11<00:14,  1.04it/s] 96%|█████████▋| 370/384 [07:18<00:29,  2.14s/it] 98%|█████████▊| 375/384 [07:18<00:08,  1.06it/s] 98%|█████████▊| 376/384 [07:20<00:08,  1.04s/it] 98%|█████████▊| 377/384 [07:20<00:06,  1.10it/s] 99%|█████████▊| 379/384 [07:26<00:07,  1.57s/it]100%|█████████▉| 383/384 [07:27<00:00,  1.16it/s]100%|██████████| 384/384 [07:28<00:00,  1.06it/s]100%|██████████| 384/384 [07:28<00:00,  1.17s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-20 20:09:56
[INFO] duration: 9 min 
[2024-09-21 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-19/2024-09-19_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-21 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-19/2024-09-19_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-19
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-19/2024-09-19_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-19/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-19/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 365 / 365
  0%|          | 0/365 [00:00<?, ?it/s]  0%|          | 1/365 [00:09<58:15,  9.60s/it]  1%|▏         | 5/365 [00:11<10:46,  1.80s/it]  2%|▏         | 7/365 [00:13<08:49,  1.48s/it]  2%|▏         | 8/365 [00:13<07:13,  1.21s/it]  2%|▏         | 9/365 [00:13<05:50,  1.02it/s]  3%|▎         | 10/365 [00:15<06:39,  1.12s/it]  3%|▎         | 11/365 [00:15<05:57,  1.01s/it]  3%|▎         | 12/365 [00:17<06:30,  1.11s/it]  4%|▍         | 14/365 [00:19<05:51,  1.00s/it]  4%|▍         | 16/365 [00:21<06:49,  1.17s/it]  5%|▍         | 17/365 [00:22<06:10,  1.06s/it]  5%|▍         | 18/365 [00:24<06:57,  1.20s/it]  5%|▌         | 19/365 [00:24<06:05,  1.06s/it]  5%|▌         | 20/365 [00:25<05:03,  1.14it/s]  6%|▌         | 21/365 [00:26<05:50,  1.02s/it]  6%|▌         | 22/365 [00:27<04:58,  1.15it/s]  6%|▋         | 23/365 [00:28<05:04,  1.12it/s]  7%|▋         | 24/365 [00:29<06:03,  1.07s/it]  7%|▋         | 25/365 [00:30<05:03,  1.12it/s]  7%|▋         | 27/365 [00:32<05:53,  1.05s/it]  8%|▊         | 30/365 [00:37<07:45,  1.39s/it]  9%|▉         | 33/365 [00:37<04:39,  1.19it/s]  9%|▉         | 34/365 [00:38<04:11,  1.32it/s] 10%|▉         | 35/365 [00:41<06:54,  1.26s/it] 10%|█         | 38/365 [00:44<06:04,  1.12s/it] 11%|█         | 41/365 [00:45<04:08,  1.31it/s] 12%|█▏        | 42/365 [00:48<06:11,  1.15s/it] 12%|█▏        | 43/365 [00:49<06:14,  1.16s/it] 12%|█▏        | 45/365 [00:50<04:56,  1.08it/s] 13%|█▎        | 46/365 [00:54<07:54,  1.49s/it] 13%|█▎        | 48/365 [00:55<05:59,  1.13s/it] 13%|█▎        | 49/365 [00:56<05:53,  1.12s/it] 14%|█▎        | 50/365 [00:56<04:54,  1.07it/s] 14%|█▍        | 51/365 [00:59<06:57,  1.33s/it] 15%|█▍        | 54/365 [01:01<05:44,  1.11s/it] 15%|█▌        | 55/365 [01:02<05:13,  1.01s/it] 16%|█▌        | 57/365 [01:05<05:57,  1.16s/it] 16%|█▋        | 60/365 [01:08<05:26,  1.07s/it] 17%|█▋        | 61/365 [01:08<04:48,  1.05it/s] 17%|█▋        | 63/365 [01:16<09:21,  1.86s/it] 18%|█▊        | 67/365 [01:17<05:21,  1.08s/it] 19%|█▊        | 68/365 [01:18<05:20,  1.08s/it] 19%|█▉        | 69/365 [01:19<05:38,  1.14s/it] 19%|█▉        | 71/365 [01:20<04:17,  1.14it/s] 20%|█▉        | 72/365 [01:21<04:15,  1.15it/s] 20%|██        | 73/365 [01:23<06:11,  1.27s/it] 21%|██        | 75/365 [01:24<04:24,  1.10it/s] 21%|██        | 76/365 [01:24<03:59,  1.21it/s] 21%|██        | 77/365 [01:26<04:58,  1.04s/it] 22%|██▏       | 79/365 [01:27<03:23,  1.41it/s] 22%|██▏       | 80/365 [01:27<03:23,  1.40it/s] 22%|██▏       | 81/365 [01:29<04:24,  1.07it/s] 22%|██▏       | 82/365 [01:29<03:25,  1.38it/s] 23%|██▎       | 83/365 [01:30<03:21,  1.40it/s] 23%|██▎       | 84/365 [01:35<08:31,  1.82s/it] 24%|██▍       | 87/365 [01:40<08:50,  1.91s/it] 24%|██▍       | 89/365 [01:41<06:03,  1.32s/it] 25%|██▌       | 92/365 [01:44<05:18,  1.17s/it] 25%|██▌       | 93/365 [01:44<04:36,  1.01s/it] 26%|██▌       | 95/365 [01:47<05:15,  1.17s/it] 26%|██▋       | 96/365 [01:49<05:49,  1.30s/it] 27%|██▋       | 98/365 [01:50<04:59,  1.12s/it] 27%|██▋       | 100/365 [01:51<03:28,  1.27it/s] 28%|██▊       | 101/365 [01:53<04:31,  1.03s/it] 28%|██▊       | 102/365 [01:53<03:50,  1.14it/s] 28%|██▊       | 103/365 [01:54<04:01,  1.09it/s] 28%|██▊       | 104/365 [01:56<05:27,  1.25s/it] 29%|██▉       | 105/365 [02:02<10:00,  2.31s/it] 30%|██▉       | 108/365 [02:02<04:47,  1.12s/it] 30%|██▉       | 109/365 [02:06<07:37,  1.79s/it] 31%|███       | 113/365 [02:08<04:26,  1.06s/it] 31%|███       | 114/365 [02:08<04:04,  1.03it/s] 32%|███▏      | 115/365 [02:13<06:35,  1.58s/it] 32%|███▏      | 118/365 [02:17<06:08,  1.49s/it] 33%|███▎      | 120/365 [02:18<05:04,  1.24s/it] 33%|███▎      | 122/365 [02:20<04:29,  1.11s/it] 34%|███▎      | 123/365 [02:21<04:56,  1.23s/it] 34%|███▍      | 124/365 [02:22<04:05,  1.02s/it] 34%|███▍      | 125/365 [02:23<04:12,  1.05s/it] 35%|███▍      | 126/365 [02:26<06:06,  1.53s/it] 35%|███▌      | 128/365 [02:26<03:55,  1.01it/s] 36%|███▌      | 130/365 [02:30<05:24,  1.38s/it] 36%|███▌      | 132/365 [02:31<04:12,  1.08s/it] 36%|███▋      | 133/365 [02:32<03:45,  1.03it/s] 37%|███▋      | 134/365 [02:33<03:51,  1.00s/it] 37%|███▋      | 135/365 [02:33<03:18,  1.16it/s] 38%|███▊      | 137/365 [02:36<03:50,  1.01s/it] 38%|███▊      | 138/365 [02:37<04:14,  1.12s/it] 38%|███▊      | 140/365 [02:39<03:31,  1.07it/s] 39%|███▊      | 141/365 [02:43<05:58,  1.60s/it] 39%|███▉      | 144/365 [02:43<03:22,  1.09it/s] 40%|████      | 146/365 [02:44<02:58,  1.23it/s] 40%|████      | 147/365 [02:45<02:44,  1.32it/s] 41%|████      | 149/365 [02:46<02:43,  1.32it/s] 41%|████      | 150/365 [02:50<04:31,  1.26s/it] 42%|████▏     | 153/365 [02:52<03:34,  1.01s/it] 42%|████▏     | 154/365 [02:56<05:17,  1.50s/it] 43%|████▎     | 156/365 [02:57<04:22,  1.26s/it] 43%|████▎     | 158/365 [02:59<03:50,  1.12s/it] 44%|████▎     | 159/365 [03:00<03:58,  1.16s/it] 44%|████▍     | 161/365 [03:02<03:35,  1.05s/it] 45%|████▍     | 163/365 [03:02<02:34,  1.31it/s] 45%|████▍     | 164/365 [03:04<03:15,  1.03it/s] 45%|████▌     | 166/365 [03:06<03:07,  1.06it/s] 46%|████▌     | 168/365 [03:07<02:51,  1.15it/s] 46%|████▋     | 169/365 [03:10<04:10,  1.28s/it] 47%|████▋     | 172/365 [03:14<03:56,  1.23s/it] 48%|████▊     | 174/365 [03:14<02:47,  1.14it/s] 48%|████▊     | 175/365 [03:16<03:32,  1.12s/it] 48%|████▊     | 177/365 [03:17<02:41,  1.16it/s] 49%|████▉     | 178/365 [03:17<02:29,  1.25it/s] 49%|████▉     | 179/365 [03:22<04:42,  1.52s/it] 50%|████▉     | 181/365 [03:23<03:35,  1.17s/it] 50%|█████     | 183/365 [03:25<03:42,  1.22s/it] 51%|█████     | 186/365 [03:29<03:46,  1.26s/it] 52%|█████▏    | 188/365 [03:33<04:13,  1.43s/it] 52%|█████▏    | 190/365 [03:36<04:22,  1.50s/it] 53%|█████▎    | 194/365 [03:38<02:41,  1.06it/s] 53%|█████▎    | 195/365 [03:40<03:16,  1.15s/it] 54%|█████▎    | 196/365 [03:42<03:52,  1.37s/it] 55%|█████▍    | 200/365 [03:47<03:18,  1.20s/it] 56%|█████▌    | 203/365 [03:51<03:38,  1.35s/it] 57%|█████▋    | 207/365 [03:53<02:35,  1.02it/s] 57%|█████▋    | 209/365 [03:57<03:03,  1.18s/it] 58%|█████▊    | 210/365 [03:58<03:03,  1.18s/it] 58%|█████▊    | 212/365 [03:58<02:18,  1.11it/s] 58%|█████▊    | 213/365 [03:59<02:00,  1.26it/s] 59%|█████▊    | 214/365 [04:00<02:17,  1.10it/s] 59%|█████▉    | 215/365 [04:08<06:04,  2.43s/it] 61%|██████    | 222/365 [04:09<02:04,  1.15it/s] 61%|██████    | 223/365 [04:10<02:02,  1.16it/s] 62%|██████▏   | 225/365 [04:14<02:42,  1.16s/it] 62%|██████▏   | 227/365 [04:16<02:31,  1.10s/it] 63%|██████▎   | 229/365 [04:16<01:54,  1.19it/s] 63%|██████▎   | 231/365 [04:18<02:05,  1.07it/s] 64%|██████▍   | 233/365 [04:20<02:05,  1.05it/s] 64%|██████▍   | 234/365 [04:21<01:47,  1.22it/s] 65%|██████▍   | 236/365 [04:22<01:49,  1.18it/s] 65%|██████▍   | 237/365 [04:25<02:30,  1.17s/it] 66%|██████▌   | 241/365 [04:27<01:35,  1.30it/s] 66%|██████▋   | 242/365 [04:27<01:28,  1.38it/s] 67%|██████▋   | 243/365 [04:27<01:19,  1.53it/s] 67%|██████▋   | 244/365 [04:31<02:24,  1.19s/it] 67%|██████▋   | 245/365 [04:32<02:35,  1.30s/it] 68%|██████▊   | 247/365 [04:35<02:25,  1.23s/it] 68%|██████▊   | 249/365 [04:35<01:48,  1.07it/s] 68%|██████▊   | 250/365 [04:36<01:32,  1.24it/s] 69%|██████▉   | 251/365 [04:39<02:40,  1.41s/it] 70%|██████▉   | 254/365 [04:40<01:25,  1.29it/s] 70%|██████▉   | 255/365 [04:41<01:31,  1.20it/s] 70%|███████   | 256/365 [04:42<01:46,  1.02it/s] 71%|███████   | 258/365 [04:43<01:12,  1.47it/s] 71%|███████   | 259/365 [04:47<02:42,  1.54s/it] 72%|███████▏  | 262/365 [04:49<02:00,  1.17s/it] 72%|███████▏  | 264/365 [04:51<01:42,  1.01s/it] 73%|███████▎  | 266/365 [04:51<01:12,  1.37it/s] 73%|███████▎  | 267/365 [04:55<02:10,  1.33s/it] 74%|███████▍  | 270/365 [04:56<01:29,  1.06it/s] 74%|███████▍  | 271/365 [04:58<01:44,  1.11s/it] 75%|███████▌  | 274/365 [05:01<01:37,  1.07s/it] 75%|███████▌  | 275/365 [05:03<01:37,  1.08s/it] 76%|███████▌  | 277/365 [05:12<03:23,  2.31s/it] 78%|███████▊  | 283/365 [05:13<01:24,  1.03s/it] 78%|███████▊  | 284/365 [05:16<01:39,  1.23s/it] 78%|███████▊  | 285/365 [05:17<01:41,  1.27s/it] 78%|███████▊  | 286/365 [05:19<01:43,  1.31s/it] 79%|███████▊  | 287/365 [05:21<02:02,  1.57s/it] 79%|███████▉  | 288/365 [05:22<01:48,  1.41s/it] 79%|███████▉  | 290/365 [05:29<02:46,  2.22s/it] 81%|████████  | 295/365 [05:31<01:21,  1.17s/it] 81%|████████  | 296/365 [05:35<01:52,  1.62s/it] 82%|████████▏ | 299/365 [05:37<01:20,  1.21s/it] 82%|████████▏ | 301/365 [05:40<01:21,  1.28s/it] 83%|████████▎ | 304/365 [05:42<01:06,  1.10s/it] 84%|████████▎ | 305/365 [05:44<01:09,  1.15s/it] 84%|████████▍ | 306/365 [05:46<01:15,  1.27s/it] 84%|████████▍ | 307/365 [05:49<01:32,  1.59s/it] 85%|████████▍ | 309/365 [05:49<00:59,  1.06s/it] 85%|████████▌ | 311/365 [05:51<01:01,  1.13s/it] 86%|████████▌ | 314/365 [05:52<00:37,  1.35it/s] 86%|████████▋ | 315/365 [05:55<00:55,  1.12s/it] 87%|████████▋ | 318/365 [05:58<00:54,  1.15s/it] 87%|████████▋ | 319/365 [05:59<00:51,  1.12s/it] 88%|████████▊ | 321/365 [06:03<00:58,  1.33s/it] 89%|████████▉ | 324/365 [06:04<00:37,  1.09it/s] 89%|████████▉ | 326/365 [06:05<00:29,  1.34it/s] 90%|████████▉ | 327/365 [06:05<00:24,  1.56it/s] 90%|████████▉ | 328/365 [06:06<00:31,  1.19it/s] 90%|█████████ | 329/365 [06:07<00:26,  1.34it/s] 90%|█████████ | 330/365 [06:07<00:20,  1.68it/s] 91%|█████████ | 331/365 [06:09<00:29,  1.15it/s] 91%|█████████ | 332/365 [06:09<00:22,  1.49it/s] 91%|█████████ | 333/365 [06:10<00:25,  1.24it/s] 92%|█████████▏| 334/365 [06:12<00:35,  1.15s/it] 92%|█████████▏| 336/365 [06:13<00:27,  1.05it/s] 92%|█████████▏| 337/365 [06:14<00:25,  1.11it/s] 93%|█████████▎| 338/365 [06:16<00:33,  1.24s/it] 93%|█████████▎| 339/365 [06:19<00:40,  1.57s/it] 93%|█████████▎| 341/365 [06:19<00:22,  1.08it/s] 94%|█████████▎| 342/365 [06:20<00:20,  1.13it/s] 94%|█████████▍| 343/365 [06:21<00:23,  1.06s/it] 94%|█████████▍| 344/365 [06:21<00:17,  1.21it/s] 95%|█████████▍| 345/365 [06:22<00:13,  1.44it/s] 95%|█████████▍| 346/365 [06:23<00:13,  1.37it/s] 95%|█████████▌| 347/365 [06:24<00:15,  1.19it/s] 95%|█████████▌| 348/365 [06:25<00:16,  1.03it/s] 96%|█████████▌| 349/365 [06:31<00:37,  2.32s/it] 97%|█████████▋| 353/365 [06:33<00:15,  1.26s/it] 97%|█████████▋| 355/365 [06:34<00:10,  1.05s/it] 98%|█████████▊| 356/365 [06:35<00:08,  1.03it/s] 98%|█████████▊| 357/365 [06:35<00:07,  1.13it/s] 98%|█████████▊| 358/365 [06:37<00:06,  1.03it/s] 98%|█████████▊| 359/365 [06:38<00:06,  1.10s/it] 99%|█████████▊| 360/365 [06:39<00:05,  1.15s/it] 99%|█████████▉| 361/365 [06:40<00:04,  1.02s/it] 99%|█████████▉| 362/365 [06:43<00:04,  1.60s/it]100%|██████████| 365/365 [06:44<00:00,  1.13it/s]100%|██████████| 365/365 [06:44<00:00,  1.11s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-21 20:09:15
[INFO] duration: 9 min 
[2024-09-22 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-20/2024-09-20_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-22 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 49, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(query_ls, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 177, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-20/2024-09-20_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-20
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-20/2024-09-20_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-20/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-20/2024-09-20_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-09-22 20:00:22
[INFO] duration: 0 min 
[2024-09-23 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-21/2024-09-21_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-24 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-22/2024-09-22_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-25 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-23/2024-09-23_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-25 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 49, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(query_ls, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 177, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-23/2024-09-23_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-23
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-23/2024-09-23_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-23/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-23/2024-09-23_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-09-25 20:00:20
[INFO] duration: 0 min 
[2024-09-26 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-24/2024-09-24_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-26 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-24/2024-09-24_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-24
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-24/2024-09-24_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-24/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-24/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 373 / 373
  0%|          | 0/373 [00:00<?, ?it/s]  0%|          | 1/373 [00:11<1:12:05, 11.63s/it]  2%|▏         | 6/373 [00:12<09:43,  1.59s/it]    2%|▏         | 7/373 [00:16<12:08,  1.99s/it]  3%|▎         | 10/373 [00:16<06:49,  1.13s/it]  3%|▎         | 11/373 [00:18<07:20,  1.22s/it]  3%|▎         | 12/373 [00:18<06:16,  1.04s/it]  3%|▎         | 13/373 [00:19<06:01,  1.00s/it]  4%|▍         | 14/373 [00:20<06:32,  1.09s/it]  4%|▍         | 15/373 [00:22<07:16,  1.22s/it]  4%|▍         | 16/373 [00:22<05:38,  1.05it/s]  5%|▍         | 17/373 [00:23<06:14,  1.05s/it]  5%|▍         | 18/373 [00:25<07:05,  1.20s/it]  5%|▌         | 19/373 [00:25<05:35,  1.06it/s]  5%|▌         | 20/373 [00:27<06:09,  1.05s/it]  6%|▌         | 21/373 [00:27<04:34,  1.28it/s]  6%|▌         | 22/373 [00:28<05:38,  1.04it/s]  6%|▌         | 23/373 [00:30<07:58,  1.37s/it]  7%|▋         | 26/373 [00:32<04:58,  1.16it/s]  7%|▋         | 27/373 [00:32<04:46,  1.21it/s]  8%|▊         | 28/373 [00:34<04:59,  1.15it/s]  8%|▊         | 29/373 [00:36<07:15,  1.27s/it]  8%|▊         | 30/373 [00:38<07:45,  1.36s/it]  8%|▊         | 31/373 [00:40<09:32,  1.67s/it]  9%|▉         | 33/373 [00:42<07:50,  1.38s/it]  9%|▉         | 34/373 [00:44<07:49,  1.38s/it]  9%|▉         | 35/373 [00:44<06:22,  1.13s/it] 10%|▉         | 36/373 [00:46<08:12,  1.46s/it] 10%|▉         | 37/373 [00:47<06:48,  1.22s/it] 10%|█         | 38/373 [00:50<09:51,  1.77s/it] 11%|█         | 41/373 [00:51<05:01,  1.10it/s] 11%|█▏        | 42/373 [00:54<08:04,  1.46s/it] 12%|█▏        | 43/373 [00:56<08:13,  1.49s/it] 12%|█▏        | 45/373 [00:58<07:03,  1.29s/it] 13%|█▎        | 47/373 [01:01<07:50,  1.44s/it] 13%|█▎        | 50/373 [01:05<07:16,  1.35s/it] 14%|█▎        | 51/373 [01:05<06:32,  1.22s/it] 14%|█▍        | 53/373 [01:11<08:54,  1.67s/it] 15%|█▍        | 55/373 [01:11<06:23,  1.21s/it] 15%|█▌        | 56/373 [01:15<09:17,  1.76s/it] 15%|█▌        | 57/373 [01:18<10:38,  2.02s/it] 16%|█▌        | 58/373 [01:20<09:42,  1.85s/it] 16%|█▌        | 59/373 [01:22<10:37,  2.03s/it] 16%|█▋        | 61/373 [01:32<16:29,  3.17s/it] 17%|█▋        | 65/373 [01:36<10:30,  2.05s/it] 18%|█▊        | 69/373 [01:36<05:57,  1.18s/it] 19%|█▉        | 70/373 [01:38<06:11,  1.22s/it] 19%|█▉        | 71/373 [01:41<07:40,  1.52s/it] 19%|█▉        | 72/373 [01:42<07:18,  1.46s/it] 20%|█▉        | 73/373 [01:45<08:32,  1.71s/it] 20%|██        | 75/373 [01:47<07:09,  1.44s/it] 20%|██        | 76/373 [01:49<07:37,  1.54s/it] 21%|██        | 78/373 [01:50<05:45,  1.17s/it] 21%|██        | 79/373 [01:55<10:00,  2.04s/it] 22%|██▏       | 81/373 [01:56<07:26,  1.53s/it] 23%|██▎       | 84/373 [01:58<04:58,  1.03s/it] 23%|██▎       | 85/373 [01:58<04:38,  1.04it/s] 23%|██▎       | 87/373 [02:00<04:39,  1.02it/s] 24%|██▎       | 88/373 [02:05<07:57,  1.68s/it] 24%|██▍       | 91/373 [02:06<04:47,  1.02s/it] 25%|██▍       | 93/373 [02:08<04:53,  1.05s/it] 25%|██▌       | 94/373 [02:11<06:54,  1.49s/it] 25%|██▌       | 95/373 [02:15<08:54,  1.92s/it] 26%|██▌       | 97/373 [02:16<06:46,  1.47s/it] 27%|██▋       | 99/373 [02:17<05:00,  1.10s/it] 27%|██▋       | 100/373 [02:18<04:49,  1.06s/it] 27%|██▋       | 101/373 [02:18<04:03,  1.12it/s] 27%|██▋       | 102/373 [02:23<08:10,  1.81s/it] 28%|██▊       | 103/373 [02:27<10:23,  2.31s/it] 28%|██▊       | 104/373 [02:37<19:24,  4.33s/it] 29%|██▉       | 108/373 [02:39<09:14,  2.09s/it] 29%|██▉       | 110/373 [02:40<06:56,  1.58s/it] 30%|██▉       | 111/373 [02:44<08:33,  1.96s/it] 30%|███       | 112/373 [02:45<07:59,  1.84s/it] 31%|███       | 114/373 [02:48<07:14,  1.68s/it] 31%|███       | 115/373 [02:51<08:43,  2.03s/it] 32%|███▏      | 119/373 [02:52<04:31,  1.07s/it] 32%|███▏      | 120/373 [02:55<05:46,  1.37s/it] 32%|███▏      | 121/373 [02:58<06:58,  1.66s/it] 33%|███▎      | 123/373 [03:00<06:00,  1.44s/it] 34%|███▎      | 125/373 [03:01<04:19,  1.05s/it] 34%|███▍      | 126/373 [03:01<03:44,  1.10it/s] 34%|███▍      | 127/373 [03:04<05:29,  1.34s/it] 34%|███▍      | 128/373 [03:04<04:28,  1.10s/it] 35%|███▍      | 129/373 [03:07<06:35,  1.62s/it] 35%|███▌      | 131/373 [03:08<04:33,  1.13s/it] 35%|███▌      | 132/373 [03:11<05:31,  1.38s/it] 36%|███▌      | 134/373 [03:11<03:37,  1.10it/s] 36%|███▌      | 135/373 [03:13<04:29,  1.13s/it] 36%|███▋      | 136/373 [03:13<03:44,  1.06it/s] 37%|███▋      | 137/373 [03:14<03:27,  1.14it/s] 37%|███▋      | 138/373 [03:19<07:48,  1.99s/it] 38%|███▊      | 141/373 [03:21<05:07,  1.33s/it] 38%|███▊      | 143/373 [03:22<04:09,  1.09s/it] 39%|███▊      | 144/373 [03:23<04:04,  1.07s/it] 39%|███▉      | 145/373 [03:24<03:28,  1.09it/s] 39%|███▉      | 146/373 [03:28<06:34,  1.74s/it] 40%|███▉      | 149/373 [03:30<04:21,  1.17s/it] 40%|████      | 150/373 [03:31<04:25,  1.19s/it] 40%|████      | 151/373 [03:33<04:43,  1.28s/it] 41%|████      | 152/373 [03:34<04:28,  1.22s/it] 41%|████▏     | 154/373 [03:35<03:49,  1.05s/it] 42%|████▏     | 155/373 [03:37<04:06,  1.13s/it] 42%|████▏     | 156/373 [03:39<04:44,  1.31s/it] 42%|████▏     | 157/373 [03:39<03:55,  1.09s/it] 42%|████▏     | 158/373 [03:41<04:42,  1.32s/it] 43%|████▎     | 159/373 [03:45<07:01,  1.97s/it] 43%|████▎     | 162/373 [03:47<04:19,  1.23s/it] 44%|████▍     | 164/373 [03:49<04:14,  1.22s/it] 45%|████▍     | 166/373 [03:51<04:02,  1.17s/it] 45%|████▌     | 169/373 [03:55<04:18,  1.27s/it] 46%|████▌     | 171/373 [03:58<04:32,  1.35s/it] 46%|████▋     | 173/373 [03:59<03:31,  1.06s/it] 47%|████▋     | 175/373 [04:04<04:39,  1.41s/it] 47%|████▋     | 177/373 [04:05<03:49,  1.17s/it] 48%|████▊     | 179/373 [04:08<04:02,  1.25s/it] 49%|████▊     | 181/373 [04:08<02:52,  1.12it/s] 49%|████▉     | 182/373 [04:13<05:20,  1.68s/it] 50%|████▉     | 185/373 [04:16<04:03,  1.30s/it] 50%|████▉     | 186/373 [04:18<04:34,  1.47s/it] 50%|█████     | 188/373 [04:18<03:15,  1.06s/it] 51%|█████     | 189/373 [04:19<03:08,  1.03s/it] 51%|█████     | 190/373 [04:19<02:38,  1.16it/s] 51%|█████     | 191/373 [04:24<04:55,  1.63s/it] 51%|█████▏    | 192/373 [04:24<03:50,  1.27s/it] 52%|█████▏    | 194/373 [04:25<02:58,  1.01it/s] 52%|█████▏    | 195/373 [04:26<02:58,  1.00s/it] 53%|█████▎    | 197/373 [04:31<04:44,  1.61s/it] 54%|█████▎    | 200/373 [04:32<03:04,  1.07s/it] 54%|█████▍    | 201/373 [04:37<04:52,  1.70s/it] 55%|█████▍    | 205/373 [04:42<04:07,  1.47s/it] 55%|█████▌    | 206/373 [04:43<04:01,  1.44s/it] 56%|█████▌    | 208/373 [04:45<03:33,  1.30s/it] 56%|█████▌    | 209/373 [04:48<04:10,  1.53s/it] 56%|█████▋    | 210/373 [04:51<05:18,  1.95s/it] 57%|█████▋    | 213/373 [04:53<03:15,  1.22s/it] 57%|█████▋    | 214/373 [04:55<03:47,  1.43s/it] 58%|█████▊    | 216/373 [04:58<03:51,  1.47s/it] 58%|█████▊    | 218/373 [04:58<02:42,  1.05s/it] 59%|█████▊    | 219/373 [05:02<04:00,  1.56s/it] 59%|█████▉    | 220/373 [05:06<05:00,  1.96s/it] 60%|█████▉    | 223/373 [05:06<02:37,  1.05s/it] 60%|██████    | 224/373 [05:12<04:59,  2.01s/it] 61%|██████    | 226/373 [05:13<03:34,  1.46s/it] 61%|██████▏   | 229/373 [05:21<04:53,  2.04s/it] 62%|██████▏   | 233/373 [05:23<03:02,  1.31s/it] 63%|██████▎   | 235/373 [05:24<02:27,  1.07s/it] 63%|██████▎   | 236/373 [05:25<02:26,  1.07s/it] 64%|██████▎   | 237/373 [05:26<02:42,  1.19s/it] 64%|██████▍   | 238/373 [05:28<02:55,  1.30s/it] 64%|██████▍   | 239/373 [05:29<02:35,  1.16s/it] 64%|██████▍   | 240/373 [05:30<02:29,  1.13s/it] 65%|██████▍   | 241/373 [05:33<03:23,  1.54s/it] 65%|██████▌   | 244/373 [05:34<02:08,  1.00it/s] 66%|██████▌   | 245/373 [05:35<02:07,  1.01it/s] 66%|██████▌   | 246/373 [05:36<02:16,  1.08s/it] 66%|██████▌   | 247/373 [05:37<01:51,  1.13it/s] 66%|██████▋   | 248/373 [05:37<01:34,  1.33it/s] 67%|██████▋   | 249/373 [05:40<02:49,  1.37s/it] 67%|██████▋   | 250/373 [05:43<03:37,  1.77s/it] 68%|██████▊   | 253/373 [05:49<03:44,  1.87s/it] 69%|██████▉   | 257/373 [05:52<02:40,  1.38s/it] 69%|██████▉   | 259/373 [05:53<02:07,  1.12s/it] 70%|██████▉   | 261/373 [05:54<01:45,  1.06it/s] 70%|███████   | 262/373 [05:56<01:52,  1.01s/it] 71%|███████   | 264/373 [06:02<03:12,  1.76s/it] 71%|███████▏  | 266/373 [06:04<02:39,  1.49s/it] 72%|███████▏  | 268/373 [06:08<02:51,  1.64s/it] 72%|███████▏  | 270/373 [06:10<02:23,  1.40s/it] 73%|███████▎  | 272/373 [06:10<01:44,  1.03s/it] 73%|███████▎  | 273/373 [06:11<01:42,  1.03s/it] 73%|███████▎  | 274/373 [06:13<02:03,  1.25s/it] 74%|███████▎  | 275/373 [06:16<02:28,  1.52s/it] 74%|███████▍  | 277/373 [06:16<01:31,  1.05it/s] 75%|███████▍  | 278/373 [06:19<02:12,  1.39s/it] 75%|███████▍  | 279/373 [06:21<02:37,  1.68s/it] 75%|███████▌  | 280/373 [06:22<02:03,  1.32s/it] 75%|███████▌  | 281/373 [06:25<02:42,  1.76s/it] 76%|███████▌  | 282/373 [06:25<02:06,  1.39s/it] 76%|███████▌  | 284/373 [06:30<02:45,  1.85s/it] 76%|███████▋  | 285/373 [06:32<02:41,  1.83s/it] 77%|███████▋  | 288/373 [06:34<01:50,  1.30s/it] 77%|███████▋  | 289/373 [06:41<03:20,  2.38s/it] 79%|███████▊  | 293/373 [06:45<02:18,  1.73s/it] 79%|███████▉  | 296/373 [06:48<01:45,  1.37s/it] 80%|███████▉  | 297/373 [06:50<01:58,  1.55s/it] 80%|███████▉  | 298/373 [06:57<03:09,  2.53s/it] 81%|████████  | 303/373 [07:01<01:47,  1.54s/it] 82%|████████▏ | 305/373 [07:03<01:30,  1.33s/it] 82%|████████▏ | 306/373 [07:04<01:31,  1.36s/it] 82%|████████▏ | 307/373 [07:05<01:27,  1.33s/it] 83%|████████▎ | 308/373 [07:08<01:45,  1.63s/it] 83%|████████▎ | 309/373 [07:09<01:38,  1.54s/it] 83%|████████▎ | 311/373 [07:10<01:08,  1.11s/it] 84%|████████▎ | 312/373 [07:14<01:42,  1.69s/it] 84%|████████▍ | 313/373 [07:16<01:53,  1.89s/it] 84%|████████▍ | 314/373 [07:17<01:26,  1.46s/it] 84%|████████▍ | 315/373 [07:18<01:16,  1.31s/it] 85%|████████▍ | 316/373 [07:19<01:20,  1.40s/it] 85%|████████▌ | 318/373 [07:21<01:06,  1.21s/it] 86%|████████▌ | 319/373 [07:23<01:07,  1.26s/it] 86%|████████▌ | 321/373 [07:25<01:09,  1.34s/it] 87%|████████▋ | 323/373 [07:26<00:51,  1.02s/it] 87%|████████▋ | 324/373 [07:28<00:56,  1.15s/it] 87%|████████▋ | 325/373 [07:29<00:57,  1.20s/it] 88%|████████▊ | 327/373 [07:30<00:39,  1.15it/s] 88%|████████▊ | 328/373 [07:32<00:48,  1.08s/it] 88%|████████▊ | 330/373 [07:34<00:48,  1.12s/it] 89%|████████▊ | 331/373 [07:35<00:46,  1.10s/it] 89%|████████▉ | 332/373 [07:45<02:04,  3.03s/it] 91%|█████████ | 338/373 [07:45<00:36,  1.06s/it] 91%|█████████ | 339/373 [07:49<00:51,  1.50s/it] 92%|█████████▏| 342/373 [07:51<00:35,  1.15s/it] 92%|█████████▏| 343/373 [07:51<00:31,  1.04s/it] 92%|█████████▏| 344/373 [07:52<00:27,  1.05it/s] 92%|█████████▏| 345/373 [07:58<00:57,  2.06s/it] 93%|█████████▎| 348/373 [07:59<00:28,  1.14s/it] 94%|█████████▎| 349/373 [08:00<00:28,  1.18s/it] 94%|█████████▍| 350/373 [08:05<00:44,  1.92s/it] 94%|█████████▍| 352/373 [08:10<00:46,  2.20s/it] 95%|█████████▌| 356/373 [08:13<00:24,  1.43s/it] 96%|█████████▌| 357/373 [08:13<00:20,  1.26s/it] 96%|█████████▌| 358/373 [08:19<00:29,  1.99s/it] 97%|█████████▋| 360/373 [08:20<00:20,  1.59s/it] 97%|█████████▋| 362/373 [08:23<00:17,  1.57s/it] 98%|█████████▊| 365/373 [08:24<00:07,  1.04it/s] 98%|█████████▊| 366/373 [08:26<00:08,  1.16s/it] 99%|█████████▊| 368/373 [08:28<00:05,  1.07s/it] 99%|█████████▉| 369/373 [08:29<00:04,  1.20s/it] 99%|█████████▉| 370/373 [08:36<00:06,  2.24s/it]100%|██████████| 373/373 [08:36<00:00,  1.38s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-26 20:11:03
[INFO] duration: 11 min 
[2024-09-27 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-25/2024-09-25_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-27 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 49, in extract_datetime_from_input
    return datetime.strptime(datetime_str, "%Y-%m-%d %H:%M:%S")
           ^^^^^^^^
NameError: name 'datetime' is not defined

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-25/2024-09-25_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-25
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-25/2024-09-25_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-25/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-25/2024-09-25_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-09-27 20:00:22
[INFO] duration: 0 min 
[2024-09-28 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-26/2024-09-26_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-28 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 49, in extract_datetime_from_input
    return datetime.strptime(datetime_str, "%Y-%m-%d %H:%M:%S")
           ^^^^^^^^
NameError: name 'datetime' is not defined

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-26/2024-09-26_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-26
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-26/2024-09-26_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-26/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-26/2024-09-26_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-09-28 20:00:24
[INFO] duration: 0 min 
[2024-09-29 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-27/2024-09-27_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-29 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 49, in extract_datetime_from_input
    return datetime.strptime(datetime_str, "%Y-%m-%d %H:%M:%S")
           ^^^^^^^^
NameError: name 'datetime' is not defined

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-27/2024-09-27_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-27
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-27/2024-09-27_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-27/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-27/2024-09-27_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-09-29 20:00:23
[INFO] duration: 0 min 
[2024-09-30 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-28/2024-09-28_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-30 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 49, in extract_datetime_from_input
    return datetime.strptime(datetime_str, "%Y-%m-%d %H:%M:%S")
           ^^^^^^^^
NameError: name 'datetime' is not defined

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-28/2024-09-28_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-28
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-28/2024-09-28_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-28/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-28/2024-09-28_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-09-30 20:00:21
[INFO] duration: 0 min 
[2024-10-01 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-29/2024-09-29_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-01 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 49, in extract_datetime_from_input
    return datetime.strptime(datetime_str, "%Y-%m-%d %H:%M:%S")
           ^^^^^^^^
NameError: name 'datetime' is not defined

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-29/2024-09-29_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-29
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-29/2024-09-29_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-29/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-29/2024-09-29_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-01 20:00:25
[INFO] duration: 0 min 
[2024-10-02 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-30/2024-09-30_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-02 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-30/2024-09-30_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-09-30
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-30/2024-09-30_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-09-30/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-09-30/2024-09-30_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-02 20:00:26
[INFO] duration: 0 min 
[2024-10-03 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-01/2024-10-01_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-03 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-01/2024-10-01_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-01
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-01/2024-10-01_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-01/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-01/2024-10-01_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-03 20:00:21
[INFO] duration: 0 min 
[2024-10-04 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-02/2024-10-02_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-10-05 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-03/2024-10-03_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-10-06 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-04/2024-10-04_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-10-07 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-05/2024-10-05_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-10-08 20:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-06/2024-10-06_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-08 20:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-06/2024-10-06_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-06
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-06/2024-10-06_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-06/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-06/2024-10-06_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-08 20:00:20
[INFO] duration: 0 min 
[2024-10-09 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-07/2024-10-07_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-09 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 46, in get_distillation_data
    df = DataFilter.filter_bad_df(df, self.config)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-07/2024-10-07_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-07
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-07/2024-10-07_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-07/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-07/2024-10-07_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-09 20:00:26
[INFO] duration: 0 min 
[2024-10-10 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-08/2024-10-08_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-10 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 44, in get_distillation_data
    df = df[~df['taskformer-model-13b-input'].isna()]
             ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-08/2024-10-08_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-08
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-08/2024-10-08_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-08/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-08/2024-10-08_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-10 20:00:27
[INFO] duration: 0 min 
[2024-10-11 20:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-09/2024-10-09_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-11 20:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 44, in get_distillation_data
    df = df[~df['taskformer-model-13b-input'].isna()]
             ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-09/2024-10-09_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-09
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-09/2024-10-09_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-09/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-09/2024-10-09_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-11 20:00:58
[INFO] duration: 0 min 
[2024-10-12 12:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-10/2024-10-10_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-12 12:00:02
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 44, in get_distillation_data
    df = df[~df['taskformer-model-13b-input'].isna()]
             ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-10/2024-10-10_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-10
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-10/2024-10-10_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-10/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-10/2024-10-10_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-12 12:00:17
[INFO] duration: 0 min 
[2024-10-13 12:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-11/2024-10-11_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-13 12:00:01
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 44, in get_distillation_data
    df = df[~df['taskformer-model-13b-input'].isna()]
             ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-11/2024-10-11_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-11
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-11/2024-10-11_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-11/raw/single_True_rag_True
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-11/2024-10-11_rule_labeled.csv.gpt_labeled.csv
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 104, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_raw_log_distillation.py", line 62, in get_distillation_data
    self.check_and_generate_gpt4_files(outfolder, prompt_path)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/base_distillation.py", line 81, in check_and_generate_gpt4_files
    if not missing_files and (wrong_data_count / total_data_count) <= 0.5:
                              ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
ZeroDivisionError: division by zero
[INFO] end_time: 2024-10-13 12:00:16
[INFO] duration: 0 min 
[2024-10-14 12:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_car_distillation_log_raw_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-12/2024-10-12_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-14 12:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:302: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Arguments: Namespace(is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-12/2024-10-12_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh')
Processing distillation data for date: 2024-10-12
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data-car/2024-10-12/2024-10-12_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-12/raw/single_True_rag_True
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation_car/2024-10-12/raw/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 467 / 467
  0%|          | 0/467 [00:00<?, ?it/s]  0%|          | 1/467 [00:07<57:05,  7.35s/it]  0%|          | 2/467 [00:09<35:25,  4.57s/it]  1%|          | 4/467 [00:11<16:12,  2.10s/it]  1%|          | 5/467 [00:12<15:06,  1.96s/it]  1%|▏         | 6/467 [00:13<12:02,  1.57s/it]  1%|▏         | 7/467 [00:14<10:54,  1.42s/it]  2%|▏         | 8/467 [00:15<09:08,  1.20s/it]  2%|▏         | 9/467 [00:18<13:28,  1.76s/it]  3%|▎         | 12/467 [00:19<07:34,  1.00it/s]  3%|▎         | 13/467 [00:21<09:24,  1.24s/it]  3%|▎         | 14/467 [00:22<08:31,  1.13s/it]  3%|▎         | 15/467 [00:30<21:31,  2.86s/it]  3%|▎         | 16/467 [00:31<16:46,  2.23s/it]  4%|▍         | 18/467 [00:32<11:55,  1.59s/it]  4%|▍         | 19/467 [00:33<10:21,  1.39s/it]  4%|▍         | 20/467 [00:34<09:41,  1.30s/it]  4%|▍         | 21/467 [00:42<22:37,  3.04s/it]  6%|▌         | 28/467 [00:50<12:04,  1.65s/it]  7%|▋         | 32/467 [00:55<11:17,  1.56s/it]  8%|▊         | 36/467 [00:58<09:09,  1.27s/it]  8%|▊         | 37/467 [01:02<10:49,  1.51s/it]  8%|▊         | 38/467 [01:02<09:55,  1.39s/it]  9%|▊         | 40/467 [01:05<09:45,  1.37s/it]  9%|▉         | 41/467 [01:08<12:17,  1.73s/it]  9%|▉         | 43/467 [01:11<11:27,  1.62s/it] 10%|▉         | 45/467 [01:13<10:21,  1.47s/it] 10%|▉         | 46/467 [01:14<08:40,  1.24s/it] 10%|█         | 47/467 [01:15<09:34,  1.37s/it] 10%|█         | 48/467 [01:18<10:39,  1.53s/it] 11%|█         | 50/467 [01:20<09:18,  1.34s/it] 11%|█         | 52/467 [01:26<14:04,  2.03s/it] 12%|█▏        | 55/467 [01:37<18:19,  2.67s/it] 13%|█▎        | 61/467 [01:41<10:35,  1.57s/it] 14%|█▎        | 64/467 [01:42<08:22,  1.25s/it] 14%|█▍        | 65/467 [01:43<07:55,  1.18s/it] 14%|█▍        | 66/467 [01:45<09:14,  1.38s/it] 15%|█▍        | 68/467 [01:47<08:10,  1.23s/it] 15%|█▍        | 69/467 [01:53<13:33,  2.05s/it] 15%|█▌        | 72/467 [01:59<13:20,  2.03s/it] 16%|█▋        | 76/467 [01:59<07:30,  1.15s/it] 17%|█▋        | 78/467 [02:05<09:53,  1.53s/it] 17%|█▋        | 81/467 [02:09<09:49,  1.53s/it] 18%|█▊        | 83/467 [02:10<07:53,  1.23s/it] 18%|█▊        | 85/467 [02:14<09:21,  1.47s/it] 19%|█▊        | 87/467 [02:14<07:01,  1.11s/it] 19%|█▉        | 88/467 [02:17<08:28,  1.34s/it] 19%|█▉        | 89/467 [02:19<09:05,  1.44s/it] 19%|█▉        | 91/467 [02:21<07:45,  1.24s/it] 20%|█▉        | 93/467 [02:24<08:11,  1.31s/it] 20%|██        | 94/467 [02:25<08:03,  1.30s/it] 21%|██        | 96/467 [02:28<08:55,  1.44s/it] 21%|██        | 99/467 [02:29<06:07,  1.00it/s] 21%|██▏       | 100/467 [02:30<05:53,  1.04it/s] 22%|██▏       | 101/467 [02:34<08:38,  1.42s/it] 22%|██▏       | 104/467 [02:35<06:02,  1.00it/s] 22%|██▏       | 105/467 [02:35<05:24,  1.12it/s] 23%|██▎       | 106/467 [02:36<05:25,  1.11it/s] 23%|██▎       | 107/467 [02:38<06:46,  1.13s/it] 23%|██▎       | 109/467 [02:41<07:07,  1.19s/it] 24%|██▎       | 110/467 [02:42<06:24,  1.08s/it] 24%|██▍       | 111/467 [02:42<06:08,  1.04s/it] 24%|██▍       | 112/467 [02:44<07:02,  1.19s/it] 24%|██▍       | 113/467 [02:45<07:20,  1.24s/it] 24%|██▍       | 114/467 [02:47<08:24,  1.43s/it] 25%|██▍       | 115/467 [02:52<13:33,  2.31s/it] 25%|██▌       | 119/467 [02:57<09:25,  1.62s/it] 26%|██▌       | 122/467 [03:00<07:53,  1.37s/it] 27%|██▋       | 125/467 [03:09<11:08,  1.96s/it] 28%|██▊       | 129/467 [03:10<07:08,  1.27s/it] 28%|██▊       | 130/467 [03:12<08:10,  1.46s/it] 28%|██▊       | 133/467 [03:17<08:15,  1.48s/it] 29%|██▉       | 136/467 [03:18<05:48,  1.05s/it] 29%|██▉       | 137/467 [03:19<06:17,  1.14s/it] 30%|██▉       | 138/467 [03:20<05:46,  1.05s/it] 30%|██▉       | 139/467 [03:22<07:07,  1.30s/it] 30%|███       | 141/467 [03:34<15:36,  2.87s/it] 31%|███▏      | 146/467 [03:37<08:54,  1.66s/it] 32%|███▏      | 149/467 [03:38<06:02,  1.14s/it] 32%|███▏      | 150/467 [03:42<08:06,  1.54s/it] 32%|███▏      | 151/467 [03:44<08:27,  1.61s/it] 33%|███▎      | 155/467 [03:48<06:53,  1.33s/it] 33%|███▎      | 156/467 [03:48<06:03,  1.17s/it] 34%|███▍      | 158/467 [03:51<06:51,  1.33s/it] 34%|███▍      | 160/467 [03:53<05:57,  1.16s/it] 34%|███▍      | 161/467 [03:56<07:33,  1.48s/it] 35%|███▍      | 162/467 [03:56<06:29,  1.28s/it] 35%|███▌      | 164/467 [04:00<07:05,  1.40s/it] 36%|███▌      | 166/467 [04:00<05:01,  1.00s/it] 36%|███▌      | 167/467 [04:02<05:42,  1.14s/it] 36%|███▌      | 168/467 [04:02<05:10,  1.04s/it] 36%|███▌      | 169/467 [04:03<05:01,  1.01s/it] 36%|███▋      | 170/467 [04:04<04:58,  1.00s/it] 37%|███▋      | 171/467 [04:05<04:45,  1.04it/s] 37%|███▋      | 172/467 [04:06<04:03,  1.21it/s] 37%|███▋      | 173/467 [04:07<04:49,  1.02it/s] 37%|███▋      | 174/467 [04:11<08:39,  1.77s/it] 38%|███▊      | 176/467 [04:13<06:55,  1.43s/it] 38%|███▊      | 177/467 [04:15<07:28,  1.55s/it] 38%|███▊      | 179/467 [04:15<04:47,  1.00it/s] 39%|███▊      | 180/467 [04:16<05:11,  1.08s/it] 39%|███▉      | 181/467 [04:21<08:38,  1.81s/it] 39%|███▉      | 184/467 [04:22<05:21,  1.14s/it] 40%|███▉      | 185/467 [04:24<06:15,  1.33s/it] 40%|████      | 187/467 [04:29<07:42,  1.65s/it] 41%|████      | 190/467 [04:31<05:59,  1.30s/it] 41%|████      | 192/467 [04:33<05:14,  1.15s/it] 41%|████▏     | 193/467 [04:35<06:27,  1.41s/it] 42%|████▏     | 195/467 [04:37<05:13,  1.15s/it] 42%|████▏     | 196/467 [04:39<06:08,  1.36s/it] 42%|████▏     | 197/467 [04:40<05:44,  1.28s/it] 42%|████▏     | 198/467 [04:41<05:42,  1.27s/it] 43%|████▎     | 199/467 [04:44<07:08,  1.60s/it] 43%|████▎     | 200/467 [04:46<07:41,  1.73s/it] 43%|████▎     | 202/467 [04:54<11:49,  2.68s/it] 45%|████▍     | 208/467 [05:01<07:35,  1.76s/it] 46%|████▌     | 213/467 [05:03<04:44,  1.12s/it] 46%|████▌     | 214/467 [05:04<04:40,  1.11s/it] 46%|████▋     | 216/467 [05:07<05:10,  1.24s/it] 47%|████▋     | 218/467 [05:07<04:03,  1.02it/s] 47%|████▋     | 219/467 [05:09<04:31,  1.09s/it] 48%|████▊     | 222/467 [05:13<04:54,  1.20s/it] 48%|████▊     | 223/467 [05:21<09:14,  2.27s/it] 49%|████▉     | 229/467 [05:36<09:24,  2.37s/it] 50%|█████     | 234/467 [05:39<06:28,  1.67s/it] 51%|█████     | 236/467 [05:42<06:11,  1.61s/it] 51%|█████     | 237/467 [05:48<08:29,  2.22s/it] 52%|█████▏    | 241/467 [05:53<06:34,  1.75s/it] 52%|█████▏    | 244/467 [05:54<05:12,  1.40s/it] 52%|█████▏    | 245/467 [05:55<04:35,  1.24s/it] 53%|█████▎    | 246/467 [05:56<04:43,  1.28s/it] 53%|█████▎    | 247/467 [05:58<04:54,  1.34s/it] 53%|█████▎    | 248/467 [06:03<07:33,  2.07s/it] 54%|█████▎    | 251/467 [06:05<05:22,  1.49s/it] 54%|█████▍    | 252/467 [06:06<04:51,  1.36s/it] 54%|█████▍    | 254/467 [06:08<04:18,  1.22s/it] 55%|█████▍    | 255/467 [06:08<03:51,  1.09s/it] 55%|█████▍    | 256/467 [06:09<03:32,  1.01s/it] 55%|█████▌    | 257/467 [06:10<03:25,  1.02it/s] 55%|█████▌    | 258/467 [06:11<03:28,  1.00it/s] 55%|█████▌    | 259/467 [06:14<05:41,  1.64s/it] 56%|█████▌    | 261/467 [06:17<05:05,  1.48s/it] 56%|█████▋    | 263/467 [06:25<08:36,  2.53s/it] 57%|█████▋    | 267/467 [06:26<04:19,  1.30s/it] 58%|█████▊    | 269/467 [06:27<03:37,  1.10s/it] 58%|█████▊    | 270/467 [06:28<03:10,  1.03it/s] 58%|█████▊    | 271/467 [06:28<02:41,  1.21it/s] 58%|█████▊    | 272/467 [06:32<04:59,  1.54s/it] 59%|█████▊    | 274/467 [06:32<03:09,  1.02it/s] 59%|█████▉    | 275/467 [06:33<03:06,  1.03it/s] 59%|█████▉    | 276/467 [06:34<03:11,  1.00s/it] 59%|█████▉    | 277/467 [06:37<04:44,  1.50s/it] 60%|█████▉    | 279/467 [06:40<04:19,  1.38s/it] 60%|█████▉    | 280/467 [06:41<04:32,  1.46s/it] 60%|██████    | 282/467 [06:43<04:01,  1.31s/it] 61%|██████    | 283/467 [06:48<05:57,  1.94s/it] 61%|██████    | 286/467 [06:48<03:14,  1.07s/it] 61%|██████▏   | 287/467 [06:50<03:47,  1.26s/it] 62%|██████▏   | 288/467 [06:51<03:36,  1.21s/it] 62%|██████▏   | 289/467 [06:53<03:49,  1.29s/it] 62%|██████▏   | 290/467 [06:53<03:23,  1.15s/it] 63%|██████▎   | 292/467 [06:55<02:40,  1.09it/s] 63%|██████▎   | 293/467 [06:58<04:15,  1.47s/it] 63%|██████▎   | 296/467 [06:59<02:40,  1.07it/s] 64%|██████▎   | 297/467 [07:01<03:03,  1.08s/it] 64%|██████▍   | 298/467 [07:01<02:43,  1.04it/s] 64%|██████▍   | 299/467 [07:03<02:59,  1.07s/it] 64%|██████▍   | 300/467 [07:05<03:45,  1.35s/it] 65%|██████▍   | 302/467 [07:07<03:24,  1.24s/it] 65%|██████▍   | 303/467 [07:10<04:18,  1.58s/it] 65%|██████▌   | 305/467 [07:11<03:17,  1.22s/it] 66%|██████▌   | 306/467 [07:15<04:38,  1.73s/it] 66%|██████▌   | 309/467 [07:17<03:30,  1.33s/it] 66%|██████▋   | 310/467 [07:19<03:48,  1.45s/it] 67%|██████▋   | 311/467 [07:24<05:40,  2.18s/it] 67%|██████▋   | 312/467 [07:25<04:48,  1.86s/it] 67%|██████▋   | 315/467 [07:26<02:46,  1.09s/it] 68%|██████▊   | 316/467 [07:27<02:51,  1.14s/it] 68%|██████▊   | 317/467 [07:28<02:49,  1.13s/it] 68%|██████▊   | 318/467 [07:30<02:52,  1.16s/it] 68%|██████▊   | 319/467 [07:31<02:39,  1.08s/it] 69%|██████▊   | 320/467 [07:32<02:36,  1.07s/it] 69%|██████▊   | 321/467 [07:34<03:26,  1.41s/it] 69%|██████▉   | 322/467 [07:34<02:33,  1.06s/it] 69%|██████▉   | 323/467 [07:37<03:59,  1.67s/it] 70%|██████▉   | 325/467 [07:39<02:56,  1.25s/it] 70%|██████▉   | 326/467 [07:39<02:25,  1.03s/it] 70%|███████   | 327/467 [07:44<04:54,  2.11s/it] 71%|███████   | 330/467 [07:45<02:34,  1.13s/it] 71%|███████   | 331/467 [07:49<03:58,  1.75s/it] 71%|███████▏  | 333/467 [07:52<03:27,  1.55s/it] 72%|███████▏  | 334/467 [07:52<03:05,  1.39s/it] 72%|███████▏  | 335/467 [07:55<03:47,  1.73s/it] 72%|███████▏  | 337/467 [07:57<02:57,  1.37s/it] 72%|███████▏  | 338/467 [07:59<03:17,  1.53s/it] 73%|███████▎  | 339/467 [08:02<04:04,  1.91s/it] 73%|███████▎  | 341/467 [08:08<05:00,  2.39s/it] 74%|███████▍  | 345/467 [08:10<02:34,  1.27s/it] 74%|███████▍  | 346/467 [08:10<02:24,  1.20s/it] 74%|███████▍  | 347/467 [08:10<01:59,  1.01it/s] 75%|███████▍  | 348/467 [08:12<02:12,  1.11s/it] 75%|███████▍  | 349/467 [08:13<02:11,  1.12s/it] 75%|███████▍  | 350/467 [08:13<01:47,  1.09it/s] 75%|███████▌  | 351/467 [08:16<02:21,  1.22s/it] 75%|███████▌  | 352/467 [08:18<02:52,  1.50s/it] 76%|███████▌  | 354/467 [08:19<02:13,  1.18s/it] 76%|███████▌  | 356/467 [08:20<01:40,  1.10it/s] 77%|███████▋  | 358/467 [08:22<01:40,  1.09it/s] 77%|███████▋  | 359/467 [08:23<01:33,  1.16it/s] 77%|███████▋  | 361/467 [08:25<01:42,  1.04it/s] 78%|███████▊  | 362/467 [08:26<01:38,  1.07it/s] 78%|███████▊  | 363/467 [08:26<01:19,  1.31it/s] 78%|███████▊  | 364/467 [08:30<02:38,  1.53s/it] 78%|███████▊  | 366/467 [08:32<02:10,  1.30s/it] 79%|███████▊  | 367/467 [08:33<01:57,  1.18s/it] 79%|███████▉  | 368/467 [08:35<02:24,  1.46s/it] 79%|███████▉  | 369/467 [08:36<01:58,  1.21s/it] 79%|███████▉  | 370/467 [08:38<02:20,  1.45s/it] 79%|███████▉  | 371/467 [08:38<02:02,  1.28s/it] 80%|███████▉  | 373/467 [08:43<02:47,  1.78s/it] 80%|████████  | 375/467 [08:44<01:46,  1.15s/it] 81%|████████  | 376/467 [08:52<03:59,  2.63s/it] 81%|████████  | 379/467 [08:52<02:09,  1.47s/it] 82%|████████▏ | 381/467 [08:54<01:53,  1.32s/it] 82%|████████▏ | 382/467 [08:56<01:58,  1.39s/it] 82%|████████▏ | 384/467 [09:05<03:30,  2.54s/it] 83%|████████▎ | 389/467 [09:08<01:47,  1.37s/it] 84%|████████▍ | 392/467 [09:10<01:31,  1.22s/it] 84%|████████▍ | 394/467 [09:13<01:36,  1.32s/it] 85%|████████▍ | 395/467 [09:14<01:25,  1.19s/it] 85%|████████▍ | 396/467 [09:16<01:29,  1.27s/it] 85%|████████▌ | 397/467 [09:17<01:33,  1.34s/it] 85%|████████▌ | 399/467 [09:24<02:20,  2.06s/it] 86%|████████▋ | 403/467 [09:26<01:20,  1.26s/it] 87%|████████▋ | 404/467 [09:30<01:49,  1.74s/it] 87%|████████▋ | 407/467 [09:33<01:28,  1.48s/it] 87%|████████▋ | 408/467 [09:37<01:46,  1.81s/it] 88%|████████▊ | 411/467 [09:40<01:21,  1.45s/it] 88%|████████▊ | 412/467 [09:42<01:25,  1.56s/it] 89%|████████▊ | 414/467 [09:43<01:03,  1.21s/it] 89%|████████▉ | 415/467 [09:45<01:14,  1.43s/it] 89%|████████▉ | 417/467 [09:50<01:26,  1.72s/it] 90%|████████▉ | 420/467 [09:54<01:11,  1.52s/it] 90%|█████████ | 421/467 [09:55<01:06,  1.45s/it] 91%|█████████ | 423/467 [09:56<00:52,  1.20s/it] 91%|█████████ | 424/467 [10:01<01:22,  1.92s/it] 92%|█████████▏| 429/467 [10:06<00:53,  1.41s/it] 93%|█████████▎| 432/467 [10:09<00:45,  1.29s/it] 93%|█████████▎| 433/467 [10:10<00:41,  1.21s/it] 93%|█████████▎| 435/467 [10:11<00:33,  1.06s/it] 93%|█████████▎| 436/467 [10:16<00:53,  1.72s/it] 94%|█████████▍| 440/467 [10:18<00:30,  1.13s/it] 95%|█████████▍| 442/467 [10:20<00:24,  1.00it/s] 95%|█████████▍| 443/467 [10:21<00:26,  1.11s/it] 95%|█████████▌| 445/467 [10:23<00:23,  1.08s/it] 96%|█████████▌| 448/467 [10:27<00:21,  1.12s/it] 96%|█████████▌| 449/467 [10:28<00:19,  1.06s/it] 97%|█████████▋| 451/467 [10:29<00:15,  1.02it/s] 97%|█████████▋| 452/467 [10:32<00:19,  1.28s/it] 97%|█████████▋| 454/467 [10:33<00:13,  1.03s/it] 97%|█████████▋| 455/467 [10:34<00:12,  1.03s/it] 98%|█████████▊| 457/467 [10:37<00:12,  1.27s/it] 98%|█████████▊| 459/467 [10:39<00:08,  1.05s/it] 99%|█████████▊| 460/467 [10:39<00:06,  1.11it/s] 99%|█████████▊| 461/467 [10:40<00:05,  1.06it/s] 99%|█████████▉| 462/467 [10:42<00:06,  1.23s/it] 99%|█████████▉| 464/467 [10:46<00:04,  1.42s/it]100%|██████████| 467/467 [10:48<00:00,  1.13s/it]100%|██████████| 467/467 [10:48<00:00,  1.39s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-10-14 12:13:12
[INFO] duration: 13 min 
