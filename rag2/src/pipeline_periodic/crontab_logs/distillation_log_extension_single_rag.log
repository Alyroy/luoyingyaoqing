[2024-08-21 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-19/prod/2024-08-19_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-21 22:00:02
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 41
    def split_you_time_command_queries(self,query_ls:list) -> list, list[dict]:
                                                                  ^
SyntaxError: expected ':'
[INFO] end_time: 2024-08-21 22:00:02  
[INFO] duration: 0 min 
[2024-08-22 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-20/prod/2024-08-20_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-22 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:30: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default=None)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(date='2024-08-20', api_url='http://172.24.162.100:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-20
Input folder: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-20
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-20/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-20/prod/2024-08-20_rule_labeled.csv.gpt_labeled.csv
  0%|          | 0/29 [00:00<?, ?it/s]  7%|▋         | 2/29 [00:00<00:12,  2.15it/s] 10%|█         | 3/29 [00:02<00:19,  1.35it/s] 14%|█▍        | 4/29 [00:03<00:20,  1.19it/s] 17%|█▋        | 5/29 [00:04<00:22,  1.08it/s] 21%|██        | 6/29 [00:05<00:22,  1.03it/s] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s] 31%|███       | 9/29 [00:07<00:14,  1.40it/s] 34%|███▍      | 10/29 [00:08<00:15,  1.21it/s] 38%|███▊      | 11/29 [00:09<00:15,  1.14it/s] 41%|████▏     | 12/29 [00:10<00:15,  1.09it/s] 45%|████▍     | 13/29 [00:11<00:15,  1.04it/s] 48%|████▊     | 14/29 [00:12<00:15,  1.00s/it] 52%|█████▏    | 15/29 [00:13<00:14,  1.02s/it] 55%|█████▌    | 16/29 [00:14<00:13,  1.03s/it] 59%|█████▊    | 17/29 [00:15<00:12,  1.02s/it] 62%|██████▏   | 18/29 [00:16<00:11,  1.06s/it] 66%|██████▌   | 19/29 [00:17<00:10,  1.04s/it] 69%|██████▉   | 20/29 [00:18<00:09,  1.04s/it] 72%|███████▏  | 21/29 [00:19<00:08,  1.07s/it] 76%|███████▌  | 22/29 [00:20<00:07,  1.04s/it] 79%|███████▉  | 23/29 [00:21<00:05,  1.01it/s] 83%|████████▎ | 24/29 [00:22<00:05,  1.01s/it] 86%|████████▌ | 25/29 [00:23<00:04,  1.00s/it] 90%|████████▉ | 26/29 [00:24<00:03,  1.03s/it] 93%|█████████▎| 27/29 [00:26<00:02,  1.06s/it] 97%|█████████▋| 28/29 [00:27<00:01,  1.03s/it]100%|██████████| 29/29 [00:28<00:00,  1.05s/it]100%|██████████| 29/29 [00:29<00:00,  1.01s/it]
Error occurred: invalid syntax (<unknown>, line 1)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:02<01:15,  2.81s/it]  7%|▋         | 2/28 [00:06<01:23,  3.21s/it] 11%|█         | 3/28 [00:09<01:22,  3.31s/it] 14%|█▍        | 4/28 [00:13<01:22,  3.42s/it] 18%|█▊        | 5/28 [00:16<01:18,  3.41s/it] 21%|██▏       | 6/28 [00:18<01:06,  3.01s/it] 25%|██▌       | 7/28 [00:22<01:06,  3.16s/it] 29%|██▊       | 8/28 [00:25<01:04,  3.24s/it] 32%|███▏      | 9/28 [00:28<00:57,  3.01s/it] 36%|███▌      | 10/28 [00:31<00:55,  3.10s/it] 39%|███▉      | 11/28 [00:34<00:53,  3.16s/it] 43%|████▎     | 12/28 [00:37<00:47,  3.00s/it] 46%|████▋     | 13/28 [00:40<00:43,  2.88s/it] 50%|█████     | 14/28 [00:43<00:42,  3.01s/it] 54%|█████▎    | 15/28 [00:53<01:06,  5.09s/it] 57%|█████▋    | 16/28 [00:55<00:50,  4.18s/it] 61%|██████    | 17/28 [00:58<00:43,  3.92s/it] 64%|██████▍   | 18/28 [01:01<00:34,  3.48s/it] 68%|██████▊   | 19/28 [01:04<00:31,  3.50s/it] 71%|███████▏  | 20/28 [01:08<00:27,  3.46s/it] 75%|███████▌  | 21/28 [01:11<00:23,  3.40s/it] 79%|███████▊  | 22/28 [01:14<00:20,  3.41s/it] 82%|████████▏ | 23/28 [01:18<00:17,  3.44s/it] 86%|████████▌ | 24/28 [01:21<00:13,  3.45s/it] 89%|████████▉ | 25/28 [01:24<00:09,  3.24s/it] 93%|█████████▎| 26/28 [01:27<00:06,  3.26s/it] 96%|█████████▋| 27/28 [01:31<00:03,  3.27s/it]100%|██████████| 28/28 [01:33<00:00,  2.92s/it]100%|██████████| 28/28 [01:33<00:00,  3.33s/it]
exception:'data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"code":13,"message":"result rescore fail for all recalls are below the min score threshold 0.000000"}, query:圣马力诺的政治体制
exception:'data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"code":13,"message":"result rescore fail for all recalls are below the min score threshold 0.000000"}, query:圣马力诺的政治体制
exception:'data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"code":13,"message":"result rescore fail for all recalls are below the min score threshold 0.000000"}, query:圣马力诺的政治体制
exception:'data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"code":13,"message":"result rescore fail for all recalls are below the min score threshold 0.000000"}, query:圣马力诺的政治体制
exception:'data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"code":13,"message":"result rescore fail for all recalls are below the min score threshold 0.000000"}, query:圣马力诺的政治体制
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-20/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 27 / 27
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:14<06:23, 14.74s/it] 15%|█▍        | 4/27 [00:20<01:39,  4.35s/it] 26%|██▌       | 7/27 [00:26<01:01,  3.09s/it] 37%|███▋      | 10/27 [00:30<00:38,  2.29s/it] 41%|████      | 11/27 [00:37<00:50,  3.14s/it] 52%|█████▏    | 14/27 [00:43<00:34,  2.66s/it] 56%|█████▌    | 15/27 [01:28<01:57,  9.82s/it] 93%|█████████▎| 25/27 [01:31<00:06,  3.07s/it] 96%|█████████▋| 26/27 [01:39<00:03,  3.57s/it]100%|██████████| 27/27 [01:43<00:00,  3.62s/it]100%|██████████| 27/27 [01:43<00:00,  3.85s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-08-22 22:06:12  
[INFO] duration: 6 min 
[2024-08-23 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-21/prod/2024-08-21_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-23 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 152, in get_distillation_data
    filter_df = DataFilter.get_task_usecols(filter_df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py", line 34, in get_task_usecols
    filter_df['task_name'] = np.select(task_conditions, task_choices, default=None)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 813, in select
    raise ValueError(
ValueError: list of cases must be same length as list of conditions

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(date='2024-08-21', api_url='http://172.24.162.100:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-21
Input folder: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-21
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-21/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-21/prod/2024-08-21_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-21/prod/2024-08-21_rule_labeled.csv.gpt_labeled.csv
Data list is empty, no valid dataframes read.
[INFO] end_time: 2024-08-23 22:00:18  
[INFO] duration: 0 min 
[2024-08-24 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-22/prod/2024-08-22_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-24 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 152, in get_distillation_data
    filter_df = DataFilter.get_task_usecols(filter_df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py", line 34, in get_task_usecols
    filter_df['task_name'] = np.select(task_conditions, task_choices, default=None)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 813, in select
    raise ValueError(
ValueError: list of cases must be same length as list of conditions

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(date='2024-08-22', api_url='http://172.24.162.100:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-22
Input folder: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-22
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-22/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-22/prod/2024-08-22_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-22/prod/2024-08-22_rule_labeled.csv.gpt_labeled.csv
Data list is empty, no valid dataframes read.
[INFO] end_time: 2024-08-24 22:00:19  
[INFO] duration: 0 min 
[2024-08-25 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-23/prod/2024-08-23_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-25 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 152, in get_distillation_data
    filter_df = DataFilter.get_task_usecols(filter_df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py", line 34, in get_task_usecols
    filter_df['task_name'] = np.select(task_conditions, task_choices, default=None)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 813, in select
    raise ValueError(
ValueError: list of cases must be same length as list of conditions

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(date='2024-08-23', api_url='http://172.24.162.100:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-23
Input folder: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-23
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-23/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-23/prod/2024-08-23_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-23/prod/2024-08-23_rule_labeled.csv.gpt_labeled.csv
Data list is empty, no valid dataframes read.
[INFO] end_time: 2024-08-25 22:00:17  
[INFO] duration: 0 min 
[2024-08-26 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-24/prod/2024-08-24_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-26 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 152, in get_distillation_data
    filter_df = DataFilter.get_task_usecols(filter_df)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py", line 34, in get_task_usecols
    filter_df['task_name'] = np.select(task_conditions, task_choices, default=None)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 813, in select
    raise ValueError(
ValueError: list of cases must be same length as list of conditions

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(date='2024-08-24', api_url='http://172.24.162.100:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-24
Input folder: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-24
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-24/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-24/prod/2024-08-24_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-24/prod/2024-08-24_rule_labeled.csv.gpt_labeled.csv
Data list is empty, no valid dataframes read.
[INFO] end_time: 2024-08-26 22:00:18  
[INFO] duration: 0 min 
[2024-08-27 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-25/prod/2024-08-25_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-27 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(date='2024-08-25', api_url='http://172.24.162.100:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-25
Input folder: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-25
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-25/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-25/prod/2024-08-25_rule_labeled.csv.gpt_labeled.csv
raw log len: 0
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 247, in <module>
    distillator.get_distillation_data(args.date)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 176, in get_distillation_data
    unique_queries_with_metadata = self.get_unique_query(clean_queries_with_metadata, batch_size=64)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 109, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-08-27 22:00:23  
[INFO] duration: 0 min 
[2024-08-28 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-26/prod/2024-08-26_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-28 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:52: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(date='2024-08-26', api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-26
Input folder: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-26
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-26/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-26/prod/2024-08-26_rule_labeled.csv.gpt_labeled.csv
raw log len: 89
时效人设任务型query 数量： 13
unique queries len: 371
  0%|          | 0/371 [00:00<?, ?it/s]  1%|          | 2/371 [00:01<04:09,  1.48it/s]  1%|          | 3/371 [00:02<06:26,  1.05s/it]  1%|          | 4/371 [00:04<06:57,  1.14s/it]  1%|▏         | 5/371 [00:06<09:59,  1.64s/it]  2%|▏         | 6/371 [00:08<10:04,  1.66s/it]  2%|▏         | 7/371 [00:09<09:46,  1.61s/it]  2%|▏         | 8/371 [00:11<09:17,  1.53s/it]  2%|▏         | 9/371 [00:13<09:27,  1.57s/it]  3%|▎         | 10/371 [00:14<09:15,  1.54s/it]  3%|▎         | 11/371 [00:15<09:06,  1.52s/it]  3%|▎         | 12/371 [00:17<08:59,  1.50s/it]  4%|▎         | 13/371 [00:18<08:51,  1.48s/it]  4%|▍         | 14/371 [00:20<08:59,  1.51s/it]  4%|▍         | 15/371 [00:21<08:46,  1.48s/it]  4%|▍         | 16/371 [00:23<08:39,  1.46s/it]  5%|▍         | 17/371 [00:24<07:34,  1.28s/it]  5%|▍         | 18/371 [00:26<09:41,  1.65s/it]  5%|▌         | 19/371 [00:27<09:07,  1.56s/it]  5%|▌         | 20/371 [00:29<08:39,  1.48s/it]  6%|▌         | 21/371 [00:30<08:28,  1.45s/it]  6%|▌         | 22/371 [00:32<08:16,  1.42s/it]  6%|▌         | 23/371 [00:33<08:06,  1.40s/it]  6%|▋         | 24/371 [00:34<08:06,  1.40s/it]  7%|▋         | 25/371 [00:36<07:58,  1.38s/it]  7%|▋         | 26/371 [00:37<07:43,  1.34s/it]  7%|▋         | 27/371 [00:38<08:01,  1.40s/it]  8%|▊         | 28/371 [00:40<08:02,  1.41s/it]  8%|▊         | 29/371 [00:41<08:20,  1.46s/it]  8%|▊         | 30/371 [00:43<08:08,  1.43s/it]  8%|▊         | 31/371 [00:45<09:26,  1.67s/it]  9%|▊         | 32/371 [00:47<09:26,  1.67s/it]  9%|▉         | 33/371 [00:48<09:00,  1.60s/it]  9%|▉         | 34/371 [00:50<08:51,  1.58s/it]  9%|▉         | 35/371 [00:51<08:24,  1.50s/it] 10%|▉         | 36/371 [00:52<08:14,  1.48s/it] 10%|▉         | 37/371 [00:54<08:01,  1.44s/it] 10%|█         | 38/371 [00:55<08:08,  1.47s/it] 11%|█         | 39/371 [00:57<08:03,  1.46s/it] 11%|█         | 40/371 [00:58<07:59,  1.45s/it] 11%|█         | 41/371 [01:00<08:12,  1.49s/it] 11%|█▏        | 42/371 [01:01<07:55,  1.44s/it] 12%|█▏        | 43/371 [01:02<07:46,  1.42s/it] 12%|█▏        | 44/371 [01:04<07:33,  1.39s/it] 12%|█▏        | 45/371 [01:05<07:27,  1.37s/it] 12%|█▏        | 46/371 [01:07<08:03,  1.49s/it] 13%|█▎        | 47/371 [01:08<07:54,  1.46s/it] 13%|█▎        | 48/371 [01:10<07:55,  1.47s/it] 13%|█▎        | 49/371 [01:11<07:50,  1.46s/it] 13%|█▎        | 50/371 [01:13<08:22,  1.57s/it] 14%|█▎        | 51/371 [01:14<08:02,  1.51s/it] 14%|█▍        | 52/371 [01:16<07:55,  1.49s/it] 14%|█▍        | 53/371 [01:17<08:00,  1.51s/it] 15%|█▍        | 54/371 [01:19<07:50,  1.49s/it] 15%|█▍        | 55/371 [01:20<07:58,  1.51s/it] 15%|█▌        | 56/371 [01:22<07:48,  1.49s/it] 15%|█▌        | 57/371 [01:23<07:18,  1.40s/it] 16%|█▌        | 58/371 [01:24<07:12,  1.38s/it] 16%|█▌        | 59/371 [01:26<07:00,  1.35s/it] 16%|█▌        | 60/371 [01:27<07:21,  1.42s/it] 16%|█▋        | 61/371 [01:28<07:05,  1.37s/it] 17%|█▋        | 62/371 [01:30<07:23,  1.44s/it] 17%|█▋        | 63/371 [01:31<07:07,  1.39s/it] 17%|█▋        | 64/371 [01:33<07:03,  1.38s/it] 18%|█▊        | 65/371 [01:34<07:12,  1.41s/it] 18%|█▊        | 66/371 [01:36<07:15,  1.43s/it] 18%|█▊        | 67/371 [01:37<06:59,  1.38s/it] 18%|█▊        | 68/371 [01:38<07:10,  1.42s/it] 19%|█▊        | 69/371 [01:40<07:00,  1.39s/it] 19%|█▉        | 70/371 [01:41<07:00,  1.40s/it] 19%|█▉        | 71/371 [01:43<07:16,  1.46s/it] 19%|█▉        | 72/371 [01:44<07:03,  1.42s/it] 20%|█▉        | 73/371 [01:46<07:19,  1.48s/it] 20%|█▉        | 74/371 [01:47<07:07,  1.44s/it] 20%|██        | 75/371 [01:48<07:03,  1.43s/it] 20%|██        | 76/371 [01:50<07:31,  1.53s/it] 21%|██        | 77/371 [01:52<07:19,  1.50s/it] 21%|██        | 78/371 [01:53<07:12,  1.48s/it] 21%|██▏       | 79/371 [01:54<06:57,  1.43s/it] 22%|██▏       | 80/371 [01:56<06:54,  1.42s/it] 22%|██▏       | 81/371 [01:57<06:45,  1.40s/it] 22%|██▏       | 82/371 [01:59<07:54,  1.64s/it] 22%|██▏       | 83/371 [02:01<07:17,  1.52s/it] 23%|██▎       | 84/371 [02:02<07:04,  1.48s/it] 23%|██▎       | 85/371 [02:03<06:55,  1.45s/it] 23%|██▎       | 86/371 [02:05<06:59,  1.47s/it] 23%|██▎       | 87/371 [02:06<06:56,  1.47s/it] 24%|██▎       | 88/371 [02:08<06:54,  1.46s/it] 24%|██▍       | 89/371 [02:09<06:43,  1.43s/it] 24%|██▍       | 90/371 [02:11<07:06,  1.52s/it] 25%|██▍       | 91/371 [02:12<06:47,  1.45s/it] 25%|██▍       | 92/371 [02:13<06:35,  1.42s/it] 25%|██▌       | 93/371 [02:15<06:56,  1.50s/it] 25%|██▌       | 94/371 [02:16<06:43,  1.46s/it] 26%|██▌       | 95/371 [02:18<06:46,  1.47s/it] 26%|██▌       | 96/371 [02:19<06:36,  1.44s/it] 26%|██▌       | 97/371 [02:20<05:00,  1.10s/it] 26%|██▋       | 98/371 [02:21<05:32,  1.22s/it] 27%|██▋       | 99/371 [02:23<05:49,  1.28s/it] 27%|██▋       | 100/371 [02:25<06:41,  1.48s/it] 27%|██▋       | 101/371 [02:26<06:39,  1.48s/it] 27%|██▋       | 102/371 [02:28<07:06,  1.59s/it] 28%|██▊       | 103/371 [02:29<06:55,  1.55s/it] 28%|██▊       | 104/371 [02:31<06:30,  1.46s/it] 28%|██▊       | 105/371 [02:32<06:28,  1.46s/it] 29%|██▊       | 106/371 [02:33<06:22,  1.44s/it] 29%|██▉       | 107/371 [02:35<06:19,  1.44s/it] 29%|██▉       | 108/371 [02:36<06:27,  1.47s/it] 29%|██▉       | 109/371 [02:38<06:30,  1.49s/it] 30%|██▉       | 110/371 [02:40<06:40,  1.54s/it] 30%|██▉       | 111/371 [02:41<06:18,  1.46s/it] 30%|███       | 112/371 [02:42<06:27,  1.50s/it] 30%|███       | 113/371 [02:44<06:07,  1.42s/it] 31%|███       | 114/371 [02:45<06:05,  1.42s/it] 31%|███       | 115/371 [02:47<06:09,  1.44s/it] 31%|███▏      | 116/371 [02:48<06:13,  1.46s/it] 32%|███▏      | 117/371 [02:49<06:03,  1.43s/it] 32%|███▏      | 118/371 [02:51<06:12,  1.47s/it] 32%|███▏      | 119/371 [02:52<06:07,  1.46s/it] 32%|███▏      | 120/371 [02:54<06:20,  1.52s/it] 33%|███▎      | 121/371 [02:56<06:14,  1.50s/it] 33%|███▎      | 122/371 [02:57<06:07,  1.48s/it] 33%|███▎      | 123/371 [02:59<06:13,  1.51s/it] 33%|███▎      | 124/371 [03:00<06:13,  1.51s/it] 34%|███▎      | 125/371 [03:01<06:01,  1.47s/it] 34%|███▍      | 126/371 [03:04<06:50,  1.67s/it] 34%|███▍      | 127/371 [03:05<06:30,  1.60s/it] 35%|███▍      | 128/371 [03:06<06:03,  1.50s/it] 35%|███▍      | 129/371 [03:08<06:05,  1.51s/it] 35%|███▌      | 130/371 [03:09<06:08,  1.53s/it] 35%|███▌      | 131/371 [03:11<05:51,  1.46s/it] 36%|███▌      | 132/371 [03:12<05:52,  1.47s/it] 36%|███▌      | 133/371 [03:14<05:59,  1.51s/it] 36%|███▌      | 134/371 [03:15<05:48,  1.47s/it] 36%|███▋      | 135/371 [03:17<05:40,  1.44s/it] 37%|███▋      | 136/371 [03:18<05:38,  1.44s/it] 37%|███▋      | 137/371 [03:20<05:39,  1.45s/it] 37%|███▋      | 138/371 [03:21<05:42,  1.47s/it] 37%|███▋      | 139/371 [03:23<05:46,  1.49s/it] 38%|███▊      | 140/371 [03:23<04:21,  1.13s/it] 38%|███▊      | 141/371 [03:24<04:45,  1.24s/it] 38%|███▊      | 142/371 [03:26<04:55,  1.29s/it] 39%|███▊      | 143/371 [03:26<03:48,  1.00s/it] 39%|███▉      | 144/371 [03:27<04:10,  1.11s/it] 39%|███▉      | 145/371 [03:29<04:33,  1.21s/it] 39%|███▉      | 146/371 [03:30<04:53,  1.31s/it] 40%|███▉      | 147/371 [03:32<04:53,  1.31s/it] 40%|███▉      | 148/371 [03:33<05:06,  1.37s/it] 40%|████      | 149/371 [03:34<03:53,  1.05s/it] 40%|████      | 150/371 [03:35<04:30,  1.22s/it] 41%|████      | 151/371 [03:37<04:45,  1.30s/it] 41%|████      | 152/371 [03:39<06:03,  1.66s/it] 41%|████      | 153/371 [03:41<05:52,  1.62s/it] 42%|████▏     | 154/371 [03:41<04:24,  1.22s/it] 42%|████▏     | 155/371 [03:42<04:37,  1.28s/it] 42%|████▏     | 156/371 [03:44<04:48,  1.34s/it] 42%|████▏     | 157/371 [03:45<04:48,  1.35s/it] 43%|████▎     | 158/371 [03:46<03:39,  1.03s/it] 43%|████▎     | 159/371 [03:47<03:58,  1.13s/it] 43%|████▎     | 160/371 [03:48<04:21,  1.24s/it] 43%|████▎     | 161/371 [03:50<04:47,  1.37s/it] 44%|████▎     | 162/371 [03:52<04:56,  1.42s/it] 44%|████▍     | 163/371 [03:53<04:52,  1.41s/it] 44%|████▍     | 164/371 [03:54<04:41,  1.36s/it] 44%|████▍     | 165/371 [03:56<04:56,  1.44s/it] 45%|████▍     | 166/371 [03:57<04:57,  1.45s/it] 45%|████▌     | 167/371 [03:59<04:57,  1.46s/it] 45%|████▌     | 168/371 [04:00<04:43,  1.40s/it] 46%|████▌     | 169/371 [04:01<04:40,  1.39s/it] 46%|████▌     | 170/371 [04:03<04:52,  1.46s/it] 46%|████▌     | 171/371 [04:04<04:51,  1.46s/it] 46%|████▋     | 172/371 [04:06<04:37,  1.39s/it] 47%|████▋     | 173/371 [04:07<04:34,  1.39s/it] 47%|████▋     | 174/371 [04:09<04:36,  1.40s/it] 47%|████▋     | 175/371 [04:10<04:29,  1.38s/it] 47%|████▋     | 176/371 [04:11<04:38,  1.43s/it] 48%|████▊     | 177/371 [04:13<04:32,  1.41s/it] 48%|████▊     | 178/371 [04:14<04:29,  1.40s/it] 48%|████▊     | 179/371 [04:16<04:34,  1.43s/it] 49%|████▊     | 180/371 [04:17<04:32,  1.42s/it] 49%|████▉     | 181/371 [04:19<04:34,  1.45s/it] 49%|████▉     | 182/371 [04:20<04:37,  1.47s/it] 49%|████▉     | 183/371 [04:22<04:37,  1.48s/it] 50%|████▉     | 184/371 [04:23<04:22,  1.41s/it] 50%|████▉     | 185/371 [04:24<04:36,  1.49s/it] 50%|█████     | 186/371 [04:26<04:26,  1.44s/it] 50%|█████     | 187/371 [04:27<04:32,  1.48s/it] 51%|█████     | 188/371 [04:29<04:22,  1.44s/it] 51%|█████     | 189/371 [04:30<04:24,  1.46s/it] 51%|█████     | 190/371 [04:32<04:19,  1.44s/it] 51%|█████▏    | 191/371 [04:33<04:23,  1.46s/it] 52%|█████▏    | 192/371 [04:35<04:25,  1.49s/it] 52%|█████▏    | 193/371 [04:36<04:32,  1.53s/it] 52%|█████▏    | 194/371 [04:38<04:25,  1.50s/it] 53%|█████▎    | 195/371 [04:38<03:27,  1.18s/it] 53%|█████▎    | 196/371 [04:40<04:18,  1.48s/it] 53%|█████▎    | 197/371 [04:42<04:02,  1.40s/it] 53%|█████▎    | 198/371 [04:43<04:02,  1.40s/it] 54%|█████▎    | 199/371 [04:44<03:59,  1.39s/it] 54%|█████▍    | 200/371 [04:46<04:02,  1.42s/it] 54%|█████▍    | 201/371 [04:48<04:41,  1.66s/it] 54%|█████▍    | 202/371 [04:49<04:18,  1.53s/it] 55%|█████▍    | 203/371 [04:51<04:09,  1.48s/it] 55%|█████▍    | 204/371 [04:53<04:48,  1.73s/it] 55%|█████▌    | 205/371 [04:55<05:22,  1.94s/it] 56%|█████▌    | 206/371 [04:57<04:53,  1.78s/it] 56%|█████▌    | 207/371 [04:58<04:48,  1.76s/it] 56%|█████▌    | 208/371 [05:01<05:13,  1.92s/it] 56%|█████▋    | 209/371 [05:02<04:58,  1.84s/it] 57%|█████▋    | 210/371 [05:04<04:40,  1.74s/it] 57%|█████▋    | 211/371 [05:04<03:29,  1.31s/it] 57%|█████▋    | 212/371 [05:06<03:43,  1.40s/it] 57%|█████▋    | 213/371 [05:07<03:42,  1.41s/it] 58%|█████▊    | 214/371 [05:09<03:35,  1.38s/it] 58%|█████▊    | 215/371 [05:10<03:34,  1.38s/it] 58%|█████▊    | 216/371 [05:11<03:31,  1.37s/it] 58%|█████▊    | 217/371 [05:13<03:34,  1.39s/it] 59%|█████▉    | 218/371 [05:14<03:45,  1.48s/it] 59%|█████▉    | 219/371 [05:16<03:37,  1.43s/it] 59%|█████▉    | 220/371 [05:17<03:44,  1.49s/it] 60%|█████▉    | 221/371 [05:18<03:06,  1.24s/it] 60%|█████▉    | 222/371 [05:18<02:23,  1.04it/s] 60%|██████    | 223/371 [05:20<02:45,  1.12s/it] 60%|██████    | 224/371 [05:21<03:06,  1.27s/it] 61%|██████    | 225/371 [05:23<03:13,  1.32s/it] 61%|██████    | 226/371 [05:24<03:14,  1.34s/it] 61%|██████    | 227/371 [05:27<04:02,  1.69s/it] 61%|██████▏   | 228/371 [05:28<03:53,  1.63s/it] 62%|██████▏   | 229/371 [05:30<03:52,  1.64s/it] 62%|██████▏   | 230/371 [05:31<03:32,  1.51s/it] 62%|██████▏   | 231/371 [05:33<03:40,  1.57s/it] 63%|██████▎   | 232/371 [05:33<02:45,  1.19s/it] 63%|██████▎   | 233/371 [05:35<02:51,  1.24s/it] 63%|██████▎   | 234/371 [05:36<03:07,  1.37s/it] 63%|██████▎   | 235/371 [05:37<03:02,  1.34s/it] 64%|██████▎   | 236/371 [05:39<03:10,  1.41s/it] 64%|██████▍   | 237/371 [05:41<03:11,  1.43s/it] 64%|██████▍   | 238/371 [05:41<02:24,  1.09s/it] 64%|██████▍   | 239/371 [05:42<02:30,  1.14s/it] 65%|██████▍   | 240/371 [05:44<02:41,  1.24s/it] 65%|██████▍   | 241/371 [05:46<03:40,  1.70s/it] 65%|██████▌   | 242/371 [05:48<03:36,  1.68s/it] 65%|██████▌   | 243/371 [05:49<03:18,  1.55s/it] 66%|██████▌   | 244/371 [05:51<03:12,  1.52s/it] 66%|██████▌   | 245/371 [05:52<03:06,  1.48s/it] 66%|██████▋   | 246/371 [05:53<02:59,  1.44s/it] 67%|██████▋   | 247/371 [05:55<03:02,  1.47s/it] 67%|██████▋   | 248/371 [05:56<02:54,  1.42s/it] 67%|██████▋   | 249/371 [05:59<03:54,  1.92s/it] 67%|██████▋   | 250/371 [06:01<03:37,  1.79s/it] 68%|██████▊   | 251/371 [06:02<03:25,  1.71s/it] 68%|██████▊   | 252/371 [06:04<03:20,  1.69s/it] 68%|██████▊   | 253/371 [06:05<03:07,  1.59s/it] 68%|██████▊   | 254/371 [06:07<02:55,  1.50s/it] 69%|██████▊   | 255/371 [06:08<02:57,  1.53s/it] 69%|██████▉   | 256/371 [06:09<02:46,  1.45s/it] 69%|██████▉   | 257/371 [06:11<02:50,  1.49s/it] 70%|██████▉   | 258/371 [06:12<02:44,  1.45s/it] 70%|██████▉   | 259/371 [06:14<02:45,  1.48s/it] 70%|███████   | 260/371 [06:15<02:38,  1.42s/it] 70%|███████   | 261/371 [06:17<02:34,  1.41s/it] 71%|███████   | 262/371 [06:18<02:32,  1.40s/it] 71%|███████   | 263/371 [06:18<01:55,  1.07s/it] 71%|███████   | 264/371 [06:20<02:02,  1.14s/it] 71%|███████▏  | 265/371 [06:21<02:13,  1.26s/it] 72%|███████▏  | 266/371 [06:23<02:23,  1.37s/it] 72%|███████▏  | 267/371 [06:24<02:24,  1.39s/it] 72%|███████▏  | 268/371 [06:26<02:21,  1.38s/it] 73%|███████▎  | 269/371 [06:27<02:24,  1.42s/it] 73%|███████▎  | 270/371 [06:29<02:27,  1.46s/it] 73%|███████▎  | 271/371 [06:30<02:25,  1.46s/it] 73%|███████▎  | 272/371 [06:32<02:28,  1.50s/it] 74%|███████▎  | 273/371 [06:33<02:25,  1.48s/it] 74%|███████▍  | 274/371 [06:34<02:19,  1.44s/it] 74%|███████▍  | 275/371 [06:36<02:21,  1.47s/it] 74%|███████▍  | 276/371 [06:38<02:21,  1.49s/it] 75%|███████▍  | 277/371 [06:39<02:17,  1.46s/it] 75%|███████▍  | 278/371 [06:41<02:41,  1.74s/it] 75%|███████▌  | 279/371 [06:43<02:43,  1.78s/it] 75%|███████▌  | 280/371 [06:45<02:31,  1.66s/it] 76%|███████▌  | 281/371 [06:46<02:22,  1.58s/it] 76%|███████▌  | 282/371 [06:47<02:15,  1.52s/it] 76%|███████▋  | 283/371 [06:49<02:07,  1.45s/it] 77%|███████▋  | 284/371 [06:50<02:05,  1.45s/it] 77%|███████▋  | 285/371 [06:50<01:34,  1.10s/it] 77%|███████▋  | 286/371 [06:52<01:34,  1.12s/it] 77%|███████▋  | 287/371 [06:54<02:20,  1.67s/it] 78%|███████▊  | 288/371 [06:56<02:18,  1.67s/it] 78%|███████▊  | 289/371 [06:58<02:16,  1.67s/it] 78%|███████▊  | 290/371 [07:00<02:36,  1.94s/it] 78%|███████▊  | 291/371 [07:02<02:31,  1.89s/it] 79%|███████▊  | 292/371 [07:03<02:15,  1.71s/it] 79%|███████▉  | 293/371 [07:05<02:08,  1.64s/it] 79%|███████▉  | 294/371 [07:06<02:02,  1.60s/it] 80%|███████▉  | 295/371 [07:09<02:17,  1.81s/it] 80%|███████▉  | 296/371 [07:10<02:10,  1.74s/it] 80%|████████  | 297/371 [07:12<02:05,  1.70s/it] 80%|████████  | 298/371 [07:13<01:55,  1.59s/it] 81%|████████  | 299/371 [07:16<02:13,  1.86s/it] 81%|████████  | 300/371 [07:16<01:38,  1.39s/it] 81%|████████  | 301/371 [07:19<02:00,  1.72s/it] 81%|████████▏ | 302/371 [07:20<01:55,  1.68s/it] 82%|████████▏ | 303/371 [07:23<02:08,  1.89s/it] 82%|████████▏ | 304/371 [07:23<01:45,  1.57s/it] 82%|████████▏ | 305/371 [07:25<01:38,  1.49s/it] 82%|████████▏ | 306/371 [07:26<01:35,  1.47s/it] 83%|████████▎ | 307/371 [07:27<01:30,  1.42s/it] 83%|████████▎ | 308/371 [07:29<01:33,  1.48s/it] 83%|████████▎ | 309/371 [07:30<01:30,  1.46s/it] 84%|████████▎ | 310/371 [07:32<01:26,  1.42s/it] 84%|████████▍ | 311/371 [07:33<01:23,  1.40s/it] 84%|████████▍ | 312/371 [07:35<01:36,  1.63s/it] 84%|████████▍ | 313/371 [07:37<01:31,  1.58s/it] 85%|████████▍ | 314/371 [07:38<01:28,  1.56s/it] 85%|████████▍ | 315/371 [07:40<01:23,  1.49s/it] 85%|████████▌ | 316/371 [07:41<01:18,  1.42s/it] 85%|████████▌ | 317/371 [07:41<00:59,  1.10s/it] 86%|████████▌ | 318/371 [07:43<01:04,  1.22s/it] 86%|████████▌ | 319/371 [07:44<01:08,  1.31s/it] 86%|████████▋ | 320/371 [07:46<01:08,  1.35s/it] 87%|████████▋ | 321/371 [07:47<01:10,  1.41s/it] 87%|████████▋ | 322/371 [07:49<01:21,  1.66s/it] 87%|████████▋ | 323/371 [07:51<01:15,  1.57s/it] 87%|████████▋ | 324/371 [07:52<01:13,  1.56s/it] 88%|████████▊ | 325/371 [07:54<01:10,  1.53s/it] 88%|████████▊ | 326/371 [07:56<01:14,  1.65s/it] 88%|████████▊ | 327/371 [07:57<01:11,  1.62s/it] 88%|████████▊ | 328/371 [07:58<00:52,  1.22s/it] 89%|████████▊ | 329/371 [07:59<00:53,  1.27s/it] 89%|████████▉ | 330/371 [08:00<00:55,  1.35s/it] 89%|████████▉ | 331/371 [08:02<01:02,  1.56s/it] 89%|████████▉ | 332/371 [08:04<00:58,  1.50s/it] 90%|████████▉ | 333/371 [08:05<00:54,  1.43s/it] 90%|█████████ | 334/371 [08:05<00:40,  1.09s/it] 90%|█████████ | 335/371 [08:08<00:55,  1.53s/it] 91%|█████████ | 336/371 [08:10<00:53,  1.54s/it] 91%|█████████ | 337/371 [08:11<00:53,  1.58s/it] 91%|█████████ | 338/371 [08:13<00:52,  1.60s/it] 91%|█████████▏| 339/371 [08:14<00:48,  1.53s/it] 92%|█████████▏| 340/371 [08:16<00:48,  1.57s/it] 92%|█████████▏| 341/371 [08:17<00:44,  1.49s/it] 92%|█████████▏| 342/371 [08:19<00:42,  1.46s/it] 92%|█████████▏| 343/371 [08:19<00:30,  1.10s/it] 93%|█████████▎| 344/371 [08:20<00:31,  1.18s/it] 93%|█████████▎| 345/371 [08:22<00:33,  1.28s/it] 93%|█████████▎| 346/371 [08:23<00:31,  1.25s/it] 94%|█████████▎| 347/371 [08:24<00:30,  1.28s/it] 94%|█████████▍| 348/371 [08:27<00:36,  1.60s/it] 94%|█████████▍| 349/371 [08:28<00:33,  1.53s/it] 94%|█████████▍| 350/371 [08:29<00:30,  1.48s/it] 95%|█████████▍| 351/371 [08:31<00:28,  1.41s/it] 95%|█████████▍| 352/371 [08:32<00:26,  1.38s/it] 95%|█████████▌| 353/371 [08:33<00:24,  1.38s/it] 95%|█████████▌| 354/371 [08:35<00:24,  1.44s/it] 96%|█████████▌| 355/371 [08:36<00:22,  1.43s/it] 96%|█████████▌| 356/371 [08:38<00:21,  1.43s/it] 96%|█████████▌| 357/371 [08:39<00:19,  1.38s/it] 96%|█████████▋| 358/371 [08:40<00:17,  1.36s/it] 97%|█████████▋| 359/371 [08:42<00:16,  1.39s/it] 97%|█████████▋| 360/371 [08:42<00:11,  1.06s/it] 97%|█████████▋| 361/371 [08:44<00:12,  1.26s/it] 98%|█████████▊| 362/371 [08:45<00:11,  1.29s/it] 98%|█████████▊| 363/371 [08:46<00:10,  1.29s/it] 98%|█████████▊| 364/371 [08:48<00:09,  1.33s/it] 98%|█████████▊| 365/371 [08:49<00:08,  1.41s/it] 99%|█████████▊| 366/371 [08:51<00:07,  1.43s/it] 99%|█████████▉| 367/371 [08:53<00:06,  1.54s/it] 99%|█████████▉| 368/371 [08:54<00:04,  1.47s/it] 99%|█████████▉| 369/371 [08:55<00:02,  1.48s/it]100%|█████████▉| 370/371 [08:57<00:01,  1.45s/it]100%|██████████| 371/371 [08:58<00:00,  1.42s/it]100%|██████████| 371/371 [08:59<00:00,  1.45s/it]
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 347
  0%|          | 0/347 [00:00<?, ?it/s]  0%|          | 1/347 [00:01<10:14,  1.78s/it]  1%|          | 2/347 [00:03<09:37,  1.67s/it]  1%|          | 3/347 [00:04<08:53,  1.55s/it]  1%|          | 4/347 [00:08<14:36,  2.55s/it]  1%|▏         | 5/347 [00:10<12:59,  2.28s/it]  2%|▏         | 6/347 [00:12<12:23,  2.18s/it]  2%|▏         | 7/347 [00:14<11:17,  1.99s/it]  2%|▏         | 8/347 [00:15<10:21,  1.83s/it]  3%|▎         | 9/347 [00:17<10:28,  1.86s/it]  3%|▎         | 10/347 [00:19<10:23,  1.85s/it]  3%|▎         | 11/347 [00:21<10:20,  1.85s/it]  3%|▎         | 12/347 [00:22<09:13,  1.65s/it]  4%|▎         | 13/347 [00:23<08:47,  1.58s/it]  4%|▍         | 14/347 [00:25<08:30,  1.53s/it]  4%|▍         | 15/347 [00:26<08:16,  1.49s/it]  5%|▍         | 16/347 [00:31<13:04,  2.37s/it]  5%|▍         | 17/347 [00:32<11:13,  2.04s/it]  5%|▌         | 18/347 [00:33<09:40,  1.76s/it]  5%|▌         | 19/347 [00:35<09:29,  1.74s/it]  6%|▌         | 20/347 [00:37<09:31,  1.75s/it]  6%|▌         | 21/347 [00:38<09:39,  1.78s/it]  6%|▋         | 22/347 [00:40<09:52,  1.82s/it]  7%|▋         | 23/347 [00:42<09:03,  1.68s/it]  7%|▋         | 24/347 [00:43<08:47,  1.63s/it]  7%|▋         | 25/347 [00:45<08:51,  1.65s/it]  7%|▋         | 26/347 [00:47<09:01,  1.69s/it]  8%|▊         | 27/347 [00:48<09:08,  1.71s/it]  8%|▊         | 28/347 [00:50<08:37,  1.62s/it]  8%|▊         | 29/347 [00:53<11:10,  2.11s/it]  9%|▊         | 30/347 [00:55<10:20,  1.96s/it]  9%|▉         | 31/347 [00:57<10:12,  1.94s/it]  9%|▉         | 32/347 [00:58<09:44,  1.85s/it] 10%|▉         | 33/347 [01:00<09:09,  1.75s/it] 10%|▉         | 34/347 [01:01<08:25,  1.62s/it] 10%|█         | 35/347 [01:02<08:04,  1.55s/it] 10%|█         | 36/347 [01:04<07:57,  1.54s/it] 11%|█         | 37/347 [01:06<08:43,  1.69s/it] 11%|█         | 38/347 [01:08<08:35,  1.67s/it] 11%|█         | 39/347 [01:09<08:52,  1.73s/it] 12%|█▏        | 40/347 [01:11<08:34,  1.68s/it] 12%|█▏        | 41/347 [01:13<08:31,  1.67s/it] 12%|█▏        | 42/347 [01:14<08:12,  1.61s/it] 12%|█▏        | 43/347 [01:15<07:32,  1.49s/it] 13%|█▎        | 44/347 [01:17<07:22,  1.46s/it] 13%|█▎        | 45/347 [01:19<08:25,  1.67s/it] 13%|█▎        | 46/347 [01:21<08:24,  1.68s/it] 14%|█▎        | 47/347 [01:22<08:28,  1.70s/it] 14%|█▍        | 48/347 [01:24<08:11,  1.64s/it] 14%|█▍        | 49/347 [01:26<08:45,  1.76s/it] 14%|█▍        | 50/347 [01:28<08:31,  1.72s/it] 15%|█▍        | 51/347 [01:29<07:57,  1.61s/it] 15%|█▍        | 52/347 [01:31<08:10,  1.66s/it] 15%|█▌        | 53/347 [01:32<07:57,  1.62s/it] 16%|█▌        | 54/347 [01:34<08:12,  1.68s/it] 16%|█▌        | 55/347 [01:35<07:48,  1.60s/it] 16%|█▌        | 56/347 [01:37<08:15,  1.70s/it] 16%|█▋        | 57/347 [01:38<06:18,  1.31s/it] 17%|█▋        | 58/347 [01:40<07:10,  1.49s/it] 17%|█▋        | 59/347 [01:41<06:29,  1.35s/it] 17%|█▋        | 60/347 [01:42<07:04,  1.48s/it] 18%|█▊        | 61/347 [01:44<07:18,  1.53s/it] 18%|█▊        | 62/347 [01:46<08:22,  1.76s/it] 18%|█▊        | 63/347 [01:48<08:00,  1.69s/it] 18%|█▊        | 64/347 [01:50<08:17,  1.76s/it] 19%|█▊        | 65/347 [01:51<07:51,  1.67s/it] 19%|█▉        | 66/347 [01:53<08:14,  1.76s/it] 19%|█▉        | 67/347 [01:55<08:03,  1.73s/it] 20%|█▉        | 68/347 [01:56<07:35,  1.63s/it] 20%|█▉        | 69/347 [01:58<07:16,  1.57s/it] 20%|██        | 70/347 [01:59<06:54,  1.50s/it] 20%|██        | 71/347 [02:01<07:12,  1.57s/it] 21%|██        | 72/347 [02:03<07:55,  1.73s/it] 21%|██        | 73/347 [02:05<07:55,  1.74s/it] 21%|██▏       | 74/347 [02:06<07:57,  1.75s/it] 22%|██▏       | 75/347 [02:08<07:43,  1.71s/it] 22%|██▏       | 76/347 [02:10<08:29,  1.88s/it] 22%|██▏       | 77/347 [02:12<08:21,  1.86s/it] 22%|██▏       | 78/347 [02:14<07:50,  1.75s/it] 23%|██▎       | 79/347 [02:15<06:41,  1.50s/it] 23%|██▎       | 80/347 [02:18<09:42,  2.18s/it] 23%|██▎       | 81/347 [02:20<09:10,  2.07s/it] 24%|██▎       | 82/347 [02:21<08:04,  1.83s/it] 24%|██▍       | 83/347 [02:23<07:07,  1.62s/it] 24%|██▍       | 84/347 [02:25<07:50,  1.79s/it] 24%|██▍       | 85/347 [02:27<07:56,  1.82s/it] 25%|██▍       | 86/347 [02:29<08:06,  1.86s/it] 25%|██▌       | 87/347 [02:30<08:00,  1.85s/it] 25%|██▌       | 88/347 [02:32<08:07,  1.88s/it] 26%|██▌       | 89/347 [02:35<08:32,  1.99s/it] 26%|██▌       | 90/347 [02:36<07:19,  1.71s/it] 26%|██▌       | 91/347 [02:38<07:42,  1.81s/it] 27%|██▋       | 92/347 [02:39<07:05,  1.67s/it] 27%|██▋       | 93/347 [02:41<07:25,  1.76s/it] 27%|██▋       | 94/347 [02:43<07:12,  1.71s/it] 27%|██▋       | 95/347 [02:45<07:29,  1.78s/it] 28%|██▊       | 96/347 [02:46<06:58,  1.67s/it] 28%|██▊       | 97/347 [02:48<06:53,  1.65s/it] 28%|██▊       | 98/347 [02:49<06:28,  1.56s/it] 29%|██▊       | 99/347 [02:50<06:17,  1.52s/it] 29%|██▉       | 100/347 [02:52<06:19,  1.54s/it] 29%|██▉       | 101/347 [02:54<06:30,  1.59s/it] 29%|██▉       | 102/347 [02:55<06:06,  1.50s/it] 30%|██▉       | 103/347 [02:57<06:47,  1.67s/it] 30%|██▉       | 104/347 [02:58<06:29,  1.60s/it] 30%|███       | 105/347 [03:00<06:33,  1.63s/it] 31%|███       | 106/347 [03:02<06:23,  1.59s/it] 31%|███       | 107/347 [03:03<06:39,  1.66s/it] 31%|███       | 108/347 [03:05<06:17,  1.58s/it] 31%|███▏      | 109/347 [03:07<06:19,  1.59s/it] 32%|███▏      | 110/347 [03:08<05:57,  1.51s/it] 32%|███▏      | 111/347 [03:09<06:00,  1.53s/it] 32%|███▏      | 112/347 [03:11<06:18,  1.61s/it] 33%|███▎      | 113/347 [03:13<06:30,  1.67s/it] 33%|███▎      | 114/347 [03:15<06:26,  1.66s/it] 33%|███▎      | 115/347 [03:16<06:19,  1.64s/it] 33%|███▎      | 116/347 [03:18<06:47,  1.77s/it] 34%|███▎      | 117/347 [03:20<06:41,  1.75s/it] 34%|███▍      | 118/347 [03:21<06:09,  1.61s/it] 34%|███▍      | 119/347 [03:23<05:51,  1.54s/it] 35%|███▍      | 120/347 [03:24<05:39,  1.49s/it] 35%|███▍      | 121/347 [03:26<06:13,  1.65s/it] 35%|███▌      | 122/347 [03:28<06:10,  1.65s/it] 35%|███▌      | 123/347 [03:31<07:48,  2.09s/it] 36%|███▌      | 124/347 [03:32<07:10,  1.93s/it] 36%|███▌      | 125/347 [03:34<06:51,  1.86s/it] 36%|███▋      | 126/347 [03:36<06:46,  1.84s/it] 37%|███▋      | 127/347 [03:37<06:25,  1.75s/it] 37%|███▋      | 128/347 [03:39<05:52,  1.61s/it] 37%|███▋      | 129/347 [03:41<06:10,  1.70s/it] 37%|███▋      | 130/347 [03:42<06:07,  1.69s/it] 38%|███▊      | 131/347 [03:44<06:09,  1.71s/it] 38%|███▊      | 132/347 [03:45<05:51,  1.63s/it] 38%|███▊      | 133/347 [03:47<06:13,  1.74s/it] 39%|███▊      | 134/347 [03:51<07:51,  2.22s/it] 39%|███▉      | 135/347 [03:52<06:46,  1.92s/it] 39%|███▉      | 136/347 [03:54<06:41,  1.90s/it] 39%|███▉      | 137/347 [03:56<06:31,  1.86s/it] 40%|███▉      | 138/347 [03:57<06:22,  1.83s/it] 40%|████      | 139/347 [03:59<06:12,  1.79s/it] 41%|████      | 141/347 [04:05<07:57,  2.32s/it] 41%|████      | 142/347 [04:06<06:53,  2.02s/it] 41%|████      | 143/347 [04:08<06:41,  1.97s/it] 41%|████▏     | 144/347 [04:09<06:04,  1.80s/it] 42%|████▏     | 145/347 [04:11<05:48,  1.73s/it] 42%|████▏     | 146/347 [04:14<06:47,  2.03s/it] 42%|████▏     | 147/347 [04:15<06:29,  1.95s/it] 43%|████▎     | 148/347 [04:17<05:56,  1.79s/it] 43%|████▎     | 149/347 [04:18<05:41,  1.72s/it] 43%|████▎     | 150/347 [04:20<05:09,  1.57s/it] 44%|████▎     | 151/347 [04:22<05:34,  1.71s/it] 44%|████▍     | 152/347 [04:24<05:54,  1.82s/it] 44%|████▍     | 153/347 [04:25<05:28,  1.69s/it] 44%|████▍     | 154/347 [04:26<04:45,  1.48s/it] 45%|████▍     | 155/347 [04:27<04:21,  1.36s/it] 45%|████▍     | 156/347 [04:28<03:46,  1.19s/it] 45%|████▌     | 157/347 [04:29<03:49,  1.21s/it] 46%|████▌     | 158/347 [04:31<03:58,  1.26s/it] 46%|████▌     | 159/347 [04:32<04:19,  1.38s/it] 46%|████▌     | 160/347 [04:34<04:41,  1.50s/it] 46%|████▋     | 161/347 [04:36<05:09,  1.66s/it] 47%|████▋     | 162/347 [04:37<04:51,  1.58s/it] 47%|████▋     | 163/347 [04:39<04:58,  1.62s/it] 47%|████▋     | 164/347 [04:41<04:56,  1.62s/it] 48%|████▊     | 165/347 [04:43<05:07,  1.69s/it] 48%|████▊     | 166/347 [04:43<04:19,  1.43s/it] 48%|████▊     | 167/347 [04:45<04:12,  1.40s/it] 48%|████▊     | 168/347 [04:46<04:18,  1.45s/it] 49%|████▊     | 169/347 [04:48<04:11,  1.41s/it] 49%|████▉     | 170/347 [04:50<04:36,  1.56s/it] 49%|████▉     | 171/347 [04:51<04:14,  1.45s/it] 50%|████▉     | 172/347 [04:53<04:49,  1.66s/it] 50%|████▉     | 173/347 [04:54<04:31,  1.56s/it] 50%|█████     | 174/347 [04:56<04:37,  1.60s/it] 50%|█████     | 175/347 [04:57<04:32,  1.59s/it] 51%|█████     | 176/347 [04:59<04:55,  1.73s/it] 51%|█████     | 177/347 [05:00<04:08,  1.46s/it] 51%|█████▏    | 178/347 [05:02<04:09,  1.48s/it] 52%|█████▏    | 179/347 [05:03<03:57,  1.41s/it] 52%|█████▏    | 180/347 [05:04<03:34,  1.29s/it] 52%|█████▏    | 181/347 [05:06<03:46,  1.36s/it] 52%|█████▏    | 182/347 [05:07<03:48,  1.39s/it] 53%|█████▎    | 183/347 [05:09<04:00,  1.47s/it] 53%|█████▎    | 184/347 [05:10<03:47,  1.40s/it] 53%|█████▎    | 185/347 [05:12<03:54,  1.45s/it] 54%|█████▎    | 186/347 [05:13<03:58,  1.48s/it] 54%|█████▍    | 187/347 [05:16<04:52,  1.83s/it] 54%|█████▍    | 188/347 [05:17<04:24,  1.66s/it] 54%|█████▍    | 189/347 [05:19<04:34,  1.74s/it] 55%|█████▍    | 190/347 [05:20<04:24,  1.68s/it] 55%|█████▌    | 191/347 [05:22<04:12,  1.62s/it] 55%|█████▌    | 192/347 [05:23<03:25,  1.33s/it] 56%|█████▌    | 193/347 [05:24<03:15,  1.27s/it] 56%|█████▌    | 194/347 [05:25<03:16,  1.28s/it] 56%|█████▌    | 195/347 [05:28<04:25,  1.75s/it] 56%|█████▋    | 196/347 [05:31<05:17,  2.11s/it] 57%|█████▋    | 197/347 [05:33<04:57,  1.98s/it] 57%|█████▋    | 198/347 [05:34<04:38,  1.87s/it] 57%|█████▋    | 199/347 [05:37<05:34,  2.26s/it] 58%|█████▊    | 200/347 [05:39<05:02,  2.06s/it] 58%|█████▊    | 201/347 [05:41<04:45,  1.96s/it] 58%|█████▊    | 202/347 [05:42<04:28,  1.85s/it] 59%|█████▊    | 203/347 [05:44<04:15,  1.78s/it] 59%|█████▉    | 204/347 [05:45<04:10,  1.75s/it] 59%|█████▉    | 205/347 [05:47<03:48,  1.61s/it] 59%|█████▉    | 206/347 [05:48<03:50,  1.63s/it] 60%|█████▉    | 207/347 [05:50<03:59,  1.71s/it] 60%|█████▉    | 208/347 [05:51<03:30,  1.52s/it] 60%|██████    | 209/347 [05:53<03:24,  1.48s/it] 61%|██████    | 210/347 [05:55<03:46,  1.65s/it] 61%|██████    | 211/347 [05:56<03:34,  1.58s/it] 61%|██████    | 212/347 [05:58<03:25,  1.52s/it] 61%|██████▏   | 213/347 [05:58<02:52,  1.29s/it] 62%|██████▏   | 214/347 [06:00<02:58,  1.34s/it] 62%|██████▏   | 215/347 [06:03<04:11,  1.91s/it] 62%|██████▏   | 216/347 [06:05<04:02,  1.85s/it] 63%|██████▎   | 217/347 [06:06<03:44,  1.73s/it] 63%|██████▎   | 218/347 [06:08<03:24,  1.59s/it] 63%|██████▎   | 219/347 [06:09<03:31,  1.65s/it] 63%|██████▎   | 220/347 [06:11<03:23,  1.60s/it] 64%|██████▎   | 221/347 [06:12<03:16,  1.56s/it] 64%|██████▍   | 222/347 [06:14<03:09,  1.51s/it] 64%|██████▍   | 223/347 [06:15<02:56,  1.42s/it] 65%|██████▍   | 224/347 [06:16<02:48,  1.37s/it] 65%|██████▍   | 225/347 [06:20<04:36,  2.26s/it] 65%|██████▌   | 226/347 [06:22<04:24,  2.18s/it] 65%|██████▌   | 227/347 [06:26<05:18,  2.65s/it] 66%|██████▌   | 228/347 [06:28<04:30,  2.27s/it] 66%|██████▌   | 229/347 [06:29<04:01,  2.05s/it] 66%|██████▋   | 230/347 [06:31<03:38,  1.86s/it] 67%|██████▋   | 231/347 [06:32<03:17,  1.70s/it] 67%|██████▋   | 232/347 [06:34<03:17,  1.72s/it] 67%|██████▋   | 233/347 [06:35<03:06,  1.64s/it] 67%|██████▋   | 234/347 [06:37<02:58,  1.58s/it] 68%|██████▊   | 235/347 [06:40<03:54,  2.10s/it] 68%|██████▊   | 236/347 [06:40<02:57,  1.60s/it] 68%|██████▊   | 237/347 [06:42<02:55,  1.60s/it] 69%|██████▊   | 238/347 [06:43<02:39,  1.47s/it] 69%|██████▉   | 239/347 [06:45<02:50,  1.58s/it] 69%|██████▉   | 240/347 [06:46<02:39,  1.49s/it] 69%|██████▉   | 241/347 [06:48<02:40,  1.51s/it] 70%|██████▉   | 242/347 [06:49<02:32,  1.46s/it] 70%|███████   | 243/347 [06:51<02:39,  1.54s/it] 70%|███████   | 244/347 [06:52<02:35,  1.51s/it] 71%|███████   | 245/347 [06:53<02:21,  1.39s/it] 71%|███████   | 246/347 [06:55<02:42,  1.61s/it] 71%|███████   | 247/347 [06:57<02:39,  1.59s/it] 71%|███████▏  | 248/347 [06:59<02:42,  1.64s/it] 72%|███████▏  | 249/347 [07:01<02:49,  1.73s/it] 72%|███████▏  | 250/347 [07:02<02:38,  1.64s/it] 72%|███████▏  | 251/347 [07:04<02:43,  1.70s/it] 73%|███████▎  | 252/347 [07:05<02:29,  1.58s/it] 73%|███████▎  | 253/347 [07:07<02:27,  1.57s/it] 73%|███████▎  | 254/347 [07:08<02:28,  1.59s/it] 73%|███████▎  | 255/347 [07:10<02:20,  1.52s/it] 74%|███████▍  | 256/347 [07:11<02:15,  1.49s/it] 74%|███████▍  | 258/347 [07:13<01:42,  1.15s/it] 75%|███████▍  | 259/347 [07:14<01:49,  1.25s/it] 75%|███████▍  | 260/347 [07:16<01:53,  1.30s/it] 75%|███████▌  | 261/347 [07:17<01:54,  1.33s/it] 76%|███████▌  | 262/347 [07:20<02:27,  1.73s/it] 76%|███████▌  | 263/347 [07:21<02:15,  1.62s/it] 76%|███████▌  | 264/347 [07:23<02:12,  1.60s/it] 76%|███████▋  | 265/347 [07:25<02:19,  1.70s/it] 77%|███████▋  | 266/347 [07:26<02:09,  1.60s/it] 77%|███████▋  | 267/347 [07:28<02:11,  1.64s/it] 77%|███████▋  | 268/347 [07:29<02:08,  1.63s/it] 78%|███████▊  | 269/347 [07:30<01:52,  1.44s/it] 78%|███████▊  | 270/347 [07:33<02:21,  1.84s/it] 78%|███████▊  | 271/347 [07:35<02:25,  1.92s/it] 78%|███████▊  | 272/347 [07:37<02:19,  1.86s/it] 79%|███████▊  | 273/347 [07:41<02:54,  2.36s/it] 79%|███████▉  | 274/347 [07:43<02:46,  2.28s/it] 79%|███████▉  | 275/347 [07:44<02:29,  2.07s/it] 80%|███████▉  | 276/347 [07:46<02:18,  1.95s/it] 80%|███████▉  | 277/347 [07:48<02:23,  2.05s/it] 80%|████████  | 278/347 [07:50<02:17,  2.00s/it] 80%|████████  | 279/347 [07:52<02:07,  1.88s/it] 81%|████████  | 280/347 [07:53<02:03,  1.84s/it] 81%|████████  | 281/347 [07:55<01:54,  1.74s/it] 81%|████████▏ | 282/347 [07:58<02:14,  2.07s/it] 82%|████████▏ | 283/347 [08:00<02:22,  2.22s/it] 82%|████████▏ | 284/347 [08:02<02:04,  1.98s/it] 82%|████████▏ | 285/347 [08:05<02:29,  2.42s/it] 83%|████████▎ | 287/347 [08:07<01:37,  1.63s/it] 83%|████████▎ | 288/347 [08:08<01:33,  1.59s/it] 83%|████████▎ | 289/347 [08:09<01:24,  1.46s/it] 84%|████████▎ | 290/347 [08:11<01:24,  1.47s/it] 84%|████████▍ | 291/347 [08:12<01:19,  1.41s/it] 84%|████████▍ | 292/347 [08:13<01:19,  1.44s/it] 84%|████████▍ | 293/347 [08:17<01:50,  2.05s/it] 85%|████████▍ | 294/347 [08:19<01:41,  1.91s/it] 85%|████████▌ | 295/347 [08:20<01:30,  1.73s/it] 85%|████████▌ | 296/347 [08:21<01:25,  1.67s/it] 86%|████████▌ | 297/347 [08:23<01:23,  1.66s/it] 86%|████████▌ | 298/347 [08:25<01:24,  1.73s/it] 86%|████████▌ | 299/347 [08:26<01:20,  1.68s/it] 87%|████████▋ | 301/347 [08:28<00:59,  1.30s/it] 87%|████████▋ | 302/347 [08:30<01:08,  1.53s/it] 87%|████████▋ | 303/347 [08:32<01:07,  1.54s/it] 88%|████████▊ | 304/347 [08:34<01:08,  1.60s/it] 88%|████████▊ | 305/347 [08:35<01:03,  1.52s/it] 88%|████████▊ | 306/347 [08:37<01:02,  1.52s/it] 88%|████████▊ | 307/347 [08:38<01:00,  1.50s/it] 89%|████████▉ | 308/347 [08:39<00:55,  1.43s/it] 89%|████████▉ | 309/347 [08:41<00:54,  1.44s/it] 89%|████████▉ | 310/347 [08:43<01:06,  1.79s/it] 90%|████████▉ | 311/347 [08:45<01:00,  1.67s/it] 90%|████████▉ | 312/347 [08:46<00:58,  1.68s/it] 90%|█████████ | 313/347 [08:49<01:06,  1.97s/it] 90%|█████████ | 314/347 [08:51<01:02,  1.89s/it] 91%|█████████ | 315/347 [08:53<00:59,  1.85s/it] 91%|█████████ | 316/347 [08:54<00:55,  1.79s/it] 91%|█████████▏| 317/347 [08:56<00:51,  1.71s/it] 92%|█████████▏| 318/347 [08:57<00:46,  1.61s/it] 92%|█████████▏| 319/347 [08:58<00:42,  1.50s/it] 92%|█████████▏| 320/347 [09:00<00:42,  1.57s/it] 93%|█████████▎| 321/347 [09:02<00:41,  1.58s/it] 93%|█████████▎| 322/347 [09:03<00:38,  1.55s/it] 93%|█████████▎| 323/347 [09:04<00:33,  1.41s/it] 93%|█████████▎| 324/347 [09:06<00:34,  1.48s/it] 94%|█████████▎| 325/347 [09:10<00:46,  2.12s/it] 94%|█████████▍| 326/347 [09:11<00:42,  2.03s/it] 94%|█████████▍| 327/347 [09:13<00:36,  1.82s/it] 95%|█████████▍| 328/347 [09:14<00:31,  1.66s/it] 95%|█████████▍| 329/347 [09:16<00:31,  1.76s/it] 95%|█████████▌| 330/347 [09:17<00:28,  1.69s/it] 95%|█████████▌| 331/347 [09:19<00:28,  1.77s/it] 96%|█████████▌| 332/347 [09:20<00:22,  1.52s/it] 96%|█████████▌| 333/347 [09:22<00:23,  1.66s/it] 96%|█████████▋| 334/347 [09:24<00:19,  1.50s/it] 97%|█████████▋| 335/347 [09:25<00:18,  1.55s/it] 97%|█████████▋| 336/347 [09:27<00:17,  1.56s/it] 97%|█████████▋| 337/347 [09:29<00:16,  1.66s/it] 97%|█████████▋| 338/347 [09:30<00:15,  1.72s/it] 98%|█████████▊| 339/347 [09:32<00:12,  1.59s/it] 98%|█████████▊| 340/347 [09:33<00:10,  1.50s/it] 98%|█████████▊| 341/347 [09:35<00:09,  1.51s/it] 99%|█████████▊| 342/347 [09:36<00:07,  1.54s/it] 99%|█████████▉| 343/347 [09:38<00:06,  1.61s/it] 99%|█████████▉| 344/347 [09:39<00:04,  1.48s/it] 99%|█████████▉| 345/347 [09:41<00:03,  1.58s/it]100%|█████████▉| 346/347 [09:42<00:01,  1.36s/it]100%|██████████| 347/347 [09:43<00:00,  1.31s/it]100%|██████████| 347/347 [09:43<00:00,  1.68s/it]
invalid api type, one_api_str:{'category': '人设', 'query': '你听过饭后百步走，活到九十九吗', 'tag': '你听过饭后百步走，活到九十九吗', 'apiname': 'charasearch'}
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"1820","lambdamart-score":"<nil>,-1.814065","service-version":"1b18d66"}}]}, query:AR体验毒液的用户感受如何
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"1028","lambdamart-score":"<nil>,-1.783967","service-version":"1b18d66"}}]}, query:AR体验毒液的用户感受如何
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"1004","lambdamart-score":"<nil>,-2.585299","service-version":"1b18d66"}}]}, query:AR体验毒液的用户感受如何
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"990","lambdamart-score":"<nil>,-2.585299","service-version":"1b18d66"}}]}, query:AR体验毒液的用户感受如何
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"985","lambdamart-score":"<nil>,-0.905533","service-version":"1b18d66"}}]}, query:AR体验毒液的用户感受如何
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"1520","lambdamart-score":"<nil>,-1.600452","service-version":"1b18d66"}}]}, query:传统燃油车市场份额计算方法
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"701","lambdamart-score":"<nil>,-0.886527","service-version":"1b18d66"}}]}, query:传统燃油车市场份额计算方法
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"685","lambdamart-score":"<nil>,-0.905533","service-version":"1b18d66"}}]}, query:传统燃油车市场份额计算方法
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"695","lambdamart-score":"<nil>,-2.089855","service-version":"1b18d66"}}]}, query:传统燃油车市场份额计算方法
exception:'bot_data', parse search results:{"metadata":{"dynamic_info":{"position":{"latitude":22.993279,"longitude":113.702286,"coordinate":"wgs84"},"speaker_seat":"RIGHT_SEAT_OF_SECOND_ROW","night_mode":"NIGHT_MODE_NIGHT"},"vehicle_info":{"vehicle_config_code":"7,64,9,32,1,255,255,9,77,3,67,3,2,3,3,255,255","hu_ota_version":"4.5.1-1.12.101","user_manual_version":"7","help_app_version":"2003000","vin":"1c4dd333c1f111111","vehicle_model":"VEHICLE_MODEL_X01","spu":"ss3pro","voice_version":"5.2.0.4","hu_version":"4.1.12006"},"request_info":{"msg_id":"postman-liping-1reaHUeB9WEITBe9"}},"message":"success","data":[{"bot_name":"knowledge-search-engine","bot_version":"1b18d66","debug_info":{"knowledge-search-engine-cost":"703","lambdamart-score":"<nil>,-0.905533","service-version":"1b18d66"}}]}, query:传统燃油车市场份额计算方法
invalid api type, one_api_str:{'keyphrase': '2560*1440的图片适合用作桌面壁纸吗', 'category': '其他', 'style': '写实', 'apiname': 'aipainting'}
invalid api type, one_api_str:{'domain': '车控', 'action': '调节', 'entity': '屏幕', 'sub': '亮度', 'range': '大一点', 'apiname': 'todrequest'}
invalid api type, one_api_str:{'keyphrase': '1920*536', 'category': '其他', 'style': '写实', 'apiname': 'aipainting'}
有效obs数量 341
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-26/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 341 / 341
  0%|          | 0/341 [00:00<?, ?it/s]  0%|          | 1/341 [00:08<48:17,  8.52s/it]  1%|          | 2/341 [00:09<24:40,  4.37s/it]  1%|          | 3/341 [00:16<30:17,  5.38s/it]  1%|          | 4/341 [00:20<26:31,  4.72s/it]  2%|▏         | 6/341 [00:32<30:21,  5.44s/it]  2%|▏         | 8/341 [00:33<18:25,  3.32s/it]  3%|▎         | 10/341 [00:36<14:38,  2.65s/it]  3%|▎         | 11/341 [00:37<12:47,  2.33s/it]  4%|▍         | 13/341 [00:51<22:32,  4.12s/it]  6%|▌         | 20/341 [00:53<08:30,  1.59s/it]  6%|▋         | 22/341 [00:57<08:51,  1.67s/it]  7%|▋         | 24/341 [01:17<18:59,  3.59s/it]  9%|▉         | 31/341 [01:20<09:58,  1.93s/it] 10%|▉         | 34/341 [01:24<08:46,  1.72s/it] 11%|█         | 36/341 [01:26<08:21,  1.64s/it] 12%|█▏        | 40/341 [01:33<08:20,  1.66s/it] 13%|█▎        | 43/341 [01:40<09:07,  1.84s/it] 13%|█▎        | 44/341 [01:41<08:31,  1.72s/it] 13%|█▎        | 46/341 [01:46<09:16,  1.89s/it] 14%|█▍        | 48/341 [02:03<17:54,  3.67s/it] 16%|█▌        | 54/341 [02:08<10:12,  2.14s/it] 16%|█▌        | 55/341 [02:19<15:00,  3.15s/it] 18%|█▊        | 60/341 [02:33<14:07,  3.02s/it] 19%|█▉        | 65/341 [02:33<08:32,  1.86s/it] 19%|█▉        | 65/341 [02:44<08:32,  1.86s/it] 19%|█▉        | 66/341 [02:50<15:13,  3.32s/it] 21%|██        | 70/341 [02:51<10:03,  2.23s/it] 21%|██        | 72/341 [03:04<13:47,  3.07s/it] 22%|██▏       | 76/341 [03:10<11:01,  2.50s/it] 23%|██▎       | 77/341 [03:12<10:50,  2.47s/it] 23%|██▎       | 80/341 [03:34<17:56,  4.13s/it] 26%|██▌       | 87/341 [03:34<08:18,  1.96s/it] 26%|██▌       | 89/341 [03:37<07:53,  1.88s/it] 27%|██▋       | 91/341 [03:49<11:12,  2.69s/it] 27%|██▋       | 92/341 [03:52<11:15,  2.71s/it] 27%|██▋       | 93/341 [03:54<10:55,  2.64s/it] 28%|██▊       | 95/341 [03:56<08:18,  2.03s/it] 28%|██▊       | 96/341 [04:02<11:39,  2.86s/it] 28%|██▊       | 97/341 [04:02<09:24,  2.31s/it] 29%|██▊       | 98/341 [04:04<08:18,  2.05s/it] 29%|██▉       | 99/341 [04:05<07:33,  1.87s/it] 29%|██▉       | 100/341 [04:06<06:40,  1.66s/it] 30%|██▉       | 101/341 [04:13<12:22,  3.09s/it] 30%|███       | 104/341 [04:15<07:17,  1.85s/it] 31%|███       | 106/341 [04:20<07:51,  2.01s/it] 32%|███▏      | 108/341 [04:22<06:24,  1.65s/it] 32%|███▏      | 109/341 [04:25<07:37,  1.97s/it] 32%|███▏      | 110/341 [04:31<11:14,  2.92s/it] 33%|███▎      | 111/341 [04:33<10:19,  2.69s/it] 33%|███▎      | 114/341 [04:38<08:15,  2.18s/it] 34%|███▎      | 115/341 [04:51<15:23,  4.09s/it] 35%|███▌      | 121/341 [05:00<09:18,  2.54s/it] 36%|███▌      | 122/341 [05:01<08:36,  2.36s/it] 36%|███▌      | 123/341 [05:03<08:09,  2.25s/it] 36%|███▋      | 124/341 [05:06<08:23,  2.32s/it] 37%|███▋      | 125/341 [05:17<15:28,  4.30s/it] 38%|███▊      | 128/341 [05:22<10:27,  2.95s/it] 38%|███▊      | 131/341 [05:27<08:45,  2.50s/it] 39%|███▉      | 133/341 [05:33<09:04,  2.62s/it] 40%|███▉      | 135/341 [06:23<30:54,  9.00s/it] 43%|████▎     | 148/341 [06:31<09:19,  2.90s/it] 44%|████▍     | 151/341 [06:41<09:22,  2.96s/it] 45%|████▌     | 154/341 [06:44<08:06,  2.60s/it] 46%|████▋     | 158/341 [06:49<06:32,  2.14s/it] 47%|████▋     | 160/341 [06:55<07:02,  2.34s/it] 48%|████▊     | 163/341 [07:00<06:16,  2.11s/it] 48%|████▊     | 164/341 [07:08<08:13,  2.79s/it] 48%|████▊     | 165/341 [07:09<07:41,  2.62s/it] 49%|████▉     | 167/341 [07:27<12:57,  4.47s/it] 51%|█████     | 174/341 [07:36<07:13,  2.60s/it] 52%|█████▏    | 176/341 [07:38<06:11,  2.25s/it] 52%|█████▏    | 178/341 [07:46<07:12,  2.65s/it] 53%|█████▎    | 180/341 [07:50<06:33,  2.44s/it] 53%|█████▎    | 181/341 [07:55<07:40,  2.88s/it] 54%|█████▍    | 184/341 [08:11<09:48,  3.75s/it] 54%|█████▍    | 185/341 [08:12<08:55,  3.43s/it] 55%|█████▍    | 187/341 [08:45<18:54,  7.37s/it] 57%|█████▋    | 196/341 [08:49<06:40,  2.76s/it] 58%|█████▊    | 197/341 [08:58<08:09,  3.40s/it] 58%|█████▊    | 198/341 [09:21<13:36,  5.71s/it] 60%|█████▉    | 203/341 [09:49<12:58,  5.64s/it] 61%|██████    | 208/341 [10:05<10:23,  4.69s/it] 62%|██████▏   | 211/341 [10:08<08:03,  3.72s/it] 62%|██████▏   | 213/341 [10:15<07:57,  3.73s/it] 63%|██████▎   | 214/341 [11:08<20:37,  9.75s/it] 66%|██████▌   | 224/341 [11:29<09:32,  4.89s/it] 67%|██████▋   | 228/341 [11:33<07:10,  3.81s/it] 67%|██████▋   | 229/341 [11:38<07:24,  3.97s/it] 68%|██████▊   | 231/341 [12:21<13:38,  7.44s/it] 71%|███████   | 241/341 [12:30<06:00,  3.61s/it] 71%|███████▏  | 243/341 [12:31<05:06,  3.13s/it] 72%|███████▏  | 244/341 [12:41<06:07,  3.79s/it] 72%|███████▏  | 247/341 [12:41<04:17,  2.74s/it] 73%|███████▎  | 248/341 [12:46<04:36,  2.98s/it] 73%|███████▎  | 249/341 [12:56<06:02,  3.94s/it] 74%|███████▍  | 253/341 [12:56<03:13,  2.20s/it] 75%|███████▍  | 255/341 [13:03<03:40,  2.56s/it] 75%|███████▌  | 256/341 [13:04<03:15,  2.30s/it] 75%|███████▌  | 257/341 [13:08<03:41,  2.64s/it] 76%|███████▌  | 258/341 [13:18<05:40,  4.10s/it] 77%|███████▋  | 262/341 [13:48<07:45,  5.89s/it] 78%|███████▊  | 266/341 [13:49<04:20,  3.48s/it] 79%|███████▉  | 269/341 [13:58<03:57,  3.30s/it] 79%|███████▉  | 270/341 [14:01<03:52,  3.28s/it] 80%|███████▉  | 272/341 [14:05<03:17,  2.86s/it] 80%|████████  | 273/341 [14:08<03:19,  2.94s/it] 80%|████████  | 274/341 [14:21<05:21,  4.80s/it] 82%|████████▏ | 279/341 [14:30<03:08,  3.05s/it] 82%|████████▏ | 281/341 [14:30<02:21,  2.36s/it] 83%|████████▎ | 282/341 [14:33<02:19,  2.37s/it] 83%|████████▎ | 283/341 [14:39<03:02,  3.15s/it] 84%|████████▎ | 285/341 [14:46<02:54,  3.12s/it] 84%|████████▍ | 286/341 [15:00<04:56,  5.38s/it] 85%|████████▍ | 289/341 [15:03<02:52,  3.31s/it] 85%|████████▌ | 290/341 [15:04<02:32,  2.99s/it] 85%|████████▌ | 291/341 [15:15<03:44,  4.49s/it] 86%|████████▌ | 293/341 [15:17<02:39,  3.33s/it] 87%|████████▋ | 296/341 [15:29<02:41,  3.59s/it] 87%|████████▋ | 298/341 [15:33<02:13,  3.11s/it] 88%|████████▊ | 299/341 [15:37<02:20,  3.34s/it] 88%|████████▊ | 300/341 [15:49<03:22,  4.94s/it] 89%|████████▉ | 304/341 [15:53<01:45,  2.86s/it] 90%|█████████ | 307/341 [16:05<01:50,  3.24s/it] 91%|█████████ | 309/341 [16:07<01:27,  2.75s/it] 91%|█████████ | 310/341 [16:21<02:16,  4.39s/it] 92%|█████████▏| 313/341 [16:35<02:06,  4.51s/it] 93%|█████████▎| 318/341 [16:39<01:02,  2.73s/it] 94%|█████████▎| 319/341 [16:40<00:55,  2.51s/it] 94%|█████████▍| 320/341 [16:46<01:02,  2.97s/it] 94%|█████████▍| 322/341 [16:48<00:47,  2.52s/it] 95%|█████████▍| 323/341 [16:50<00:41,  2.30s/it] 95%|█████████▌| 324/341 [16:54<00:45,  2.68s/it] 95%|█████████▌| 325/341 [17:00<00:55,  3.48s/it] 96%|█████████▌| 326/341 [17:03<00:49,  3.31s/it] 96%|█████████▋| 329/341 [17:05<00:24,  2.04s/it] 97%|█████████▋| 331/341 [17:11<00:22,  2.28s/it] 98%|█████████▊| 333/341 [17:15<00:18,  2.27s/it] 98%|█████████▊| 334/341 [17:22<00:21,  3.05s/it] 99%|█████████▊| 336/341 [17:23<00:10,  2.18s/it] 99%|█████████▉| 337/341 [17:29<00:12,  3.01s/it] 99%|█████████▉| 339/341 [17:36<00:06,  3.20s/it]100%|██████████| 341/341 [17:59<00:00,  5.87s/it]100%|██████████| 341/341 [17:59<00:00,  3.16s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-08-28 22:39:09  
[INFO] duration: 39 min 
[2024-08-29 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-27/prod/2024-08-27_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-29 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-27/prod/2024-08-27_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-27
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-27/prod/2024-08-27_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-27/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-27/prod/2024-08-27_rule_labeled.csv.gpt_labeled.csv
raw log len: 960
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-08-29 22:00:17 
[INFO] duration: 0 min 
[2024-08-30 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-28/prod/2024-08-28_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-30 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-28/prod/2024-08-28_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-28
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-28/prod/2024-08-28_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-28/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-28/prod/2024-08-28_rule_labeled.csv.gpt_labeled.csv
raw log len: 761
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-08-30 22:00:19 
[INFO] duration: 0 min 
[2024-08-31 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-29/prod/2024-08-29_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-08-31 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-29/prod/2024-08-29_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-29
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-29/prod/2024-08-29_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-29/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-29/prod/2024-08-29_rule_labeled.csv.gpt_labeled.csv
raw log len: 1033
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-08-31 22:00:18 
[INFO] duration: 0 min 
[2024-09-01 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-30/prod/2024-08-30_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-01 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-30/prod/2024-08-30_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-30
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-30/prod/2024-08-30_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-30/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-30/prod/2024-08-30_rule_labeled.csv.gpt_labeled.csv
raw log len: 787
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-09-01 22:00:17 
[INFO] duration: 0 min 
[2024-09-02 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-31/prod/2024-08-31_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-02 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-31/prod/2024-08-31_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-08-31
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-31/prod/2024-08-31_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-08-31/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-08-31/prod/2024-08-31_rule_labeled.csv.gpt_labeled.csv
raw log len: 292
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-09-02 22:00:18 
[INFO] duration: 0 min 
[2024-09-03 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-01/prod/2024-09-01_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-03 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-01/prod/2024-09-01_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-01
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-01/prod/2024-09-01_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-01/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-01/prod/2024-09-01_rule_labeled.csv.gpt_labeled.csv
raw log len: 99
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-09-03 22:00:19 
[INFO] duration: 0 min 
[2024-09-04 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-02/prod/2024-09-02_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-04 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-02/prod/2024-09-02_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-02
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-02/prod/2024-09-02_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-02/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-02/prod/2024-09-02_rule_labeled.csv.gpt_labeled.csv
raw log len: 581
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-09-04 22:00:21 
[INFO] duration: 0 min 
[2024-09-05 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-03/prod/2024-09-03_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-05 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-03/prod/2024-09-03_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-03
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-03/prod/2024-09-03_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-03/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-03/prod/2024-09-03_rule_labeled.csv.gpt_labeled.csv
raw log len: 431
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 186, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 104, in get_distillation_data
    query_ls_with_metadata = self.get_new_query_ls_with_metadata(filter_df)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 70, in get_new_query_ls_with_metadata
    query_ls1 = self.get_query_ls_with_metadata(df, 'generalized_question_from_user')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 59, in get_query_ls_with_metadata
    queries = row[query_column_name].split('\n')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'split'
[INFO] end_time: 2024-09-05 22:00:19 
[INFO] duration: 0 min 
[2024-09-06 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-04/prod/2024-09-04_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-06 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-04/prod/2024-09-04_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-04
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-04/prod/2024-09-04_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-04/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-04/prod/2024-09-04_rule_labeled.csv.gpt_labeled.csv
raw log len: 470
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 189, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/get_extension_log_distillation.py", line 116, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py", line 177, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-09-06 22:00:22 
[INFO] duration: 0 min 
[2024-09-07 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-05/prod/2024-09-05_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-07 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-05/prod/2024-09-05_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-05
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-05/prod/2024-09-05_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-05/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-05/prod/2024-09-05_rule_labeled.csv.gpt_labeled.csv
raw log len: 333
时效人设任务型query 数量： 10
unique queries len: 175
调用API
  0%|          | 0/175 [00:00<?, ?it/s]  1%|          | 2/175 [00:02<03:01,  1.05s/it]  2%|▏         | 3/175 [00:04<04:16,  1.49s/it]  2%|▏         | 4/175 [00:07<05:54,  2.07s/it]  3%|▎         | 5/175 [00:09<05:50,  2.06s/it]  3%|▎         | 6/175 [00:10<05:20,  1.90s/it]  4%|▍         | 7/175 [00:12<05:18,  1.90s/it]  5%|▍         | 8/175 [00:15<05:42,  2.05s/it]  5%|▌         | 9/175 [00:16<05:21,  1.94s/it]  6%|▌         | 10/175 [00:18<05:21,  1.95s/it]  6%|▋         | 11/175 [00:20<05:06,  1.87s/it]  7%|▋         | 12/175 [00:20<03:43,  1.37s/it]  7%|▋         | 13/175 [00:22<04:02,  1.50s/it]  8%|▊         | 14/175 [00:23<03:59,  1.49s/it]  9%|▊         | 15/175 [00:25<04:13,  1.58s/it]  9%|▉         | 16/175 [00:27<04:27,  1.68s/it] 10%|▉         | 17/175 [00:27<03:16,  1.25s/it] 10%|█         | 18/175 [00:29<03:44,  1.43s/it] 11%|█         | 19/175 [00:31<04:02,  1.56s/it] 11%|█▏        | 20/175 [00:33<04:18,  1.67s/it] 12%|█▏        | 21/175 [00:35<04:30,  1.76s/it] 13%|█▎        | 22/175 [00:37<04:35,  1.80s/it] 13%|█▎        | 23/175 [00:39<04:35,  1.82s/it] 14%|█▎        | 24/175 [00:41<04:33,  1.81s/it] 14%|█▍        | 25/175 [00:43<04:55,  1.97s/it] 15%|█▍        | 26/175 [00:45<04:53,  1.97s/it] 15%|█▌        | 27/175 [00:45<03:34,  1.45s/it] 16%|█▌        | 28/175 [00:47<03:47,  1.55s/it] 17%|█▋        | 29/175 [00:49<03:52,  1.59s/it] 17%|█▋        | 30/175 [00:50<03:53,  1.61s/it] 18%|█▊        | 31/175 [00:52<04:01,  1.68s/it] 18%|█▊        | 32/175 [00:54<04:05,  1.72s/it] 19%|█▉        | 33/175 [00:56<04:23,  1.85s/it] 19%|█▉        | 34/175 [00:58<04:25,  1.88s/it] 20%|██        | 35/175 [00:58<03:14,  1.39s/it] 21%|██        | 36/175 [01:01<03:48,  1.65s/it] 21%|██        | 37/175 [01:02<03:44,  1.63s/it] 22%|██▏       | 38/175 [01:04<04:02,  1.77s/it] 22%|██▏       | 39/175 [01:06<03:49,  1.69s/it] 23%|██▎       | 40/175 [01:08<03:54,  1.73s/it] 23%|██▎       | 41/175 [01:09<03:48,  1.71s/it] 24%|██▍       | 42/175 [01:11<03:50,  1.73s/it] 25%|██▍       | 43/175 [01:13<03:50,  1.75s/it] 25%|██▌       | 44/175 [01:15<04:06,  1.88s/it] 26%|██▌       | 45/175 [01:17<03:59,  1.84s/it] 26%|██▋       | 46/175 [01:18<03:50,  1.79s/it] 27%|██▋       | 47/175 [01:20<03:46,  1.77s/it] 27%|██▋       | 48/175 [01:22<03:54,  1.85s/it] 28%|██▊       | 49/175 [01:24<03:48,  1.81s/it] 29%|██▊       | 50/175 [01:25<03:39,  1.75s/it] 29%|██▉       | 51/175 [01:28<03:56,  1.91s/it] 30%|██▉       | 52/175 [01:31<04:40,  2.28s/it] 30%|███       | 53/175 [01:33<04:31,  2.22s/it] 31%|███       | 54/175 [01:35<04:04,  2.02s/it] 31%|███▏      | 55/175 [01:37<04:11,  2.09s/it] 32%|███▏      | 56/175 [01:41<05:25,  2.73s/it] 33%|███▎      | 57/175 [01:43<04:46,  2.43s/it] 33%|███▎      | 58/175 [01:45<04:22,  2.24s/it] 34%|███▎      | 59/175 [01:46<04:07,  2.14s/it] 34%|███▍      | 60/175 [01:48<03:57,  2.07s/it] 35%|███▍      | 61/175 [01:50<03:44,  1.97s/it] 35%|███▌      | 62/175 [01:52<03:40,  1.95s/it] 36%|███▌      | 63/175 [01:54<03:25,  1.84s/it] 37%|███▋      | 64/175 [01:55<03:22,  1.82s/it] 37%|███▋      | 65/175 [01:57<03:18,  1.81s/it] 38%|███▊      | 66/175 [01:59<03:10,  1.75s/it] 38%|███▊      | 67/175 [02:00<03:07,  1.73s/it] 39%|███▉      | 68/175 [02:02<03:10,  1.78s/it] 39%|███▉      | 69/175 [02:04<02:59,  1.70s/it] 40%|████      | 70/175 [02:06<03:09,  1.81s/it] 41%|████      | 71/175 [02:08<03:19,  1.91s/it] 41%|████      | 72/175 [02:08<02:25,  1.41s/it] 42%|████▏     | 73/175 [02:10<02:36,  1.54s/it] 42%|████▏     | 74/175 [02:12<02:42,  1.61s/it] 43%|████▎     | 75/175 [02:14<02:48,  1.69s/it] 43%|████▎     | 76/175 [02:17<03:27,  2.10s/it] 44%|████▍     | 77/175 [02:19<03:14,  1.99s/it] 45%|████▍     | 78/175 [02:20<03:01,  1.87s/it] 45%|████▌     | 79/175 [02:22<02:59,  1.87s/it] 46%|████▌     | 80/175 [02:24<03:07,  1.98s/it] 46%|████▋     | 81/175 [02:26<02:59,  1.91s/it] 47%|████▋     | 82/175 [02:28<02:56,  1.90s/it] 47%|████▋     | 83/175 [02:30<02:52,  1.87s/it] 48%|████▊     | 84/175 [02:31<02:45,  1.82s/it] 49%|████▊     | 85/175 [02:34<02:53,  1.93s/it] 49%|████▉     | 86/175 [02:35<02:49,  1.91s/it] 50%|████▉     | 87/175 [02:37<02:47,  1.90s/it] 50%|█████     | 88/175 [02:39<02:36,  1.80s/it] 51%|█████     | 89/175 [02:41<02:36,  1.82s/it] 51%|█████▏    | 90/175 [02:42<02:27,  1.74s/it] 52%|█████▏    | 91/175 [02:44<02:19,  1.66s/it] 53%|█████▎    | 92/175 [02:46<02:26,  1.77s/it] 53%|█████▎    | 93/175 [02:47<02:22,  1.74s/it] 54%|█████▎    | 94/175 [02:49<02:18,  1.71s/it] 54%|█████▍    | 95/175 [02:51<02:20,  1.76s/it] 55%|█████▍    | 96/175 [02:51<01:42,  1.30s/it] 55%|█████▌    | 97/175 [02:53<01:51,  1.43s/it] 56%|█████▌    | 98/175 [02:55<01:57,  1.52s/it] 57%|█████▋    | 99/175 [02:55<01:26,  1.13s/it] 57%|█████▋    | 100/175 [02:57<01:40,  1.35s/it] 58%|█████▊    | 101/175 [02:59<01:49,  1.48s/it] 58%|█████▊    | 102/175 [03:00<01:51,  1.52s/it] 59%|█████▉    | 103/175 [03:02<01:54,  1.59s/it] 59%|█████▉    | 104/175 [03:05<02:18,  1.95s/it] 60%|██████    | 105/175 [03:06<02:08,  1.83s/it] 61%|██████    | 106/175 [03:08<02:01,  1.76s/it] 61%|██████    | 107/175 [03:10<01:58,  1.75s/it] 62%|██████▏   | 108/175 [03:12<02:13,  1.99s/it] 62%|██████▏   | 109/175 [03:14<02:10,  1.97s/it] 63%|██████▎   | 110/175 [03:17<02:20,  2.16s/it] 63%|██████▎   | 111/175 [03:18<02:10,  2.04s/it] 64%|██████▍   | 112/175 [03:20<02:05,  2.00s/it] 65%|██████▍   | 113/175 [03:22<02:03,  1.99s/it] 65%|██████▌   | 114/175 [03:24<02:03,  2.02s/it] 66%|██████▌   | 115/175 [03:27<02:09,  2.16s/it] 66%|██████▋   | 116/175 [03:30<02:28,  2.52s/it] 67%|██████▋   | 117/175 [03:32<02:12,  2.28s/it] 67%|██████▋   | 118/175 [03:34<02:04,  2.19s/it] 68%|██████▊   | 119/175 [03:36<01:54,  2.04s/it] 69%|██████▊   | 120/175 [03:36<01:22,  1.50s/it] 69%|██████▉   | 121/175 [03:38<01:25,  1.58s/it] 70%|██████▉   | 122/175 [03:40<01:29,  1.69s/it] 70%|███████   | 123/175 [03:40<01:05,  1.25s/it] 71%|███████   | 124/175 [03:41<01:09,  1.36s/it] 71%|███████▏  | 125/175 [03:43<01:09,  1.40s/it] 72%|███████▏  | 126/175 [03:44<01:10,  1.44s/it] 73%|███████▎  | 127/175 [03:46<01:14,  1.56s/it] 73%|███████▎  | 128/175 [03:48<01:18,  1.66s/it] 74%|███████▎  | 129/175 [03:50<01:18,  1.70s/it] 74%|███████▍  | 130/175 [03:51<01:13,  1.63s/it] 75%|███████▍  | 131/175 [03:53<01:16,  1.75s/it] 75%|███████▌  | 132/175 [03:57<01:38,  2.29s/it] 76%|███████▌  | 133/175 [03:59<01:31,  2.18s/it] 77%|███████▋  | 134/175 [04:01<01:22,  2.01s/it] 77%|███████▋  | 135/175 [04:02<01:15,  1.89s/it] 78%|███████▊  | 136/175 [04:04<01:15,  1.92s/it] 78%|███████▊  | 137/175 [04:06<01:11,  1.89s/it] 79%|███████▉  | 138/175 [04:08<01:16,  2.08s/it] 79%|███████▉  | 139/175 [04:10<01:10,  1.96s/it] 80%|████████  | 140/175 [04:12<01:04,  1.84s/it] 81%|████████  | 141/175 [04:13<00:59,  1.76s/it] 81%|████████  | 142/175 [04:15<00:58,  1.77s/it] 82%|████████▏ | 143/175 [04:17<00:58,  1.83s/it] 82%|████████▏ | 144/175 [04:19<00:57,  1.86s/it] 83%|████████▎ | 145/175 [04:20<00:52,  1.74s/it] 83%|████████▎ | 146/175 [04:22<00:50,  1.75s/it] 84%|████████▍ | 147/175 [04:25<00:54,  1.96s/it] 85%|████████▍ | 148/175 [04:26<00:50,  1.87s/it] 85%|████████▌ | 149/175 [04:28<00:46,  1.77s/it] 86%|████████▌ | 150/175 [04:30<00:45,  1.82s/it] 86%|████████▋ | 151/175 [04:32<00:43,  1.79s/it] 87%|████████▋ | 152/175 [04:33<00:41,  1.79s/it] 87%|████████▋ | 153/175 [04:35<00:39,  1.78s/it] 88%|████████▊ | 154/175 [04:37<00:36,  1.75s/it] 89%|████████▊ | 155/175 [04:39<00:38,  1.94s/it] 89%|████████▉ | 156/175 [04:41<00:36,  1.92s/it] 90%|████████▉ | 157/175 [04:43<00:33,  1.87s/it] 90%|█████████ | 158/175 [04:45<00:31,  1.85s/it] 91%|█████████ | 159/175 [04:46<00:29,  1.85s/it] 91%|█████████▏| 160/175 [04:48<00:28,  1.89s/it] 92%|█████████▏| 161/175 [04:50<00:26,  1.90s/it] 93%|█████████▎| 162/175 [04:52<00:24,  1.85s/it] 93%|█████████▎| 163/175 [04:54<00:23,  1.96s/it] 94%|█████████▎| 164/175 [04:56<00:21,  1.99s/it] 94%|█████████▍| 165/175 [04:58<00:19,  1.98s/it] 95%|█████████▍| 166/175 [05:00<00:17,  1.91s/it] 95%|█████████▌| 167/175 [05:02<00:14,  1.83s/it] 96%|█████████▌| 168/175 [05:03<00:12,  1.75s/it] 97%|█████████▋| 169/175 [05:05<00:10,  1.72s/it] 97%|█████████▋| 170/175 [05:07<00:09,  1.83s/it] 98%|█████████▊| 171/175 [05:09<00:07,  1.84s/it] 98%|█████████▊| 172/175 [05:10<00:05,  1.75s/it] 99%|█████████▉| 173/175 [05:12<00:03,  1.72s/it] 99%|█████████▉| 174/175 [05:16<00:02,  2.52s/it]100%|██████████| 175/175 [05:18<00:00,  2.34s/it]100%|██████████| 175/175 [05:20<00:00,  1.83s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 166
调用obs
  0%|          | 0/166 [00:00<?, ?it/s]  1%|          | 1/166 [00:01<03:22,  1.23s/it]  1%|          | 2/166 [00:02<03:48,  1.40s/it]  2%|▏         | 3/166 [00:05<05:40,  2.09s/it]  2%|▏         | 4/166 [00:06<04:44,  1.76s/it]  3%|▎         | 5/166 [00:08<04:38,  1.73s/it]  4%|▎         | 6/166 [00:09<04:01,  1.51s/it]  4%|▍         | 7/166 [00:11<03:59,  1.51s/it]  5%|▍         | 8/166 [00:13<04:20,  1.65s/it]  5%|▌         | 9/166 [00:14<04:02,  1.54s/it]  6%|▌         | 10/166 [00:15<03:32,  1.36s/it]  7%|▋         | 11/166 [00:16<03:41,  1.43s/it]  7%|▋         | 12/166 [00:18<03:26,  1.34s/it]  8%|▊         | 13/166 [00:19<03:19,  1.30s/it]  8%|▊         | 14/166 [00:20<03:24,  1.34s/it]  9%|▉         | 15/166 [00:21<03:13,  1.28s/it] 10%|▉         | 16/166 [00:23<03:15,  1.30s/it] 10%|█         | 17/166 [00:24<03:15,  1.31s/it] 11%|█         | 18/166 [00:26<03:28,  1.41s/it] 11%|█▏        | 19/166 [00:27<03:24,  1.39s/it] 12%|█▏        | 20/166 [00:28<03:08,  1.29s/it] 13%|█▎        | 21/166 [00:30<03:14,  1.34s/it] 13%|█▎        | 22/166 [00:31<03:05,  1.29s/it] 14%|█▍        | 23/166 [00:32<02:43,  1.14s/it] 14%|█▍        | 24/166 [00:33<02:58,  1.25s/it] 15%|█▌        | 25/166 [00:34<02:49,  1.20s/it] 16%|█▋        | 27/166 [00:35<02:10,  1.06it/s] 17%|█▋        | 28/166 [00:37<02:34,  1.12s/it] 17%|█▋        | 29/166 [00:39<02:51,  1.25s/it] 18%|█▊        | 30/166 [00:39<02:08,  1.06it/s] 19%|█▊        | 31/166 [00:40<02:23,  1.06s/it] 19%|█▉        | 32/166 [00:41<02:28,  1.11s/it] 20%|█▉        | 33/166 [00:43<02:41,  1.22s/it] 20%|██        | 34/166 [00:44<02:45,  1.25s/it] 21%|██        | 35/166 [00:46<03:02,  1.39s/it] 22%|██▏       | 36/166 [00:47<02:54,  1.35s/it] 22%|██▏       | 37/166 [00:49<03:02,  1.41s/it] 23%|██▎       | 38/166 [00:50<02:52,  1.35s/it] 23%|██▎       | 39/166 [00:52<03:02,  1.44s/it] 24%|██▍       | 40/166 [00:53<02:53,  1.38s/it] 25%|██▍       | 41/166 [00:54<02:52,  1.38s/it] 25%|██▌       | 42/166 [00:56<03:04,  1.49s/it] 26%|██▌       | 43/166 [00:57<03:01,  1.47s/it] 27%|██▋       | 44/166 [00:59<02:45,  1.36s/it] 27%|██▋       | 45/166 [01:00<02:40,  1.32s/it] 28%|██▊       | 46/166 [01:01<02:38,  1.32s/it] 28%|██▊       | 47/166 [01:03<03:15,  1.65s/it] 29%|██▉       | 48/166 [01:05<03:09,  1.60s/it] 30%|██▉       | 49/166 [01:06<03:04,  1.57s/it] 30%|███       | 50/166 [01:08<02:44,  1.41s/it] 31%|███       | 51/166 [01:10<03:26,  1.80s/it] 31%|███▏      | 52/166 [01:11<03:07,  1.64s/it] 32%|███▏      | 53/166 [01:13<03:04,  1.64s/it] 33%|███▎      | 54/166 [01:14<02:48,  1.50s/it] 33%|███▎      | 55/166 [01:16<02:40,  1.44s/it] 34%|███▎      | 56/166 [01:17<02:41,  1.46s/it] 34%|███▍      | 57/166 [01:19<02:38,  1.45s/it] 35%|███▍      | 58/166 [01:20<02:30,  1.39s/it] 36%|███▌      | 59/166 [01:21<02:21,  1.32s/it] 36%|███▌      | 60/166 [01:23<02:32,  1.44s/it] 37%|███▋      | 61/166 [01:24<02:37,  1.50s/it] 37%|███▋      | 62/166 [01:26<02:37,  1.52s/it] 38%|███▊      | 63/166 [01:27<02:36,  1.52s/it] 39%|███▊      | 64/166 [01:29<02:41,  1.58s/it] 39%|███▉      | 65/166 [01:31<02:35,  1.54s/it] 40%|███▉      | 66/166 [01:32<02:25,  1.46s/it] 40%|████      | 67/166 [01:34<02:31,  1.54s/it] 41%|████      | 68/166 [01:35<02:28,  1.51s/it] 42%|████▏     | 69/166 [01:36<02:15,  1.40s/it] 42%|████▏     | 70/166 [01:38<02:37,  1.64s/it] 43%|████▎     | 71/166 [01:40<02:31,  1.60s/it] 43%|████▎     | 72/166 [01:41<02:17,  1.47s/it] 44%|████▍     | 73/166 [01:42<02:08,  1.38s/it] 45%|████▍     | 74/166 [01:43<02:04,  1.35s/it] 45%|████▌     | 75/166 [01:45<02:05,  1.38s/it] 46%|████▌     | 76/166 [01:46<02:07,  1.42s/it] 46%|████▋     | 77/166 [01:48<01:57,  1.32s/it] 47%|████▋     | 78/166 [01:49<02:02,  1.39s/it] 48%|████▊     | 79/166 [01:51<02:03,  1.42s/it] 48%|████▊     | 80/166 [01:51<01:46,  1.23s/it] 49%|████▉     | 81/166 [01:52<01:41,  1.19s/it] 49%|████▉     | 82/166 [01:54<01:46,  1.26s/it] 50%|█████     | 83/166 [01:55<01:51,  1.34s/it] 51%|█████     | 84/166 [01:57<02:03,  1.50s/it] 51%|█████     | 85/166 [01:59<02:05,  1.55s/it] 52%|█████▏    | 86/166 [02:01<02:07,  1.59s/it] 52%|█████▏    | 87/166 [02:01<01:35,  1.21s/it] 53%|█████▎    | 88/166 [02:02<01:29,  1.15s/it] 54%|█████▎    | 89/166 [02:03<01:37,  1.26s/it] 54%|█████▍    | 90/166 [02:05<01:33,  1.23s/it] 55%|█████▍    | 91/166 [02:07<01:49,  1.46s/it] 55%|█████▌    | 92/166 [02:08<01:45,  1.42s/it] 56%|█████▌    | 93/166 [02:09<01:38,  1.35s/it] 57%|█████▋    | 94/166 [02:10<01:34,  1.32s/it] 57%|█████▋    | 95/166 [02:12<01:37,  1.37s/it] 58%|█████▊    | 96/166 [02:14<02:01,  1.73s/it] 58%|█████▊    | 97/166 [02:15<01:36,  1.40s/it] 59%|█████▉    | 98/166 [02:17<01:45,  1.55s/it] 60%|█████▉    | 99/166 [02:19<01:46,  1.59s/it] 60%|██████    | 100/166 [02:20<01:37,  1.48s/it] 61%|██████    | 101/166 [02:22<01:43,  1.60s/it] 61%|██████▏   | 102/166 [02:23<01:34,  1.48s/it] 62%|██████▏   | 103/166 [02:24<01:27,  1.40s/it] 63%|██████▎   | 104/166 [02:26<01:28,  1.42s/it] 63%|██████▎   | 105/166 [02:26<01:15,  1.24s/it] 64%|██████▍   | 106/166 [02:28<01:14,  1.24s/it] 64%|██████▍   | 107/166 [02:29<01:17,  1.31s/it] 65%|██████▌   | 108/166 [02:32<01:44,  1.80s/it] 66%|██████▌   | 109/166 [02:34<01:37,  1.70s/it] 66%|██████▋   | 110/166 [02:35<01:27,  1.56s/it] 67%|██████▋   | 111/166 [02:36<01:14,  1.35s/it] 67%|██████▋   | 112/166 [02:37<01:10,  1.30s/it] 68%|██████▊   | 113/166 [02:39<01:16,  1.45s/it] 69%|██████▊   | 114/166 [02:40<01:10,  1.35s/it] 69%|██████▉   | 115/166 [02:41<01:08,  1.34s/it] 70%|██████▉   | 116/166 [02:43<01:09,  1.39s/it] 70%|███████   | 117/166 [02:44<01:08,  1.40s/it] 71%|███████   | 118/166 [02:45<01:02,  1.29s/it] 72%|███████▏  | 119/166 [02:46<01:02,  1.32s/it] 72%|███████▏  | 120/166 [02:48<01:00,  1.32s/it] 73%|███████▎  | 121/166 [02:49<00:58,  1.30s/it] 73%|███████▎  | 122/166 [02:52<01:19,  1.81s/it] 74%|███████▍  | 123/166 [02:54<01:13,  1.71s/it] 75%|███████▍  | 124/166 [02:55<01:07,  1.60s/it] 75%|███████▌  | 125/166 [02:56<01:02,  1.52s/it] 76%|███████▌  | 126/166 [02:57<00:54,  1.37s/it] 77%|███████▋  | 127/166 [02:59<00:57,  1.48s/it] 77%|███████▋  | 128/166 [03:01<00:57,  1.52s/it] 78%|███████▊  | 129/166 [03:02<00:54,  1.46s/it] 78%|███████▊  | 130/166 [03:03<00:52,  1.45s/it] 79%|███████▉  | 131/166 [03:04<00:43,  1.24s/it] 80%|███████▉  | 132/166 [03:05<00:41,  1.23s/it] 80%|████████  | 133/166 [03:07<00:42,  1.30s/it] 81%|████████  | 134/166 [03:08<00:44,  1.38s/it] 81%|████████▏ | 135/166 [03:09<00:36,  1.19s/it] 82%|████████▏ | 136/166 [03:10<00:32,  1.08s/it] 83%|████████▎ | 137/166 [03:11<00:32,  1.11s/it] 83%|████████▎ | 138/166 [03:13<00:34,  1.22s/it] 84%|████████▎ | 139/166 [03:14<00:32,  1.21s/it] 84%|████████▍ | 140/166 [03:15<00:34,  1.34s/it] 85%|████████▍ | 141/166 [03:17<00:36,  1.45s/it] 86%|████████▌ | 142/166 [03:18<00:33,  1.38s/it] 86%|████████▌ | 143/166 [03:19<00:27,  1.19s/it] 87%|████████▋ | 144/166 [03:21<00:29,  1.32s/it] 87%|████████▋ | 145/166 [03:22<00:29,  1.40s/it] 88%|████████▊ | 146/166 [03:23<00:26,  1.34s/it] 89%|████████▊ | 147/166 [03:25<00:28,  1.51s/it] 89%|████████▉ | 148/166 [03:27<00:25,  1.43s/it] 90%|████████▉ | 149/166 [03:28<00:24,  1.47s/it] 90%|█████████ | 150/166 [03:30<00:24,  1.51s/it] 91%|█████████ | 151/166 [03:31<00:22,  1.48s/it] 92%|█████████▏| 152/166 [03:33<00:20,  1.48s/it] 92%|█████████▏| 153/166 [03:34<00:18,  1.40s/it] 93%|█████████▎| 154/166 [03:35<00:16,  1.40s/it] 93%|█████████▎| 155/166 [03:37<00:16,  1.46s/it] 94%|█████████▍| 156/166 [03:38<00:14,  1.41s/it] 95%|█████████▍| 157/166 [03:40<00:12,  1.43s/it] 95%|█████████▌| 158/166 [03:41<00:11,  1.44s/it] 96%|█████████▌| 159/166 [03:43<00:10,  1.46s/it] 96%|█████████▋| 160/166 [03:44<00:08,  1.36s/it] 97%|█████████▋| 161/166 [03:45<00:06,  1.31s/it] 98%|█████████▊| 162/166 [03:46<00:05,  1.29s/it] 98%|█████████▊| 163/166 [03:47<00:03,  1.28s/it] 99%|█████████▉| 164/166 [03:51<00:03,  1.88s/it] 99%|█████████▉| 165/166 [03:52<00:01,  1.70s/it]100%|██████████| 166/166 [03:53<00:00,  1.53s/it]100%|██████████| 166/166 [03:53<00:00,  1.41s/it]
invalid api type, one_api_str:{'domain': '地图导航', 'action': '搜索', 'poi': '自行车', 'searchoption': '周边', 'apiname': 'todrequest'}
有效obs数量 165
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-05/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 165 / 165
  0%|          | 0/165 [00:00<?, ?it/s]  1%|          | 1/165 [00:35<1:38:19, 35.97s/it] 10%|█         | 17/165 [00:38<04:06,  1.66s/it]  11%|█         | 18/165 [00:41<04:18,  1.76s/it] 13%|█▎        | 22/165 [00:42<03:04,  1.29s/it] 14%|█▍        | 23/165 [00:56<06:07,  2.59s/it] 16%|█▋        | 27/165 [00:57<03:57,  1.72s/it] 19%|█▉        | 31/165 [01:05<04:01,  1.80s/it] 22%|██▏       | 36/165 [01:06<02:31,  1.17s/it] 22%|██▏       | 37/165 [01:11<03:28,  1.63s/it] 24%|██▎       | 39/165 [01:13<02:57,  1.41s/it] 25%|██▍       | 41/165 [01:14<02:38,  1.27s/it] 25%|██▌       | 42/165 [01:20<03:55,  1.92s/it] 27%|██▋       | 45/165 [01:26<03:53,  1.94s/it] 28%|██▊       | 47/165 [01:35<05:04,  2.58s/it] 30%|███       | 50/165 [01:35<03:17,  1.72s/it] 32%|███▏      | 53/165 [01:38<02:40,  1.43s/it] 33%|███▎      | 54/165 [01:43<03:42,  2.00s/it] 34%|███▍      | 56/165 [01:45<03:01,  1.66s/it] 35%|███▍      | 57/165 [01:46<02:42,  1.51s/it] 36%|███▌      | 59/165 [01:47<02:17,  1.29s/it] 38%|███▊      | 62/165 [01:56<03:12,  1.87s/it] 40%|████      | 66/165 [02:00<02:33,  1.55s/it] 42%|████▏     | 70/165 [02:02<01:43,  1.09s/it] 43%|████▎     | 71/165 [02:05<02:12,  1.41s/it] 44%|████▎     | 72/165 [02:06<01:57,  1.26s/it] 45%|████▌     | 75/165 [02:07<01:26,  1.05it/s] 46%|████▌     | 76/165 [02:10<01:54,  1.28s/it] 47%|████▋     | 78/165 [02:15<02:23,  1.65s/it] 48%|████▊     | 80/165 [02:20<02:43,  1.93s/it] 51%|█████     | 84/165 [02:22<01:41,  1.25s/it] 52%|█████▏    | 85/165 [02:25<02:00,  1.51s/it] 53%|█████▎    | 87/165 [02:28<01:52,  1.45s/it] 53%|█████▎    | 88/165 [02:30<01:56,  1.51s/it] 56%|█████▋    | 93/165 [02:38<01:53,  1.58s/it] 58%|█████▊    | 95/165 [02:41<01:48,  1.55s/it] 61%|██████    | 100/165 [02:44<01:11,  1.10s/it] 61%|██████    | 101/165 [02:46<01:18,  1.23s/it] 62%|██████▏   | 102/165 [02:47<01:14,  1.18s/it] 63%|██████▎   | 104/165 [02:48<01:03,  1.04s/it] 64%|██████▎   | 105/165 [02:57<02:18,  2.31s/it] 65%|██████▍   | 107/165 [03:01<02:15,  2.33s/it] 68%|██████▊   | 112/165 [03:02<01:01,  1.15s/it] 68%|██████▊   | 113/165 [03:12<02:03,  2.37s/it] 71%|███████   | 117/165 [03:14<01:15,  1.57s/it] 72%|███████▏  | 119/165 [03:22<01:34,  2.06s/it] 76%|███████▌  | 125/165 [03:22<00:41,  1.05s/it] 77%|███████▋  | 127/165 [03:27<00:50,  1.32s/it] 78%|███████▊  | 128/165 [03:27<00:44,  1.21s/it] 79%|███████▉  | 131/165 [03:32<00:45,  1.34s/it] 81%|████████  | 133/165 [03:33<00:37,  1.16s/it] 82%|████████▏ | 135/165 [03:39<00:48,  1.60s/it] 82%|████████▏ | 136/165 [03:45<01:05,  2.25s/it] 85%|████████▍ | 140/165 [03:47<00:37,  1.50s/it] 85%|████████▌ | 141/165 [03:51<00:45,  1.88s/it] 88%|████████▊ | 145/165 [03:57<00:32,  1.61s/it] 90%|████████▉ | 148/165 [04:00<00:25,  1.50s/it] 92%|█████████▏| 152/165 [04:10<00:24,  1.86s/it] 95%|█████████▌| 157/165 [04:11<00:09,  1.13s/it] 96%|█████████▌| 158/165 [04:11<00:07,  1.10s/it] 96%|█████████▋| 159/165 [04:25<00:16,  2.67s/it] 97%|█████████▋| 160/165 [04:25<00:11,  2.28s/it]100%|██████████| 165/165 [04:25<00:00,  1.61s/it]
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
chatgpt api 调用异常：Expecting value: line 1 column 1 (char 0)
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-07 22:16:07 
[INFO] duration: 16 min 
[2024-09-08 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-06/prod/2024-09-06_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-08 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-06/prod/2024-09-06_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-06
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-06/prod/2024-09-06_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-06/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-06/prod/2024-09-06_rule_labeled.csv.gpt_labeled.csv
raw log len: 340
时效人设任务型query 数量： 11
unique queries len: 185
调用API
  0%|          | 0/185 [00:00<?, ?it/s]  1%|          | 2/185 [00:02<03:06,  1.02s/it]  2%|▏         | 3/185 [00:05<05:59,  1.98s/it]  2%|▏         | 4/185 [00:07<05:54,  1.96s/it]  3%|▎         | 5/185 [00:10<06:52,  2.29s/it]  3%|▎         | 6/185 [00:12<06:23,  2.15s/it]  4%|▍         | 7/185 [00:13<05:55,  2.00s/it]  4%|▍         | 8/185 [00:15<06:02,  2.05s/it]  5%|▍         | 9/185 [00:17<05:40,  1.94s/it]  5%|▌         | 10/185 [00:19<05:16,  1.81s/it]  6%|▌         | 11/185 [00:20<05:02,  1.74s/it]  6%|▋         | 12/185 [00:22<04:50,  1.68s/it]  7%|▋         | 13/185 [00:25<05:56,  2.08s/it]  8%|▊         | 14/185 [00:26<05:26,  1.91s/it]  8%|▊         | 15/185 [00:28<05:06,  1.80s/it]  9%|▊         | 16/185 [00:30<05:09,  1.83s/it]  9%|▉         | 17/185 [00:31<04:57,  1.77s/it] 10%|▉         | 18/185 [00:35<06:09,  2.21s/it] 10%|█         | 19/185 [00:38<07:02,  2.54s/it] 11%|█         | 20/185 [00:40<06:54,  2.51s/it] 11%|█▏        | 21/185 [00:42<06:01,  2.21s/it] 12%|█▏        | 22/185 [00:44<05:46,  2.12s/it] 12%|█▏        | 23/185 [00:45<05:21,  1.98s/it] 13%|█▎        | 24/185 [00:47<05:13,  1.95s/it] 14%|█▎        | 25/185 [00:50<05:30,  2.06s/it] 14%|█▍        | 26/185 [00:51<05:17,  2.00s/it] 15%|█▍        | 27/185 [00:53<05:03,  1.92s/it] 15%|█▌        | 28/185 [00:55<04:45,  1.82s/it] 16%|█▌        | 29/185 [00:57<04:44,  1.82s/it] 16%|█▌        | 30/185 [00:59<04:46,  1.85s/it] 17%|█▋        | 31/185 [01:01<04:53,  1.90s/it] 17%|█▋        | 32/185 [01:03<05:30,  2.16s/it] 18%|█▊        | 33/185 [01:05<05:03,  2.00s/it] 18%|█▊        | 34/185 [01:07<04:50,  1.92s/it] 19%|█▉        | 35/185 [01:08<04:37,  1.85s/it] 19%|█▉        | 36/185 [01:10<04:26,  1.79s/it] 20%|██        | 37/185 [01:12<04:20,  1.76s/it] 21%|██        | 38/185 [01:13<04:15,  1.74s/it] 21%|██        | 39/185 [01:15<04:16,  1.75s/it] 22%|██▏       | 40/185 [01:17<04:08,  1.72s/it] 22%|██▏       | 41/185 [01:18<04:06,  1.71s/it] 23%|██▎       | 42/185 [01:22<05:24,  2.27s/it] 23%|██▎       | 43/185 [01:25<06:06,  2.58s/it] 24%|██▍       | 44/185 [01:27<05:23,  2.29s/it] 24%|██▍       | 45/185 [01:30<05:48,  2.49s/it] 25%|██▍       | 46/185 [01:32<05:20,  2.30s/it] 25%|██▌       | 47/185 [01:33<04:43,  2.05s/it] 26%|██▌       | 48/185 [01:35<04:18,  1.88s/it] 26%|██▋       | 49/185 [01:37<04:32,  2.00s/it] 27%|██▋       | 50/185 [01:37<03:19,  1.47s/it] 28%|██▊       | 51/185 [01:40<04:23,  1.97s/it] 28%|██▊       | 52/185 [01:42<04:15,  1.92s/it] 29%|██▊       | 53/185 [01:46<05:08,  2.34s/it] 29%|██▉       | 54/185 [01:48<04:52,  2.23s/it] 30%|██▉       | 55/185 [01:49<04:21,  2.01s/it] 30%|███       | 56/185 [01:51<04:20,  2.02s/it] 31%|███       | 57/185 [01:53<04:04,  1.91s/it] 31%|███▏      | 58/185 [01:55<04:00,  1.89s/it] 32%|███▏      | 59/185 [01:57<04:00,  1.91s/it] 32%|███▏      | 60/185 [01:57<02:56,  1.41s/it] 33%|███▎      | 61/185 [02:00<03:50,  1.86s/it] 34%|███▎      | 62/185 [02:02<03:51,  1.88s/it] 34%|███▍      | 63/185 [02:04<03:53,  1.91s/it] 35%|███▍      | 64/185 [02:06<04:03,  2.01s/it] 35%|███▌      | 65/185 [02:07<03:47,  1.89s/it] 36%|███▌      | 66/185 [02:09<03:39,  1.85s/it] 36%|███▌      | 67/185 [02:11<03:38,  1.85s/it] 37%|███▋      | 68/185 [02:13<03:36,  1.85s/it] 37%|███▋      | 69/185 [02:15<03:29,  1.80s/it] 38%|███▊      | 70/185 [02:18<04:17,  2.24s/it] 38%|███▊      | 71/185 [02:19<03:52,  2.04s/it] 39%|███▉      | 72/185 [02:21<03:31,  1.87s/it] 39%|███▉      | 73/185 [02:23<03:22,  1.80s/it] 40%|████      | 74/185 [02:24<03:12,  1.73s/it] 41%|████      | 75/185 [02:26<03:05,  1.68s/it] 41%|████      | 76/185 [02:27<03:07,  1.72s/it] 42%|████▏     | 77/185 [02:30<03:22,  1.87s/it] 42%|████▏     | 78/185 [02:32<03:19,  1.86s/it] 43%|████▎     | 79/185 [02:33<03:08,  1.78s/it] 43%|████▎     | 80/185 [02:35<03:04,  1.76s/it] 44%|████▍     | 81/185 [02:37<03:02,  1.76s/it] 44%|████▍     | 82/185 [02:39<03:06,  1.81s/it] 45%|████▍     | 83/185 [02:40<03:06,  1.82s/it] 45%|████▌     | 84/185 [02:42<03:12,  1.90s/it] 46%|████▌     | 85/185 [02:44<03:05,  1.85s/it] 46%|████▋     | 86/185 [02:46<03:03,  1.86s/it] 47%|████▋     | 87/185 [02:48<03:04,  1.88s/it] 48%|████▊     | 88/185 [02:50<02:58,  1.84s/it] 48%|████▊     | 89/185 [02:52<02:54,  1.81s/it] 49%|████▊     | 90/185 [02:53<02:52,  1.82s/it] 49%|████▉     | 91/185 [02:56<03:23,  2.17s/it] 50%|████▉     | 92/185 [02:59<03:22,  2.18s/it] 50%|█████     | 93/185 [03:00<03:08,  2.04s/it] 51%|█████     | 94/185 [03:02<02:52,  1.90s/it] 51%|█████▏    | 95/185 [03:04<02:46,  1.85s/it] 52%|█████▏    | 96/185 [03:05<02:41,  1.81s/it] 52%|█████▏    | 97/185 [03:07<02:35,  1.77s/it] 53%|█████▎    | 98/185 [03:09<02:39,  1.84s/it] 54%|█████▎    | 99/185 [03:10<02:28,  1.73s/it] 54%|█████▍    | 100/185 [03:12<02:26,  1.72s/it] 55%|█████▍    | 101/185 [03:14<02:29,  1.78s/it] 55%|█████▌    | 102/185 [03:16<02:32,  1.84s/it] 56%|█████▌    | 103/185 [03:16<01:50,  1.35s/it] 56%|█████▌    | 104/185 [03:18<02:01,  1.49s/it] 57%|█████▋    | 105/185 [03:20<02:03,  1.55s/it] 57%|█████▋    | 106/185 [03:22<02:11,  1.67s/it] 58%|█████▊    | 107/185 [03:23<02:08,  1.64s/it] 58%|█████▊    | 108/185 [03:25<02:04,  1.61s/it] 59%|█████▉    | 109/185 [03:27<02:07,  1.68s/it] 59%|█████▉    | 110/185 [03:30<02:46,  2.21s/it] 60%|██████    | 111/185 [03:32<02:42,  2.20s/it] 61%|██████    | 112/185 [03:34<02:31,  2.07s/it] 61%|██████    | 113/185 [03:36<02:25,  2.02s/it] 62%|██████▏   | 114/185 [03:37<02:13,  1.88s/it] 62%|██████▏   | 115/185 [03:40<02:18,  1.98s/it] 63%|██████▎   | 116/185 [03:43<02:48,  2.45s/it] 63%|██████▎   | 117/185 [03:45<02:34,  2.27s/it] 64%|██████▍   | 118/185 [03:47<02:19,  2.09s/it] 64%|██████▍   | 119/185 [03:49<02:11,  1.99s/it] 65%|██████▍   | 120/185 [03:50<02:04,  1.91s/it] 65%|██████▌   | 121/185 [03:52<01:59,  1.87s/it] 66%|██████▌   | 122/185 [03:54<01:56,  1.85s/it] 66%|██████▋   | 123/185 [03:56<01:53,  1.83s/it] 67%|██████▋   | 124/185 [03:57<01:51,  1.82s/it] 68%|██████▊   | 125/185 [04:01<02:20,  2.34s/it] 68%|██████▊   | 126/185 [04:03<02:08,  2.17s/it] 69%|██████▊   | 127/185 [04:04<01:54,  1.97s/it] 69%|██████▉   | 128/185 [04:06<01:50,  1.94s/it] 70%|██████▉   | 129/185 [04:08<01:50,  1.97s/it] 70%|███████   | 130/185 [04:10<01:40,  1.82s/it] 71%|███████   | 131/185 [04:11<01:37,  1.80s/it] 71%|███████▏  | 132/185 [04:15<01:57,  2.22s/it] 72%|███████▏  | 133/185 [04:16<01:50,  2.13s/it] 72%|███████▏  | 134/185 [04:18<01:45,  2.06s/it] 73%|███████▎  | 135/185 [04:20<01:39,  1.99s/it] 74%|███████▎  | 136/185 [04:22<01:36,  1.97s/it] 74%|███████▍  | 137/185 [04:22<01:09,  1.45s/it] 75%|███████▍  | 138/185 [04:25<01:21,  1.74s/it] 75%|███████▌  | 139/185 [04:28<01:41,  2.20s/it] 76%|███████▌  | 140/185 [04:30<01:32,  2.06s/it] 76%|███████▌  | 141/185 [04:32<01:26,  1.97s/it] 77%|███████▋  | 142/185 [04:33<01:18,  1.83s/it] 77%|███████▋  | 143/185 [04:35<01:16,  1.83s/it] 78%|███████▊  | 144/185 [04:37<01:21,  1.98s/it] 78%|███████▊  | 145/185 [04:40<01:23,  2.09s/it] 79%|███████▉  | 146/185 [04:41<01:17,  2.00s/it] 79%|███████▉  | 147/185 [04:43<01:13,  1.94s/it] 80%|████████  | 148/185 [04:45<01:13,  1.99s/it] 81%|████████  | 149/185 [04:47<01:09,  1.93s/it] 81%|████████  | 150/185 [04:49<01:07,  1.93s/it] 82%|████████▏ | 151/185 [04:51<01:03,  1.88s/it] 82%|████████▏ | 152/185 [04:52<00:58,  1.79s/it] 83%|████████▎ | 153/185 [04:55<01:08,  2.13s/it] 83%|████████▎ | 154/185 [04:57<01:02,  2.02s/it] 84%|████████▍ | 155/185 [04:59<01:01,  2.04s/it] 84%|████████▍ | 156/185 [05:01<00:55,  1.92s/it] 85%|████████▍ | 157/185 [05:02<00:50,  1.80s/it] 85%|████████▌ | 158/185 [05:04<00:49,  1.82s/it] 86%|████████▌ | 159/185 [05:06<00:46,  1.80s/it] 86%|████████▋ | 160/185 [05:08<00:48,  1.94s/it] 87%|████████▋ | 161/185 [05:10<00:46,  1.93s/it] 88%|████████▊ | 162/185 [05:12<00:43,  1.91s/it] 88%|████████▊ | 163/185 [05:14<00:40,  1.84s/it] 89%|████████▊ | 164/185 [05:15<00:37,  1.78s/it] 89%|████████▉ | 165/185 [05:15<00:26,  1.31s/it] 90%|████████▉ | 166/185 [05:17<00:26,  1.37s/it] 90%|█████████ | 167/185 [05:19<00:28,  1.56s/it] 91%|█████████ | 168/185 [05:22<00:33,  1.97s/it] 91%|█████████▏| 169/185 [05:22<00:23,  1.46s/it] 92%|█████████▏| 170/185 [05:26<00:33,  2.21s/it] 92%|█████████▏| 171/185 [05:28<00:30,  2.17s/it] 93%|█████████▎| 172/185 [05:30<00:27,  2.12s/it] 94%|█████████▎| 173/185 [05:32<00:24,  2.03s/it] 94%|█████████▍| 174/185 [05:34<00:21,  1.91s/it] 95%|█████████▍| 175/185 [05:35<00:18,  1.88s/it] 95%|█████████▌| 176/185 [05:37<00:16,  1.88s/it] 96%|█████████▌| 177/185 [05:39<00:14,  1.82s/it] 96%|█████████▌| 178/185 [05:41<00:12,  1.84s/it] 97%|█████████▋| 179/185 [05:43<00:10,  1.83s/it] 97%|█████████▋| 180/185 [05:44<00:09,  1.81s/it] 98%|█████████▊| 181/185 [05:46<00:07,  1.83s/it] 98%|█████████▊| 182/185 [05:48<00:05,  1.86s/it] 99%|█████████▉| 183/185 [05:50<00:03,  1.86s/it] 99%|█████████▉| 184/185 [05:52<00:01,  1.91s/it]100%|██████████| 185/185 [05:54<00:00,  1.96s/it]100%|██████████| 185/185 [05:56<00:00,  1.93s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 179
调用obs
  0%|          | 0/179 [00:00<?, ?it/s]  1%|          | 1/179 [00:01<03:25,  1.16s/it]  1%|          | 2/179 [00:03<05:39,  1.92s/it]  2%|▏         | 3/179 [00:04<04:48,  1.64s/it]  2%|▏         | 4/179 [00:07<05:34,  1.91s/it]  3%|▎         | 5/179 [00:08<04:52,  1.68s/it]  3%|▎         | 6/179 [00:09<04:24,  1.53s/it]  4%|▍         | 7/179 [00:11<04:10,  1.46s/it]  4%|▍         | 8/179 [00:12<03:58,  1.40s/it]  6%|▌         | 10/179 [00:13<02:54,  1.03s/it]  6%|▌         | 11/179 [00:14<02:59,  1.07s/it]  7%|▋         | 12/179 [00:17<04:09,  1.50s/it]  7%|▋         | 13/179 [00:18<03:38,  1.31s/it]  8%|▊         | 14/179 [00:19<03:34,  1.30s/it]  8%|▊         | 15/179 [00:20<03:27,  1.26s/it]  9%|▉         | 16/179 [00:21<03:20,  1.23s/it]  9%|▉         | 17/179 [00:23<04:01,  1.49s/it] 10%|█         | 18/179 [00:26<04:31,  1.69s/it] 11%|█         | 19/179 [00:27<04:04,  1.53s/it] 11%|█         | 20/179 [00:27<03:19,  1.25s/it] 12%|█▏        | 21/179 [00:29<03:14,  1.23s/it] 12%|█▏        | 22/179 [00:30<03:22,  1.29s/it] 13%|█▎        | 23/179 [00:31<03:18,  1.27s/it] 13%|█▎        | 24/179 [00:33<03:19,  1.29s/it] 14%|█▍        | 25/179 [00:34<03:19,  1.29s/it] 15%|█▌        | 27/179 [00:35<02:11,  1.16it/s] 16%|█▌        | 28/179 [00:36<02:25,  1.04it/s] 16%|█▌        | 29/179 [00:37<02:35,  1.04s/it] 17%|█▋        | 30/179 [00:39<03:09,  1.27s/it] 17%|█▋        | 31/179 [00:41<03:57,  1.60s/it] 18%|█▊        | 32/179 [00:43<03:45,  1.53s/it] 18%|█▊        | 33/179 [00:44<03:22,  1.39s/it] 19%|█▉        | 34/179 [00:45<03:23,  1.41s/it] 20%|█▉        | 35/179 [00:46<03:13,  1.34s/it] 20%|██        | 36/179 [00:48<03:06,  1.30s/it] 21%|██        | 37/179 [00:49<02:59,  1.27s/it] 21%|██        | 38/179 [00:50<03:03,  1.30s/it] 22%|██▏       | 39/179 [00:52<03:06,  1.33s/it] 22%|██▏       | 40/179 [00:53<03:14,  1.40s/it] 23%|██▎       | 41/179 [00:56<04:05,  1.78s/it] 23%|██▎       | 42/179 [00:58<04:29,  1.97s/it] 24%|██▍       | 43/179 [00:59<03:51,  1.70s/it] 25%|██▍       | 44/179 [01:02<04:08,  1.84s/it] 25%|██▌       | 45/179 [01:03<03:57,  1.77s/it] 26%|██▌       | 46/179 [01:04<03:33,  1.61s/it] 26%|██▋       | 47/179 [01:06<03:31,  1.60s/it] 27%|██▋       | 48/179 [01:07<03:14,  1.48s/it] 27%|██▋       | 49/179 [01:10<04:00,  1.85s/it] 28%|██▊       | 50/179 [01:11<03:32,  1.65s/it] 28%|██▊       | 51/179 [01:13<03:59,  1.87s/it] 29%|██▉       | 52/179 [01:15<03:26,  1.63s/it] 30%|██▉       | 53/179 [01:16<03:28,  1.65s/it] 30%|███       | 54/179 [01:17<03:07,  1.50s/it] 31%|███       | 55/179 [01:20<03:55,  1.90s/it] 31%|███▏      | 56/179 [01:22<03:34,  1.74s/it] 32%|███▏      | 57/179 [01:23<03:10,  1.56s/it] 32%|███▏      | 58/179 [01:25<03:43,  1.85s/it] 33%|███▎      | 59/179 [01:27<03:26,  1.72s/it] 34%|███▎      | 60/179 [01:29<03:50,  1.94s/it] 34%|███▍      | 61/179 [01:30<03:22,  1.72s/it] 35%|███▍      | 62/179 [01:32<03:14,  1.66s/it] 35%|███▌      | 63/179 [01:33<02:55,  1.51s/it] 36%|███▌      | 64/179 [01:34<02:51,  1.49s/it] 36%|███▋      | 65/179 [01:36<02:37,  1.38s/it] 37%|███▋      | 66/179 [01:37<02:28,  1.32s/it] 37%|███▋      | 67/179 [01:39<03:08,  1.68s/it] 38%|███▊      | 68/179 [01:40<02:46,  1.50s/it] 39%|███▊      | 69/179 [01:42<02:41,  1.47s/it] 39%|███▉      | 70/179 [01:43<02:36,  1.44s/it] 40%|███▉      | 71/179 [01:44<02:27,  1.36s/it] 40%|████      | 72/179 [01:46<02:21,  1.32s/it] 41%|████      | 73/179 [01:47<02:19,  1.32s/it] 41%|████▏     | 74/179 [01:48<02:17,  1.30s/it] 42%|████▏     | 75/179 [01:49<02:17,  1.32s/it] 42%|████▏     | 76/179 [01:50<01:45,  1.02s/it] 43%|████▎     | 77/179 [01:51<01:43,  1.01s/it] 44%|████▎     | 78/179 [01:52<01:48,  1.08s/it] 44%|████▍     | 79/179 [01:53<01:59,  1.20s/it] 45%|████▍     | 80/179 [01:55<02:07,  1.28s/it] 45%|████▌     | 81/179 [01:56<01:51,  1.14s/it] 46%|████▌     | 82/179 [01:57<01:52,  1.16s/it] 46%|████▋     | 83/179 [01:58<01:50,  1.15s/it] 47%|████▋     | 84/179 [01:59<01:49,  1.15s/it] 47%|████▋     | 85/179 [02:00<01:46,  1.13s/it] 48%|████▊     | 86/179 [02:01<01:41,  1.09s/it] 49%|████▊     | 87/179 [02:03<01:46,  1.16s/it] 49%|████▉     | 88/179 [02:05<02:29,  1.64s/it] 50%|████▉     | 89/179 [02:07<02:13,  1.49s/it] 50%|█████     | 90/179 [02:08<02:07,  1.44s/it] 51%|█████     | 91/179 [02:09<01:58,  1.35s/it] 51%|█████▏    | 92/179 [02:10<01:51,  1.28s/it] 52%|█████▏    | 93/179 [02:11<01:52,  1.30s/it] 53%|█████▎    | 94/179 [02:13<01:51,  1.31s/it] 53%|█████▎    | 95/179 [02:15<02:03,  1.47s/it] 54%|█████▎    | 96/179 [02:16<01:55,  1.39s/it] 54%|█████▍    | 97/179 [02:17<01:39,  1.21s/it] 55%|█████▍    | 98/179 [02:19<01:54,  1.41s/it] 55%|█████▌    | 99/179 [02:20<01:43,  1.30s/it] 56%|█████▌    | 100/179 [02:21<01:44,  1.32s/it] 56%|█████▋    | 101/179 [02:22<01:41,  1.30s/it] 57%|█████▋    | 102/179 [02:23<01:37,  1.27s/it] 58%|█████▊    | 103/179 [02:25<01:45,  1.38s/it] 58%|█████▊    | 104/179 [02:26<01:39,  1.32s/it] 59%|█████▊    | 105/179 [02:27<01:29,  1.20s/it] 59%|█████▉    | 106/179 [02:30<02:02,  1.67s/it] 60%|█████▉    | 107/179 [02:33<02:24,  2.00s/it] 60%|██████    | 108/179 [02:34<02:10,  1.84s/it] 61%|██████    | 109/179 [02:36<02:04,  1.77s/it] 61%|██████▏   | 110/179 [02:37<01:52,  1.62s/it] 62%|██████▏   | 111/179 [02:38<01:44,  1.53s/it] 63%|██████▎   | 112/179 [02:41<02:03,  1.85s/it] 63%|██████▎   | 113/179 [02:42<01:47,  1.63s/it] 64%|██████▎   | 114/179 [02:43<01:40,  1.55s/it] 64%|██████▍   | 115/179 [02:45<01:35,  1.48s/it] 65%|██████▍   | 116/179 [02:46<01:29,  1.42s/it] 65%|██████▌   | 117/179 [02:48<01:29,  1.44s/it] 66%|██████▌   | 118/179 [02:49<01:27,  1.43s/it] 66%|██████▋   | 119/179 [02:50<01:23,  1.40s/it] 67%|██████▋   | 120/179 [02:51<01:16,  1.29s/it] 68%|██████▊   | 121/179 [02:54<01:37,  1.67s/it] 68%|██████▊   | 122/179 [02:55<01:20,  1.42s/it] 69%|██████▊   | 123/179 [02:56<01:15,  1.34s/it] 69%|██████▉   | 124/179 [02:58<01:21,  1.48s/it] 70%|██████▉   | 125/179 [02:58<01:07,  1.25s/it] 70%|███████   | 126/179 [02:59<01:03,  1.19s/it] 71%|███████   | 127/179 [03:01<01:08,  1.33s/it] 72%|███████▏  | 128/179 [03:03<01:22,  1.61s/it] 72%|███████▏  | 129/179 [03:05<01:16,  1.54s/it] 73%|███████▎  | 130/179 [03:06<01:10,  1.44s/it] 73%|███████▎  | 131/179 [03:07<01:05,  1.36s/it] 74%|███████▎  | 132/179 [03:09<01:05,  1.40s/it] 75%|███████▍  | 134/179 [03:11<00:58,  1.31s/it] 75%|███████▌  | 135/179 [03:11<00:45,  1.04s/it] 76%|███████▌  | 136/179 [03:11<00:34,  1.23it/s] 77%|███████▋  | 137/179 [03:13<00:39,  1.06it/s] 77%|███████▋  | 138/179 [03:14<00:39,  1.03it/s] 78%|███████▊  | 139/179 [03:15<00:41,  1.03s/it] 78%|███████▊  | 140/179 [03:16<00:43,  1.11s/it] 79%|███████▉  | 141/179 [03:18<00:47,  1.24s/it] 79%|███████▉  | 142/179 [03:19<00:46,  1.25s/it] 80%|███████▉  | 143/179 [03:20<00:41,  1.14s/it] 80%|████████  | 144/179 [03:21<00:38,  1.10s/it] 81%|████████  | 145/179 [03:22<00:38,  1.14s/it] 82%|████████▏ | 146/179 [03:23<00:38,  1.17s/it] 82%|████████▏ | 147/179 [03:24<00:34,  1.09s/it] 83%|████████▎ | 148/179 [03:27<00:46,  1.51s/it] 83%|████████▎ | 149/179 [03:28<00:42,  1.41s/it] 84%|████████▍ | 150/179 [03:29<00:36,  1.26s/it] 84%|████████▍ | 151/179 [03:30<00:34,  1.25s/it] 85%|████████▍ | 152/179 [03:31<00:33,  1.22s/it] 85%|████████▌ | 153/179 [03:33<00:32,  1.26s/it] 86%|████████▌ | 154/179 [03:34<00:30,  1.22s/it] 87%|████████▋ | 155/179 [03:35<00:29,  1.22s/it] 87%|████████▋ | 156/179 [03:36<00:28,  1.22s/it] 88%|████████▊ | 157/179 [03:37<00:26,  1.20s/it] 88%|████████▊ | 158/179 [03:38<00:24,  1.17s/it] 89%|████████▉ | 159/179 [03:40<00:25,  1.25s/it] 89%|████████▉ | 160/179 [03:41<00:23,  1.25s/it] 90%|████████▉ | 161/179 [03:42<00:23,  1.29s/it] 91%|█████████ | 162/179 [03:45<00:26,  1.58s/it] 91%|█████████ | 163/179 [03:47<00:29,  1.83s/it] 92%|█████████▏| 164/179 [03:48<00:23,  1.54s/it] 92%|█████████▏| 165/179 [03:49<00:20,  1.44s/it] 93%|█████████▎| 166/179 [03:51<00:18,  1.43s/it] 93%|█████████▎| 167/179 [03:52<00:17,  1.44s/it] 94%|█████████▍| 168/179 [03:53<00:14,  1.36s/it] 94%|█████████▍| 169/179 [03:55<00:13,  1.40s/it] 95%|█████████▍| 170/179 [03:56<00:11,  1.32s/it] 96%|█████████▌| 171/179 [03:57<00:09,  1.21s/it] 96%|█████████▌| 172/179 [03:58<00:09,  1.30s/it] 97%|█████████▋| 173/179 [04:00<00:07,  1.27s/it] 97%|█████████▋| 174/179 [04:00<00:05,  1.16s/it] 98%|█████████▊| 175/179 [04:02<00:05,  1.29s/it] 98%|█████████▊| 176/179 [04:03<00:03,  1.25s/it] 99%|█████████▉| 177/179 [04:04<00:02,  1.10s/it] 99%|█████████▉| 178/179 [04:06<00:01,  1.26s/it]100%|██████████| 179/179 [04:07<00:00,  1.29s/it]100%|██████████| 179/179 [04:07<00:00,  1.38s/it]
invalid api type, one_api_str:{'domain': '车控', 'action': '调节', 'entity': '辣度', 'range': '适中', 'apiname': 'todrequest'}
invalid api type, one_api_str:{'keyphrase': '一个绿色苹果', 'category': '餐饮食物', 'style': '写实', 'apiname': 'aipainting'}
invalid api type, one_api_str:{'keyphrase': '小刚如何在海边驱赶了那只威胁游客的海鸥', 'category': '动物&自然风景', 'query': '小刚如何在海边驱赶了那只威胁游客的海鸥', 'apiname': 'aipainting'}
有效obs数量 176
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-06/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 176 / 176
  0%|          | 0/176 [00:00<?, ?it/s]  1%|          | 1/176 [00:11<33:36, 11.52s/it]  3%|▎         | 6/176 [00:16<06:15,  2.21s/it]  4%|▍         | 7/176 [00:17<05:48,  2.06s/it]  5%|▍         | 8/176 [00:20<06:37,  2.36s/it]  6%|▌         | 10/176 [00:24<05:38,  2.04s/it]  6%|▋         | 11/176 [00:26<05:52,  2.14s/it]  7%|▋         | 13/176 [00:28<04:25,  1.63s/it]  9%|▊         | 15/176 [00:42<09:41,  3.61s/it] 12%|█▎        | 22/176 [00:43<03:36,  1.41s/it] 13%|█▎        | 23/176 [00:44<03:25,  1.34s/it] 14%|█▍        | 25/176 [00:49<04:12,  1.67s/it] 16%|█▋        | 29/176 [00:50<02:31,  1.03s/it] 18%|█▊        | 31/176 [00:54<03:03,  1.27s/it] 19%|█▉        | 33/176 [00:58<03:34,  1.50s/it] 20%|█▉        | 35/176 [01:02<03:44,  1.59s/it] 21%|██        | 37/176 [01:02<02:47,  1.20s/it] 22%|██▏       | 38/176 [01:08<04:23,  1.91s/it] 22%|██▏       | 39/176 [01:14<06:05,  2.67s/it] 24%|██▍       | 42/176 [01:17<04:22,  1.96s/it] 26%|██▌       | 45/176 [01:23<04:09,  1.90s/it] 27%|██▋       | 48/176 [01:24<02:57,  1.39s/it] 28%|██▊       | 50/176 [01:26<02:39,  1.26s/it] 29%|██▉       | 51/176 [01:30<03:34,  1.72s/it] 31%|███▏      | 55/176 [01:35<02:56,  1.46s/it] 33%|███▎      | 58/176 [01:36<02:11,  1.12s/it] 34%|███▎      | 59/176 [01:38<02:28,  1.27s/it] 34%|███▍      | 60/176 [01:46<04:28,  2.31s/it] 38%|███▊      | 67/176 [01:50<02:18,  1.27s/it] 40%|████      | 71/176 [01:52<01:44,  1.01it/s] 41%|████▏     | 73/176 [01:56<02:02,  1.19s/it] 43%|████▎     | 75/176 [01:57<01:39,  1.01it/s] 43%|████▎     | 76/176 [01:59<02:01,  1.21s/it] 44%|████▍     | 78/176 [02:04<02:29,  1.53s/it] 47%|████▋     | 82/176 [02:05<01:32,  1.02it/s] 48%|████▊     | 84/176 [02:08<01:34,  1.02s/it] 48%|████▊     | 85/176 [02:14<02:49,  1.86s/it] 50%|█████     | 88/176 [02:15<01:52,  1.27s/it] 51%|█████     | 89/176 [02:20<02:40,  1.85s/it] 51%|█████     | 90/176 [02:22<02:30,  1.75s/it] 53%|█████▎    | 93/176 [02:26<02:16,  1.64s/it] 53%|█████▎    | 94/176 [02:26<01:56,  1.42s/it] 55%|█████▍    | 96/176 [02:29<01:48,  1.35s/it] 56%|█████▌    | 98/176 [02:31<01:36,  1.23s/it] 56%|█████▋    | 99/176 [02:36<02:33,  1.99s/it] 59%|█████▉    | 104/176 [02:39<01:24,  1.17s/it] 60%|█████▉    | 105/176 [02:40<01:22,  1.17s/it] 61%|██████▏   | 108/176 [02:42<01:08,  1.01s/it] 62%|██████▎   | 110/176 [02:45<01:14,  1.13s/it] 64%|██████▎   | 112/176 [02:46<00:54,  1.16it/s] 64%|██████▍   | 113/176 [02:51<01:46,  1.69s/it] 65%|██████▍   | 114/176 [02:57<02:27,  2.38s/it] 66%|██████▌   | 116/176 [02:58<01:43,  1.73s/it] 67%|██████▋   | 118/176 [02:59<01:15,  1.30s/it] 68%|██████▊   | 119/176 [03:03<01:49,  1.92s/it] 69%|██████▉   | 121/176 [03:06<01:36,  1.76s/it] 70%|███████   | 124/176 [03:12<01:33,  1.80s/it] 72%|███████▏  | 127/176 [03:19<01:36,  1.97s/it] 74%|███████▍  | 131/176 [03:23<01:10,  1.57s/it] 75%|███████▌  | 132/176 [03:25<01:13,  1.68s/it] 76%|███████▌  | 134/176 [03:27<01:05,  1.55s/it] 77%|███████▋  | 136/176 [03:30<01:01,  1.55s/it] 78%|███████▊  | 137/176 [03:31<00:56,  1.44s/it] 78%|███████▊  | 138/176 [03:35<01:10,  1.84s/it] 81%|████████  | 142/176 [03:39<00:49,  1.45s/it] 82%|████████▏ | 144/176 [03:43<00:49,  1.55s/it] 82%|████████▏ | 145/176 [03:46<00:57,  1.85s/it] 84%|████████▍ | 148/176 [03:50<00:45,  1.61s/it] 85%|████████▍ | 149/176 [03:53<00:47,  1.77s/it] 86%|████████▋ | 152/176 [03:54<00:29,  1.23s/it] 88%|████████▊ | 154/176 [03:57<00:29,  1.33s/it] 88%|████████▊ | 155/176 [04:03<00:43,  2.09s/it] 89%|████████▉ | 157/176 [04:03<00:27,  1.44s/it] 90%|████████▉ | 158/176 [04:05<00:25,  1.42s/it] 91%|█████████ | 160/176 [04:09<00:25,  1.62s/it] 93%|█████████▎| 163/176 [04:49<01:27,  6.73s/it]100%|██████████| 176/176 [04:49<00:00,  1.65s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-08 22:17:20 
[INFO] duration: 17 min 
[2024-09-09 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-07/prod/2024-09-07_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-09 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-07/prod/2024-09-07_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-07
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-07/prod/2024-09-07_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-07/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-07/prod/2024-09-07_rule_labeled.csv.gpt_labeled.csv
raw log len: 178
时效人设任务型query 数量： 4
unique queries len: 73
调用API
  0%|          | 0/73 [00:00<?, ?it/s]  3%|▎         | 2/73 [00:01<01:05,  1.09it/s]  4%|▍         | 3/73 [00:03<01:32,  1.32s/it]  5%|▌         | 4/73 [00:05<01:47,  1.56s/it]  7%|▋         | 5/73 [00:07<01:44,  1.54s/it]  8%|▊         | 6/73 [00:10<02:20,  2.10s/it] 10%|▉         | 7/73 [00:12<02:09,  1.96s/it] 11%|█         | 8/73 [00:13<02:06,  1.95s/it] 12%|█▏        | 9/73 [00:15<02:02,  1.92s/it] 14%|█▎        | 10/73 [00:17<01:58,  1.88s/it] 15%|█▌        | 11/73 [00:19<01:51,  1.80s/it] 16%|█▋        | 12/73 [00:19<01:20,  1.33s/it] 18%|█▊        | 13/73 [00:20<01:22,  1.38s/it] 19%|█▉        | 14/73 [00:22<01:23,  1.42s/it] 21%|██        | 15/73 [00:24<01:32,  1.59s/it] 22%|██▏       | 16/73 [00:26<01:35,  1.68s/it] 23%|██▎       | 17/73 [00:28<01:40,  1.80s/it] 25%|██▍       | 18/73 [00:30<01:41,  1.85s/it] 26%|██▌       | 19/73 [00:31<01:25,  1.59s/it] 27%|██▋       | 20/73 [00:32<01:23,  1.58s/it] 29%|██▉       | 21/73 [00:34<01:22,  1.59s/it] 30%|███       | 22/73 [00:36<01:25,  1.67s/it] 32%|███▏      | 23/73 [00:38<01:31,  1.84s/it] 33%|███▎      | 24/73 [00:40<01:29,  1.84s/it] 34%|███▍      | 25/73 [00:40<01:05,  1.36s/it] 36%|███▌      | 26/73 [00:42<01:10,  1.50s/it] 37%|███▋      | 27/73 [00:44<01:16,  1.66s/it] 38%|███▊      | 28/73 [00:46<01:18,  1.73s/it] 40%|███▉      | 29/73 [00:48<01:18,  1.78s/it] 41%|████      | 30/73 [00:50<01:19,  1.86s/it] 42%|████▏     | 31/73 [00:52<01:14,  1.78s/it] 44%|████▍     | 32/73 [00:53<01:13,  1.79s/it] 45%|████▌     | 33/73 [00:55<01:13,  1.84s/it] 47%|████▋     | 34/73 [00:57<01:10,  1.82s/it] 48%|████▊     | 35/73 [00:58<00:59,  1.57s/it] 49%|████▉     | 36/73 [01:00<01:03,  1.73s/it] 51%|█████     | 37/73 [01:00<00:46,  1.28s/it] 52%|█████▏    | 38/73 [01:02<00:47,  1.36s/it] 53%|█████▎    | 39/73 [01:02<00:34,  1.02s/it] 55%|█████▍    | 40/73 [01:04<00:40,  1.23s/it] 56%|█████▌    | 41/73 [01:06<00:45,  1.43s/it] 58%|█████▊    | 42/73 [01:08<00:50,  1.62s/it] 59%|█████▉    | 43/73 [01:10<00:52,  1.75s/it] 60%|██████    | 44/73 [01:12<00:52,  1.81s/it] 62%|██████▏   | 45/73 [01:14<00:51,  1.84s/it] 63%|██████▎   | 46/73 [01:14<00:36,  1.37s/it] 64%|██████▍   | 47/73 [01:16<00:40,  1.55s/it] 66%|██████▌   | 48/73 [01:18<00:39,  1.57s/it] 67%|██████▋   | 49/73 [01:20<00:41,  1.72s/it] 68%|██████▊   | 50/73 [01:23<00:48,  2.09s/it] 70%|██████▉   | 51/73 [01:25<00:45,  2.05s/it] 71%|███████   | 52/73 [01:27<00:42,  2.04s/it] 73%|███████▎  | 53/73 [01:29<00:40,  2.05s/it] 74%|███████▍  | 54/73 [01:31<00:38,  2.05s/it] 75%|███████▌  | 55/73 [01:33<00:36,  2.02s/it] 77%|███████▋  | 56/73 [01:34<00:32,  1.94s/it] 78%|███████▊  | 57/73 [01:37<00:33,  2.06s/it] 79%|███████▉  | 58/73 [01:40<00:35,  2.36s/it] 81%|████████  | 59/73 [01:42<00:30,  2.16s/it] 82%|████████▏ | 60/73 [01:44<00:28,  2.21s/it] 84%|████████▎ | 61/73 [01:46<00:24,  2.08s/it] 85%|████████▍ | 62/73 [01:46<00:16,  1.52s/it] 86%|████████▋ | 63/73 [01:48<00:15,  1.59s/it] 88%|████████▊ | 64/73 [01:49<00:15,  1.67s/it] 89%|████████▉ | 65/73 [01:51<00:13,  1.73s/it] 90%|█████████ | 66/73 [01:53<00:11,  1.70s/it] 92%|█████████▏| 67/73 [01:55<00:11,  1.89s/it] 93%|█████████▎| 68/73 [01:57<00:09,  1.84s/it] 95%|█████████▍| 69/73 [01:57<00:05,  1.36s/it] 96%|█████████▌| 70/73 [01:59<00:04,  1.54s/it] 97%|█████████▋| 71/73 [02:01<00:03,  1.62s/it] 99%|█████████▊| 72/73 [02:03<00:01,  1.78s/it]100%|██████████| 73/73 [02:03<00:00,  1.32s/it]100%|██████████| 73/73 [02:05<00:00,  1.72s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 63
调用obs
  0%|          | 0/63 [00:00<?, ?it/s]  2%|▏         | 1/63 [00:00<00:21,  2.82it/s]  3%|▎         | 2/63 [00:01<00:50,  1.20it/s]  5%|▍         | 3/63 [00:02<01:00,  1.02s/it]  6%|▋         | 4/63 [00:04<01:10,  1.20s/it]  8%|▊         | 5/63 [00:06<01:35,  1.64s/it] 10%|▉         | 6/63 [00:07<01:25,  1.49s/it] 11%|█         | 7/63 [00:09<01:23,  1.48s/it] 13%|█▎        | 8/63 [00:10<01:16,  1.39s/it] 14%|█▍        | 9/63 [00:11<01:13,  1.36s/it] 16%|█▌        | 10/63 [00:13<01:09,  1.31s/it] 17%|█▋        | 11/63 [00:14<01:05,  1.25s/it] 19%|█▉        | 12/63 [00:14<00:57,  1.13s/it] 21%|██        | 13/63 [00:16<00:59,  1.20s/it] 22%|██▏       | 14/63 [00:17<00:56,  1.14s/it] 24%|██▍       | 15/63 [00:18<00:57,  1.20s/it] 25%|██▌       | 16/63 [00:19<00:55,  1.18s/it] 27%|██▋       | 17/63 [00:21<00:55,  1.21s/it] 29%|██▊       | 18/63 [00:21<00:49,  1.09s/it] 30%|███       | 19/63 [00:23<00:49,  1.12s/it] 32%|███▏      | 20/63 [00:24<00:48,  1.12s/it] 33%|███▎      | 21/63 [00:25<00:47,  1.13s/it] 35%|███▍      | 22/63 [00:26<00:47,  1.15s/it] 37%|███▋      | 23/63 [00:27<00:46,  1.16s/it] 38%|███▊      | 24/63 [00:28<00:46,  1.18s/it] 40%|███▉      | 25/63 [00:30<00:46,  1.22s/it] 41%|████▏     | 26/63 [00:31<00:46,  1.27s/it] 43%|████▎     | 27/63 [00:32<00:44,  1.24s/it] 44%|████▍     | 28/63 [00:34<00:43,  1.24s/it] 46%|████▌     | 29/63 [00:35<00:42,  1.26s/it] 48%|████▊     | 30/63 [00:36<00:42,  1.30s/it] 49%|████▉     | 31/63 [00:38<00:41,  1.31s/it] 51%|█████     | 32/63 [00:39<00:40,  1.30s/it] 52%|█████▏    | 33/63 [00:40<00:39,  1.31s/it] 54%|█████▍    | 34/63 [00:41<00:36,  1.26s/it] 56%|█████▌    | 35/63 [00:42<00:33,  1.21s/it] 57%|█████▋    | 36/63 [00:44<00:32,  1.22s/it] 59%|█████▊    | 37/63 [00:45<00:31,  1.23s/it] 60%|██████    | 38/63 [00:46<00:31,  1.27s/it] 62%|██████▏   | 39/63 [00:48<00:30,  1.26s/it] 63%|██████▎   | 40/63 [00:49<00:29,  1.28s/it] 65%|██████▌   | 41/63 [00:50<00:25,  1.15s/it] 67%|██████▋   | 42/63 [00:52<00:31,  1.49s/it] 68%|██████▊   | 43/63 [00:53<00:29,  1.47s/it] 70%|██████▉   | 44/63 [00:55<00:26,  1.38s/it] 71%|███████▏  | 45/63 [00:56<00:24,  1.37s/it] 73%|███████▎  | 46/63 [00:57<00:23,  1.37s/it] 75%|███████▍  | 47/63 [00:59<00:21,  1.34s/it] 76%|███████▌  | 48/63 [01:00<00:18,  1.25s/it] 78%|███████▊  | 49/63 [01:01<00:17,  1.24s/it] 79%|███████▉  | 50/63 [01:03<00:20,  1.58s/it] 81%|████████  | 51/63 [01:05<00:19,  1.65s/it] 83%|████████▎ | 52/63 [01:06<00:16,  1.47s/it] 84%|████████▍ | 53/63 [01:07<00:13,  1.35s/it] 86%|████████▌ | 54/63 [01:09<00:12,  1.36s/it] 87%|████████▋ | 55/63 [01:10<00:10,  1.35s/it] 89%|████████▉ | 56/63 [01:11<00:09,  1.36s/it] 90%|█████████ | 57/63 [01:12<00:07,  1.31s/it] 92%|█████████▏| 58/63 [01:14<00:06,  1.28s/it] 95%|█████████▌| 60/63 [01:15<00:03,  1.03s/it] 97%|█████████▋| 61/63 [01:17<00:02,  1.17s/it] 98%|█████████▊| 62/63 [01:18<00:01,  1.28s/it]100%|██████████| 63/63 [01:20<00:00,  1.26s/it]100%|██████████| 63/63 [01:20<00:00,  1.27s/it]
invalid api type, one_api_str:{'domain': '媒体', 'action': '搜索', 'mediatype': '视频', 'category': '科幻', 'videotitle': '疯狂的外星人', 'apiname': 'todrequest'}
有效obs数量 62
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-07/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 62 / 62
  0%|          | 0/62 [00:00<?, ?it/s]  2%|▏         | 1/62 [00:06<06:36,  6.50s/it]  3%|▎         | 2/62 [00:08<03:58,  3.98s/it]  6%|▋         | 4/62 [00:11<02:10,  2.25s/it]  8%|▊         | 5/62 [00:13<02:18,  2.43s/it] 15%|█▍        | 9/62 [00:14<00:51,  1.02it/s] 16%|█▌        | 10/62 [00:15<00:51,  1.01it/s] 18%|█▊        | 11/62 [00:15<00:41,  1.23it/s] 19%|█▉        | 12/62 [00:19<01:08,  1.36s/it] 26%|██▌       | 16/62 [00:23<00:58,  1.27s/it] 29%|██▉       | 18/62 [00:24<00:45,  1.03s/it] 32%|███▏      | 20/62 [00:24<00:31,  1.33it/s] 34%|███▍      | 21/62 [00:26<00:39,  1.04it/s] 35%|███▌      | 22/62 [00:29<00:48,  1.20s/it] 37%|███▋      | 23/62 [00:30<00:46,  1.19s/it] 40%|████      | 25/62 [00:31<00:35,  1.04it/s] 42%|████▏     | 26/62 [00:31<00:30,  1.18it/s] 44%|████▎     | 27/62 [00:32<00:32,  1.08it/s] 45%|████▌     | 28/62 [00:33<00:31,  1.08it/s] 48%|████▊     | 30/62 [00:34<00:23,  1.35it/s] 50%|█████     | 31/62 [00:36<00:32,  1.06s/it] 55%|█████▍    | 34/62 [00:38<00:20,  1.36it/s] 56%|█████▋    | 35/62 [00:40<00:26,  1.01it/s] 60%|█████▉    | 37/62 [00:42<00:23,  1.05it/s] 63%|██████▎   | 39/62 [00:43<00:18,  1.26it/s] 65%|██████▍   | 40/62 [00:44<00:19,  1.13it/s] 66%|██████▌   | 41/62 [00:44<00:17,  1.23it/s] 68%|██████▊   | 42/62 [00:46<00:20,  1.04s/it] 69%|██████▉   | 43/62 [00:48<00:23,  1.24s/it] 71%|███████   | 44/62 [00:49<00:20,  1.12s/it] 74%|███████▍  | 46/62 [00:49<00:10,  1.51it/s] 76%|███████▌  | 47/62 [00:51<00:15,  1.04s/it] 77%|███████▋  | 48/62 [00:52<00:14,  1.04s/it] 79%|███████▉  | 49/62 [00:52<00:10,  1.26it/s] 81%|████████  | 50/62 [00:53<00:07,  1.54it/s] 82%|████████▏ | 51/62 [00:54<00:08,  1.24it/s] 84%|████████▍ | 52/62 [00:56<00:11,  1.20s/it] 89%|████████▊ | 55/62 [00:59<00:07,  1.08s/it] 92%|█████████▏| 57/62 [00:59<00:04,  1.25it/s] 95%|█████████▌| 59/62 [01:00<00:01,  1.52it/s] 97%|█████████▋| 60/62 [01:03<00:02,  1.12s/it] 98%|█████████▊| 61/62 [01:03<00:00,  1.10it/s]100%|██████████| 62/62 [01:03<00:00,  1.03s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-09 22:06:56 
[INFO] duration: 6 min 
[2024-09-10 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-08/prod/2024-09-08_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-10 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.202:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-08/prod/2024-09-08_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-08
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-08/prod/2024-09-08_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-08/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-08/prod/2024-09-08_rule_labeled.csv.gpt_labeled.csv
raw log len: 112
时效人设任务型query 数量： 2
unique queries len: 67
调用API
  0%|          | 0/67 [00:00<?, ?it/s]  3%|▎         | 2/67 [00:02<01:18,  1.20s/it]  4%|▍         | 3/67 [00:02<00:51,  1.25it/s]  6%|▌         | 4/67 [00:04<01:16,  1.21s/it]  7%|▋         | 5/67 [00:06<01:29,  1.45s/it]  9%|▉         | 6/67 [00:07<01:28,  1.46s/it] 10%|█         | 7/67 [00:09<01:36,  1.61s/it] 12%|█▏        | 8/67 [00:11<01:39,  1.69s/it] 13%|█▎        | 9/67 [00:13<01:39,  1.72s/it] 15%|█▍        | 10/67 [00:15<01:39,  1.74s/it] 16%|█▋        | 11/67 [00:17<01:42,  1.83s/it] 18%|█▊        | 12/67 [00:19<01:45,  1.92s/it] 19%|█▉        | 13/67 [00:20<01:28,  1.64s/it] 21%|██        | 14/67 [00:20<01:04,  1.21s/it] 22%|██▏       | 15/67 [00:22<01:10,  1.36s/it] 24%|██▍       | 16/67 [00:24<01:20,  1.58s/it] 25%|██▌       | 17/67 [00:26<01:23,  1.67s/it] 27%|██▋       | 18/67 [00:27<01:20,  1.65s/it] 28%|██▊       | 19/67 [00:29<01:22,  1.73s/it] 30%|██▉       | 20/67 [00:32<01:27,  1.87s/it] 31%|███▏      | 21/67 [00:34<01:28,  1.93s/it] 33%|███▎      | 22/67 [00:35<01:23,  1.86s/it] 34%|███▍      | 23/67 [00:37<01:22,  1.87s/it] 36%|███▌      | 24/67 [00:39<01:22,  1.92s/it] 37%|███▋      | 25/67 [00:41<01:17,  1.85s/it] 39%|███▉      | 26/67 [00:44<01:26,  2.10s/it] 40%|████      | 27/67 [00:44<01:09,  1.74s/it] 42%|████▏     | 28/67 [00:46<01:07,  1.74s/it] 43%|████▎     | 29/67 [00:47<00:55,  1.45s/it] 45%|████▍     | 30/67 [00:49<00:59,  1.60s/it] 46%|████▋     | 31/67 [00:51<00:59,  1.64s/it] 48%|████▊     | 32/67 [00:52<00:58,  1.68s/it] 49%|████▉     | 33/67 [00:54<00:57,  1.70s/it] 51%|█████     | 34/67 [00:56<00:57,  1.73s/it] 52%|█████▏    | 35/67 [00:58<00:54,  1.71s/it] 54%|█████▎    | 36/67 [01:00<00:56,  1.81s/it] 55%|█████▌    | 37/67 [01:01<00:53,  1.79s/it] 57%|█████▋    | 38/67 [01:02<00:43,  1.49s/it] 58%|█████▊    | 39/67 [01:04<00:45,  1.62s/it] 60%|█████▉    | 40/67 [01:06<00:46,  1.72s/it] 61%|██████    | 41/67 [01:08<00:46,  1.79s/it] 63%|██████▎   | 42/67 [01:10<00:46,  1.87s/it] 64%|██████▍   | 43/67 [01:10<00:33,  1.38s/it] 66%|██████▌   | 44/67 [01:13<00:38,  1.66s/it] 67%|██████▋   | 45/67 [01:15<00:39,  1.80s/it] 69%|██████▊   | 46/67 [01:17<00:37,  1.79s/it] 70%|███████   | 47/67 [01:18<00:36,  1.81s/it] 72%|███████▏  | 48/67 [01:20<00:33,  1.75s/it] 73%|███████▎  | 49/67 [01:22<00:32,  1.78s/it] 75%|███████▍  | 50/67 [01:22<00:22,  1.32s/it] 76%|███████▌  | 51/67 [01:24<00:23,  1.49s/it] 78%|███████▊  | 52/67 [01:26<00:23,  1.58s/it] 79%|███████▉  | 53/67 [01:28<00:24,  1.77s/it] 81%|████████  | 54/67 [01:30<00:23,  1.84s/it] 82%|████████▏ | 55/67 [01:32<00:23,  1.95s/it] 84%|████████▎ | 56/67 [01:34<00:21,  1.97s/it] 85%|████████▌ | 57/67 [01:36<00:18,  1.84s/it] 87%|████████▋ | 58/67 [01:38<00:16,  1.81s/it] 88%|████████▊ | 59/67 [01:40<00:14,  1.87s/it] 90%|████████▉ | 60/67 [01:42<00:13,  1.91s/it] 91%|█████████ | 61/67 [01:44<00:11,  1.92s/it] 93%|█████████▎| 62/67 [01:45<00:09,  1.92s/it] 94%|█████████▍| 63/67 [01:47<00:07,  1.84s/it] 96%|█████████▌| 64/67 [01:49<00:05,  1.86s/it] 97%|█████████▋| 65/67 [01:51<00:03,  1.85s/it] 99%|█████████▊| 66/67 [01:53<00:01,  1.89s/it]100%|██████████| 67/67 [01:55<00:00,  1.94s/it]100%|██████████| 67/67 [01:57<00:00,  1.75s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: 'arguments'
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 59
调用obs
  0%|          | 0/59 [00:00<?, ?it/s]  2%|▏         | 1/59 [00:01<01:21,  1.41s/it]  3%|▎         | 2/59 [00:02<01:13,  1.29s/it]  5%|▌         | 3/59 [00:04<01:22,  1.48s/it]  7%|▋         | 4/59 [00:05<01:13,  1.33s/it]  8%|▊         | 5/59 [00:06<01:09,  1.29s/it] 10%|█         | 6/59 [00:08<01:18,  1.48s/it] 12%|█▏        | 7/59 [00:09<01:14,  1.42s/it] 14%|█▎        | 8/59 [00:10<01:08,  1.35s/it] 15%|█▌        | 9/59 [00:12<01:04,  1.29s/it] 17%|█▋        | 10/59 [00:13<01:02,  1.27s/it] 19%|█▊        | 11/59 [00:16<01:21,  1.70s/it] 20%|██        | 12/59 [00:17<01:19,  1.70s/it] 22%|██▏       | 13/59 [00:18<01:10,  1.53s/it] 24%|██▎       | 14/59 [00:20<01:07,  1.51s/it] 25%|██▌       | 15/59 [00:22<01:09,  1.57s/it] 27%|██▋       | 16/59 [00:23<01:02,  1.45s/it] 29%|██▉       | 17/59 [00:24<00:55,  1.32s/it] 31%|███       | 18/59 [00:25<00:50,  1.24s/it] 32%|███▏      | 19/59 [00:27<00:57,  1.44s/it] 34%|███▍      | 20/59 [00:28<00:52,  1.35s/it] 36%|███▌      | 21/59 [00:29<00:49,  1.30s/it] 37%|███▋      | 22/59 [00:31<00:50,  1.37s/it] 39%|███▉      | 23/59 [00:32<00:47,  1.33s/it] 41%|████      | 24/59 [00:33<00:44,  1.27s/it] 42%|████▏     | 25/59 [00:34<00:41,  1.22s/it] 44%|████▍     | 26/59 [00:35<00:34,  1.05s/it] 46%|████▌     | 27/59 [00:36<00:37,  1.17s/it] 47%|████▋     | 28/59 [00:37<00:35,  1.15s/it] 49%|████▉     | 29/59 [00:38<00:34,  1.16s/it] 51%|█████     | 30/59 [00:40<00:37,  1.29s/it] 53%|█████▎    | 31/59 [00:41<00:35,  1.28s/it] 54%|█████▍    | 32/59 [00:42<00:33,  1.24s/it] 56%|█████▌    | 33/59 [00:44<00:36,  1.42s/it] 58%|█████▊    | 34/59 [00:45<00:33,  1.32s/it] 59%|█████▉    | 35/59 [00:47<00:34,  1.44s/it] 61%|██████    | 36/59 [00:48<00:31,  1.37s/it] 63%|██████▎   | 37/59 [00:49<00:28,  1.31s/it] 64%|██████▍   | 38/59 [00:50<00:25,  1.23s/it] 66%|██████▌   | 39/59 [00:52<00:27,  1.38s/it] 68%|██████▊   | 40/59 [00:53<00:24,  1.28s/it] 69%|██████▉   | 41/59 [00:55<00:23,  1.32s/it] 71%|███████   | 42/59 [00:58<00:30,  1.77s/it] 73%|███████▎  | 43/59 [00:59<00:26,  1.64s/it] 75%|███████▍  | 44/59 [01:01<00:25,  1.69s/it] 76%|███████▋  | 45/59 [01:02<00:21,  1.55s/it] 78%|███████▊  | 46/59 [01:03<00:18,  1.43s/it] 80%|███████▉  | 47/59 [01:05<00:17,  1.48s/it] 81%|████████▏ | 48/59 [01:05<00:13,  1.26s/it] 83%|████████▎ | 49/59 [01:06<00:11,  1.17s/it] 85%|████████▍ | 50/59 [01:08<00:12,  1.36s/it] 86%|████████▋ | 51/59 [01:09<00:10,  1.27s/it] 88%|████████▊ | 52/59 [01:10<00:08,  1.22s/it] 90%|████████▉ | 53/59 [01:12<00:08,  1.36s/it] 92%|█████████▏| 54/59 [01:13<00:06,  1.33s/it] 93%|█████████▎| 55/59 [01:14<00:04,  1.24s/it] 95%|█████████▍| 56/59 [01:15<00:03,  1.19s/it] 97%|█████████▋| 57/59 [01:17<00:02,  1.26s/it] 98%|█████████▊| 58/59 [01:18<00:01,  1.20s/it]100%|██████████| 59/59 [01:19<00:00,  1.18s/it]100%|██████████| 59/59 [01:19<00:00,  1.35s/it]
有效obs数量 59
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-08/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 59 / 59
  0%|          | 0/59 [00:00<?, ?it/s]  2%|▏         | 1/59 [00:10<10:30, 10.86s/it] 14%|█▎        | 8/59 [00:12<01:01,  1.20s/it] 15%|█▌        | 9/59 [00:12<00:52,  1.05s/it] 20%|██        | 12/59 [00:14<00:42,  1.11it/s] 22%|██▏       | 13/59 [00:16<00:49,  1.07s/it] 27%|██▋       | 16/59 [00:17<00:31,  1.36it/s] 31%|███       | 18/59 [00:17<00:24,  1.68it/s] 32%|███▏      | 19/59 [00:18<00:24,  1.61it/s] 34%|███▍      | 20/59 [00:19<00:25,  1.53it/s] 36%|███▌      | 21/59 [00:20<00:27,  1.38it/s] 37%|███▋      | 22/59 [00:22<00:34,  1.07it/s] 41%|████      | 24/59 [00:23<00:26,  1.34it/s] 42%|████▏     | 25/59 [00:23<00:26,  1.28it/s] 46%|████▌     | 27/59 [00:25<00:23,  1.38it/s] 47%|████▋     | 28/59 [00:25<00:20,  1.48it/s] 49%|████▉     | 29/59 [00:26<00:18,  1.63it/s] 51%|█████     | 30/59 [00:27<00:26,  1.11it/s] 54%|█████▍    | 32/59 [00:28<00:16,  1.60it/s] 56%|█████▌    | 33/59 [00:29<00:16,  1.53it/s] 59%|█████▉    | 35/59 [00:31<00:22,  1.07it/s] 63%|██████▎   | 37/59 [00:33<00:17,  1.23it/s] 66%|██████▌   | 39/59 [00:35<00:17,  1.14it/s] 71%|███████   | 42/59 [00:35<00:10,  1.67it/s] 73%|███████▎  | 43/59 [00:36<00:11,  1.44it/s] 75%|███████▍  | 44/59 [00:39<00:17,  1.17s/it] 80%|███████▉  | 47/59 [00:41<00:10,  1.12it/s] 83%|████████▎ | 49/59 [00:43<00:09,  1.09it/s] 85%|████████▍ | 50/59 [00:43<00:07,  1.25it/s] 88%|████████▊ | 52/59 [00:43<00:03,  1.82it/s] 90%|████████▉ | 53/59 [00:46<00:05,  1.16it/s] 93%|█████████▎| 55/59 [00:47<00:03,  1.20it/s] 98%|█████████▊| 58/59 [00:49<00:00,  1.40it/s]100%|██████████| 59/59 [00:50<00:00,  1.18it/s]100%|██████████| 59/59 [00:50<00:00,  1.16it/s]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-10 22:06:33 
[INFO] duration: 6 min 
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh: line 7: cd: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/weekly_run/: No such file or directory
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh: line 8: common/periodical_job_template.sh: No such file or directory
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh: line 10: common/common_scripts.sh: No such file or directory
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh: line 36: PrintLog: command not found
[INFO] begin_time: 2024-09-11 22:00:02
python: can't open file '/root/get_extension_log_distillation.py': [Errno 2] No such file or directory
[INFO] end_time: 2024-09-11 22:00:02 
[INFO] duration: 0 min 
[2024-09-12 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-10/prod/2024-09-10_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-12 22:00:03
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-10/prod/2024-09-10_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-10
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-10/prod/2024-09-10_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-10/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-10/prod/2024-09-10_rule_labeled.csv.gpt_labeled.csv
raw log len: 326
时效人设任务型query 数量： 3
unique queries len: 62
调用API
  0%|          | 0/62 [00:00<?, ?it/s]  3%|▎         | 2/62 [00:01<00:49,  1.21it/s]  5%|▍         | 3/62 [00:01<00:33,  1.75it/s]  6%|▋         | 4/62 [00:03<00:59,  1.03s/it]  8%|▊         | 5/62 [00:05<01:12,  1.27s/it] 10%|▉         | 6/62 [00:08<01:46,  1.90s/it] 11%|█▏        | 7/62 [00:10<01:47,  1.95s/it] 13%|█▎        | 8/62 [00:12<01:43,  1.92s/it] 15%|█▍        | 9/62 [00:14<01:45,  1.99s/it] 16%|█▌        | 10/62 [00:16<01:38,  1.90s/it] 18%|█▊        | 11/62 [00:17<01:31,  1.80s/it] 19%|█▉        | 12/62 [00:19<01:25,  1.70s/it] 21%|██        | 13/62 [00:22<01:41,  2.07s/it] 23%|██▎       | 14/62 [00:24<01:35,  2.00s/it] 24%|██▍       | 15/62 [00:25<01:27,  1.87s/it] 26%|██▌       | 16/62 [00:27<01:22,  1.80s/it] 27%|██▋       | 17/62 [00:28<01:17,  1.72s/it] 29%|██▉       | 18/62 [00:30<01:13,  1.68s/it] 31%|███       | 19/62 [00:33<01:24,  1.97s/it] 32%|███▏      | 20/62 [00:34<01:18,  1.87s/it] 34%|███▍      | 21/62 [00:36<01:17,  1.89s/it] 35%|███▌      | 22/62 [00:36<00:55,  1.39s/it] 37%|███▋      | 23/62 [00:38<00:58,  1.51s/it] 39%|███▊      | 24/62 [00:40<00:57,  1.53s/it] 40%|████      | 25/62 [00:41<00:56,  1.54s/it] 42%|████▏     | 26/62 [00:43<00:54,  1.50s/it] 44%|████▎     | 27/62 [00:44<00:52,  1.51s/it] 45%|████▌     | 28/62 [00:46<00:52,  1.53s/it] 47%|████▋     | 29/62 [00:48<00:52,  1.60s/it] 48%|████▊     | 30/62 [00:49<00:51,  1.60s/it] 50%|█████     | 31/62 [00:51<00:52,  1.69s/it] 52%|█████▏    | 32/62 [00:53<00:50,  1.68s/it] 53%|█████▎    | 33/62 [00:54<00:47,  1.63s/it] 55%|█████▍    | 34/62 [00:56<00:45,  1.61s/it] 56%|█████▋    | 35/62 [00:57<00:41,  1.54s/it] 58%|█████▊    | 36/62 [00:59<00:40,  1.57s/it] 60%|█████▉    | 37/62 [01:01<00:41,  1.64s/it] 61%|██████▏   | 38/62 [01:02<00:38,  1.61s/it] 63%|██████▎   | 39/62 [01:05<00:45,  2.00s/it] 65%|██████▍   | 40/62 [01:06<00:40,  1.82s/it] 66%|██████▌   | 41/62 [01:08<00:36,  1.74s/it] 68%|██████▊   | 42/62 [01:10<00:34,  1.72s/it] 69%|██████▉   | 43/62 [01:11<00:32,  1.69s/it] 71%|███████   | 44/62 [01:14<00:34,  1.90s/it] 73%|███████▎  | 45/62 [01:15<00:31,  1.84s/it] 74%|███████▍  | 46/62 [01:17<00:28,  1.79s/it] 76%|███████▌  | 47/62 [01:19<00:25,  1.71s/it] 77%|███████▋  | 48/62 [01:20<00:23,  1.67s/it] 79%|███████▉  | 49/62 [01:22<00:20,  1.60s/it] 81%|████████  | 50/62 [01:23<00:20,  1.68s/it] 82%|████████▏ | 51/62 [01:25<00:18,  1.65s/it] 84%|████████▍ | 52/62 [01:27<00:16,  1.67s/it] 85%|████████▌ | 53/62 [01:28<00:14,  1.60s/it] 87%|████████▋ | 54/62 [01:30<00:13,  1.63s/it] 89%|████████▊ | 55/62 [01:31<00:11,  1.59s/it] 90%|█████████ | 56/62 [01:33<00:09,  1.66s/it] 92%|█████████▏| 57/62 [01:35<00:08,  1.66s/it] 94%|█████████▎| 58/62 [01:38<00:08,  2.02s/it] 95%|█████████▌| 59/62 [01:39<00:05,  1.92s/it] 97%|█████████▋| 60/62 [01:41<00:03,  1.85s/it] 98%|█████████▊| 61/62 [01:43<00:01,  1.81s/it]100%|██████████| 62/62 [01:45<00:00,  1.78s/it]100%|██████████| 62/62 [01:47<00:00,  1.74s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 60
调用obs
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:01<01:18,  1.33s/it]  3%|▎         | 2/60 [00:02<01:19,  1.37s/it]  5%|▌         | 3/60 [00:04<01:18,  1.37s/it]  7%|▋         | 4/60 [00:06<01:42,  1.84s/it]  8%|▊         | 5/60 [00:07<01:28,  1.60s/it] 10%|█         | 6/60 [00:09<01:19,  1.47s/it] 12%|█▏        | 7/60 [00:11<01:35,  1.80s/it] 13%|█▎        | 8/60 [00:12<01:24,  1.62s/it] 15%|█▌        | 9/60 [00:13<01:05,  1.29s/it] 17%|█▋        | 10/60 [00:14<01:04,  1.29s/it] 18%|█▊        | 11/60 [00:17<01:31,  1.87s/it] 20%|██        | 12/60 [00:18<01:19,  1.66s/it] 22%|██▏       | 13/60 [00:20<01:11,  1.51s/it] 23%|██▎       | 14/60 [00:21<01:03,  1.38s/it] 25%|██▌       | 15/60 [00:22<01:00,  1.35s/it] 27%|██▋       | 16/60 [00:23<00:58,  1.33s/it] 28%|██▊       | 17/60 [00:26<01:14,  1.74s/it] 30%|███       | 18/60 [00:27<01:07,  1.60s/it] 32%|███▏      | 19/60 [00:28<00:59,  1.45s/it] 33%|███▎      | 20/60 [00:30<00:57,  1.44s/it] 35%|███▌      | 21/60 [00:31<00:55,  1.42s/it] 37%|███▋      | 22/60 [00:33<00:53,  1.42s/it] 38%|███▊      | 23/60 [00:34<00:51,  1.40s/it] 40%|████      | 24/60 [00:35<00:46,  1.30s/it] 42%|████▏     | 25/60 [00:36<00:44,  1.27s/it] 43%|████▎     | 26/60 [00:37<00:43,  1.28s/it] 45%|████▌     | 27/60 [00:39<00:42,  1.29s/it] 47%|████▋     | 28/60 [00:40<00:41,  1.30s/it] 48%|████▊     | 29/60 [00:41<00:37,  1.22s/it] 50%|█████     | 30/60 [00:43<00:45,  1.50s/it] 52%|█████▏    | 31/60 [00:45<00:41,  1.43s/it] 53%|█████▎    | 32/60 [00:46<00:37,  1.33s/it] 55%|█████▌    | 33/60 [00:47<00:35,  1.31s/it] 57%|█████▋    | 34/60 [00:48<00:34,  1.33s/it] 58%|█████▊    | 35/60 [00:50<00:33,  1.34s/it] 60%|██████    | 36/60 [00:52<00:40,  1.70s/it] 62%|██████▏   | 37/60 [00:53<00:35,  1.54s/it] 63%|██████▎   | 38/60 [00:55<00:32,  1.46s/it] 65%|██████▌   | 39/60 [00:56<00:31,  1.49s/it] 67%|██████▋   | 40/60 [00:57<00:27,  1.38s/it] 68%|██████▊   | 41/60 [00:59<00:25,  1.34s/it] 70%|███████   | 42/60 [01:00<00:24,  1.37s/it] 72%|███████▏  | 43/60 [01:01<00:22,  1.30s/it] 73%|███████▎  | 44/60 [01:02<00:19,  1.24s/it] 75%|███████▌  | 45/60 [01:03<00:16,  1.11s/it] 77%|███████▋  | 46/60 [01:04<00:16,  1.15s/it] 78%|███████▊  | 47/60 [01:05<00:15,  1.16s/it] 80%|████████  | 48/60 [01:07<00:14,  1.17s/it] 82%|████████▏ | 49/60 [01:08<00:13,  1.24s/it] 83%|████████▎ | 50/60 [01:09<00:11,  1.17s/it] 85%|████████▌ | 51/60 [01:10<00:10,  1.16s/it] 87%|████████▋ | 52/60 [01:11<00:09,  1.19s/it] 88%|████████▊ | 53/60 [01:13<00:09,  1.32s/it] 90%|█████████ | 54/60 [01:14<00:07,  1.32s/it] 92%|█████████▏| 55/60 [01:17<00:07,  1.56s/it] 93%|█████████▎| 56/60 [01:18<00:06,  1.59s/it] 95%|█████████▌| 57/60 [01:20<00:04,  1.53s/it] 97%|█████████▋| 58/60 [01:21<00:02,  1.47s/it] 98%|█████████▊| 59/60 [01:22<00:01,  1.36s/it]100%|██████████| 60/60 [01:24<00:00,  1.67s/it]100%|██████████| 60/60 [01:24<00:00,  1.42s/it]
有效obs数量 60
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-10/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 60 / 60
  0%|          | 0/60 [00:00<?, ?it/s]  2%|▏         | 1/60 [00:07<07:31,  7.65s/it]  3%|▎         | 2/60 [00:10<04:31,  4.68s/it]  5%|▌         | 3/60 [00:10<02:39,  2.80s/it]  7%|▋         | 4/60 [00:12<02:02,  2.19s/it] 10%|█         | 6/60 [00:13<01:14,  1.38s/it] 12%|█▏        | 7/60 [00:14<01:16,  1.44s/it] 15%|█▌        | 9/60 [00:16<00:57,  1.13s/it] 18%|█▊        | 11/60 [00:16<00:37,  1.30it/s] 20%|██        | 12/60 [00:17<00:38,  1.24it/s] 22%|██▏       | 13/60 [00:21<01:13,  1.57s/it] 25%|██▌       | 15/60 [00:22<00:46,  1.04s/it] 27%|██▋       | 16/60 [00:22<00:40,  1.08it/s] 28%|██▊       | 17/60 [00:25<00:59,  1.38s/it] 32%|███▏      | 19/60 [00:26<00:36,  1.12it/s] 33%|███▎      | 20/60 [00:26<00:36,  1.11it/s] 35%|███▌      | 21/60 [00:29<00:53,  1.38s/it] 37%|███▋      | 22/60 [00:30<00:47,  1.24s/it] 42%|████▏     | 25/60 [00:31<00:28,  1.25it/s] 45%|████▌     | 27/60 [00:33<00:26,  1.24it/s] 47%|████▋     | 28/60 [00:34<00:28,  1.12it/s] 52%|█████▏    | 31/60 [00:39<00:33,  1.14s/it] 58%|█████▊    | 35/60 [00:41<00:23,  1.07it/s] 62%|██████▏   | 37/60 [00:43<00:20,  1.11it/s] 65%|██████▌   | 39/60 [00:43<00:15,  1.37it/s] 68%|██████▊   | 41/60 [00:48<00:21,  1.12s/it] 70%|███████   | 42/60 [00:48<00:17,  1.05it/s] 73%|███████▎  | 44/60 [00:49<00:12,  1.25it/s] 75%|███████▌  | 45/60 [00:51<00:14,  1.04it/s] 77%|███████▋  | 46/60 [00:53<00:18,  1.33s/it] 83%|████████▎ | 50/60 [00:56<00:09,  1.07it/s] 88%|████████▊ | 53/60 [00:56<00:04,  1.46it/s] 90%|█████████ | 54/60 [00:59<00:05,  1.06it/s] 93%|█████████▎| 56/60 [01:00<00:03,  1.11it/s] 98%|█████████▊| 59/60 [01:04<00:01,  1.05s/it]100%|██████████| 60/60 [01:07<00:00,  1.26s/it]100%|██████████| 60/60 [01:07<00:00,  1.12s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-12 22:06:48 
[INFO] duration: 6 min 
[2024-09-13 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-11/prod/2024-09-11_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-13 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-11/prod/2024-09-11_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-11
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-11/prod/2024-09-11_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-11/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-11/prod/2024-09-11_rule_labeled.csv.gpt_labeled.csv
raw log len: 305
时效人设任务型query 数量： 4
unique queries len: 105
调用API
  0%|          | 0/105 [00:00<?, ?it/s]  2%|▏         | 2/105 [00:01<01:34,  1.09it/s]  3%|▎         | 3/105 [00:03<02:08,  1.26s/it]  4%|▍         | 4/105 [00:05<02:30,  1.49s/it]  5%|▍         | 5/105 [00:07<02:32,  1.53s/it]  6%|▌         | 6/105 [00:10<03:25,  2.08s/it]  7%|▋         | 7/105 [00:12<03:22,  2.06s/it]  8%|▊         | 8/105 [00:14<03:15,  2.02s/it]  9%|▊         | 9/105 [00:15<03:06,  1.94s/it] 10%|▉         | 10/105 [00:17<02:54,  1.84s/it] 10%|█         | 11/105 [00:19<02:47,  1.78s/it] 11%|█▏        | 12/105 [00:20<02:39,  1.72s/it] 12%|█▏        | 13/105 [00:22<02:31,  1.65s/it] 13%|█▎        | 14/105 [00:23<02:31,  1.66s/it] 14%|█▍        | 15/105 [00:25<02:32,  1.69s/it] 15%|█▌        | 16/105 [00:27<02:39,  1.79s/it] 16%|█▌        | 17/105 [00:29<02:34,  1.76s/it] 17%|█▋        | 18/105 [00:31<02:32,  1.75s/it] 18%|█▊        | 19/105 [00:32<02:25,  1.69s/it] 19%|█▉        | 20/105 [00:34<02:23,  1.69s/it] 20%|██        | 21/105 [00:36<02:19,  1.66s/it] 21%|██        | 22/105 [00:37<02:13,  1.61s/it] 22%|██▏       | 23/105 [00:38<02:08,  1.57s/it] 23%|██▎       | 24/105 [00:40<02:15,  1.67s/it] 24%|██▍       | 25/105 [00:42<02:20,  1.75s/it] 25%|██▍       | 26/105 [00:44<02:17,  1.74s/it] 26%|██▌       | 27/105 [00:47<02:50,  2.18s/it] 27%|██▋       | 28/105 [00:49<02:40,  2.08s/it] 28%|██▊       | 29/105 [00:51<02:30,  1.98s/it] 29%|██▊       | 30/105 [00:52<02:16,  1.82s/it] 30%|██▉       | 31/105 [00:53<01:39,  1.34s/it] 30%|███       | 32/105 [00:55<01:53,  1.56s/it] 31%|███▏      | 33/105 [00:57<02:00,  1.68s/it] 32%|███▏      | 34/105 [00:58<01:56,  1.64s/it] 33%|███▎      | 35/105 [00:58<01:24,  1.21s/it] 34%|███▍      | 36/105 [01:00<01:35,  1.38s/it] 35%|███▌      | 37/105 [01:01<01:33,  1.38s/it] 36%|███▌      | 38/105 [01:03<01:39,  1.48s/it] 37%|███▋      | 39/105 [01:05<01:45,  1.60s/it] 38%|███▊      | 40/105 [01:07<01:44,  1.61s/it] 39%|███▉      | 41/105 [01:08<01:38,  1.54s/it] 40%|████      | 42/105 [01:10<01:43,  1.64s/it] 41%|████      | 43/105 [01:12<01:43,  1.67s/it] 42%|████▏     | 44/105 [01:13<01:38,  1.62s/it] 43%|████▎     | 45/105 [01:15<01:34,  1.57s/it] 44%|████▍     | 46/105 [01:16<01:35,  1.61s/it] 45%|████▍     | 47/105 [01:18<01:35,  1.65s/it] 46%|████▌     | 48/105 [01:20<01:31,  1.61s/it] 47%|████▋     | 49/105 [01:21<01:30,  1.62s/it] 48%|████▊     | 50/105 [01:23<01:31,  1.67s/it] 49%|████▊     | 51/105 [01:25<01:33,  1.72s/it] 50%|████▉     | 52/105 [01:27<01:31,  1.73s/it] 50%|█████     | 53/105 [01:29<01:35,  1.83s/it] 51%|█████▏    | 54/105 [01:31<01:34,  1.85s/it] 52%|█████▏    | 55/105 [01:31<01:07,  1.36s/it] 53%|█████▎    | 56/105 [01:32<01:08,  1.40s/it] 54%|█████▍    | 57/105 [01:34<01:13,  1.52s/it] 55%|█████▌    | 58/105 [01:35<01:09,  1.47s/it] 56%|█████▌    | 59/105 [01:37<01:13,  1.61s/it] 57%|█████▋    | 60/105 [01:39<01:12,  1.62s/it] 58%|█████▊    | 61/105 [01:41<01:11,  1.63s/it] 59%|█████▉    | 62/105 [01:42<01:07,  1.57s/it] 60%|██████    | 63/105 [01:44<01:07,  1.60s/it] 61%|██████    | 64/105 [01:46<01:07,  1.65s/it] 62%|██████▏   | 65/105 [01:47<01:07,  1.69s/it] 63%|██████▎   | 66/105 [01:49<01:04,  1.66s/it] 64%|██████▍   | 67/105 [01:51<01:03,  1.67s/it] 65%|██████▍   | 68/105 [01:52<01:00,  1.62s/it] 66%|██████▌   | 69/105 [01:54<00:57,  1.60s/it] 67%|██████▋   | 70/105 [01:55<00:54,  1.57s/it] 68%|██████▊   | 71/105 [01:57<00:51,  1.51s/it] 69%|██████▊   | 72/105 [01:58<00:52,  1.58s/it] 70%|██████▉   | 73/105 [02:00<00:48,  1.51s/it] 70%|███████   | 74/105 [02:01<00:48,  1.56s/it] 71%|███████▏  | 75/105 [02:03<00:46,  1.56s/it] 72%|███████▏  | 76/105 [02:04<00:45,  1.56s/it] 73%|███████▎  | 77/105 [02:06<00:43,  1.55s/it] 74%|███████▍  | 78/105 [02:08<00:43,  1.62s/it] 75%|███████▌  | 79/105 [02:11<00:53,  2.06s/it] 76%|███████▌  | 80/105 [02:13<00:51,  2.06s/it] 77%|███████▋  | 81/105 [02:15<00:48,  2.03s/it] 78%|███████▊  | 82/105 [02:16<00:43,  1.90s/it] 79%|███████▉  | 83/105 [02:18<00:39,  1.77s/it] 80%|████████  | 84/105 [02:19<00:35,  1.70s/it] 81%|████████  | 85/105 [02:21<00:32,  1.63s/it] 82%|████████▏ | 86/105 [02:22<00:30,  1.60s/it] 83%|████████▎ | 87/105 [02:24<00:29,  1.64s/it] 84%|████████▍ | 88/105 [02:28<00:37,  2.21s/it] 85%|████████▍ | 89/105 [02:29<00:33,  2.08s/it] 86%|████████▌ | 90/105 [02:31<00:28,  1.91s/it] 87%|████████▋ | 91/105 [02:33<00:25,  1.83s/it] 88%|████████▊ | 92/105 [02:34<00:23,  1.83s/it] 89%|████████▊ | 93/105 [02:36<00:21,  1.78s/it] 90%|████████▉ | 94/105 [02:38<00:19,  1.73s/it] 90%|█████████ | 95/105 [02:40<00:19,  1.93s/it] 91%|█████████▏| 96/105 [02:42<00:16,  1.87s/it] 92%|█████████▏| 97/105 [02:43<00:13,  1.75s/it] 93%|█████████▎| 98/105 [02:45<00:11,  1.71s/it] 94%|█████████▍| 99/105 [02:47<00:09,  1.67s/it] 95%|█████████▌| 100/105 [02:48<00:08,  1.62s/it] 96%|█████████▌| 101/105 [02:49<00:06,  1.56s/it] 97%|█████████▋| 102/105 [02:51<00:04,  1.62s/it] 98%|█████████▊| 103/105 [02:53<00:03,  1.58s/it] 99%|█████████▉| 104/105 [02:54<00:01,  1.60s/it]100%|██████████| 105/105 [02:55<00:00,  1.19s/it]100%|██████████| 105/105 [02:56<00:00,  1.68s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 101
调用obs
  0%|          | 0/101 [00:00<?, ?it/s]  1%|          | 1/101 [00:01<01:58,  1.18s/it]  2%|▏         | 2/101 [00:02<02:11,  1.33s/it]  3%|▎         | 3/101 [00:04<02:23,  1.47s/it]  4%|▍         | 4/101 [00:05<02:15,  1.39s/it]  5%|▍         | 5/101 [00:08<02:56,  1.84s/it]  6%|▌         | 6/101 [00:09<02:38,  1.67s/it]  7%|▋         | 7/101 [00:11<02:32,  1.63s/it]  8%|▊         | 8/101 [00:12<02:17,  1.48s/it]  9%|▉         | 9/101 [00:13<02:09,  1.41s/it] 11%|█         | 11/101 [00:14<01:34,  1.05s/it] 12%|█▏        | 12/101 [00:16<01:50,  1.24s/it] 13%|█▎        | 13/101 [00:17<01:45,  1.20s/it] 14%|█▍        | 14/101 [00:19<01:48,  1.25s/it] 15%|█▍        | 15/101 [00:20<01:49,  1.27s/it] 16%|█▌        | 16/101 [00:21<01:49,  1.29s/it] 17%|█▋        | 17/101 [00:23<01:59,  1.42s/it] 19%|█▉        | 19/101 [00:24<01:23,  1.02s/it] 20%|█▉        | 20/101 [00:25<01:26,  1.07s/it] 21%|██        | 21/101 [00:27<01:37,  1.21s/it] 22%|██▏       | 22/101 [00:28<01:42,  1.30s/it] 23%|██▎       | 23/101 [00:29<01:36,  1.23s/it] 24%|██▍       | 24/101 [00:31<01:31,  1.19s/it] 25%|██▍       | 25/101 [00:32<01:32,  1.22s/it] 26%|██▌       | 26/101 [00:34<01:46,  1.42s/it] 27%|██▋       | 27/101 [00:35<01:37,  1.31s/it] 28%|██▊       | 28/101 [00:36<01:35,  1.31s/it] 29%|██▊       | 29/101 [00:37<01:33,  1.30s/it] 30%|██▉       | 30/101 [00:39<01:42,  1.44s/it] 31%|███       | 31/101 [00:40<01:36,  1.38s/it] 32%|███▏      | 32/101 [00:41<01:29,  1.29s/it] 33%|███▎      | 33/101 [00:43<01:29,  1.32s/it] 34%|███▎      | 34/101 [00:45<01:36,  1.45s/it] 35%|███▍      | 35/101 [00:46<01:39,  1.51s/it] 36%|███▌      | 36/101 [00:47<01:31,  1.40s/it] 37%|███▋      | 37/101 [00:49<01:27,  1.37s/it] 38%|███▊      | 38/101 [00:50<01:30,  1.43s/it] 39%|███▊      | 39/101 [00:52<01:28,  1.43s/it] 41%|████      | 41/101 [00:53<01:06,  1.11s/it] 42%|████▏     | 42/101 [00:54<01:06,  1.12s/it] 43%|████▎     | 43/101 [00:56<01:10,  1.21s/it] 44%|████▎     | 44/101 [00:57<01:07,  1.19s/it] 45%|████▍     | 45/101 [00:58<01:11,  1.28s/it] 46%|████▌     | 46/101 [01:00<01:14,  1.35s/it] 47%|████▋     | 47/101 [01:02<01:17,  1.44s/it] 48%|████▊     | 48/101 [01:03<01:13,  1.39s/it] 49%|████▊     | 49/101 [01:04<01:10,  1.36s/it] 50%|████▉     | 50/101 [01:06<01:08,  1.34s/it] 50%|█████     | 51/101 [01:07<01:05,  1.31s/it] 51%|█████▏    | 52/101 [01:08<01:03,  1.29s/it] 52%|█████▏    | 53/101 [01:09<00:57,  1.21s/it] 53%|█████▎    | 54/101 [01:10<00:57,  1.23s/it] 54%|█████▍    | 55/101 [01:12<00:56,  1.24s/it] 55%|█████▌    | 56/101 [01:13<00:59,  1.31s/it] 56%|█████▋    | 57/101 [01:14<00:53,  1.21s/it] 57%|█████▋    | 58/101 [01:15<00:53,  1.25s/it] 58%|█████▊    | 59/101 [01:17<00:52,  1.25s/it] 59%|█████▉    | 60/101 [01:18<00:54,  1.34s/it] 60%|██████    | 61/101 [01:19<00:50,  1.26s/it] 61%|██████▏   | 62/101 [01:21<00:50,  1.31s/it] 62%|██████▏   | 63/101 [01:22<00:49,  1.30s/it] 63%|██████▎   | 64/101 [01:23<00:48,  1.30s/it] 64%|██████▍   | 65/101 [01:24<00:45,  1.26s/it] 65%|██████▌   | 66/101 [01:26<00:44,  1.27s/it] 66%|██████▋   | 67/101 [01:27<00:47,  1.41s/it] 67%|██████▋   | 68/101 [01:29<00:44,  1.34s/it] 68%|██████▊   | 69/101 [01:30<00:41,  1.30s/it] 69%|██████▉   | 70/101 [01:31<00:41,  1.33s/it] 70%|███████   | 71/101 [01:33<00:40,  1.34s/it] 71%|███████▏  | 72/101 [01:34<00:38,  1.32s/it] 72%|███████▏  | 73/101 [01:35<00:33,  1.19s/it] 73%|███████▎  | 74/101 [01:36<00:34,  1.27s/it] 74%|███████▍  | 75/101 [01:38<00:40,  1.57s/it] 75%|███████▌  | 76/101 [01:40<00:38,  1.56s/it] 76%|███████▌  | 77/101 [01:41<00:34,  1.45s/it] 77%|███████▋  | 78/101 [01:43<00:34,  1.50s/it] 78%|███████▊  | 79/101 [01:44<00:30,  1.38s/it] 79%|███████▉  | 80/101 [01:46<00:30,  1.46s/it] 80%|████████  | 81/101 [01:47<00:28,  1.41s/it] 81%|████████  | 82/101 [01:48<00:24,  1.30s/it] 82%|████████▏ | 83/101 [01:50<00:26,  1.46s/it] 83%|████████▎ | 84/101 [01:52<00:29,  1.75s/it] 84%|████████▍ | 85/101 [01:54<00:27,  1.73s/it] 85%|████████▌ | 86/101 [01:55<00:23,  1.54s/it] 86%|████████▌ | 87/101 [01:56<00:19,  1.42s/it] 87%|████████▋ | 88/101 [01:58<00:19,  1.47s/it] 88%|████████▊ | 89/101 [01:59<00:17,  1.43s/it] 89%|████████▉ | 90/101 [02:02<00:20,  1.82s/it] 90%|█████████ | 91/101 [02:03<00:16,  1.61s/it] 91%|█████████ | 92/101 [02:04<00:12,  1.44s/it] 92%|█████████▏| 93/101 [02:05<00:11,  1.38s/it] 93%|█████████▎| 94/101 [02:07<00:10,  1.43s/it] 94%|█████████▍| 95/101 [02:08<00:08,  1.40s/it] 95%|█████████▌| 96/101 [02:09<00:06,  1.37s/it] 96%|█████████▌| 97/101 [02:11<00:05,  1.36s/it] 97%|█████████▋| 98/101 [02:12<00:04,  1.39s/it] 98%|█████████▊| 99/101 [02:13<00:02,  1.35s/it] 99%|█████████▉| 100/101 [02:14<00:01,  1.27s/it]100%|██████████| 101/101 [02:16<00:00,  1.26s/it]100%|██████████| 101/101 [02:16<00:00,  1.35s/it]
invalid api type, one_api_str:{'domain': '媒体', 'action': '搜索', 'mediatype': '视频', 'category': '经典', 'actors': '刘德华', 'channel': '综艺', 'apiname': 'todrequest'}
invalid api type, one_api_str:{'domain': '媒体', 'action': '搜索', 'mediatype': '视频', 'personname': '周润发', 'apiname': 'todrequest'}
invalid api type, one_api_str:{'domain': '媒体', 'action': '搜索', 'mediatype': '视频', 'channel': '电影', 'ranktype': '最新', 'personname': '刘德华', 'apiname': 'todrequest'}
有效obs数量 98
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-11/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 98 / 98
  0%|          | 0/98 [00:00<?, ?it/s]  1%|          | 1/98 [00:10<16:22, 10.13s/it]  3%|▎         | 3/98 [00:10<04:22,  2.76s/it]  5%|▌         | 5/98 [00:11<02:21,  1.52s/it]  6%|▌         | 6/98 [00:12<02:24,  1.57s/it]  7%|▋         | 7/98 [00:14<02:24,  1.59s/it]  9%|▉         | 9/98 [00:15<01:36,  1.09s/it] 10%|█         | 10/98 [00:16<01:41,  1.15s/it] 11%|█         | 11/98 [00:17<01:33,  1.08s/it] 12%|█▏        | 12/98 [00:21<02:34,  1.80s/it] 15%|█▌        | 15/98 [00:24<01:50,  1.34s/it] 17%|█▋        | 17/98 [00:24<01:20,  1.01it/s] 18%|█▊        | 18/98 [00:28<01:59,  1.49s/it] 20%|██        | 20/98 [00:30<01:45,  1.36s/it] 23%|██▎       | 23/98 [00:33<01:24,  1.12s/it] 26%|██▌       | 25/98 [00:33<01:03,  1.14it/s] 27%|██▋       | 26/98 [00:34<00:58,  1.24it/s] 28%|██▊       | 27/98 [00:37<01:26,  1.22s/it] 30%|██▉       | 29/98 [00:39<01:21,  1.18s/it] 34%|███▎      | 33/98 [00:43<01:14,  1.14s/it] 37%|███▋      | 36/98 [00:44<00:53,  1.17it/s] 39%|███▉      | 38/98 [00:54<01:52,  1.88s/it] 45%|████▍     | 44/98 [00:58<01:07,  1.25s/it] 47%|████▋     | 46/98 [00:59<00:56,  1.08s/it] 49%|████▉     | 48/98 [01:00<00:46,  1.08it/s] 50%|█████     | 49/98 [01:03<01:01,  1.26s/it] 52%|█████▏    | 51/98 [01:08<01:14,  1.59s/it] 56%|█████▌    | 55/98 [01:09<00:45,  1.06s/it] 58%|█████▊    | 57/98 [01:10<00:36,  1.12it/s] 59%|█████▉    | 58/98 [01:11<00:36,  1.09it/s] 61%|██████    | 60/98 [01:17<00:55,  1.47s/it] 65%|██████▌   | 64/98 [01:20<00:38,  1.12s/it] 67%|██████▋   | 66/98 [01:25<00:47,  1.49s/it] 70%|███████   | 69/98 [01:26<00:31,  1.10s/it] 71%|███████▏  | 70/98 [01:27<00:29,  1.06s/it] 73%|███████▎  | 72/98 [01:30<00:30,  1.17s/it] 74%|███████▍  | 73/98 [01:33<00:37,  1.52s/it] 79%|███████▊  | 77/98 [01:33<00:16,  1.25it/s] 80%|███████▉  | 78/98 [01:37<00:24,  1.25s/it] 84%|████████▎ | 82/98 [01:40<00:16,  1.01s/it] 85%|████████▍ | 83/98 [01:45<00:23,  1.58s/it] 91%|█████████ | 89/98 [01:47<00:08,  1.08it/s] 93%|█████████▎| 91/98 [01:48<00:05,  1.24it/s] 95%|█████████▍| 93/98 [01:48<00:03,  1.54it/s] 96%|█████████▌| 94/98 [01:52<00:04,  1.14s/it] 98%|█████████▊| 96/98 [01:53<00:01,  1.03it/s]100%|██████████| 98/98 [01:53<00:00,  1.16s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-13 22:09:37 
[INFO] duration: 9 min 
[2024-09-14 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-12/prod/2024-09-12_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-14 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-12/prod/2024-09-12_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-12
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-12/prod/2024-09-12_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-12/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-12/prod/2024-09-12_rule_labeled.csv.gpt_labeled.csv
raw log len: 360
时效人设任务型query 数量： 0
unique queries len: 83
调用API
  0%|          | 0/83 [00:00<?, ?it/s]  2%|▏         | 2/83 [00:01<01:18,  1.03it/s]  4%|▎         | 3/83 [00:02<00:53,  1.51it/s]  5%|▍         | 4/83 [00:03<01:26,  1.09s/it]  6%|▌         | 5/83 [00:05<01:34,  1.21s/it]  7%|▋         | 6/83 [00:06<01:39,  1.29s/it]  8%|▊         | 7/83 [00:08<01:51,  1.47s/it] 10%|▉         | 8/83 [00:10<02:03,  1.65s/it] 11%|█         | 9/83 [00:12<02:08,  1.74s/it] 12%|█▏        | 10/83 [00:14<01:59,  1.64s/it] 13%|█▎        | 11/83 [00:15<01:55,  1.61s/it] 14%|█▍        | 12/83 [00:17<01:51,  1.58s/it] 16%|█▌        | 13/83 [00:17<01:21,  1.17s/it] 17%|█▋        | 14/83 [00:18<01:27,  1.27s/it] 18%|█▊        | 15/83 [00:20<01:32,  1.36s/it] 19%|█▉        | 16/83 [00:22<01:43,  1.54s/it] 20%|██        | 17/83 [00:24<01:44,  1.59s/it] 22%|██▏       | 18/83 [00:26<01:54,  1.75s/it] 23%|██▎       | 19/83 [00:27<01:50,  1.73s/it] 24%|██▍       | 20/83 [00:29<01:51,  1.76s/it] 25%|██▌       | 21/83 [00:31<01:52,  1.81s/it] 27%|██▋       | 22/83 [00:33<01:42,  1.68s/it] 28%|██▊       | 23/83 [00:34<01:44,  1.74s/it] 29%|██▉       | 24/83 [00:36<01:44,  1.78s/it] 30%|███       | 25/83 [00:38<01:37,  1.67s/it] 31%|███▏      | 26/83 [00:40<01:37,  1.71s/it] 33%|███▎      | 27/83 [00:41<01:35,  1.70s/it] 34%|███▎      | 28/83 [00:43<01:32,  1.69s/it] 35%|███▍      | 29/83 [00:45<01:30,  1.67s/it] 36%|███▌      | 30/83 [00:46<01:29,  1.68s/it] 37%|███▋      | 31/83 [00:48<01:28,  1.71s/it] 39%|███▊      | 32/83 [00:50<01:29,  1.75s/it] 40%|███▉      | 33/83 [00:51<01:25,  1.71s/it] 41%|████      | 34/83 [00:53<01:26,  1.77s/it] 42%|████▏     | 35/83 [00:55<01:22,  1.72s/it] 43%|████▎     | 36/83 [00:57<01:20,  1.72s/it] 45%|████▍     | 37/83 [00:58<01:16,  1.67s/it] 46%|████▌     | 38/83 [01:00<01:14,  1.66s/it] 47%|████▋     | 39/83 [01:01<01:12,  1.64s/it] 48%|████▊     | 40/83 [01:03<01:13,  1.70s/it] 49%|████▉     | 41/83 [01:05<01:12,  1.72s/it] 51%|█████     | 42/83 [01:06<01:06,  1.63s/it] 52%|█████▏    | 43/83 [01:08<01:05,  1.63s/it] 53%|█████▎    | 44/83 [01:10<01:04,  1.65s/it] 54%|█████▍    | 45/83 [01:11<01:02,  1.64s/it] 55%|█████▌    | 46/83 [01:13<01:01,  1.66s/it] 57%|█████▋    | 47/83 [01:15<00:59,  1.65s/it] 58%|█████▊    | 48/83 [01:17<01:01,  1.74s/it] 59%|█████▉    | 49/83 [01:18<00:57,  1.68s/it] 60%|██████    | 50/83 [01:20<00:55,  1.67s/it] 61%|██████▏   | 51/83 [01:22<00:54,  1.71s/it] 63%|██████▎   | 52/83 [01:23<00:53,  1.73s/it] 64%|██████▍   | 53/83 [01:25<00:50,  1.68s/it] 65%|██████▌   | 54/83 [01:27<00:49,  1.70s/it] 66%|██████▋   | 55/83 [01:29<00:49,  1.77s/it] 67%|██████▋   | 56/83 [01:30<00:47,  1.74s/it] 69%|██████▊   | 57/83 [01:32<00:43,  1.67s/it] 70%|██████▉   | 58/83 [01:33<00:40,  1.60s/it] 71%|███████   | 59/83 [01:35<00:39,  1.63s/it] 72%|███████▏  | 60/83 [01:37<00:36,  1.58s/it] 73%|███████▎  | 61/83 [01:38<00:36,  1.65s/it] 75%|███████▍  | 62/83 [01:40<00:35,  1.71s/it] 76%|███████▌  | 63/83 [01:42<00:32,  1.62s/it] 77%|███████▋  | 64/83 [01:44<00:33,  1.78s/it] 78%|███████▊  | 65/83 [01:45<00:30,  1.70s/it] 80%|███████▉  | 66/83 [01:47<00:28,  1.68s/it] 81%|████████  | 67/83 [01:49<00:28,  1.77s/it] 82%|████████▏ | 68/83 [01:51<00:26,  1.73s/it] 83%|████████▎ | 69/83 [01:54<00:29,  2.10s/it] 84%|████████▍ | 70/83 [01:55<00:25,  1.97s/it] 86%|████████▌ | 71/83 [01:55<00:17,  1.45s/it] 87%|████████▋ | 72/83 [01:57<00:17,  1.55s/it] 88%|████████▊ | 73/83 [01:59<00:15,  1.57s/it] 89%|████████▉ | 74/83 [02:00<00:13,  1.55s/it] 90%|█████████ | 75/83 [02:02<00:12,  1.56s/it] 92%|█████████▏| 76/83 [02:03<00:10,  1.53s/it] 93%|█████████▎| 77/83 [02:05<00:09,  1.60s/it] 94%|█████████▍| 78/83 [02:07<00:08,  1.64s/it] 95%|█████████▌| 79/83 [02:08<00:06,  1.60s/it] 96%|█████████▋| 80/83 [02:10<00:04,  1.59s/it] 98%|█████████▊| 81/83 [02:12<00:03,  1.82s/it] 99%|█████████▉| 82/83 [02:14<00:01,  1.79s/it]100%|██████████| 83/83 [02:16<00:00,  1.89s/it]100%|██████████| 83/83 [02:18<00:00,  1.66s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 80
调用obs
  0%|          | 0/80 [00:00<?, ?it/s]  1%|▏         | 1/80 [00:03<05:01,  3.82s/it]  2%|▎         | 2/80 [00:04<02:54,  2.24s/it]  4%|▍         | 3/80 [00:06<02:28,  1.92s/it]  5%|▌         | 4/80 [00:07<02:06,  1.67s/it]  6%|▋         | 5/80 [00:08<01:49,  1.46s/it]  8%|▊         | 6/80 [00:10<01:40,  1.36s/it]  9%|▉         | 7/80 [00:11<01:35,  1.30s/it] 10%|█         | 8/80 [00:12<01:30,  1.26s/it] 11%|█▏        | 9/80 [00:13<01:25,  1.20s/it] 12%|█▎        | 10/80 [00:14<01:28,  1.27s/it] 14%|█▍        | 11/80 [00:15<01:24,  1.22s/it] 15%|█▌        | 12/80 [00:17<01:25,  1.26s/it] 16%|█▋        | 13/80 [00:18<01:15,  1.12s/it] 18%|█▊        | 14/80 [00:19<01:15,  1.14s/it] 19%|█▉        | 15/80 [00:20<01:17,  1.19s/it] 20%|██        | 16/80 [00:21<01:14,  1.16s/it] 21%|██▏       | 17/80 [00:22<01:07,  1.07s/it] 22%|██▎       | 18/80 [00:23<01:03,  1.02s/it] 24%|██▍       | 19/80 [00:24<01:08,  1.12s/it] 25%|██▌       | 20/80 [00:26<01:13,  1.22s/it] 26%|██▋       | 21/80 [00:27<01:11,  1.21s/it] 28%|██▊       | 22/80 [00:28<01:13,  1.26s/it] 29%|██▉       | 23/80 [00:30<01:13,  1.29s/it] 30%|███       | 24/80 [00:31<01:17,  1.38s/it] 31%|███▏      | 25/80 [00:32<01:11,  1.29s/it] 32%|███▎      | 26/80 [00:34<01:08,  1.27s/it] 34%|███▍      | 27/80 [00:35<01:10,  1.34s/it] 35%|███▌      | 28/80 [00:36<01:06,  1.29s/it] 36%|███▋      | 29/80 [00:38<01:05,  1.28s/it] 38%|███▊      | 30/80 [00:39<01:02,  1.24s/it] 39%|███▉      | 31/80 [00:40<01:01,  1.26s/it] 40%|████      | 32/80 [00:41<00:59,  1.24s/it] 41%|████▏     | 33/80 [00:43<01:02,  1.33s/it] 42%|████▎     | 34/80 [00:44<01:04,  1.39s/it] 44%|████▍     | 35/80 [00:46<01:09,  1.54s/it] 45%|████▌     | 36/80 [00:47<01:03,  1.45s/it] 46%|████▋     | 37/80 [00:49<00:57,  1.34s/it] 48%|████▊     | 38/80 [00:50<00:59,  1.41s/it] 49%|████▉     | 39/80 [00:51<00:53,  1.31s/it] 50%|█████     | 40/80 [00:52<00:51,  1.28s/it] 51%|█████▏    | 41/80 [00:54<00:49,  1.28s/it] 52%|█████▎    | 42/80 [00:55<00:50,  1.34s/it] 54%|█████▍    | 43/80 [00:57<00:50,  1.37s/it] 55%|█████▌    | 44/80 [00:58<00:47,  1.32s/it] 56%|█████▋    | 45/80 [00:58<00:39,  1.14s/it] 57%|█████▊    | 46/80 [01:00<00:42,  1.26s/it] 59%|█████▉    | 47/80 [01:01<00:42,  1.28s/it] 60%|██████    | 48/80 [01:03<00:41,  1.29s/it] 61%|██████▏   | 49/80 [01:04<00:38,  1.25s/it] 62%|██████▎   | 50/80 [01:05<00:38,  1.27s/it] 64%|██████▍   | 51/80 [01:06<00:37,  1.29s/it] 65%|██████▌   | 52/80 [01:07<00:31,  1.12s/it] 66%|██████▋   | 53/80 [01:09<00:31,  1.18s/it] 68%|██████▊   | 54/80 [01:10<00:32,  1.24s/it] 69%|██████▉   | 55/80 [01:11<00:32,  1.31s/it] 70%|███████   | 56/80 [01:13<00:30,  1.28s/it] 71%|███████▏  | 57/80 [01:14<00:31,  1.37s/it] 72%|███████▎  | 58/80 [01:15<00:29,  1.34s/it] 74%|███████▍  | 59/80 [01:17<00:30,  1.45s/it] 75%|███████▌  | 60/80 [01:19<00:28,  1.43s/it] 76%|███████▋  | 61/80 [01:20<00:25,  1.34s/it] 78%|███████▊  | 62/80 [01:21<00:24,  1.37s/it] 79%|███████▉  | 63/80 [01:22<00:21,  1.26s/it] 80%|████████  | 64/80 [01:23<00:20,  1.27s/it] 81%|████████▏ | 65/80 [01:25<00:20,  1.38s/it] 82%|████████▎ | 66/80 [01:28<00:24,  1.75s/it] 84%|████████▍ | 67/80 [01:29<00:21,  1.62s/it] 85%|████████▌ | 68/80 [01:31<00:19,  1.63s/it] 86%|████████▋ | 69/80 [01:32<00:16,  1.54s/it] 88%|████████▊ | 70/80 [01:34<00:15,  1.60s/it] 89%|████████▉ | 71/80 [01:35<00:13,  1.55s/it] 90%|█████████ | 72/80 [01:36<00:11,  1.46s/it] 91%|█████████▏| 73/80 [01:38<00:09,  1.38s/it] 92%|█████████▎| 74/80 [01:39<00:08,  1.35s/it] 94%|█████████▍| 75/80 [01:40<00:06,  1.32s/it] 95%|█████████▌| 76/80 [01:41<00:04,  1.24s/it] 96%|█████████▋| 77/80 [01:42<00:03,  1.16s/it] 98%|█████████▊| 78/80 [01:43<00:02,  1.20s/it] 99%|█████████▉| 79/80 [01:44<00:01,  1.10s/it]100%|██████████| 80/80 [01:46<00:00,  1.14s/it]100%|██████████| 80/80 [01:46<00:00,  1.33s/it]
有效obs数量 80
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-12/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 80 / 80
  0%|          | 0/80 [00:00<?, ?it/s]  1%|▏         | 1/80 [00:07<09:32,  7.25s/it]  2%|▎         | 2/80 [00:08<04:53,  3.76s/it]  4%|▍         | 3/80 [00:09<03:16,  2.55s/it]  5%|▌         | 4/80 [00:11<02:46,  2.19s/it]  8%|▊         | 6/80 [00:13<02:08,  1.74s/it]  9%|▉         | 7/80 [00:16<02:25,  1.99s/it] 14%|█▍        | 11/80 [00:18<01:12,  1.04s/it] 15%|█▌        | 12/80 [00:19<01:13,  1.08s/it] 18%|█▊        | 14/80 [00:20<00:51,  1.27it/s] 19%|█▉        | 15/80 [00:20<00:49,  1.31it/s] 20%|██        | 16/80 [00:23<01:12,  1.14s/it] 24%|██▍       | 19/80 [00:24<00:49,  1.24it/s] 25%|██▌       | 20/80 [00:25<00:48,  1.23it/s] 26%|██▋       | 21/80 [00:26<00:47,  1.24it/s] 29%|██▉       | 23/80 [00:27<00:47,  1.20it/s] 30%|███       | 24/80 [00:29<00:51,  1.09it/s] 31%|███▏      | 25/80 [00:31<01:10,  1.28s/it] 34%|███▍      | 27/80 [00:31<00:44,  1.20it/s] 36%|███▋      | 29/80 [00:36<01:05,  1.28s/it] 40%|████      | 32/80 [00:36<00:38,  1.24it/s] 42%|████▎     | 34/80 [00:40<00:49,  1.07s/it] 48%|████▊     | 38/80 [00:43<00:39,  1.07it/s] 51%|█████▏    | 41/80 [00:43<00:26,  1.48it/s] 54%|█████▍    | 43/80 [00:44<00:24,  1.50it/s] 55%|█████▌    | 44/80 [00:46<00:28,  1.26it/s] 56%|█████▋    | 45/80 [00:47<00:31,  1.12it/s] 60%|██████    | 48/80 [00:49<00:24,  1.28it/s] 61%|██████▏   | 49/80 [00:53<00:38,  1.23s/it] 65%|██████▌   | 52/80 [00:54<00:25,  1.10it/s] 66%|██████▋   | 53/80 [00:56<00:29,  1.10s/it] 70%|███████   | 56/80 [00:57<00:17,  1.35it/s] 71%|███████▏  | 57/80 [00:59<00:22,  1.03it/s] 72%|███████▎  | 58/80 [01:01<00:24,  1.12s/it] 75%|███████▌  | 60/80 [01:01<00:16,  1.18it/s] 76%|███████▋  | 61/80 [01:02<00:17,  1.12it/s] 79%|███████▉  | 63/80 [01:04<00:14,  1.20it/s] 81%|████████▏ | 65/80 [01:05<00:11,  1.32it/s] 82%|████████▎ | 66/80 [01:09<00:18,  1.34s/it] 86%|████████▋ | 69/80 [01:09<00:08,  1.32it/s] 88%|████████▊ | 70/80 [01:12<00:11,  1.12s/it] 90%|█████████ | 72/80 [01:13<00:07,  1.08it/s] 91%|█████████▏| 73/80 [01:14<00:06,  1.12it/s] 94%|█████████▍| 75/80 [01:17<00:06,  1.22s/it]100%|██████████| 80/80 [01:17<00:00,  1.03it/s]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-14 22:07:48 
[INFO] duration: 7 min 
[2024-09-15 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-13/prod/2024-09-13_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-16 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-14/prod/2024-09-14_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-17 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-15/prod/2024-09-15_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-18 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-16/prod/2024-09-16_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-19 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-17/prod/2024-09-17_rule_labeled.csv.gpt_labeled.csv is not ready.
[2024-09-20 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-18/prod/2024-09-18_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-20 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-18/prod/2024-09-18_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-18
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-18/prod/2024-09-18_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-18/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-18/prod/2024-09-18_rule_labeled.csv.gpt_labeled.csv
raw log len: 241
时效人设任务型query 数量： 2
unique queries len: 66
调用API
  0%|          | 0/66 [00:00<?, ?it/s]  3%|▎         | 2/66 [00:01<01:01,  1.04it/s]  5%|▍         | 3/66 [00:04<01:43,  1.64s/it]  6%|▌         | 4/66 [00:06<01:40,  1.62s/it]  8%|▊         | 5/66 [00:07<01:42,  1.68s/it]  9%|▉         | 6/66 [00:09<01:39,  1.65s/it] 11%|█         | 7/66 [00:11<01:41,  1.72s/it] 12%|█▏        | 8/66 [00:13<01:38,  1.70s/it] 14%|█▎        | 9/66 [00:14<01:37,  1.71s/it] 15%|█▌        | 10/66 [00:16<01:33,  1.67s/it] 17%|█▋        | 11/66 [00:18<01:33,  1.71s/it] 18%|█▊        | 12/66 [00:20<01:39,  1.84s/it] 20%|█▉        | 13/66 [00:21<01:33,  1.76s/it] 21%|██        | 14/66 [00:23<01:26,  1.67s/it] 23%|██▎       | 15/66 [00:25<01:28,  1.74s/it] 24%|██▍       | 16/66 [00:26<01:28,  1.76s/it] 26%|██▌       | 17/66 [00:28<01:20,  1.64s/it] 27%|██▋       | 18/66 [00:29<01:17,  1.61s/it] 29%|██▉       | 19/66 [00:31<01:17,  1.64s/it] 30%|███       | 20/66 [00:33<01:14,  1.62s/it] 32%|███▏      | 21/66 [00:35<01:18,  1.75s/it] 33%|███▎      | 22/66 [00:37<01:17,  1.77s/it] 35%|███▍      | 23/66 [00:38<01:13,  1.71s/it] 36%|███▋      | 24/66 [00:40<01:13,  1.74s/it] 38%|███▊      | 25/66 [00:42<01:09,  1.70s/it] 39%|███▉      | 26/66 [00:43<01:08,  1.70s/it] 41%|████      | 27/66 [00:45<01:06,  1.70s/it] 42%|████▏     | 28/66 [00:47<01:05,  1.71s/it] 44%|████▍     | 29/66 [00:49<01:12,  1.97s/it] 45%|████▌     | 30/66 [00:51<01:12,  2.03s/it] 47%|████▋     | 31/66 [00:53<01:07,  1.92s/it] 48%|████▊     | 32/66 [00:55<01:01,  1.82s/it] 50%|█████     | 33/66 [00:57<01:01,  1.85s/it] 52%|█████▏    | 34/66 [00:58<00:58,  1.83s/it] 53%|█████▎    | 35/66 [01:00<00:55,  1.78s/it] 55%|█████▍    | 36/66 [01:02<00:53,  1.80s/it] 56%|█████▌    | 37/66 [01:04<00:51,  1.77s/it] 58%|█████▊    | 38/66 [01:05<00:49,  1.75s/it] 59%|█████▉    | 39/66 [01:07<00:48,  1.78s/it] 61%|██████    | 40/66 [01:09<00:44,  1.70s/it] 62%|██████▏   | 41/66 [01:10<00:42,  1.71s/it] 64%|██████▎   | 42/66 [01:12<00:41,  1.74s/it] 65%|██████▌   | 43/66 [01:14<00:37,  1.63s/it] 67%|██████▋   | 44/66 [01:15<00:36,  1.64s/it] 68%|██████▊   | 45/66 [01:17<00:32,  1.57s/it] 70%|██████▉   | 46/66 [01:18<00:31,  1.56s/it] 71%|███████   | 47/66 [01:20<00:28,  1.52s/it] 73%|███████▎  | 48/66 [01:21<00:27,  1.55s/it] 74%|███████▍  | 49/66 [01:24<00:34,  2.03s/it] 76%|███████▌  | 50/66 [01:26<00:30,  1.91s/it] 77%|███████▋  | 51/66 [01:28<00:27,  1.84s/it] 79%|███████▉  | 52/66 [01:30<00:27,  1.97s/it] 80%|████████  | 53/66 [01:32<00:25,  1.98s/it] 82%|████████▏ | 54/66 [01:34<00:22,  1.91s/it] 83%|████████▎ | 55/66 [01:35<00:19,  1.81s/it] 85%|████████▍ | 56/66 [01:37<00:17,  1.75s/it] 86%|████████▋ | 57/66 [01:39<00:15,  1.71s/it] 88%|████████▊ | 58/66 [01:40<00:13,  1.73s/it] 89%|████████▉ | 59/66 [01:42<00:11,  1.70s/it] 91%|█████████ | 60/66 [01:44<00:09,  1.67s/it] 92%|█████████▏| 61/66 [01:45<00:08,  1.60s/it] 94%|█████████▍| 62/66 [01:46<00:06,  1.55s/it] 95%|█████████▌| 63/66 [01:48<00:04,  1.63s/it] 97%|█████████▋| 64/66 [01:50<00:03,  1.56s/it] 98%|█████████▊| 65/66 [01:51<00:01,  1.57s/it]100%|██████████| 66/66 [01:53<00:00,  1.62s/it]100%|██████████| 66/66 [01:55<00:00,  1.75s/it]
有效api数量 66
调用obs
  0%|          | 0/66 [00:00<?, ?it/s]  2%|▏         | 1/66 [00:01<01:18,  1.21s/it]  3%|▎         | 2/66 [00:03<02:12,  2.07s/it]  5%|▍         | 3/66 [00:05<02:01,  1.92s/it]  6%|▌         | 4/66 [00:06<01:40,  1.62s/it]  8%|▊         | 5/66 [00:08<01:34,  1.55s/it]  9%|▉         | 6/66 [00:09<01:22,  1.37s/it] 11%|█         | 7/66 [00:10<01:18,  1.33s/it] 12%|█▏        | 8/66 [00:12<01:23,  1.44s/it] 14%|█▎        | 9/66 [00:13<01:18,  1.38s/it] 15%|█▌        | 10/66 [00:14<01:20,  1.44s/it] 17%|█▋        | 11/66 [00:16<01:18,  1.44s/it] 18%|█▊        | 12/66 [00:18<01:21,  1.51s/it] 20%|█▉        | 13/66 [00:19<01:15,  1.42s/it] 21%|██        | 14/66 [00:20<01:14,  1.44s/it] 23%|██▎       | 15/66 [00:21<01:03,  1.25s/it] 24%|██▍       | 16/66 [00:22<01:04,  1.29s/it] 26%|██▌       | 17/66 [00:24<01:10,  1.44s/it] 27%|██▋       | 18/66 [00:26<01:08,  1.42s/it] 29%|██▉       | 19/66 [00:27<01:08,  1.45s/it] 30%|███       | 20/66 [00:29<01:07,  1.46s/it] 32%|███▏      | 21/66 [00:30<01:08,  1.51s/it] 33%|███▎      | 22/66 [00:32<01:04,  1.46s/it] 35%|███▍      | 23/66 [00:33<01:01,  1.43s/it] 36%|███▋      | 24/66 [00:34<00:57,  1.37s/it] 38%|███▊      | 25/66 [00:36<00:58,  1.43s/it] 39%|███▉      | 26/66 [00:37<00:57,  1.43s/it] 41%|████      | 27/66 [00:38<00:52,  1.34s/it] 42%|████▏     | 28/66 [00:41<01:09,  1.83s/it] 44%|████▍     | 29/66 [00:42<01:00,  1.63s/it] 45%|████▌     | 30/66 [00:44<00:55,  1.53s/it] 47%|████▋     | 31/66 [00:45<00:48,  1.37s/it] 48%|████▊     | 32/66 [00:46<00:48,  1.42s/it] 50%|█████     | 33/66 [00:48<00:49,  1.49s/it] 52%|█████▏    | 34/66 [00:49<00:45,  1.42s/it] 53%|█████▎    | 35/66 [00:51<00:44,  1.45s/it] 55%|█████▍    | 36/66 [00:52<00:41,  1.40s/it] 56%|█████▌    | 37/66 [00:53<00:41,  1.42s/it] 58%|█████▊    | 38/66 [00:55<00:40,  1.45s/it] 59%|█████▉    | 39/66 [00:56<00:38,  1.43s/it] 61%|██████    | 40/66 [00:58<00:36,  1.40s/it] 62%|██████▏   | 41/66 [00:59<00:35,  1.43s/it] 64%|██████▎   | 42/66 [01:01<00:34,  1.44s/it] 65%|██████▌   | 43/66 [01:02<00:33,  1.44s/it] 67%|██████▋   | 44/66 [01:04<00:32,  1.46s/it] 68%|██████▊   | 45/66 [01:05<00:31,  1.51s/it] 70%|██████▉   | 46/66 [01:07<00:29,  1.47s/it] 71%|███████   | 47/66 [01:08<00:28,  1.50s/it] 73%|███████▎  | 48/66 [01:11<00:34,  1.91s/it] 74%|███████▍  | 49/66 [01:13<00:30,  1.81s/it] 76%|███████▌  | 50/66 [01:14<00:28,  1.76s/it] 77%|███████▋  | 51/66 [01:15<00:22,  1.53s/it] 79%|███████▉  | 52/66 [01:17<00:21,  1.50s/it] 80%|████████  | 53/66 [01:18<00:19,  1.48s/it] 82%|████████▏ | 54/66 [01:20<00:18,  1.54s/it] 83%|████████▎ | 55/66 [01:21<00:15,  1.42s/it] 85%|████████▍ | 56/66 [01:22<00:13,  1.33s/it] 86%|████████▋ | 57/66 [01:23<00:10,  1.22s/it] 89%|████████▉ | 59/66 [01:25<00:07,  1.01s/it] 91%|█████████ | 60/66 [01:26<00:06,  1.15s/it] 92%|█████████▏| 61/66 [01:27<00:05,  1.17s/it] 94%|█████████▍| 62/66 [01:29<00:04,  1.22s/it] 95%|█████████▌| 63/66 [01:30<00:03,  1.30s/it] 97%|█████████▋| 64/66 [01:31<00:02,  1.27s/it] 98%|█████████▊| 65/66 [01:32<00:01,  1.21s/it]100%|██████████| 66/66 [01:34<00:00,  1.26s/it]100%|██████████| 66/66 [01:34<00:00,  1.43s/it]
invalid api type, one_api_str:{'keyphrase': '理想l七的内饰', 'category': '交通工具', 'style': '写实', 'apiname': 'aipainting'}
有效obs数量 65
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-18/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 65 / 65
  0%|          | 0/65 [00:00<?, ?it/s]  2%|▏         | 1/65 [00:10<11:32, 10.82s/it]  5%|▍         | 3/65 [00:14<04:19,  4.19s/it] 12%|█▏        | 8/65 [00:15<01:16,  1.33s/it] 14%|█▍        | 9/65 [00:17<01:18,  1.40s/it] 15%|█▌        | 10/65 [00:19<01:23,  1.52s/it] 18%|█▊        | 12/65 [00:20<00:57,  1.08s/it] 20%|██        | 13/65 [00:21<00:58,  1.12s/it] 23%|██▎       | 15/65 [00:24<00:59,  1.18s/it] 25%|██▍       | 16/65 [00:26<01:08,  1.40s/it] 28%|██▊       | 18/65 [00:26<00:44,  1.05it/s] 29%|██▉       | 19/65 [00:30<01:11,  1.55s/it] 32%|███▏      | 21/65 [00:31<00:55,  1.25s/it] 35%|███▌      | 23/65 [00:35<00:57,  1.38s/it] 38%|███▊      | 25/65 [00:35<00:39,  1.02it/s] 43%|████▎     | 28/65 [00:38<00:38,  1.05s/it] 45%|████▍     | 29/65 [00:40<00:37,  1.05s/it] 49%|████▉     | 32/65 [00:45<00:45,  1.39s/it] 57%|█████▋    | 37/65 [00:46<00:21,  1.32it/s] 58%|█████▊    | 38/65 [00:49<00:29,  1.08s/it] 62%|██████▏   | 40/65 [00:49<00:21,  1.19it/s] 63%|██████▎   | 41/65 [00:52<00:27,  1.14s/it] 65%|██████▍   | 42/65 [00:53<00:27,  1.18s/it] 69%|██████▉   | 45/65 [01:00<00:31,  1.56s/it] 74%|███████▍  | 48/65 [01:03<00:22,  1.34s/it] 77%|███████▋  | 50/65 [01:04<00:16,  1.13s/it] 78%|███████▊  | 51/65 [01:04<00:13,  1.02it/s] 82%|████████▏ | 53/65 [01:06<00:12,  1.06s/it] 85%|████████▍ | 55/65 [01:07<00:08,  1.20it/s] 86%|████████▌ | 56/65 [01:07<00:06,  1.43it/s] 88%|████████▊ | 57/65 [01:07<00:04,  1.60it/s] 89%|████████▉ | 58/65 [01:10<00:07,  1.10s/it] 91%|█████████ | 59/65 [01:14<00:10,  1.79s/it] 94%|█████████▍| 61/65 [01:17<00:06,  1.68s/it] 98%|█████████▊| 64/65 [01:18<00:00,  1.03it/s]100%|██████████| 65/65 [01:18<00:00,  1.20s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-20 22:07:11 
[INFO] duration: 7 min 
[2024-09-21 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-19/prod/2024-09-19_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-21 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-19/prod/2024-09-19_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-19
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-19/prod/2024-09-19_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-19/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-19/prod/2024-09-19_rule_labeled.csv.gpt_labeled.csv
raw log len: 206
时效人设任务型query 数量： 1
unique queries len: 66
调用API
  0%|          | 0/66 [00:00<?, ?it/s]  3%|▎         | 2/66 [00:01<01:02,  1.03it/s]  5%|▍         | 3/66 [00:03<01:21,  1.29s/it]  6%|▌         | 4/66 [00:05<01:30,  1.45s/it]  8%|▊         | 5/66 [00:07<01:32,  1.51s/it]  9%|▉         | 6/66 [00:08<01:34,  1.57s/it] 11%|█         | 7/66 [00:10<01:34,  1.60s/it] 12%|█▏        | 8/66 [00:12<01:33,  1.62s/it] 14%|█▎        | 9/66 [00:13<01:32,  1.61s/it] 15%|█▌        | 10/66 [00:15<01:34,  1.69s/it] 17%|█▋        | 11/66 [00:17<01:31,  1.67s/it] 18%|█▊        | 12/66 [00:18<01:27,  1.63s/it] 20%|█▉        | 13/66 [00:20<01:29,  1.68s/it] 21%|██        | 14/66 [00:22<01:30,  1.74s/it] 23%|██▎       | 15/66 [00:24<01:32,  1.81s/it] 24%|██▍       | 16/66 [00:25<01:26,  1.74s/it] 26%|██▌       | 17/66 [00:27<01:23,  1.70s/it] 27%|██▋       | 18/66 [00:29<01:25,  1.78s/it] 29%|██▉       | 19/66 [00:29<01:02,  1.32s/it] 30%|███       | 20/66 [00:31<01:08,  1.49s/it] 32%|███▏      | 21/66 [00:33<01:08,  1.53s/it] 33%|███▎      | 22/66 [00:34<01:08,  1.55s/it] 35%|███▍      | 23/66 [00:36<01:14,  1.72s/it] 36%|███▋      | 24/66 [00:38<01:11,  1.71s/it] 38%|███▊      | 25/66 [00:38<00:51,  1.27s/it] 39%|███▉      | 26/66 [00:40<00:54,  1.37s/it] 41%|████      | 27/66 [00:41<00:54,  1.41s/it] 42%|████▏     | 28/66 [00:43<00:53,  1.41s/it] 44%|████▍     | 29/66 [00:45<00:57,  1.55s/it] 45%|████▌     | 30/66 [00:46<00:57,  1.60s/it] 47%|████▋     | 31/66 [00:48<00:57,  1.63s/it] 48%|████▊     | 32/66 [00:50<00:56,  1.66s/it] 50%|█████     | 33/66 [00:52<00:55,  1.68s/it] 52%|█████▏    | 34/66 [00:54<00:57,  1.80s/it] 53%|█████▎    | 35/66 [00:55<00:53,  1.74s/it] 55%|█████▍    | 36/66 [00:57<00:55,  1.85s/it] 56%|█████▌    | 37/66 [00:59<00:50,  1.75s/it] 58%|█████▊    | 38/66 [01:00<00:47,  1.69s/it] 59%|█████▉    | 39/66 [01:02<00:43,  1.60s/it] 61%|██████    | 40/66 [01:03<00:40,  1.55s/it] 62%|██████▏   | 41/66 [01:05<00:40,  1.62s/it] 64%|██████▎   | 42/66 [01:07<00:38,  1.60s/it] 65%|██████▌   | 43/66 [01:08<00:36,  1.59s/it] 67%|██████▋   | 44/66 [01:10<00:36,  1.65s/it] 68%|██████▊   | 45/66 [01:12<00:34,  1.66s/it] 70%|██████▉   | 46/66 [01:13<00:32,  1.63s/it] 71%|███████   | 47/66 [01:16<00:35,  1.86s/it] 73%|███████▎  | 48/66 [01:16<00:24,  1.37s/it] 74%|███████▍  | 49/66 [01:18<00:24,  1.47s/it] 76%|███████▌  | 50/66 [01:19<00:25,  1.59s/it] 77%|███████▋  | 51/66 [01:21<00:23,  1.59s/it] 79%|███████▉  | 52/66 [01:23<00:22,  1.62s/it] 80%|████████  | 53/66 [01:24<00:21,  1.62s/it] 82%|████████▏ | 54/66 [01:25<00:14,  1.20s/it] 83%|████████▎ | 55/66 [01:26<00:14,  1.33s/it] 85%|████████▍ | 56/66 [01:28<00:14,  1.42s/it] 86%|████████▋ | 57/66 [01:30<00:14,  1.57s/it] 88%|████████▊ | 58/66 [01:32<00:13,  1.72s/it] 89%|████████▉ | 59/66 [01:34<00:12,  1.74s/it] 91%|█████████ | 60/66 [01:36<00:11,  1.92s/it] 92%|█████████▏| 61/66 [01:38<00:09,  1.83s/it] 94%|█████████▍| 62/66 [01:39<00:07,  1.75s/it] 95%|█████████▌| 63/66 [01:41<00:05,  1.78s/it] 97%|█████████▋| 64/66 [01:43<00:03,  1.80s/it] 98%|█████████▊| 65/66 [01:44<00:01,  1.76s/it]100%|██████████| 66/66 [01:45<00:00,  1.29s/it]100%|██████████| 66/66 [01:47<00:00,  1.63s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 61
调用obs
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:01<01:32,  1.53s/it]  3%|▎         | 2/61 [00:03<01:57,  1.99s/it]  5%|▍         | 3/61 [00:05<01:42,  1.77s/it]  7%|▋         | 4/61 [00:06<01:29,  1.56s/it]  8%|▊         | 5/61 [00:07<01:15,  1.34s/it] 10%|▉         | 6/61 [00:07<00:56,  1.03s/it] 11%|█▏        | 7/61 [00:09<01:02,  1.16s/it] 13%|█▎        | 8/61 [00:10<01:05,  1.23s/it] 15%|█▍        | 9/61 [00:11<00:55,  1.06s/it] 16%|█▋        | 10/61 [00:13<01:03,  1.25s/it] 18%|█▊        | 11/61 [00:14<01:03,  1.27s/it] 20%|█▉        | 12/61 [00:15<01:05,  1.33s/it] 21%|██▏       | 13/61 [00:16<00:54,  1.14s/it] 23%|██▎       | 14/61 [00:18<00:58,  1.24s/it] 25%|██▍       | 15/61 [00:19<01:02,  1.35s/it] 26%|██▌       | 16/61 [00:20<00:59,  1.33s/it] 28%|██▊       | 17/61 [00:22<00:57,  1.30s/it] 30%|██▉       | 18/61 [00:23<01:00,  1.40s/it] 31%|███       | 19/61 [00:25<00:58,  1.40s/it] 33%|███▎      | 20/61 [00:26<00:59,  1.45s/it] 36%|███▌      | 22/61 [00:28<00:43,  1.13s/it] 38%|███▊      | 23/61 [00:29<00:44,  1.18s/it] 39%|███▉      | 24/61 [00:30<00:43,  1.19s/it] 41%|████      | 25/61 [00:32<00:44,  1.23s/it] 43%|████▎     | 26/61 [00:33<00:44,  1.27s/it] 44%|████▍     | 27/61 [00:34<00:44,  1.30s/it] 46%|████▌     | 28/61 [00:36<00:43,  1.32s/it] 48%|████▊     | 29/61 [00:37<00:38,  1.19s/it] 49%|████▉     | 30/61 [00:38<00:36,  1.17s/it] 51%|█████     | 31/61 [00:39<00:35,  1.17s/it] 52%|█████▏    | 32/61 [00:40<00:32,  1.12s/it] 54%|█████▍    | 33/61 [00:42<00:36,  1.30s/it] 56%|█████▌    | 34/61 [00:43<00:34,  1.27s/it] 57%|█████▋    | 35/61 [00:45<00:37,  1.43s/it] 59%|█████▉    | 36/61 [00:46<00:35,  1.44s/it] 61%|██████    | 37/61 [00:47<00:31,  1.33s/it] 62%|██████▏   | 38/61 [00:48<00:28,  1.23s/it] 64%|██████▍   | 39/61 [00:50<00:30,  1.38s/it] 66%|██████▌   | 40/61 [00:51<00:29,  1.39s/it] 67%|██████▋   | 41/61 [00:53<00:28,  1.43s/it] 69%|██████▉   | 42/61 [00:55<00:29,  1.53s/it] 70%|███████   | 43/61 [00:57<00:32,  1.78s/it] 72%|███████▏  | 44/61 [00:59<00:29,  1.76s/it] 74%|███████▍  | 45/61 [01:00<00:26,  1.65s/it] 75%|███████▌  | 46/61 [01:01<00:22,  1.50s/it] 77%|███████▋  | 47/61 [01:03<00:21,  1.53s/it] 79%|███████▊  | 48/61 [01:03<00:15,  1.23s/it] 80%|████████  | 49/61 [01:05<00:14,  1.18s/it] 82%|████████▏ | 50/61 [01:07<00:15,  1.45s/it] 84%|████████▎ | 51/61 [01:07<00:11,  1.18s/it] 85%|████████▌ | 52/61 [01:09<00:11,  1.23s/it] 87%|████████▋ | 53/61 [01:10<00:10,  1.30s/it] 89%|████████▊ | 54/61 [01:11<00:08,  1.26s/it] 90%|█████████ | 55/61 [01:12<00:07,  1.27s/it] 92%|█████████▏| 56/61 [01:14<00:07,  1.40s/it] 93%|█████████▎| 57/61 [01:16<00:05,  1.44s/it] 95%|█████████▌| 58/61 [01:17<00:04,  1.45s/it] 97%|█████████▋| 59/61 [01:18<00:02,  1.23s/it] 98%|█████████▊| 60/61 [01:19<00:01,  1.27s/it]100%|██████████| 61/61 [01:20<00:00,  1.26s/it]100%|██████████| 61/61 [01:20<00:00,  1.33s/it]
有效obs数量 61
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-19/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 61 / 61
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:20<20:00, 20.01s/it] 20%|█▉        | 12/61 [00:25<01:22,  1.68s/it] 23%|██▎       | 14/61 [00:27<01:13,  1.56s/it] 28%|██▊       | 17/61 [00:29<00:56,  1.29s/it] 30%|██▉       | 18/61 [00:30<00:52,  1.23s/it] 33%|███▎      | 20/61 [00:33<00:53,  1.31s/it] 39%|███▉      | 24/61 [00:36<00:39,  1.07s/it] 43%|████▎     | 26/61 [00:38<00:37,  1.07s/it] 48%|████▊     | 29/61 [00:42<00:36,  1.14s/it] 54%|█████▍    | 33/61 [00:43<00:23,  1.22it/s] 57%|█████▋    | 35/61 [00:46<00:25,  1.03it/s] 62%|██████▏   | 38/61 [00:49<00:20,  1.11it/s] 64%|██████▍   | 39/61 [00:57<00:42,  1.95s/it] 74%|███████▍  | 45/61 [01:01<00:19,  1.20s/it] 80%|████████  | 49/61 [01:03<00:11,  1.05it/s] 82%|████████▏ | 50/61 [01:06<00:12,  1.18s/it] 89%|████████▊ | 54/61 [01:09<00:07,  1.09s/it] 93%|█████████▎| 57/61 [01:10<00:03,  1.27it/s] 95%|█████████▌| 58/61 [01:12<00:02,  1.01it/s] 97%|█████████▋| 59/61 [01:14<00:02,  1.10s/it]100%|██████████| 61/61 [01:14<00:00,  1.26it/s]100%|██████████| 61/61 [01:14<00:00,  1.22s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-21 22:06:48 
[INFO] duration: 6 min 
[2024-09-22 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-20/prod/2024-09-20_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-22 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-20/prod/2024-09-20_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-20
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-20/prod/2024-09-20_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-20/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-20/prod/2024-09-20_rule_labeled.csv.gpt_labeled.csv
raw log len: 195
时效人设任务型query 数量： 0
unique queries len: 59
调用API
  0%|          | 0/59 [00:00<?, ?it/s]  3%|▎         | 2/59 [00:01<00:49,  1.14it/s]  5%|▌         | 3/59 [00:03<01:12,  1.29s/it]  7%|▋         | 4/59 [00:05<01:22,  1.50s/it]  8%|▊         | 5/59 [00:07<01:36,  1.78s/it] 10%|█         | 6/59 [00:09<01:34,  1.78s/it] 12%|█▏        | 7/59 [00:10<01:26,  1.67s/it] 14%|█▎        | 8/59 [00:12<01:26,  1.70s/it] 15%|█▌        | 9/59 [00:14<01:21,  1.63s/it] 17%|█▋        | 10/59 [00:15<01:07,  1.38s/it] 19%|█▊        | 11/59 [00:16<01:09,  1.44s/it] 20%|██        | 12/59 [00:18<01:07,  1.44s/it] 22%|██▏       | 13/59 [00:19<01:11,  1.55s/it] 24%|██▎       | 14/59 [00:21<01:11,  1.60s/it] 25%|██▌       | 15/59 [00:21<00:52,  1.18s/it] 27%|██▋       | 16/59 [00:23<00:58,  1.36s/it] 29%|██▉       | 17/59 [00:24<00:49,  1.17s/it] 31%|███       | 18/59 [00:26<00:57,  1.41s/it] 32%|███▏      | 19/59 [00:27<00:58,  1.47s/it] 34%|███▍      | 20/59 [00:29<01:03,  1.62s/it] 36%|███▌      | 21/59 [00:31<00:59,  1.56s/it] 37%|███▋      | 22/59 [00:32<00:58,  1.59s/it] 39%|███▉      | 23/59 [00:34<00:57,  1.59s/it] 41%|████      | 24/59 [00:36<00:57,  1.63s/it] 42%|████▏     | 25/59 [00:38<01:06,  1.97s/it] 44%|████▍     | 26/59 [00:40<01:05,  1.98s/it] 46%|████▌     | 27/59 [00:42<01:01,  1.92s/it] 47%|████▋     | 28/59 [00:44<00:59,  1.92s/it] 49%|████▉     | 29/59 [00:46<00:54,  1.83s/it] 51%|█████     | 30/59 [00:47<00:43,  1.49s/it] 53%|█████▎    | 31/59 [00:48<00:42,  1.51s/it] 54%|█████▍    | 32/59 [00:50<00:43,  1.61s/it] 56%|█████▌    | 33/59 [00:52<00:44,  1.72s/it] 58%|█████▊    | 34/59 [00:54<00:42,  1.69s/it] 59%|█████▉    | 35/59 [00:54<00:33,  1.40s/it] 61%|██████    | 36/59 [00:56<00:34,  1.50s/it] 63%|██████▎   | 37/59 [00:58<00:37,  1.69s/it] 64%|██████▍   | 38/59 [01:00<00:35,  1.67s/it] 66%|██████▌   | 39/59 [01:01<00:32,  1.60s/it] 68%|██████▊   | 40/59 [01:03<00:30,  1.61s/it] 69%|██████▉   | 41/59 [01:04<00:27,  1.54s/it] 71%|███████   | 42/59 [01:06<00:27,  1.60s/it] 73%|███████▎  | 43/59 [01:06<00:18,  1.18s/it] 75%|███████▍  | 44/59 [01:08<00:20,  1.37s/it] 76%|███████▋  | 45/59 [01:10<00:20,  1.47s/it] 78%|███████▊  | 46/59 [01:12<00:21,  1.64s/it] 80%|███████▉  | 47/59 [01:13<00:19,  1.61s/it] 81%|████████▏ | 48/59 [01:15<00:17,  1.57s/it] 83%|████████▎ | 49/59 [01:16<00:15,  1.54s/it] 85%|████████▍ | 50/59 [01:18<00:14,  1.65s/it] 86%|████████▋ | 51/59 [01:20<00:13,  1.65s/it] 88%|████████▊ | 52/59 [01:21<00:11,  1.61s/it] 90%|████████▉ | 53/59 [01:23<00:09,  1.60s/it] 92%|█████████▏| 54/59 [01:25<00:08,  1.69s/it] 93%|█████████▎| 55/59 [01:26<00:06,  1.66s/it] 95%|█████████▍| 56/59 [01:28<00:05,  1.67s/it] 97%|█████████▋| 57/59 [01:29<00:03,  1.62s/it] 98%|█████████▊| 58/59 [01:32<00:01,  1.75s/it]100%|██████████| 59/59 [01:32<00:00,  1.44s/it]100%|██████████| 59/59 [01:34<00:00,  1.60s/it]
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: 'arguments'
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
有效api数量 52
调用obs
  0%|          | 0/52 [00:00<?, ?it/s]  2%|▏         | 1/52 [00:01<01:25,  1.68s/it]  4%|▍         | 2/52 [00:03<01:15,  1.51s/it]  6%|▌         | 3/52 [00:04<01:01,  1.25s/it]  8%|▊         | 4/52 [00:05<01:12,  1.52s/it] 10%|▉         | 5/52 [00:07<01:14,  1.58s/it] 12%|█▏        | 6/52 [00:09<01:14,  1.62s/it] 13%|█▎        | 7/52 [00:10<01:08,  1.52s/it] 15%|█▌        | 8/52 [00:12<01:05,  1.49s/it] 17%|█▋        | 9/52 [00:13<01:07,  1.56s/it] 19%|█▉        | 10/52 [00:14<01:00,  1.45s/it] 21%|██        | 11/52 [00:15<00:52,  1.28s/it] 23%|██▎       | 12/52 [00:17<00:54,  1.36s/it] 25%|██▌       | 13/52 [00:19<00:55,  1.43s/it] 27%|██▋       | 14/52 [00:20<00:52,  1.39s/it] 29%|██▉       | 15/52 [00:21<00:53,  1.46s/it] 31%|███       | 16/52 [00:23<00:50,  1.39s/it] 33%|███▎      | 17/52 [00:24<00:47,  1.35s/it] 35%|███▍      | 18/52 [00:26<00:48,  1.42s/it] 37%|███▋      | 19/52 [00:27<00:46,  1.41s/it] 38%|███▊      | 20/52 [00:29<00:48,  1.52s/it] 40%|████      | 21/52 [00:32<01:00,  1.96s/it] 42%|████▏     | 22/52 [00:33<00:56,  1.88s/it] 44%|████▍     | 23/52 [00:35<00:48,  1.68s/it] 46%|████▌     | 24/52 [00:36<00:44,  1.60s/it] 48%|████▊     | 25/52 [00:37<00:41,  1.52s/it] 50%|█████     | 26/52 [00:39<00:37,  1.45s/it] 52%|█████▏    | 27/52 [00:40<00:38,  1.54s/it] 54%|█████▍    | 28/52 [00:42<00:35,  1.47s/it] 56%|█████▌    | 29/52 [00:43<00:30,  1.34s/it] 58%|█████▊    | 30/52 [00:44<00:30,  1.36s/it] 60%|█████▉    | 31/52 [00:45<00:28,  1.36s/it] 62%|██████▏   | 32/52 [00:47<00:26,  1.33s/it] 63%|██████▎   | 33/52 [00:48<00:24,  1.30s/it] 65%|██████▌   | 34/52 [00:49<00:23,  1.32s/it] 67%|██████▋   | 35/52 [00:51<00:22,  1.34s/it] 69%|██████▉   | 36/52 [00:51<00:17,  1.08s/it] 71%|███████   | 37/52 [00:52<00:13,  1.13it/s] 73%|███████▎  | 38/52 [00:53<00:15,  1.10s/it] 75%|███████▌  | 39/52 [00:55<00:15,  1.16s/it] 77%|███████▋  | 40/52 [00:56<00:15,  1.28s/it] 79%|███████▉  | 41/52 [00:57<00:13,  1.26s/it] 81%|████████  | 42/52 [00:59<00:12,  1.30s/it] 83%|████████▎ | 43/52 [01:01<00:13,  1.48s/it] 85%|████████▍ | 44/52 [01:02<00:12,  1.55s/it] 87%|████████▋ | 45/52 [01:03<00:09,  1.35s/it] 88%|████████▊ | 46/52 [01:04<00:07,  1.24s/it] 90%|█████████ | 47/52 [01:05<00:05,  1.20s/it] 92%|█████████▏| 48/52 [01:07<00:05,  1.25s/it] 94%|█████████▍| 49/52 [01:08<00:03,  1.22s/it] 96%|█████████▌| 50/52 [01:09<00:02,  1.22s/it] 98%|█████████▊| 51/52 [01:10<00:01,  1.29s/it]100%|██████████| 52/52 [01:11<00:00,  1.03s/it]100%|██████████| 52/52 [01:11<00:00,  1.37s/it]
有效obs数量 52
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-20/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 52 / 52
  0%|          | 0/52 [00:00<?, ?it/s]  2%|▏         | 1/52 [00:10<08:45, 10.31s/it]  8%|▊         | 4/52 [00:10<01:41,  2.11s/it] 10%|▉         | 5/52 [00:12<01:35,  2.03s/it] 12%|█▏        | 6/52 [00:13<01:12,  1.58s/it] 13%|█▎        | 7/52 [00:16<01:39,  2.21s/it] 21%|██        | 11/52 [00:17<00:38,  1.07it/s] 25%|██▌       | 13/52 [00:22<00:55,  1.43s/it] 29%|██▉       | 15/52 [00:24<00:44,  1.20s/it] 33%|███▎      | 17/52 [00:26<00:40,  1.15s/it] 37%|███▋      | 19/52 [00:28<00:38,  1.18s/it] 42%|████▏     | 22/52 [00:32<00:37,  1.25s/it] 50%|█████     | 26/52 [00:35<00:26,  1.03s/it] 54%|█████▍    | 28/52 [00:37<00:22,  1.05it/s] 56%|█████▌    | 29/52 [00:37<00:19,  1.19it/s] 58%|█████▊    | 30/52 [00:38<00:19,  1.13it/s] 62%|██████▏   | 32/52 [00:42<00:24,  1.22s/it] 71%|███████   | 37/52 [00:42<00:09,  1.63it/s] 73%|███████▎  | 38/52 [00:43<00:08,  1.57it/s] 75%|███████▌  | 39/52 [00:44<00:08,  1.50it/s] 77%|███████▋  | 40/52 [00:45<00:09,  1.29it/s] 79%|███████▉  | 41/52 [00:46<00:08,  1.37it/s] 83%|████████▎ | 43/52 [00:48<00:08,  1.02it/s] 87%|████████▋ | 45/52 [00:50<00:06,  1.02it/s] 90%|█████████ | 47/52 [00:52<00:04,  1.11it/s] 94%|█████████▍| 49/52 [00:53<00:02,  1.17it/s]100%|██████████| 52/52 [00:54<00:00,  1.74it/s]100%|██████████| 52/52 [00:54<00:00,  1.04s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-22 22:06:02 
[INFO] duration: 6 min 
[2024-09-23 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-21/prod/2024-09-21_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-23 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-21/prod/2024-09-21_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-21
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-21/prod/2024-09-21_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-21/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-21/prod/2024-09-21_rule_labeled.csv.gpt_labeled.csv
raw log len: 106
时效人设任务型query 数量： 0
unique queries len: 26
调用API
  0%|          | 0/26 [00:00<?, ?it/s]  8%|▊         | 2/26 [00:01<00:19,  1.20it/s] 12%|█▏        | 3/26 [00:03<00:29,  1.29s/it] 15%|█▌        | 4/26 [00:05<00:31,  1.45s/it] 19%|█▉        | 5/26 [00:08<00:40,  1.93s/it] 23%|██▎       | 6/26 [00:09<00:37,  1.86s/it] 27%|██▋       | 7/26 [00:11<00:34,  1.84s/it] 31%|███       | 8/26 [00:13<00:31,  1.76s/it] 35%|███▍      | 9/26 [00:15<00:31,  1.86s/it] 38%|███▊      | 10/26 [00:17<00:29,  1.83s/it] 42%|████▏     | 11/26 [00:18<00:27,  1.85s/it] 46%|████▌     | 12/26 [00:19<00:18,  1.36s/it] 50%|█████     | 13/26 [00:21<00:19,  1.49s/it] 54%|█████▍    | 14/26 [00:22<00:19,  1.61s/it] 58%|█████▊    | 15/26 [00:26<00:23,  2.10s/it] 62%|██████▏   | 16/26 [00:27<00:20,  2.01s/it] 65%|██████▌   | 17/26 [00:29<00:18,  2.01s/it] 69%|██████▉   | 18/26 [00:31<00:15,  1.96s/it] 73%|███████▎  | 19/26 [00:33<00:13,  1.87s/it] 77%|███████▋  | 20/26 [00:35<00:11,  1.91s/it] 81%|████████  | 21/26 [00:37<00:09,  1.89s/it] 85%|████████▍ | 22/26 [00:38<00:07,  1.79s/it] 88%|████████▊ | 23/26 [00:40<00:05,  1.80s/it] 92%|█████████▏| 24/26 [00:43<00:04,  2.16s/it] 96%|█████████▌| 25/26 [00:45<00:02,  2.01s/it]100%|██████████| 26/26 [00:46<00:00,  1.88s/it]100%|██████████| 26/26 [00:47<00:00,  1.81s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 24
调用obs
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:01<00:43,  1.88s/it]  8%|▊         | 2/24 [00:04<00:46,  2.10s/it] 12%|█▎        | 3/24 [00:06<00:42,  2.02s/it] 17%|█▋        | 4/24 [00:08<00:44,  2.25s/it] 21%|██        | 5/24 [00:10<00:40,  2.12s/it] 25%|██▌       | 6/24 [00:12<00:37,  2.11s/it] 29%|██▉       | 7/24 [00:13<00:31,  1.85s/it] 33%|███▎      | 8/24 [00:16<00:32,  2.02s/it] 38%|███▊      | 9/24 [00:18<00:28,  1.91s/it] 42%|████▏     | 10/24 [00:20<00:30,  2.18s/it] 46%|████▌     | 11/24 [00:22<00:26,  2.03s/it] 50%|█████     | 12/24 [00:24<00:23,  2.00s/it] 54%|█████▍    | 13/24 [00:28<00:27,  2.49s/it] 58%|█████▊    | 14/24 [00:30<00:23,  2.37s/it] 62%|██████▎   | 15/24 [00:32<00:20,  2.26s/it] 67%|██████▋   | 16/24 [00:33<00:15,  1.97s/it] 71%|███████   | 17/24 [00:35<00:13,  1.92s/it] 75%|███████▌  | 18/24 [00:36<00:10,  1.78s/it] 79%|███████▉  | 19/24 [00:38<00:09,  1.81s/it] 83%|████████▎ | 20/24 [00:39<00:06,  1.62s/it] 88%|████████▊ | 21/24 [00:41<00:04,  1.55s/it] 92%|█████████▏| 22/24 [00:44<00:04,  2.04s/it] 96%|█████████▌| 23/24 [00:45<00:01,  1.85s/it]100%|██████████| 24/24 [00:47<00:00,  1.90s/it]100%|██████████| 24/24 [00:47<00:00,  1.99s/it]
有效obs数量 24
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-21/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 24 / 24
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:14<05:23, 14.09s/it]  8%|▊         | 2/24 [00:16<02:43,  7.43s/it] 29%|██▉       | 7/24 [00:20<00:34,  2.02s/it] 42%|████▏     | 10/24 [00:23<00:22,  1.58s/it] 50%|█████     | 12/24 [00:31<00:27,  2.25s/it] 62%|██████▎   | 15/24 [00:31<00:12,  1.43s/it] 67%|██████▋   | 16/24 [00:32<00:10,  1.35s/it] 71%|███████   | 17/24 [00:33<00:09,  1.38s/it] 75%|███████▌  | 18/24 [00:38<00:12,  2.02s/it] 79%|███████▉  | 19/24 [00:39<00:09,  1.88s/it] 88%|████████▊ | 21/24 [00:42<00:04,  1.64s/it] 96%|█████████▌| 23/24 [00:48<00:02,  2.21s/it]100%|██████████| 24/24 [00:49<00:00,  1.84s/it]100%|██████████| 24/24 [00:49<00:00,  2.05s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-23 22:04:48 
[INFO] duration: 4 min 
[2024-09-24 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-22/prod/2024-09-22_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-24 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-22/prod/2024-09-22_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-22
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-22/prod/2024-09-22_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-22/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-22/prod/2024-09-22_rule_labeled.csv.gpt_labeled.csv
raw log len: 101
时效人设任务型query 数量： 0
unique queries len: 45
调用API
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:01<00:34,  1.25it/s]  7%|▋         | 3/45 [00:03<00:46,  1.12s/it]  9%|▉         | 4/45 [00:04<00:49,  1.22s/it] 11%|█         | 5/45 [00:06<01:00,  1.50s/it] 13%|█▎        | 6/45 [00:08<01:00,  1.54s/it] 16%|█▌        | 7/45 [00:09<00:58,  1.53s/it] 18%|█▊        | 8/45 [00:11<01:01,  1.67s/it] 20%|██        | 9/45 [00:13<01:01,  1.70s/it] 22%|██▏       | 10/45 [00:15<01:01,  1.75s/it] 24%|██▍       | 11/45 [00:16<00:58,  1.71s/it] 27%|██▋       | 12/45 [00:18<00:54,  1.65s/it] 29%|██▉       | 13/45 [00:20<00:52,  1.63s/it] 31%|███       | 14/45 [00:21<00:50,  1.62s/it] 33%|███▎      | 15/45 [00:23<00:51,  1.71s/it] 36%|███▌      | 16/45 [00:24<00:47,  1.62s/it] 38%|███▊      | 17/45 [00:26<00:44,  1.58s/it] 40%|████      | 18/45 [00:29<00:52,  1.96s/it] 42%|████▏     | 19/45 [00:30<00:48,  1.87s/it] 44%|████▍     | 20/45 [00:32<00:45,  1.83s/it] 47%|████▋     | 21/45 [00:34<00:43,  1.83s/it] 49%|████▉     | 22/45 [00:36<00:43,  1.88s/it] 51%|█████     | 23/45 [00:38<00:40,  1.83s/it] 53%|█████▎    | 24/45 [00:39<00:36,  1.75s/it] 56%|█████▌    | 25/45 [00:41<00:35,  1.79s/it] 58%|█████▊    | 26/45 [00:43<00:33,  1.76s/it] 60%|██████    | 27/45 [00:44<00:30,  1.71s/it] 62%|██████▏   | 28/45 [00:46<00:28,  1.69s/it] 64%|██████▍   | 29/45 [00:48<00:26,  1.67s/it] 67%|██████▋   | 30/45 [00:50<00:25,  1.71s/it] 69%|██████▉   | 31/45 [00:51<00:23,  1.70s/it] 71%|███████   | 32/45 [00:53<00:21,  1.66s/it] 73%|███████▎  | 33/45 [00:54<00:18,  1.56s/it] 76%|███████▌  | 34/45 [00:56<00:16,  1.51s/it] 78%|███████▊  | 35/45 [00:57<00:15,  1.56s/it] 80%|████████  | 36/45 [00:59<00:14,  1.60s/it] 82%|████████▏ | 37/45 [01:00<00:12,  1.61s/it] 84%|████████▍ | 38/45 [01:02<00:11,  1.62s/it] 87%|████████▋ | 39/45 [01:04<00:09,  1.64s/it] 89%|████████▉ | 40/45 [01:06<00:08,  1.66s/it] 91%|█████████ | 41/45 [01:07<00:06,  1.71s/it] 93%|█████████▎| 42/45 [01:09<00:05,  1.68s/it] 96%|█████████▌| 43/45 [01:10<00:03,  1.61s/it] 98%|█████████▊| 44/45 [01:12<00:01,  1.61s/it]100%|██████████| 45/45 [01:14<00:00,  1.58s/it]100%|██████████| 45/45 [01:15<00:00,  1.68s/it]
有效api数量 45
调用obs
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:06,  1.51s/it]  4%|▍         | 2/45 [00:03<01:10,  1.63s/it]  7%|▋         | 3/45 [00:04<01:10,  1.67s/it]  9%|▉         | 4/45 [00:06<01:00,  1.49s/it] 11%|█         | 5/45 [00:07<00:54,  1.36s/it] 13%|█▎        | 6/45 [00:08<00:48,  1.25s/it] 16%|█▌        | 7/45 [00:09<00:49,  1.31s/it] 18%|█▊        | 8/45 [00:11<00:53,  1.45s/it] 20%|██        | 9/45 [00:13<00:53,  1.50s/it] 22%|██▏       | 10/45 [00:14<00:51,  1.47s/it] 24%|██▍       | 11/45 [00:15<00:49,  1.46s/it] 27%|██▋       | 12/45 [00:17<00:49,  1.50s/it] 29%|██▉       | 13/45 [00:18<00:43,  1.37s/it] 31%|███       | 14/45 [00:20<00:43,  1.41s/it] 33%|███▎      | 15/45 [00:21<00:42,  1.43s/it] 36%|███▌      | 16/45 [00:23<00:45,  1.56s/it] 38%|███▊      | 17/45 [00:25<00:48,  1.74s/it] 40%|████      | 18/45 [00:27<00:45,  1.68s/it] 42%|████▏     | 19/45 [00:28<00:44,  1.70s/it] 44%|████▍     | 20/45 [00:30<00:41,  1.66s/it] 47%|████▋     | 21/45 [00:31<00:39,  1.63s/it] 49%|████▉     | 22/45 [00:33<00:34,  1.49s/it] 51%|█████     | 23/45 [00:34<00:32,  1.47s/it] 53%|█████▎    | 24/45 [00:35<00:29,  1.42s/it] 56%|█████▌    | 25/45 [00:37<00:29,  1.46s/it] 58%|█████▊    | 26/45 [00:38<00:27,  1.46s/it] 60%|██████    | 27/45 [00:40<00:25,  1.44s/it] 62%|██████▏   | 28/45 [00:41<00:23,  1.38s/it] 64%|██████▍   | 29/45 [00:42<00:22,  1.40s/it] 67%|██████▋   | 30/45 [00:44<00:21,  1.43s/it] 69%|██████▉   | 31/45 [00:46<00:20,  1.47s/it] 71%|███████   | 32/45 [00:47<00:18,  1.46s/it] 73%|███████▎  | 33/45 [00:48<00:17,  1.45s/it] 76%|███████▌  | 34/45 [00:50<00:16,  1.47s/it] 78%|███████▊  | 35/45 [00:51<00:14,  1.41s/it] 80%|████████  | 36/45 [00:53<00:12,  1.42s/it] 82%|████████▏ | 37/45 [00:54<00:11,  1.39s/it] 84%|████████▍ | 38/45 [00:55<00:09,  1.41s/it] 87%|████████▋ | 39/45 [00:57<00:08,  1.44s/it] 89%|████████▉ | 40/45 [00:58<00:07,  1.42s/it] 91%|█████████ | 41/45 [01:00<00:05,  1.36s/it] 93%|█████████▎| 42/45 [01:01<00:04,  1.43s/it] 96%|█████████▌| 43/45 [01:02<00:02,  1.40s/it] 98%|█████████▊| 44/45 [01:04<00:01,  1.41s/it]100%|██████████| 45/45 [01:05<00:00,  1.35s/it]100%|██████████| 45/45 [01:05<00:00,  1.46s/it]
有效obs数量 45
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-22/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 45 / 45
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:05<03:47,  5.17s/it]  9%|▉         | 4/45 [00:06<00:56,  1.38s/it] 13%|█▎        | 6/45 [00:08<00:43,  1.13s/it] 16%|█▌        | 7/45 [00:09<00:44,  1.16s/it] 18%|█▊        | 8/45 [00:10<00:37,  1.02s/it] 20%|██        | 9/45 [00:10<00:35,  1.02it/s] 22%|██▏       | 10/45 [00:13<00:50,  1.43s/it] 24%|██▍       | 11/45 [00:15<00:54,  1.61s/it] 31%|███       | 14/45 [00:18<00:39,  1.26s/it] 33%|███▎      | 15/45 [00:19<00:35,  1.19s/it] 36%|███▌      | 16/45 [00:21<00:36,  1.26s/it] 40%|████      | 18/45 [00:25<00:42,  1.56s/it] 49%|████▉     | 22/45 [00:25<00:18,  1.26it/s] 51%|█████     | 23/45 [00:28<00:25,  1.14s/it] 53%|█████▎    | 24/45 [00:33<00:39,  1.88s/it] 64%|██████▍   | 29/45 [00:34<00:14,  1.09it/s] 69%|██████▉   | 31/45 [00:35<00:11,  1.18it/s] 73%|███████▎  | 33/45 [00:36<00:08,  1.44it/s] 76%|███████▌  | 34/45 [00:38<00:09,  1.18it/s] 78%|███████▊  | 35/45 [00:39<00:10,  1.02s/it] 82%|████████▏ | 37/45 [00:39<00:05,  1.42it/s] 84%|████████▍ | 38/45 [00:40<00:05,  1.32it/s] 87%|████████▋ | 39/45 [00:41<00:03,  1.60it/s] 89%|████████▉ | 40/45 [00:43<00:05,  1.00s/it] 93%|█████████▎| 42/45 [00:45<00:02,  1.04it/s] 98%|█████████▊| 44/45 [00:46<00:00,  1.13it/s]100%|██████████| 45/45 [00:46<00:00,  1.04s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-24 22:05:35 
[INFO] duration: 5 min 
[2024-09-25 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-23/prod/2024-09-23_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-25 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-23/prod/2024-09-23_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-23
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-23/prod/2024-09-23_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-23/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-23/prod/2024-09-23_rule_labeled.csv.gpt_labeled.csv
raw log len: 555
时效人设任务型query 数量： 3
unique queries len: 184
调用API
  0%|          | 0/184 [00:00<?, ?it/s]  1%|          | 2/184 [00:01<02:33,  1.19it/s]  2%|▏         | 3/184 [00:03<03:29,  1.16s/it]  2%|▏         | 4/184 [00:04<03:51,  1.29s/it]  3%|▎         | 5/184 [00:06<04:12,  1.41s/it]  3%|▎         | 6/184 [00:08<05:01,  1.69s/it]  4%|▍         | 7/184 [00:10<05:14,  1.78s/it]  4%|▍         | 8/184 [00:12<05:06,  1.74s/it]  5%|▍         | 9/184 [00:13<04:58,  1.70s/it]  5%|▌         | 10/184 [00:14<03:43,  1.28s/it]  6%|▌         | 11/184 [00:15<04:02,  1.40s/it]  7%|▋         | 12/184 [00:17<04:14,  1.48s/it]  7%|▋         | 13/184 [00:19<04:27,  1.56s/it]  8%|▊         | 14/184 [00:20<04:22,  1.54s/it]  8%|▊         | 15/184 [00:22<04:13,  1.50s/it]  9%|▊         | 16/184 [00:24<04:25,  1.58s/it]  9%|▉         | 17/184 [00:25<04:32,  1.63s/it] 10%|▉         | 18/184 [00:27<04:21,  1.57s/it] 10%|█         | 19/184 [00:29<04:59,  1.82s/it] 11%|█         | 20/184 [00:31<05:14,  1.92s/it] 11%|█▏        | 21/184 [00:33<04:59,  1.84s/it] 12%|█▏        | 22/184 [00:35<05:09,  1.91s/it] 12%|█▎        | 23/184 [00:37<04:51,  1.81s/it] 13%|█▎        | 24/184 [00:38<04:48,  1.81s/it] 14%|█▎        | 25/184 [00:40<04:52,  1.84s/it] 14%|█▍        | 26/184 [00:43<05:12,  1.98s/it] 15%|█▍        | 27/184 [00:44<04:55,  1.88s/it] 15%|█▌        | 28/184 [00:46<04:32,  1.75s/it] 16%|█▌        | 29/184 [00:47<04:27,  1.73s/it] 16%|█▋        | 30/184 [00:49<04:29,  1.75s/it] 17%|█▋        | 31/184 [00:51<04:29,  1.76s/it] 17%|█▋        | 32/184 [00:51<03:17,  1.30s/it] 18%|█▊        | 33/184 [00:53<03:50,  1.53s/it] 18%|█▊        | 34/184 [00:55<03:49,  1.53s/it] 19%|█▉        | 35/184 [00:56<03:55,  1.58s/it] 20%|█▉        | 36/184 [00:58<04:09,  1.68s/it] 20%|██        | 37/184 [01:00<04:12,  1.72s/it] 21%|██        | 38/184 [01:02<04:04,  1.68s/it] 21%|██        | 39/184 [01:04<04:24,  1.82s/it] 22%|██▏       | 40/184 [01:06<04:20,  1.81s/it] 22%|██▏       | 41/184 [01:07<04:07,  1.73s/it] 23%|██▎       | 42/184 [01:09<03:56,  1.67s/it] 23%|██▎       | 43/184 [01:10<03:54,  1.66s/it] 24%|██▍       | 44/184 [01:12<03:51,  1.66s/it] 24%|██▍       | 45/184 [01:16<05:21,  2.32s/it] 25%|██▌       | 46/184 [01:17<04:47,  2.08s/it] 26%|██▌       | 47/184 [01:19<04:21,  1.91s/it] 26%|██▌       | 48/184 [01:20<03:59,  1.76s/it] 27%|██▋       | 49/184 [01:22<04:01,  1.79s/it] 27%|██▋       | 50/184 [01:24<04:04,  1.83s/it] 28%|██▊       | 51/184 [01:26<03:55,  1.77s/it] 28%|██▊       | 52/184 [01:27<03:43,  1.69s/it] 29%|██▉       | 53/184 [01:29<03:38,  1.67s/it] 29%|██▉       | 54/184 [01:31<03:40,  1.69s/it] 30%|██▉       | 55/184 [01:32<03:36,  1.68s/it] 30%|███       | 56/184 [01:34<03:30,  1.64s/it] 31%|███       | 57/184 [01:36<03:40,  1.74s/it] 32%|███▏      | 58/184 [01:37<03:27,  1.64s/it] 32%|███▏      | 59/184 [01:39<03:18,  1.59s/it] 33%|███▎      | 60/184 [01:40<03:16,  1.58s/it] 33%|███▎      | 61/184 [01:42<03:17,  1.60s/it] 34%|███▎      | 62/184 [01:44<03:27,  1.70s/it] 34%|███▍      | 63/184 [01:45<03:15,  1.62s/it] 35%|███▍      | 64/184 [01:47<03:14,  1.62s/it] 35%|███▌      | 65/184 [01:49<03:18,  1.67s/it] 36%|███▌      | 66/184 [01:50<03:11,  1.62s/it] 36%|███▋      | 67/184 [01:52<03:07,  1.61s/it] 37%|███▋      | 68/184 [01:53<03:03,  1.59s/it] 38%|███▊      | 69/184 [01:53<02:15,  1.18s/it] 38%|███▊      | 70/184 [01:55<02:26,  1.29s/it] 39%|███▊      | 71/184 [01:57<02:41,  1.43s/it] 39%|███▉      | 72/184 [01:58<02:41,  1.44s/it] 40%|███▉      | 73/184 [02:00<02:56,  1.59s/it] 40%|████      | 74/184 [02:02<02:53,  1.57s/it] 41%|████      | 75/184 [02:03<02:51,  1.57s/it] 41%|████▏     | 76/184 [02:05<02:53,  1.60s/it] 42%|████▏     | 77/184 [02:07<02:51,  1.60s/it] 42%|████▏     | 78/184 [02:08<02:47,  1.58s/it] 43%|████▎     | 79/184 [02:10<02:50,  1.62s/it] 43%|████▎     | 80/184 [02:12<03:04,  1.77s/it] 44%|████▍     | 81/184 [02:14<03:11,  1.86s/it] 45%|████▍     | 82/184 [02:16<03:04,  1.81s/it] 45%|████▌     | 83/184 [02:17<02:53,  1.72s/it] 46%|████▌     | 84/184 [02:17<02:06,  1.26s/it] 46%|████▌     | 85/184 [02:19<02:21,  1.42s/it] 47%|████▋     | 86/184 [02:21<02:21,  1.45s/it] 47%|████▋     | 87/184 [02:22<02:21,  1.46s/it] 48%|████▊     | 88/184 [02:24<02:22,  1.49s/it] 48%|████▊     | 89/184 [02:25<02:22,  1.51s/it] 49%|████▉     | 90/184 [02:27<02:22,  1.52s/it] 49%|████▉     | 91/184 [02:29<02:25,  1.56s/it] 50%|█████     | 92/184 [02:30<02:23,  1.55s/it] 51%|█████     | 93/184 [02:30<01:44,  1.15s/it] 51%|█████     | 94/184 [02:32<01:52,  1.25s/it] 52%|█████▏    | 95/184 [02:34<02:06,  1.42s/it] 52%|█████▏    | 96/184 [02:35<02:11,  1.50s/it] 53%|█████▎    | 97/184 [02:37<02:15,  1.56s/it] 53%|█████▎    | 98/184 [02:39<02:17,  1.60s/it] 54%|█████▍    | 99/184 [02:40<02:14,  1.58s/it] 54%|█████▍    | 100/184 [02:42<02:25,  1.73s/it] 55%|█████▍    | 101/184 [02:45<02:45,  2.00s/it] 55%|█████▌    | 102/184 [02:47<02:35,  1.90s/it] 56%|█████▌    | 103/184 [02:48<02:30,  1.86s/it] 57%|█████▋    | 104/184 [02:50<02:29,  1.86s/it] 57%|█████▋    | 105/184 [02:52<02:17,  1.74s/it] 58%|█████▊    | 106/184 [02:53<02:13,  1.71s/it] 58%|█████▊    | 107/184 [02:55<02:05,  1.63s/it] 59%|█████▊    | 108/184 [02:56<02:00,  1.59s/it] 59%|█████▉    | 109/184 [02:58<02:04,  1.66s/it] 60%|█████▉    | 110/184 [03:00<02:03,  1.67s/it] 60%|██████    | 111/184 [03:01<01:58,  1.62s/it] 61%|██████    | 112/184 [03:03<02:08,  1.79s/it] 61%|██████▏   | 113/184 [03:05<02:04,  1.75s/it] 62%|██████▏   | 114/184 [03:07<02:01,  1.74s/it] 62%|██████▎   | 115/184 [03:10<02:24,  2.10s/it] 63%|██████▎   | 116/184 [03:12<02:18,  2.04s/it] 64%|██████▎   | 117/184 [03:13<02:07,  1.90s/it] 64%|██████▍   | 118/184 [03:15<02:05,  1.91s/it] 65%|██████▍   | 119/184 [03:18<02:17,  2.12s/it] 65%|██████▌   | 120/184 [03:19<02:04,  1.94s/it] 66%|██████▌   | 121/184 [03:21<01:50,  1.75s/it] 66%|██████▋   | 122/184 [03:22<01:47,  1.74s/it] 67%|██████▋   | 123/184 [03:25<02:02,  2.01s/it] 67%|██████▋   | 124/184 [03:26<01:51,  1.86s/it] 68%|██████▊   | 125/184 [03:28<01:46,  1.81s/it] 68%|██████▊   | 126/184 [03:30<01:39,  1.71s/it] 69%|██████▉   | 127/184 [03:31<01:34,  1.66s/it] 70%|██████▉   | 128/184 [03:33<01:31,  1.64s/it] 70%|███████   | 129/184 [03:34<01:31,  1.66s/it] 71%|███████   | 130/184 [03:36<01:33,  1.74s/it] 71%|███████   | 131/184 [03:38<01:34,  1.79s/it] 72%|███████▏  | 132/184 [03:40<01:29,  1.72s/it] 72%|███████▏  | 133/184 [03:41<01:25,  1.68s/it] 73%|███████▎  | 134/184 [03:43<01:23,  1.66s/it] 73%|███████▎  | 135/184 [03:46<01:37,  1.99s/it] 74%|███████▍  | 136/184 [03:48<01:32,  1.93s/it] 74%|███████▍  | 137/184 [03:49<01:24,  1.81s/it] 75%|███████▌  | 138/184 [03:51<01:20,  1.74s/it] 76%|███████▌  | 139/184 [03:53<01:22,  1.83s/it] 76%|███████▌  | 140/184 [03:54<01:16,  1.75s/it] 77%|███████▋  | 141/184 [03:56<01:15,  1.75s/it] 77%|███████▋  | 142/184 [03:58<01:10,  1.68s/it] 78%|███████▊  | 143/184 [03:59<01:10,  1.71s/it] 78%|███████▊  | 144/184 [04:01<01:06,  1.67s/it] 79%|███████▉  | 145/184 [04:03<01:05,  1.67s/it] 79%|███████▉  | 146/184 [04:05<01:14,  1.96s/it] 80%|███████▉  | 147/184 [04:08<01:21,  2.19s/it] 80%|████████  | 148/184 [04:10<01:14,  2.06s/it] 81%|████████  | 149/184 [04:12<01:17,  2.23s/it] 82%|████████▏ | 150/184 [04:14<01:08,  2.01s/it] 82%|████████▏ | 151/184 [04:16<01:04,  1.97s/it] 83%|████████▎ | 152/184 [04:17<01:00,  1.88s/it] 83%|████████▎ | 153/184 [04:19<00:54,  1.76s/it] 84%|████████▎ | 154/184 [04:20<00:50,  1.69s/it] 84%|████████▍ | 155/184 [04:22<00:47,  1.64s/it] 85%|████████▍ | 156/184 [04:24<00:47,  1.70s/it] 85%|████████▌ | 157/184 [04:25<00:43,  1.63s/it] 86%|████████▌ | 158/184 [04:27<00:40,  1.57s/it] 86%|████████▋ | 159/184 [04:27<00:29,  1.16s/it] 87%|████████▋ | 160/184 [04:28<00:30,  1.26s/it] 88%|████████▊ | 161/184 [04:30<00:30,  1.33s/it] 88%|████████▊ | 162/184 [04:30<00:21,  1.00it/s] 89%|████████▊ | 163/184 [04:32<00:26,  1.25s/it] 89%|████████▉ | 164/184 [04:33<00:25,  1.28s/it] 90%|████████▉ | 165/184 [04:35<00:28,  1.47s/it] 90%|█████████ | 166/184 [04:37<00:28,  1.57s/it] 91%|█████████ | 167/184 [04:39<00:29,  1.71s/it] 91%|█████████▏| 168/184 [04:41<00:26,  1.68s/it] 92%|█████████▏| 169/184 [04:43<00:27,  1.83s/it] 92%|█████████▏| 170/184 [04:45<00:25,  1.85s/it] 93%|█████████▎| 171/184 [04:46<00:23,  1.78s/it] 93%|█████████▎| 172/184 [04:48<00:22,  1.90s/it] 94%|█████████▍| 173/184 [04:50<00:20,  1.86s/it] 95%|█████████▍| 174/184 [04:52<00:18,  1.88s/it] 95%|█████████▌| 175/184 [04:54<00:16,  1.82s/it] 96%|█████████▌| 176/184 [04:56<00:14,  1.81s/it] 96%|█████████▌| 177/184 [04:58<00:13,  1.88s/it] 97%|█████████▋| 178/184 [05:00<00:11,  1.86s/it] 97%|█████████▋| 179/184 [05:01<00:08,  1.79s/it] 98%|█████████▊| 180/184 [05:03<00:07,  1.85s/it] 98%|█████████▊| 181/184 [05:05<00:05,  1.87s/it] 99%|█████████▉| 182/184 [05:06<00:03,  1.74s/it] 99%|█████████▉| 183/184 [05:08<00:01,  1.66s/it]100%|██████████| 184/184 [05:09<00:00,  1.60s/it]100%|██████████| 184/184 [05:11<00:00,  1.69s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 177
调用obs
  0%|          | 0/177 [00:00<?, ?it/s]  1%|          | 1/177 [00:01<04:49,  1.64s/it]  1%|          | 2/177 [00:03<04:26,  1.53s/it]  2%|▏         | 3/177 [00:05<05:37,  1.94s/it]  2%|▏         | 4/177 [00:06<04:46,  1.66s/it]  3%|▎         | 5/177 [00:08<04:22,  1.53s/it]  3%|▎         | 6/177 [00:10<04:47,  1.68s/it]  4%|▍         | 7/177 [00:11<04:33,  1.61s/it]  5%|▍         | 8/177 [00:13<04:43,  1.68s/it]  5%|▌         | 9/177 [00:14<04:21,  1.56s/it]  6%|▌         | 10/177 [00:17<05:18,  1.91s/it]  6%|▌         | 11/177 [00:18<04:56,  1.79s/it]  7%|▋         | 12/177 [00:20<04:40,  1.70s/it]  7%|▋         | 13/177 [00:22<04:39,  1.71s/it]  8%|▊         | 14/177 [00:23<04:09,  1.53s/it]  8%|▊         | 15/177 [00:24<04:03,  1.50s/it]  9%|▉         | 16/177 [00:26<04:01,  1.50s/it] 10%|▉         | 17/177 [00:27<03:40,  1.38s/it] 10%|█         | 18/177 [00:28<03:44,  1.41s/it] 11%|█         | 19/177 [00:30<03:50,  1.46s/it] 11%|█▏        | 20/177 [00:31<03:17,  1.26s/it] 12%|█▏        | 21/177 [00:32<03:29,  1.34s/it] 12%|█▏        | 22/177 [00:33<03:24,  1.32s/it] 13%|█▎        | 23/177 [00:36<04:25,  1.72s/it] 14%|█▎        | 24/177 [00:37<04:13,  1.66s/it] 14%|█▍        | 25/177 [00:39<03:53,  1.54s/it] 15%|█▍        | 26/177 [00:40<03:44,  1.49s/it] 15%|█▌        | 27/177 [00:41<03:29,  1.40s/it] 16%|█▌        | 28/177 [00:43<03:40,  1.48s/it] 16%|█▋        | 29/177 [00:44<03:33,  1.44s/it] 17%|█▋        | 30/177 [00:46<03:30,  1.43s/it] 18%|█▊        | 31/177 [00:47<03:07,  1.29s/it] 18%|█▊        | 32/177 [00:48<03:13,  1.33s/it] 19%|█▊        | 33/177 [00:50<03:20,  1.39s/it] 19%|█▉        | 34/177 [00:52<03:38,  1.53s/it] 20%|█▉        | 35/177 [00:53<03:27,  1.46s/it] 20%|██        | 36/177 [00:55<03:48,  1.62s/it] 21%|██        | 37/177 [00:56<03:36,  1.55s/it] 21%|██▏       | 38/177 [00:57<03:15,  1.40s/it] 22%|██▏       | 39/177 [00:58<02:41,  1.17s/it] 23%|██▎       | 40/177 [00:59<02:48,  1.23s/it] 23%|██▎       | 41/177 [01:01<02:58,  1.31s/it] 24%|██▎       | 42/177 [01:05<05:11,  2.31s/it] 24%|██▍       | 43/177 [01:07<04:39,  2.08s/it] 25%|██▍       | 44/177 [01:09<04:42,  2.12s/it] 25%|██▌       | 45/177 [01:10<03:50,  1.75s/it] 26%|██▌       | 46/177 [01:12<03:46,  1.73s/it] 27%|██▋       | 47/177 [01:12<03:03,  1.41s/it] 27%|██▋       | 48/177 [01:14<03:02,  1.42s/it] 28%|██▊       | 49/177 [01:15<03:05,  1.45s/it] 28%|██▊       | 50/177 [01:17<03:01,  1.43s/it] 29%|██▉       | 51/177 [01:18<03:02,  1.45s/it] 29%|██▉       | 52/177 [01:20<03:06,  1.49s/it] 30%|██▉       | 53/177 [01:21<03:05,  1.49s/it] 31%|███       | 54/177 [01:23<03:04,  1.50s/it] 31%|███       | 55/177 [01:24<02:55,  1.44s/it] 32%|███▏      | 56/177 [01:25<02:51,  1.42s/it] 32%|███▏      | 57/177 [01:26<02:31,  1.26s/it] 33%|███▎      | 58/177 [01:28<02:37,  1.32s/it] 33%|███▎      | 59/177 [01:29<02:14,  1.14s/it] 34%|███▍      | 60/177 [01:30<02:27,  1.26s/it] 34%|███▍      | 61/177 [01:32<02:37,  1.36s/it] 35%|███▌      | 62/177 [01:33<02:26,  1.27s/it] 36%|███▌      | 63/177 [01:34<02:30,  1.32s/it] 36%|███▌      | 64/177 [01:36<02:37,  1.39s/it] 37%|███▋      | 65/177 [01:37<02:18,  1.24s/it] 37%|███▋      | 66/177 [01:38<02:28,  1.34s/it] 38%|███▊      | 67/177 [01:40<02:33,  1.39s/it] 38%|███▊      | 68/177 [01:41<02:32,  1.40s/it] 39%|███▉      | 69/177 [01:44<03:04,  1.71s/it] 40%|████      | 71/177 [01:45<02:17,  1.30s/it] 41%|████      | 72/177 [01:47<02:23,  1.37s/it] 41%|████      | 73/177 [01:48<02:24,  1.39s/it] 42%|████▏     | 74/177 [01:50<02:26,  1.42s/it] 42%|████▏     | 75/177 [01:51<02:27,  1.44s/it] 43%|████▎     | 76/177 [01:53<02:27,  1.46s/it] 44%|████▎     | 77/177 [01:54<02:14,  1.35s/it] 44%|████▍     | 78/177 [01:56<02:34,  1.56s/it] 45%|████▍     | 79/177 [01:57<02:26,  1.49s/it] 45%|████▌     | 80/177 [01:58<02:03,  1.27s/it] 46%|████▌     | 81/177 [01:59<02:02,  1.28s/it] 46%|████▋     | 82/177 [02:01<02:05,  1.32s/it] 47%|████▋     | 83/177 [02:02<02:02,  1.30s/it] 47%|████▋     | 84/177 [02:04<02:18,  1.49s/it] 48%|████▊     | 85/177 [02:05<02:03,  1.34s/it] 49%|████▊     | 86/177 [02:06<02:08,  1.41s/it] 49%|████▉     | 87/177 [02:08<02:09,  1.44s/it] 50%|████▉     | 88/177 [02:09<02:09,  1.45s/it] 50%|█████     | 89/177 [02:11<02:14,  1.53s/it] 51%|█████     | 90/177 [02:12<01:44,  1.20s/it] 51%|█████▏    | 91/177 [02:13<01:52,  1.31s/it] 52%|█████▏    | 92/177 [02:15<01:53,  1.34s/it] 53%|█████▎    | 93/177 [02:16<01:55,  1.38s/it] 53%|█████▎    | 94/177 [02:17<01:52,  1.36s/it] 54%|█████▎    | 95/177 [02:20<02:20,  1.71s/it] 54%|█████▍    | 96/177 [02:21<02:03,  1.52s/it] 55%|█████▍    | 97/177 [02:22<02:01,  1.52s/it] 55%|█████▌    | 98/177 [02:24<01:54,  1.45s/it] 56%|█████▌    | 99/177 [02:25<01:56,  1.50s/it] 56%|█████▋    | 100/177 [02:26<01:47,  1.39s/it] 57%|█████▋    | 101/177 [02:28<01:48,  1.42s/it] 58%|█████▊    | 102/177 [02:29<01:46,  1.42s/it] 58%|█████▊    | 103/177 [02:31<01:44,  1.42s/it] 59%|█████▉    | 104/177 [02:32<01:47,  1.47s/it] 59%|█████▉    | 105/177 [02:34<01:49,  1.52s/it] 60%|█████▉    | 106/177 [02:36<02:06,  1.78s/it] 60%|██████    | 107/177 [02:38<01:59,  1.70s/it] 61%|██████    | 108/177 [02:39<01:49,  1.59s/it] 62%|██████▏   | 109/177 [02:42<02:18,  2.04s/it] 62%|██████▏   | 110/177 [02:43<01:50,  1.64s/it] 63%|██████▎   | 111/177 [02:45<01:45,  1.60s/it] 63%|██████▎   | 112/177 [02:46<01:45,  1.62s/it] 64%|██████▍   | 113/177 [02:49<02:07,  2.00s/it] 64%|██████▍   | 114/177 [02:50<01:52,  1.78s/it] 65%|██████▍   | 115/177 [02:52<01:46,  1.72s/it] 66%|██████▌   | 116/177 [02:54<01:41,  1.67s/it] 66%|██████▌   | 117/177 [02:56<01:57,  1.96s/it] 67%|██████▋   | 118/177 [02:58<01:47,  1.83s/it] 67%|██████▋   | 119/177 [02:59<01:30,  1.56s/it] 68%|██████▊   | 120/177 [03:00<01:27,  1.53s/it] 68%|██████▊   | 121/177 [03:02<01:25,  1.52s/it] 69%|██████▉   | 122/177 [03:03<01:24,  1.54s/it] 69%|██████▉   | 123/177 [03:05<01:24,  1.56s/it] 70%|███████   | 124/177 [03:06<01:21,  1.54s/it] 71%|███████   | 125/177 [03:08<01:17,  1.50s/it] 71%|███████   | 126/177 [03:09<01:15,  1.48s/it] 72%|███████▏  | 127/177 [03:11<01:13,  1.47s/it] 72%|███████▏  | 128/177 [03:12<01:12,  1.48s/it] 73%|███████▎  | 129/177 [03:15<01:28,  1.83s/it] 73%|███████▎  | 130/177 [03:16<01:19,  1.68s/it] 74%|███████▍  | 131/177 [03:18<01:16,  1.66s/it] 75%|███████▍  | 132/177 [03:19<01:10,  1.57s/it] 75%|███████▌  | 133/177 [03:21<01:09,  1.58s/it] 76%|███████▌  | 134/177 [03:22<00:59,  1.39s/it] 76%|███████▋  | 135/177 [03:22<00:50,  1.21s/it] 77%|███████▋  | 136/177 [03:23<00:45,  1.12s/it] 77%|███████▋  | 137/177 [03:25<00:49,  1.25s/it] 78%|███████▊  | 138/177 [03:26<00:49,  1.26s/it] 79%|███████▊  | 139/177 [03:27<00:47,  1.25s/it] 79%|███████▉  | 140/177 [03:29<00:48,  1.32s/it] 80%|███████▉  | 141/177 [03:32<01:03,  1.76s/it] 80%|████████  | 142/177 [03:33<00:59,  1.71s/it] 81%|████████  | 143/177 [03:37<01:22,  2.42s/it] 81%|████████▏ | 144/177 [03:39<01:09,  2.12s/it] 82%|████████▏ | 145/177 [03:40<01:00,  1.91s/it] 82%|████████▏ | 146/177 [03:42<00:54,  1.76s/it] 83%|████████▎ | 147/177 [03:43<00:51,  1.71s/it] 84%|████████▎ | 148/177 [03:45<00:48,  1.68s/it] 84%|████████▍ | 149/177 [03:46<00:45,  1.63s/it] 85%|████████▍ | 150/177 [03:48<00:44,  1.64s/it] 85%|████████▌ | 151/177 [03:50<00:43,  1.66s/it] 86%|████████▌ | 152/177 [03:50<00:34,  1.39s/it] 86%|████████▋ | 153/177 [03:52<00:33,  1.38s/it] 87%|████████▋ | 154/177 [03:53<00:31,  1.36s/it] 88%|████████▊ | 155/177 [03:54<00:28,  1.31s/it] 88%|████████▊ | 156/177 [03:55<00:24,  1.19s/it] 89%|████████▊ | 157/177 [03:57<00:27,  1.39s/it] 89%|████████▉ | 158/177 [03:58<00:24,  1.27s/it] 90%|████████▉ | 159/177 [03:59<00:22,  1.24s/it] 90%|█████████ | 160/177 [04:01<00:22,  1.33s/it] 91%|█████████ | 161/177 [04:02<00:20,  1.25s/it] 92%|█████████▏| 162/177 [04:03<00:19,  1.29s/it] 92%|█████████▏| 163/177 [04:04<00:17,  1.23s/it] 93%|█████████▎| 164/177 [04:06<00:17,  1.36s/it] 93%|█████████▎| 165/177 [04:07<00:14,  1.17s/it] 94%|█████████▍| 166/177 [04:08<00:13,  1.24s/it] 94%|█████████▍| 167/177 [04:09<00:10,  1.07s/it] 95%|█████████▍| 168/177 [04:10<00:09,  1.11s/it] 95%|█████████▌| 169/177 [04:11<00:09,  1.19s/it] 96%|█████████▌| 170/177 [04:13<00:08,  1.21s/it] 97%|█████████▋| 171/177 [04:14<00:07,  1.32s/it] 97%|█████████▋| 172/177 [04:16<00:07,  1.45s/it] 98%|█████████▊| 173/177 [04:17<00:05,  1.41s/it] 98%|█████████▊| 174/177 [04:19<00:04,  1.39s/it] 99%|█████████▉| 175/177 [04:20<00:02,  1.29s/it] 99%|█████████▉| 176/177 [04:21<00:01,  1.44s/it]100%|██████████| 177/177 [04:22<00:00,  1.23s/it]100%|██████████| 177/177 [04:22<00:00,  1.48s/it]
有效obs数量 177
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-23/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 177 / 177
  0%|          | 0/177 [00:00<?, ?it/s]  1%|          | 1/177 [00:07<20:44,  7.07s/it]  1%|          | 2/177 [00:07<09:47,  3.36s/it]  2%|▏         | 4/177 [00:09<05:16,  1.83s/it]  3%|▎         | 6/177 [00:12<04:20,  1.52s/it]  4%|▍         | 7/177 [00:12<03:20,  1.18s/it]  5%|▍         | 8/177 [00:13<03:30,  1.25s/it]  5%|▌         | 9/177 [00:14<03:09,  1.13s/it]  6%|▌         | 10/177 [00:17<04:16,  1.53s/it]  7%|▋         | 13/177 [00:19<03:12,  1.17s/it]  8%|▊         | 15/177 [00:20<02:40,  1.01it/s]  9%|▉         | 16/177 [00:21<02:26,  1.10it/s] 10%|▉         | 17/177 [00:24<03:48,  1.43s/it] 10%|█         | 18/177 [00:26<04:14,  1.60s/it] 12%|█▏        | 22/177 [00:28<02:29,  1.04it/s] 13%|█▎        | 23/177 [00:30<02:56,  1.14s/it] 15%|█▍        | 26/177 [00:35<03:12,  1.28s/it] 16%|█▌        | 28/177 [00:37<02:55,  1.18s/it] 16%|█▋        | 29/177 [00:41<04:06,  1.67s/it] 19%|█▉        | 34/177 [00:43<02:18,  1.04it/s] 20%|█▉        | 35/177 [00:45<02:51,  1.21s/it] 22%|██▏       | 39/177 [00:48<02:13,  1.03it/s] 23%|██▎       | 40/177 [00:55<04:08,  1.81s/it] 23%|██▎       | 41/177 [00:58<04:21,  1.92s/it] 25%|██▍       | 44/177 [00:59<02:50,  1.28s/it] 27%|██▋       | 47/177 [01:03<02:50,  1.31s/it] 28%|██▊       | 49/177 [01:05<02:33,  1.20s/it] 29%|██▉       | 51/177 [01:05<02:04,  1.02it/s] 29%|██▉       | 52/177 [01:09<02:47,  1.34s/it] 31%|███       | 54/177 [01:14<03:37,  1.77s/it] 33%|███▎      | 59/177 [01:18<02:25,  1.23s/it] 35%|███▌      | 62/177 [01:18<01:44,  1.10it/s] 36%|███▌      | 63/177 [01:20<01:48,  1.05it/s] 36%|███▌      | 64/177 [01:23<02:36,  1.38s/it] 37%|███▋      | 65/177 [01:32<05:07,  2.74s/it] 41%|████      | 72/177 [01:42<03:18,  1.89s/it] 45%|████▌     | 80/177 [01:45<01:43,  1.07s/it] 46%|████▋     | 82/177 [01:47<01:46,  1.13s/it] 47%|████▋     | 84/177 [01:50<01:44,  1.12s/it] 49%|████▉     | 87/177 [01:51<01:28,  1.02it/s] 50%|████▉     | 88/177 [01:52<01:25,  1.05it/s] 50%|█████     | 89/177 [01:53<01:17,  1.14it/s] 51%|█████     | 90/177 [01:53<01:08,  1.27it/s] 51%|█████▏    | 91/177 [02:03<03:40,  2.56s/it] 55%|█████▍    | 97/177 [02:03<01:21,  1.02s/it] 55%|█████▌    | 98/177 [02:09<02:05,  1.59s/it] 56%|█████▋    | 100/177 [02:09<01:32,  1.20s/it] 58%|█████▊    | 103/177 [02:10<01:06,  1.10it/s] 59%|█████▉    | 104/177 [02:14<01:39,  1.37s/it] 59%|█████▉    | 105/177 [02:16<01:36,  1.34s/it] 60%|██████    | 107/177 [02:18<01:28,  1.27s/it] 62%|██████▏   | 109/177 [02:19<01:12,  1.07s/it] 62%|██████▏   | 110/177 [02:25<02:18,  2.07s/it] 64%|██████▍   | 113/177 [02:27<01:28,  1.39s/it] 64%|██████▍   | 114/177 [02:29<01:30,  1.44s/it] 65%|██████▍   | 115/177 [02:30<01:27,  1.41s/it] 66%|██████▌   | 116/177 [02:32<01:30,  1.48s/it] 66%|██████▌   | 117/177 [02:36<02:01,  2.03s/it] 68%|██████▊   | 121/177 [02:37<01:00,  1.08s/it] 69%|██████▉   | 122/177 [02:39<01:09,  1.27s/it] 70%|███████   | 124/177 [02:45<01:35,  1.80s/it] 72%|███████▏  | 128/177 [02:45<00:46,  1.06it/s] 73%|███████▎  | 130/177 [02:49<00:54,  1.17s/it] 74%|███████▍  | 131/177 [02:51<01:01,  1.34s/it] 75%|███████▌  | 133/177 [02:55<01:05,  1.48s/it] 77%|███████▋  | 136/177 [02:57<00:47,  1.16s/it] 79%|███████▊  | 139/177 [02:58<00:35,  1.08it/s] 80%|███████▉  | 141/177 [03:04<00:50,  1.40s/it] 80%|████████  | 142/177 [03:04<00:43,  1.25s/it] 81%|████████  | 143/177 [03:07<00:51,  1.50s/it] 82%|████████▏ | 145/177 [03:10<00:50,  1.59s/it] 83%|████████▎ | 147/177 [03:13<00:43,  1.44s/it] 84%|████████▍ | 149/177 [03:13<00:29,  1.05s/it] 85%|████████▌ | 151/177 [03:16<00:29,  1.12s/it] 86%|████████▋ | 153/177 [03:18<00:27,  1.14s/it] 87%|████████▋ | 154/177 [03:18<00:22,  1.04it/s] 88%|████████▊ | 156/177 [03:21<00:24,  1.15s/it] 90%|████████▉ | 159/177 [03:22<00:14,  1.25it/s] 90%|█████████ | 160/177 [03:26<00:22,  1.33s/it] 92%|█████████▏| 162/177 [03:27<00:14,  1.02it/s] 93%|█████████▎| 164/177 [03:29<00:13,  1.02s/it] 93%|█████████▎| 165/177 [03:31<00:14,  1.24s/it] 95%|█████████▍| 168/177 [03:33<00:09,  1.02s/it] 96%|█████████▌| 170/177 [03:34<00:05,  1.30it/s] 97%|█████████▋| 171/177 [03:38<00:08,  1.45s/it] 98%|█████████▊| 173/177 [03:40<00:04,  1.17s/it] 99%|█████████▉| 176/177 [03:41<00:00,  1.07it/s]100%|██████████| 177/177 [03:44<00:00,  1.22s/it]100%|██████████| 177/177 [03:44<00:00,  1.27s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-25 22:15:43 
[INFO] duration: 15 min 
[2024-09-26 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-24/prod/2024-09-24_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-26 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:79: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-24/prod/2024-09-24_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-24
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-24/prod/2024-09-24_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-24/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-24/prod/2024-09-24_rule_labeled.csv.gpt_labeled.csv
raw log len: 462
时效人设任务型query 数量： 5
unique queries len: 162
调用API
  0%|          | 0/162 [00:00<?, ?it/s]  1%|          | 2/162 [00:01<02:11,  1.22it/s]  2%|▏         | 3/162 [00:03<02:53,  1.09s/it]  2%|▏         | 4/162 [00:04<03:20,  1.27s/it]  3%|▎         | 5/162 [00:06<03:39,  1.40s/it]  4%|▎         | 6/162 [00:08<04:03,  1.56s/it]  4%|▍         | 7/162 [00:09<04:10,  1.62s/it]  5%|▍         | 8/162 [00:12<04:52,  1.90s/it]  6%|▌         | 9/162 [00:14<05:10,  2.03s/it]  6%|▌         | 10/162 [00:16<04:54,  1.94s/it]  7%|▋         | 11/162 [00:18<04:36,  1.83s/it]  7%|▋         | 12/162 [00:19<04:22,  1.75s/it]  8%|▊         | 13/162 [00:22<05:09,  2.08s/it]  9%|▊         | 14/162 [00:24<04:42,  1.91s/it]  9%|▉         | 15/162 [00:25<04:30,  1.84s/it] 10%|▉         | 16/162 [00:27<04:35,  1.89s/it] 10%|█         | 17/162 [00:29<04:21,  1.80s/it] 11%|█         | 18/162 [00:30<04:09,  1.73s/it] 12%|█▏        | 19/162 [00:32<04:14,  1.78s/it] 12%|█▏        | 20/162 [00:34<04:03,  1.71s/it] 13%|█▎        | 21/162 [00:36<04:08,  1.77s/it] 14%|█▎        | 22/162 [00:39<04:56,  2.12s/it] 14%|█▍        | 23/162 [00:40<04:28,  1.93s/it] 15%|█▍        | 24/162 [00:42<04:36,  2.00s/it] 15%|█▌        | 25/162 [00:44<04:30,  1.98s/it] 16%|█▌        | 26/162 [00:46<04:07,  1.82s/it] 17%|█▋        | 27/162 [00:47<04:04,  1.81s/it] 17%|█▋        | 28/162 [00:49<04:02,  1.81s/it] 18%|█▊        | 29/162 [00:51<03:52,  1.75s/it] 19%|█▊        | 30/162 [00:52<03:42,  1.68s/it] 19%|█▉        | 31/162 [00:54<03:46,  1.73s/it] 20%|█▉        | 32/162 [00:56<03:44,  1.73s/it] 20%|██        | 33/162 [00:59<04:31,  2.11s/it] 21%|██        | 34/162 [01:01<04:10,  1.96s/it] 22%|██▏       | 35/162 [01:02<04:00,  1.89s/it] 22%|██▏       | 36/162 [01:04<03:54,  1.86s/it] 23%|██▎       | 37/162 [01:06<03:51,  1.85s/it] 23%|██▎       | 38/162 [01:07<03:36,  1.75s/it] 24%|██▍       | 39/162 [01:10<04:22,  2.13s/it] 25%|██▍       | 40/162 [01:12<04:05,  2.01s/it] 25%|██▌       | 41/162 [01:14<03:55,  1.95s/it] 26%|██▌       | 42/162 [01:17<04:24,  2.20s/it] 27%|██▋       | 43/162 [01:19<04:04,  2.06s/it] 27%|██▋       | 44/162 [01:20<03:56,  2.00s/it] 28%|██▊       | 45/162 [01:23<03:59,  2.04s/it] 28%|██▊       | 46/162 [01:24<03:48,  1.97s/it] 29%|██▉       | 47/162 [01:26<03:30,  1.83s/it] 30%|██▉       | 48/162 [01:28<03:33,  1.87s/it] 30%|███       | 49/162 [01:30<03:28,  1.85s/it] 31%|███       | 50/162 [01:32<03:36,  1.93s/it] 31%|███▏      | 51/162 [01:33<03:27,  1.87s/it] 32%|███▏      | 52/162 [01:35<03:18,  1.80s/it] 33%|███▎      | 53/162 [01:37<03:19,  1.83s/it] 33%|███▎      | 54/162 [01:37<02:26,  1.35s/it] 34%|███▍      | 55/162 [01:39<02:49,  1.59s/it] 35%|███▍      | 56/162 [01:41<02:56,  1.67s/it] 35%|███▌      | 57/162 [01:43<03:05,  1.76s/it] 36%|███▌      | 58/162 [01:45<03:03,  1.76s/it] 36%|███▋      | 59/162 [01:47<03:00,  1.75s/it] 37%|███▋      | 60/162 [01:49<03:11,  1.88s/it] 38%|███▊      | 61/162 [01:51<03:03,  1.82s/it] 38%|███▊      | 62/162 [01:52<02:56,  1.76s/it] 39%|███▉      | 63/162 [01:54<02:57,  1.80s/it] 40%|███▉      | 64/162 [01:56<03:05,  1.89s/it] 40%|████      | 65/162 [01:58<02:55,  1.81s/it] 41%|████      | 66/162 [02:00<02:59,  1.87s/it] 41%|████▏     | 67/162 [02:04<03:50,  2.43s/it] 42%|████▏     | 68/162 [02:05<03:23,  2.17s/it] 43%|████▎     | 69/162 [02:07<03:02,  1.96s/it] 43%|████▎     | 70/162 [02:09<03:05,  2.01s/it] 44%|████▍     | 71/162 [02:10<02:53,  1.90s/it] 44%|████▍     | 72/162 [02:12<02:53,  1.93s/it] 45%|████▌     | 73/162 [02:14<02:45,  1.86s/it] 46%|████▌     | 74/162 [02:16<02:43,  1.86s/it] 46%|████▋     | 75/162 [02:18<02:35,  1.79s/it] 47%|████▋     | 76/162 [02:19<02:29,  1.74s/it] 48%|████▊     | 77/162 [02:21<02:33,  1.80s/it] 48%|████▊     | 78/162 [02:23<02:30,  1.79s/it] 49%|████▉     | 79/162 [02:25<02:31,  1.83s/it] 49%|████▉     | 80/162 [02:26<02:26,  1.78s/it] 50%|█████     | 81/162 [02:28<02:24,  1.78s/it] 51%|█████     | 82/162 [02:30<02:13,  1.67s/it] 51%|█████     | 83/162 [02:31<02:08,  1.63s/it] 52%|█████▏    | 84/162 [02:33<02:05,  1.61s/it] 52%|█████▏    | 85/162 [02:34<02:02,  1.59s/it] 53%|█████▎    | 86/162 [02:36<01:59,  1.58s/it] 54%|█████▎    | 87/162 [02:38<02:05,  1.68s/it] 54%|█████▍    | 88/162 [02:39<02:00,  1.63s/it] 55%|█████▍    | 89/162 [02:41<02:00,  1.66s/it] 56%|█████▌    | 90/162 [02:43<02:06,  1.75s/it] 56%|█████▌    | 91/162 [02:45<02:16,  1.92s/it] 57%|█████▋    | 92/162 [02:47<02:09,  1.85s/it] 57%|█████▋    | 93/162 [02:49<02:06,  1.83s/it] 58%|█████▊    | 94/162 [02:50<01:59,  1.76s/it] 59%|█████▊    | 95/162 [02:53<02:20,  2.10s/it] 59%|█████▉    | 96/162 [02:55<02:10,  1.98s/it] 60%|█████▉    | 97/162 [02:57<02:03,  1.90s/it] 60%|██████    | 98/162 [02:58<01:56,  1.82s/it] 61%|██████    | 99/162 [03:00<01:54,  1.82s/it] 62%|██████▏   | 100/162 [03:02<01:53,  1.82s/it] 62%|██████▏   | 101/162 [03:04<01:52,  1.85s/it] 63%|██████▎   | 102/162 [03:05<01:47,  1.79s/it] 64%|██████▎   | 103/162 [03:07<01:45,  1.78s/it] 64%|██████▍   | 104/162 [03:09<01:45,  1.81s/it] 65%|██████▍   | 105/162 [03:11<01:38,  1.73s/it] 65%|██████▌   | 106/162 [03:13<01:38,  1.76s/it] 66%|██████▌   | 107/162 [03:14<01:32,  1.69s/it] 67%|██████▋   | 108/162 [03:16<01:28,  1.65s/it] 67%|██████▋   | 109/162 [03:18<01:34,  1.78s/it] 68%|██████▊   | 110/162 [03:19<01:28,  1.70s/it] 69%|██████▊   | 111/162 [03:21<01:25,  1.67s/it] 69%|██████▉   | 112/162 [03:23<01:26,  1.72s/it] 70%|██████▉   | 113/162 [03:24<01:24,  1.73s/it] 70%|███████   | 114/162 [03:26<01:22,  1.73s/it] 71%|███████   | 115/162 [03:28<01:23,  1.78s/it] 72%|███████▏  | 116/162 [03:30<01:20,  1.75s/it] 72%|███████▏  | 117/162 [03:31<01:18,  1.76s/it] 73%|███████▎  | 118/162 [03:33<01:16,  1.75s/it] 73%|███████▎  | 119/162 [03:35<01:14,  1.73s/it] 74%|███████▍  | 120/162 [03:36<01:10,  1.69s/it] 75%|███████▍  | 121/162 [03:38<01:12,  1.77s/it] 75%|███████▌  | 122/162 [03:40<01:10,  1.77s/it] 76%|███████▌  | 123/162 [03:42<01:04,  1.66s/it] 77%|███████▋  | 124/162 [03:45<01:17,  2.03s/it] 77%|███████▋  | 125/162 [03:46<01:12,  1.96s/it] 78%|███████▊  | 126/162 [03:48<01:08,  1.91s/it] 78%|███████▊  | 127/162 [03:50<01:03,  1.80s/it] 79%|███████▉  | 128/162 [03:50<00:45,  1.33s/it] 80%|███████▉  | 129/162 [03:52<00:51,  1.56s/it] 80%|████████  | 130/162 [03:54<00:50,  1.59s/it] 81%|████████  | 131/162 [03:56<00:53,  1.72s/it] 81%|████████▏ | 132/162 [03:59<01:09,  2.32s/it] 82%|████████▏ | 133/162 [04:01<01:03,  2.18s/it] 83%|████████▎ | 134/162 [04:03<00:56,  2.01s/it] 83%|████████▎ | 135/162 [04:04<00:50,  1.86s/it] 84%|████████▍ | 136/162 [04:06<00:50,  1.94s/it] 85%|████████▍ | 137/162 [04:08<00:46,  1.85s/it] 85%|████████▌ | 138/162 [04:10<00:41,  1.74s/it] 86%|████████▌ | 139/162 [04:11<00:39,  1.74s/it] 86%|████████▋ | 140/162 [04:13<00:37,  1.71s/it] 87%|████████▋ | 141/162 [04:15<00:35,  1.68s/it] 88%|████████▊ | 142/162 [04:16<00:35,  1.75s/it] 88%|████████▊ | 143/162 [04:19<00:35,  1.85s/it] 89%|████████▉ | 144/162 [04:21<00:37,  2.06s/it] 90%|████████▉ | 145/162 [04:23<00:33,  1.94s/it] 90%|█████████ | 146/162 [04:25<00:31,  1.99s/it] 91%|█████████ | 147/162 [04:27<00:28,  1.88s/it] 91%|█████████▏| 148/162 [04:28<00:25,  1.85s/it] 92%|█████████▏| 149/162 [04:30<00:23,  1.82s/it] 93%|█████████▎| 150/162 [04:32<00:20,  1.75s/it] 93%|█████████▎| 151/162 [04:33<00:18,  1.71s/it] 94%|█████████▍| 152/162 [04:35<00:17,  1.74s/it] 94%|█████████▍| 153/162 [04:37<00:15,  1.76s/it] 95%|█████████▌| 154/162 [04:39<00:14,  1.78s/it] 96%|█████████▌| 155/162 [04:40<00:12,  1.72s/it] 96%|█████████▋| 156/162 [04:43<00:12,  2.11s/it] 97%|█████████▋| 157/162 [04:45<00:10,  2.03s/it] 98%|█████████▊| 158/162 [04:47<00:08,  2.01s/it] 98%|█████████▊| 159/162 [04:49<00:05,  1.92s/it] 99%|█████████▉| 160/162 [04:51<00:03,  1.91s/it] 99%|█████████▉| 161/162 [04:52<00:01,  1.83s/it]100%|██████████| 162/162 [04:54<00:00,  1.86s/it]100%|██████████| 162/162 [04:56<00:00,  1.83s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 160
调用obs
  0%|          | 0/160 [00:00<?, ?it/s]  1%|          | 1/160 [00:01<04:02,  1.52s/it]  1%|▏         | 2/160 [00:02<02:54,  1.10s/it]  2%|▎         | 4/160 [00:03<02:13,  1.17it/s]  3%|▎         | 5/160 [00:04<02:11,  1.18it/s]  4%|▍         | 6/160 [00:06<02:51,  1.12s/it]  4%|▍         | 7/160 [00:09<04:16,  1.68s/it]  5%|▌         | 8/160 [00:10<04:05,  1.62s/it]  6%|▌         | 9/160 [00:12<03:50,  1.52s/it]  6%|▋         | 10/160 [00:13<03:52,  1.55s/it]  7%|▋         | 11/160 [00:14<03:40,  1.48s/it]  8%|▊         | 12/160 [00:17<04:25,  1.79s/it]  8%|▊         | 13/160 [00:19<04:22,  1.78s/it]  9%|▉         | 14/160 [00:21<05:00,  2.06s/it]  9%|▉         | 15/160 [00:23<04:34,  1.90s/it] 10%|█         | 16/160 [00:24<04:08,  1.73s/it] 11%|█         | 17/160 [00:26<03:54,  1.64s/it] 11%|█▏        | 18/160 [00:27<03:41,  1.56s/it] 12%|█▏        | 19/160 [00:29<03:32,  1.51s/it] 12%|█▎        | 20/160 [00:30<03:36,  1.54s/it] 13%|█▎        | 21/160 [00:33<04:15,  1.84s/it] 14%|█▍        | 22/160 [00:35<04:33,  1.98s/it] 14%|█▍        | 23/160 [00:36<03:39,  1.61s/it] 15%|█▌        | 24/160 [00:37<03:34,  1.58s/it] 16%|█▌        | 25/160 [00:38<03:10,  1.41s/it] 16%|█▋        | 26/160 [00:39<02:48,  1.26s/it] 17%|█▋        | 27/160 [00:41<03:00,  1.36s/it] 18%|█▊        | 28/160 [00:42<02:36,  1.19s/it] 18%|█▊        | 29/160 [00:43<02:44,  1.26s/it] 19%|█▉        | 30/160 [00:45<03:01,  1.40s/it] 19%|█▉        | 31/160 [00:46<02:59,  1.39s/it] 20%|██        | 32/160 [00:48<03:14,  1.52s/it] 21%|██        | 33/160 [00:50<03:21,  1.58s/it] 21%|██▏       | 34/160 [00:51<03:06,  1.48s/it] 22%|██▏       | 35/160 [00:52<03:04,  1.48s/it] 22%|██▎       | 36/160 [00:53<02:52,  1.39s/it] 23%|██▎       | 37/160 [00:55<02:53,  1.41s/it] 24%|██▍       | 38/160 [00:58<03:54,  1.92s/it] 24%|██▍       | 39/160 [00:59<03:26,  1.71s/it] 25%|██▌       | 40/160 [01:00<02:58,  1.49s/it] 26%|██▌       | 41/160 [01:03<03:49,  1.93s/it] 26%|██▋       | 42/160 [01:04<02:54,  1.48s/it] 27%|██▋       | 43/160 [01:05<02:58,  1.52s/it] 28%|██▊       | 44/160 [01:06<02:45,  1.43s/it] 28%|██▊       | 45/160 [01:08<02:50,  1.48s/it] 29%|██▉       | 46/160 [01:09<02:31,  1.33s/it] 29%|██▉       | 47/160 [01:10<02:27,  1.30s/it] 30%|███       | 48/160 [01:12<02:32,  1.36s/it] 31%|███       | 49/160 [01:13<02:38,  1.43s/it] 31%|███▏      | 50/160 [01:14<02:21,  1.29s/it] 32%|███▏      | 51/160 [01:15<02:08,  1.18s/it] 32%|███▎      | 52/160 [01:15<01:36,  1.12it/s] 33%|███▎      | 53/160 [01:17<02:03,  1.16s/it] 34%|███▍      | 54/160 [01:19<02:11,  1.24s/it] 35%|███▌      | 56/160 [01:20<01:41,  1.03it/s] 36%|███▌      | 57/160 [01:22<02:01,  1.18s/it] 36%|███▋      | 58/160 [01:23<01:55,  1.14s/it] 37%|███▋      | 59/160 [01:25<02:14,  1.33s/it] 38%|███▊      | 60/160 [01:25<01:55,  1.15s/it] 38%|███▊      | 61/160 [01:27<02:10,  1.32s/it] 39%|███▉      | 62/160 [01:29<02:12,  1.35s/it] 39%|███▉      | 63/160 [01:30<01:59,  1.23s/it] 40%|████      | 64/160 [01:30<01:49,  1.14s/it] 41%|████      | 65/160 [01:35<03:29,  2.21s/it] 41%|████▏     | 66/160 [01:37<03:09,  2.02s/it] 42%|████▏     | 67/160 [01:38<02:58,  1.92s/it] 42%|████▎     | 68/160 [01:39<02:13,  1.45s/it] 43%|████▎     | 69/160 [01:40<01:58,  1.30s/it] 44%|████▍     | 70/160 [01:41<02:02,  1.37s/it] 44%|████▍     | 71/160 [01:43<02:08,  1.45s/it] 45%|████▌     | 72/160 [01:44<02:03,  1.40s/it] 46%|████▋     | 74/160 [01:45<01:14,  1.15it/s] 47%|████▋     | 75/160 [01:46<01:19,  1.07it/s] 48%|████▊     | 76/160 [01:47<01:33,  1.11s/it] 48%|████▊     | 77/160 [01:49<01:32,  1.11s/it] 49%|████▉     | 78/160 [01:50<01:30,  1.10s/it] 49%|████▉     | 79/160 [01:51<01:44,  1.29s/it] 50%|█████     | 80/160 [01:53<01:50,  1.38s/it] 51%|█████     | 81/160 [01:54<01:50,  1.40s/it] 51%|█████▏    | 82/160 [01:56<01:45,  1.35s/it] 52%|█████▏    | 83/160 [01:57<01:42,  1.33s/it] 52%|█████▎    | 84/160 [01:59<01:51,  1.46s/it] 53%|█████▎    | 85/160 [02:00<01:50,  1.48s/it] 54%|█████▍    | 86/160 [02:02<01:45,  1.43s/it] 54%|█████▍    | 87/160 [02:03<01:43,  1.41s/it] 55%|█████▌    | 88/160 [02:04<01:44,  1.46s/it] 56%|█████▌    | 89/160 [02:06<01:40,  1.42s/it] 56%|█████▋    | 90/160 [02:06<01:13,  1.05s/it] 57%|█████▋    | 91/160 [02:08<01:29,  1.30s/it] 57%|█████▊    | 92/160 [02:09<01:26,  1.27s/it] 58%|█████▊    | 93/160 [02:11<01:46,  1.59s/it] 59%|█████▉    | 94/160 [02:13<01:41,  1.53s/it] 59%|█████▉    | 95/160 [02:14<01:30,  1.39s/it] 60%|██████    | 96/160 [02:15<01:26,  1.35s/it] 61%|██████    | 97/160 [02:17<01:33,  1.48s/it] 61%|██████▏   | 98/160 [02:18<01:27,  1.41s/it] 62%|██████▏   | 99/160 [02:19<01:20,  1.32s/it] 62%|██████▎   | 100/160 [02:21<01:18,  1.31s/it] 64%|██████▍   | 102/160 [02:22<00:58,  1.01s/it] 64%|██████▍   | 103/160 [02:23<01:03,  1.11s/it] 65%|██████▌   | 104/160 [02:24<00:56,  1.01s/it] 66%|██████▌   | 105/160 [02:25<00:55,  1.00s/it] 66%|██████▋   | 106/160 [02:26<01:00,  1.12s/it] 67%|██████▋   | 107/160 [02:28<01:08,  1.29s/it] 68%|██████▊   | 108/160 [02:29<00:57,  1.11s/it] 68%|██████▊   | 109/160 [02:30<00:58,  1.16s/it] 69%|██████▉   | 110/160 [02:32<01:05,  1.31s/it] 69%|██████▉   | 111/160 [02:33<01:05,  1.33s/it] 70%|███████   | 112/160 [02:35<01:05,  1.36s/it] 71%|███████   | 113/160 [02:36<01:07,  1.43s/it] 71%|███████▏  | 114/160 [02:38<01:09,  1.50s/it] 72%|███████▏  | 115/160 [02:39<01:05,  1.45s/it] 72%|███████▎  | 116/160 [02:40<01:00,  1.38s/it] 73%|███████▎  | 117/160 [02:41<00:55,  1.28s/it] 74%|███████▍  | 118/160 [02:43<00:56,  1.35s/it] 74%|███████▍  | 119/160 [02:44<00:54,  1.32s/it] 75%|███████▌  | 120/160 [02:45<00:52,  1.31s/it] 76%|███████▌  | 121/160 [02:46<00:41,  1.07s/it] 76%|███████▋  | 122/160 [02:49<01:02,  1.63s/it] 77%|███████▋  | 123/160 [02:50<00:53,  1.45s/it] 78%|███████▊  | 124/160 [02:52<00:56,  1.56s/it] 78%|███████▊  | 125/160 [02:53<00:50,  1.43s/it] 79%|███████▉  | 126/160 [02:54<00:41,  1.23s/it] 79%|███████▉  | 127/160 [02:55<00:42,  1.29s/it] 80%|████████  | 128/160 [02:57<00:42,  1.34s/it] 81%|████████  | 129/160 [02:59<00:54,  1.77s/it] 81%|████████▏ | 130/160 [03:01<00:48,  1.62s/it] 82%|████████▏ | 131/160 [03:02<00:43,  1.51s/it] 82%|████████▎ | 132/160 [03:03<00:41,  1.50s/it] 83%|████████▎ | 133/160 [03:04<00:36,  1.34s/it] 84%|████████▍ | 134/160 [03:06<00:36,  1.42s/it] 84%|████████▍ | 135/160 [03:07<00:30,  1.21s/it] 85%|████████▌ | 136/160 [03:08<00:30,  1.26s/it] 86%|████████▋ | 138/160 [03:09<00:21,  1.03it/s] 87%|████████▋ | 139/160 [03:10<00:18,  1.13it/s] 88%|████████▊ | 140/160 [03:12<00:22,  1.12s/it] 88%|████████▊ | 141/160 [03:14<00:25,  1.33s/it] 89%|████████▉ | 142/160 [03:15<00:25,  1.42s/it] 89%|████████▉ | 143/160 [03:17<00:26,  1.56s/it] 90%|█████████ | 144/160 [03:18<00:21,  1.36s/it] 91%|█████████ | 145/160 [03:19<00:19,  1.30s/it] 91%|█████████▏| 146/160 [03:20<00:17,  1.27s/it] 92%|█████████▏| 147/160 [03:22<00:18,  1.44s/it] 92%|█████████▎| 148/160 [03:23<00:16,  1.39s/it] 93%|█████████▎| 149/160 [03:25<00:14,  1.34s/it] 94%|█████████▍| 150/160 [03:26<00:13,  1.39s/it] 94%|█████████▍| 151/160 [03:28<00:12,  1.42s/it] 95%|█████████▌| 152/160 [03:29<00:10,  1.26s/it] 96%|█████████▌| 153/160 [03:29<00:08,  1.15s/it] 96%|█████████▋| 154/160 [03:31<00:06,  1.15s/it] 97%|█████████▋| 155/160 [03:32<00:05,  1.11s/it] 98%|█████████▊| 156/160 [03:34<00:05,  1.35s/it] 98%|█████████▊| 157/160 [03:35<00:04,  1.36s/it] 99%|█████████▉| 158/160 [03:36<00:02,  1.28s/it] 99%|█████████▉| 159/160 [03:37<00:01,  1.26s/it]100%|██████████| 160/160 [03:39<00:00,  1.33s/it]100%|██████████| 160/160 [03:39<00:00,  1.37s/it]
有效obs数量 160
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-24/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 160 / 160
  0%|          | 0/160 [00:00<?, ?it/s]  1%|          | 1/160 [00:11<29:49, 11.26s/it]  3%|▎         | 5/160 [00:12<04:48,  1.86s/it]  4%|▍         | 6/160 [00:13<04:44,  1.85s/it]  4%|▍         | 7/160 [00:14<03:51,  1.51s/it]  5%|▌         | 8/160 [00:16<04:05,  1.61s/it]  7%|▋         | 11/160 [00:18<02:58,  1.20s/it]  8%|▊         | 12/160 [00:19<02:28,  1.00s/it]  9%|▉         | 14/160 [00:20<02:02,  1.20it/s]  9%|▉         | 15/160 [00:23<03:07,  1.29s/it] 11%|█         | 17/160 [00:25<02:55,  1.22s/it] 12%|█▏        | 19/160 [00:27<02:33,  1.09s/it] 12%|█▎        | 20/160 [00:27<02:06,  1.11it/s] 14%|█▍        | 22/160 [00:29<02:12,  1.04it/s] 14%|█▍        | 23/160 [00:30<02:22,  1.04s/it] 16%|█▋        | 26/160 [00:32<01:53,  1.18it/s] 17%|█▋        | 27/160 [00:37<03:21,  1.52s/it] 19%|█▉        | 30/160 [00:39<02:37,  1.21s/it] 20%|██        | 32/160 [00:44<03:26,  1.61s/it] 22%|██▎       | 36/160 [00:45<02:03,  1.01it/s] 23%|██▎       | 37/160 [00:47<02:22,  1.16s/it] 24%|██▍       | 38/160 [00:49<02:33,  1.26s/it] 26%|██▌       | 41/160 [00:51<01:55,  1.03it/s] 27%|██▋       | 43/160 [00:58<03:13,  1.65s/it] 29%|██▉       | 47/160 [00:59<01:59,  1.06s/it] 31%|███       | 49/160 [01:02<02:16,  1.23s/it] 32%|███▏      | 51/160 [01:04<02:00,  1.11s/it] 33%|███▎      | 53/160 [01:07<02:07,  1.19s/it] 34%|███▍      | 55/160 [01:09<02:03,  1.18s/it] 36%|███▌      | 57/160 [01:15<02:50,  1.66s/it] 37%|███▋      | 59/160 [01:16<02:10,  1.30s/it] 38%|███▊      | 61/160 [01:19<02:16,  1.38s/it] 39%|███▉      | 63/160 [01:21<02:02,  1.26s/it] 40%|████      | 64/160 [01:22<02:01,  1.27s/it] 41%|████      | 65/160 [01:27<03:06,  1.97s/it] 44%|████▍     | 70/160 [01:29<01:30,  1.01s/it] 44%|████▍     | 71/160 [01:31<01:47,  1.21s/it] 47%|████▋     | 75/160 [01:34<01:26,  1.01s/it] 49%|████▉     | 79/160 [01:35<00:59,  1.35it/s] 50%|█████     | 80/160 [01:37<01:09,  1.16it/s] 51%|█████     | 81/160 [01:38<01:05,  1.21it/s] 51%|█████▏    | 82/160 [01:39<01:17,  1.01it/s] 52%|█████▏    | 83/160 [01:43<01:49,  1.42s/it] 54%|█████▍    | 86/160 [01:46<01:41,  1.38s/it] 56%|█████▌    | 89/160 [01:51<01:44,  1.47s/it] 58%|█████▊    | 93/160 [01:53<01:04,  1.03it/s] 59%|█████▉    | 94/160 [01:54<01:04,  1.03it/s] 60%|██████    | 96/160 [01:54<00:52,  1.22it/s] 61%|██████    | 97/160 [01:56<01:00,  1.05it/s] 61%|██████▏   | 98/160 [01:57<00:58,  1.06it/s] 62%|██████▏   | 99/160 [01:59<01:12,  1.19s/it] 64%|██████▍   | 103/160 [01:59<00:33,  1.72it/s] 65%|██████▌   | 104/160 [02:02<00:53,  1.05it/s] 66%|██████▌   | 105/160 [02:04<01:04,  1.17s/it] 66%|██████▋   | 106/160 [02:05<00:53,  1.02it/s] 68%|██████▊   | 109/160 [02:08<00:52,  1.03s/it] 69%|██████▉   | 111/160 [02:10<00:49,  1.01s/it] 70%|███████   | 112/160 [02:11<00:49,  1.02s/it] 71%|███████   | 113/160 [02:12<00:47,  1.00s/it] 71%|███████▏  | 114/160 [02:13<00:49,  1.08s/it] 73%|███████▎  | 117/160 [02:15<00:34,  1.24it/s] 74%|███████▍  | 118/160 [02:16<00:34,  1.20it/s] 74%|███████▍  | 119/160 [02:17<00:43,  1.05s/it] 75%|███████▌  | 120/160 [02:18<00:39,  1.01it/s] 76%|███████▌  | 121/160 [02:22<01:06,  1.71s/it] 78%|███████▊  | 125/160 [02:22<00:25,  1.36it/s] 79%|███████▉  | 126/160 [02:25<00:34,  1.01s/it] 80%|████████  | 128/160 [02:27<00:34,  1.08s/it] 81%|████████  | 129/160 [02:28<00:30,  1.03it/s] 81%|████████▏ | 130/160 [02:30<00:41,  1.38s/it] 82%|████████▏ | 131/160 [02:32<00:42,  1.46s/it] 84%|████████▍ | 134/160 [02:35<00:29,  1.13s/it] 84%|████████▍ | 135/160 [02:36<00:29,  1.19s/it] 85%|████████▌ | 136/160 [02:38<00:33,  1.40s/it] 87%|████████▋ | 139/160 [02:39<00:18,  1.16it/s] 88%|████████▊ | 140/160 [02:45<00:37,  1.86s/it] 89%|████████▉ | 143/160 [02:46<00:18,  1.11s/it] 90%|█████████ | 144/160 [02:47<00:18,  1.16s/it] 91%|█████████ | 145/160 [02:49<00:18,  1.26s/it] 92%|█████████▏| 147/160 [02:51<00:15,  1.21s/it] 93%|█████████▎| 149/160 [02:56<00:17,  1.58s/it] 96%|█████████▌| 153/160 [02:56<00:05,  1.20it/s] 96%|█████████▋| 154/160 [02:58<00:05,  1.02it/s] 97%|█████████▋| 155/160 [03:06<00:10,  2.18s/it]100%|██████████| 160/160 [03:07<00:00,  1.16s/it]100%|██████████| 160/160 [03:07<00:00,  1.17s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-09-26 22:14:07 
[INFO] duration: 14 min 
[2024-09-27 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-25/prod/2024-09-25_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-27 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 49, in extract_datetime_from_input
    return datetime.strptime(datetime_str, "%Y-%m-%d %H:%M:%S")
           ^^^^^^^^
NameError: name 'datetime' is not defined
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-25/prod/2024-09-25_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-25
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-25/prod/2024-09-25_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-25/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-25/prod/2024-09-25_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-25/prod/2024-09-25_rule_labeled.csv.gpt_labeled.csv
raw log len: 137
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-09-27 22:00:19 
[INFO] duration: 0 min 
[2024-09-28 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-26/prod/2024-09-26_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-28 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-26/prod/2024-09-26_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-26
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-26/prod/2024-09-26_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-26/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-26/prod/2024-09-26_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-26/prod/2024-09-26_rule_labeled.csv.gpt_labeled.csv
raw log len: 210
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-09-28 22:00:21 
[INFO] duration: 0 min 
[2024-09-29 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-27/prod/2024-09-27_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-29 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-27/prod/2024-09-27_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-27
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-27/prod/2024-09-27_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-27/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-27/prod/2024-09-27_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-27/prod/2024-09-27_rule_labeled.csv.gpt_labeled.csv
raw log len: 177
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-09-29 22:00:20 
[INFO] duration: 0 min 
[2024-09-30 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-28/prod/2024-09-28_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-09-30 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-28/prod/2024-09-28_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-28
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-28/prod/2024-09-28_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-28/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-28/prod/2024-09-28_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-28/prod/2024-09-28_rule_labeled.csv.gpt_labeled.csv
raw log len: 74
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-09-30 22:00:18 
[INFO] duration: 0 min 
[2024-10-01 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-29/prod/2024-09-29_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-01 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-29/prod/2024-09-29_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-29
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-29/prod/2024-09-29_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-29/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-29/prod/2024-09-29_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-29/prod/2024-09-29_rule_labeled.csv.gpt_labeled.csv
raw log len: 389
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-01 22:00:20 
[INFO] duration: 0 min 
[2024-10-02 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-30/prod/2024-09-30_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-02 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-30/prod/2024-09-30_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-09-30
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-30/prod/2024-09-30_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-09-30/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-30/prod/2024-09-30_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-09-30/prod/2024-09-30_rule_labeled.csv.gpt_labeled.csv
raw log len: 127
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-02 22:00:20 
[INFO] duration: 0 min 
[2024-10-03 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-01/prod/2024-10-01_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-03 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/series.py", line 4630, in apply
    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1025, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/apply.py", line 1076, in apply_standard
    mapped = lib.map_infer(
             ^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2834, in pandas._libs.lib.map_infer
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 30, in extract_datetime_from_input
    match = re.search(pattern, input_16b)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/re/__init__.py", line 176, in search
    return _compile(pattern, flags).search(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'float'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-01/prod/2024-10-01_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-01
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-01/prod/2024-10-01_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-01/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-01/prod/2024-10-01_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-01/prod/2024-10-01_rule_labeled.csv.gpt_labeled.csv
raw log len: 88
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-03 22:00:20 
[INFO] duration: 0 min 
[2024-10-04 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-02/prod/2024-10-02_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-04 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-02/prod/2024-10-02_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-02
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-02/prod/2024-10-02_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-02/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-02/prod/2024-10-02_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-02/prod/2024-10-02_rule_labeled.csv.gpt_labeled.csv
raw log len: 102
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-04 22:00:23 
[INFO] duration: 0 min 
[2024-10-05 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-03/prod/2024-10-03_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-05 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-03/prod/2024-10-03_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-03
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-03/prod/2024-10-03_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-03/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-03/prod/2024-10-03_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-03/prod/2024-10-03_rule_labeled.csv.gpt_labeled.csv
raw log len: 72
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-05 22:00:21 
[INFO] duration: 0 min 
[2024-10-06 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-04/prod/2024-10-04_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-06 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-04/prod/2024-10-04_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-04
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-04/prod/2024-10-04_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-04/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-04/prod/2024-10-04_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-04/prod/2024-10-04_rule_labeled.csv.gpt_labeled.csv
raw log len: 81
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-06 22:00:19 
[INFO] duration: 0 min 
[2024-10-07 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-05/prod/2024-10-05_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-07 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-05/prod/2024-10-05_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-05
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-05/prod/2024-10-05_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-05/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-05/prod/2024-10-05_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-05/prod/2024-10-05_rule_labeled.csv.gpt_labeled.csv
raw log len: 49
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-07 22:00:25 
[INFO] duration: 0 min 
[2024-10-08 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-06/prod/2024-10-06_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-08 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so'), PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    filter_df = DataFilter.filter_bad_df(df, self.config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 176, in filter_bad_df
    df['datetime'] = df['taskformer-model-13b-input'].apply(extract_datetime_from_input) # 增加datetime字段
                     ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-06/prod/2024-10-06_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-06
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-06/prod/2024-10-06_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-06/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-06/prod/2024-10-06_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-06/prod/2024-10-06_rule_labeled.csv.gpt_labeled.csv
raw log len: 363
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 208, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 134, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 202, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-08 22:00:21 
[INFO] duration: 0 min 
[2024-10-09 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-07/prod/2024-10-07_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-09 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 114, in get_distillation_data
    df = df[~df['taskformer-model-13b-input'].isna()]
             ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-07/prod/2024-10-07_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-07
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-07/prod/2024-10-07_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-07/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-07/prod/2024-10-07_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-07/prod/2024-10-07_rule_labeled.csv.gpt_labeled.csv
raw log len: 181
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 209, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 135, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 203, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-09 22:00:18 
[INFO] duration: 0 min 
[2024-10-10 22:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-08/prod/2024-10-08_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-10 22:00:01
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:106: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-08/prod/2024-10-08_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-08
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-08/prod/2024-10-08_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-08/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-08/prod/2024-10-08_rule_labeled.csv.gpt_labeled.csv
raw log len: 85
时效人设任务型query 数量： 0
unique queries len: 32
调用API
  0%|          | 0/32 [00:00<?, ?it/s]  6%|▋         | 2/32 [00:01<00:29,  1.01it/s]  9%|▉         | 3/32 [00:04<00:49,  1.71s/it] 12%|█▎        | 4/32 [00:06<00:49,  1.77s/it] 16%|█▌        | 5/32 [00:08<00:47,  1.74s/it] 19%|█▉        | 6/32 [00:09<00:45,  1.74s/it] 22%|██▏       | 7/32 [00:11<00:44,  1.77s/it] 25%|██▌       | 8/32 [00:13<00:42,  1.78s/it] 28%|██▊       | 9/32 [00:15<00:43,  1.89s/it] 31%|███▏      | 10/32 [00:17<00:43,  1.98s/it] 34%|███▍      | 11/32 [00:19<00:39,  1.90s/it] 38%|███▊      | 12/32 [00:21<00:35,  1.77s/it] 41%|████      | 13/32 [00:22<00:32,  1.71s/it] 44%|████▍     | 14/32 [00:24<00:30,  1.71s/it] 47%|████▋     | 15/32 [00:26<00:29,  1.73s/it] 50%|█████     | 16/32 [00:28<00:28,  1.75s/it] 53%|█████▎    | 17/32 [00:29<00:27,  1.81s/it] 56%|█████▋    | 18/32 [00:31<00:25,  1.79s/it] 59%|█████▉    | 19/32 [00:33<00:22,  1.70s/it] 62%|██████▎   | 20/32 [00:35<00:24,  2.02s/it] 66%|██████▌   | 21/32 [00:37<00:22,  2.00s/it] 69%|██████▉   | 22/32 [00:39<00:19,  1.93s/it] 72%|███████▏  | 23/32 [00:42<00:19,  2.17s/it] 75%|███████▌  | 24/32 [00:44<00:16,  2.06s/it] 78%|███████▊  | 25/32 [00:45<00:13,  1.96s/it] 81%|████████▏ | 26/32 [00:48<00:12,  2.02s/it] 84%|████████▍ | 27/32 [00:49<00:09,  1.88s/it] 88%|████████▊ | 28/32 [00:51<00:07,  1.89s/it] 91%|█████████ | 29/32 [00:54<00:06,  2.10s/it] 94%|█████████▍| 30/32 [00:56<00:04,  2.29s/it] 97%|█████████▋| 31/32 [00:58<00:02,  2.11s/it]100%|██████████| 32/32 [01:00<00:00,  1.99s/it]100%|██████████| 32/32 [01:00<00:00,  1.89s/it]
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 31
调用obs
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:01<00:56,  1.89s/it]  6%|▋         | 2/31 [00:03<00:44,  1.53s/it] 10%|▉         | 3/31 [00:04<00:44,  1.60s/it] 13%|█▎        | 4/31 [00:06<00:41,  1.53s/it] 16%|█▌        | 5/31 [00:07<00:38,  1.48s/it] 19%|█▉        | 6/31 [00:08<00:34,  1.38s/it] 23%|██▎       | 7/31 [00:10<00:35,  1.46s/it] 26%|██▌       | 8/31 [00:11<00:28,  1.25s/it] 29%|██▉       | 9/31 [00:12<00:27,  1.23s/it] 32%|███▏      | 10/31 [00:13<00:27,  1.29s/it] 35%|███▌      | 11/31 [00:15<00:26,  1.34s/it] 39%|███▊      | 12/31 [00:16<00:25,  1.37s/it] 42%|████▏     | 13/31 [00:18<00:24,  1.37s/it] 45%|████▌     | 14/31 [00:19<00:23,  1.37s/it] 48%|████▊     | 15/31 [00:19<00:16,  1.06s/it] 52%|█████▏    | 16/31 [00:20<00:14,  1.05it/s] 55%|█████▍    | 17/31 [00:21<00:15,  1.07s/it] 58%|█████▊    | 18/31 [00:23<00:15,  1.17s/it] 61%|██████▏   | 19/31 [00:26<00:19,  1.66s/it] 65%|██████▍   | 20/31 [00:27<00:17,  1.59s/it] 68%|██████▊   | 21/31 [00:28<00:15,  1.55s/it] 71%|███████   | 22/31 [00:32<00:17,  1.99s/it] 74%|███████▍  | 23/31 [00:33<00:14,  1.80s/it] 77%|███████▋  | 24/31 [00:34<00:11,  1.65s/it] 81%|████████  | 25/31 [00:35<00:08,  1.39s/it] 84%|████████▍ | 26/31 [00:36<00:07,  1.41s/it] 87%|████████▋ | 27/31 [00:37<00:04,  1.23s/it] 90%|█████████ | 28/31 [00:40<00:04,  1.61s/it] 94%|█████████▎| 29/31 [00:43<00:04,  2.13s/it] 97%|█████████▋| 30/31 [00:44<00:01,  1.87s/it]100%|██████████| 31/31 [00:46<00:00,  1.71s/it]100%|██████████| 31/31 [00:46<00:00,  1.49s/it]
有效obs数量 31
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-08/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 31 / 31
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:10<05:25, 10.87s/it] 10%|▉         | 3/31 [00:15<02:06,  4.53s/it] 16%|█▌        | 5/31 [00:20<01:29,  3.43s/it] 23%|██▎       | 7/31 [00:22<00:59,  2.49s/it] 26%|██▌       | 8/31 [00:24<00:54,  2.38s/it] 29%|██▉       | 9/31 [00:26<00:46,  2.14s/it] 32%|███▏      | 10/31 [00:29<00:53,  2.57s/it] 35%|███▌      | 11/31 [00:33<00:58,  2.92s/it] 42%|████▏     | 13/31 [00:40<00:56,  3.13s/it] 48%|████▊     | 15/31 [00:45<00:44,  2.79s/it] 52%|█████▏    | 16/31 [00:46<00:36,  2.43s/it] 55%|█████▍    | 17/31 [00:50<00:39,  2.79s/it] 58%|█████▊    | 18/31 [00:51<00:30,  2.35s/it] 61%|██████▏   | 19/31 [00:57<00:39,  3.30s/it] 68%|██████▊   | 21/31 [00:58<00:22,  2.26s/it] 71%|███████   | 22/31 [01:03<00:25,  2.85s/it] 77%|███████▋  | 24/31 [01:11<00:22,  3.23s/it] 84%|████████▍ | 26/31 [01:12<00:11,  2.35s/it] 87%|████████▋ | 27/31 [01:14<00:08,  2.24s/it] 90%|█████████ | 28/31 [01:18<00:07,  2.52s/it] 94%|█████████▎| 29/31 [01:19<00:04,  2.34s/it] 97%|█████████▋| 30/31 [01:23<00:02,  2.74s/it]100%|██████████| 31/31 [01:26<00:00,  2.75s/it]100%|██████████| 31/31 [01:26<00:00,  2.79s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-10-10 22:05:40 
[INFO] duration: 5 min 
[2024-10-11 22:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-09/prod/2024-10-09_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-11 22:00:02
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /opt/conda/envs/rhm_env did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:106: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:364: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 116
CUDA SETUP: Loading binary /opt/conda/envs/rhm_env/lib/python3.11/site-packages/bitsandbytes/libbitsandbytes_cuda116.so...
Arguments: Namespace(api_url='http://172.24.139.47:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-09/prod/2024-10-09_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-09
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-09/prod/2024-10-09_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-09/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-09/prod/2024-10-09_rule_labeled.csv.gpt_labeled.csv
raw log len: 1701
时效人设任务型query 数量： 20
unique queries len: 343
调用API
  0%|          | 0/343 [00:00<?, ?it/s]  1%|          | 2/343 [00:01<04:55,  1.15it/s]  1%|          | 3/343 [00:03<07:23,  1.31s/it]  1%|          | 4/343 [00:03<05:16,  1.07it/s]  1%|▏         | 5/343 [00:05<07:03,  1.25s/it]  2%|▏         | 6/343 [00:07<08:17,  1.48s/it]  2%|▏         | 7/343 [00:09<08:46,  1.57s/it]  2%|▏         | 8/343 [00:11<08:44,  1.57s/it]  3%|▎         | 9/343 [00:13<09:26,  1.69s/it]  3%|▎         | 10/343 [00:14<09:47,  1.77s/it]  3%|▎         | 11/343 [00:16<09:24,  1.70s/it]  3%|▎         | 12/343 [00:18<09:58,  1.81s/it]  4%|▍         | 13/343 [00:20<10:22,  1.89s/it]  4%|▍         | 14/343 [00:22<10:21,  1.89s/it]  4%|▍         | 15/343 [00:24<09:59,  1.83s/it]  5%|▍         | 16/343 [00:25<09:27,  1.74s/it]  5%|▍         | 17/343 [00:28<10:19,  1.90s/it]  5%|▌         | 18/343 [00:29<10:20,  1.91s/it]  6%|▌         | 19/343 [00:31<09:40,  1.79s/it]  6%|▌         | 20/343 [00:33<09:38,  1.79s/it]  6%|▌         | 21/343 [00:34<09:23,  1.75s/it]  6%|▋         | 22/343 [00:37<10:00,  1.87s/it]  7%|▋         | 23/343 [00:39<10:23,  1.95s/it]  7%|▋         | 24/343 [00:40<09:42,  1.82s/it]  7%|▋         | 25/343 [00:42<09:58,  1.88s/it]  8%|▊         | 26/343 [00:44<10:07,  1.92s/it]  8%|▊         | 27/343 [00:46<09:53,  1.88s/it]  8%|▊         | 28/343 [00:48<09:23,  1.79s/it]  8%|▊         | 29/343 [00:49<09:25,  1.80s/it]  9%|▊         | 30/343 [00:51<08:59,  1.72s/it]  9%|▉         | 31/343 [00:53<09:04,  1.75s/it]  9%|▉         | 32/343 [00:55<09:37,  1.86s/it] 10%|▉         | 33/343 [00:57<09:31,  1.84s/it] 10%|▉         | 34/343 [00:58<09:19,  1.81s/it] 10%|█         | 35/343 [01:00<08:37,  1.68s/it] 10%|█         | 36/343 [01:02<09:18,  1.82s/it] 11%|█         | 37/343 [01:04<09:24,  1.84s/it] 11%|█         | 38/343 [01:06<09:18,  1.83s/it] 11%|█▏        | 39/343 [01:08<10:05,  1.99s/it] 12%|█▏        | 40/343 [01:10<10:12,  2.02s/it] 12%|█▏        | 41/343 [01:12<10:20,  2.05s/it] 12%|█▏        | 42/343 [01:14<10:00,  1.99s/it] 13%|█▎        | 43/343 [01:17<10:39,  2.13s/it] 13%|█▎        | 44/343 [01:18<09:58,  2.00s/it] 13%|█▎        | 45/343 [01:20<09:24,  1.89s/it] 13%|█▎        | 46/343 [01:22<09:11,  1.86s/it] 14%|█▎        | 47/343 [01:24<09:33,  1.94s/it] 14%|█▍        | 48/343 [01:26<09:17,  1.89s/it] 14%|█▍        | 49/343 [01:28<09:38,  1.97s/it] 15%|█▍        | 50/343 [01:30<09:20,  1.91s/it] 15%|█▍        | 51/343 [01:30<07:37,  1.57s/it] 15%|█▌        | 52/343 [01:32<07:53,  1.63s/it] 15%|█▌        | 53/343 [01:34<07:48,  1.62s/it] 16%|█▌        | 54/343 [01:35<08:02,  1.67s/it] 16%|█▌        | 55/343 [01:37<08:08,  1.70s/it] 16%|█▋        | 56/343 [01:39<08:20,  1.74s/it] 17%|█▋        | 57/343 [01:41<08:13,  1.73s/it] 17%|█▋        | 58/343 [01:43<08:16,  1.74s/it] 17%|█▋        | 59/343 [01:44<08:32,  1.80s/it] 17%|█▋        | 60/343 [01:46<08:33,  1.81s/it] 18%|█▊        | 61/343 [01:48<08:44,  1.86s/it] 18%|█▊        | 62/343 [01:50<08:31,  1.82s/it] 18%|█▊        | 63/343 [01:52<08:21,  1.79s/it] 19%|█▊        | 64/343 [01:53<08:15,  1.78s/it] 19%|█▉        | 65/343 [01:55<08:02,  1.74s/it] 19%|█▉        | 66/343 [01:57<07:56,  1.72s/it] 20%|█▉        | 67/343 [01:58<07:48,  1.70s/it] 20%|█▉        | 68/343 [02:00<08:11,  1.79s/it] 20%|██        | 69/343 [02:02<08:10,  1.79s/it] 20%|██        | 70/343 [02:04<07:48,  1.72s/it] 21%|██        | 71/343 [02:06<07:57,  1.76s/it] 21%|██        | 72/343 [02:08<08:15,  1.83s/it] 21%|██▏       | 73/343 [02:09<08:11,  1.82s/it] 22%|██▏       | 74/343 [02:12<08:34,  1.91s/it] 22%|██▏       | 75/343 [02:13<08:06,  1.81s/it] 22%|██▏       | 76/343 [02:15<07:49,  1.76s/it] 22%|██▏       | 77/343 [02:16<07:42,  1.74s/it] 23%|██▎       | 78/343 [02:19<08:09,  1.85s/it] 23%|██▎       | 79/343 [02:20<08:12,  1.86s/it] 23%|██▎       | 80/343 [02:23<08:57,  2.04s/it] 24%|██▎       | 81/343 [02:25<08:42,  1.99s/it] 24%|██▍       | 82/343 [02:26<08:16,  1.90s/it] 24%|██▍       | 83/343 [02:28<08:05,  1.87s/it] 24%|██▍       | 84/343 [02:30<07:47,  1.80s/it] 25%|██▍       | 85/343 [02:32<07:40,  1.78s/it] 25%|██▌       | 86/343 [02:33<07:39,  1.79s/it] 25%|██▌       | 87/343 [02:35<07:47,  1.82s/it] 26%|██▌       | 88/343 [02:37<07:28,  1.76s/it] 26%|██▌       | 89/343 [02:39<07:41,  1.82s/it] 26%|██▌       | 90/343 [02:41<07:24,  1.76s/it] 27%|██▋       | 91/343 [02:43<07:48,  1.86s/it] 27%|██▋       | 92/343 [02:44<07:42,  1.84s/it] 27%|██▋       | 93/343 [02:46<07:47,  1.87s/it] 27%|██▋       | 94/343 [02:48<07:21,  1.77s/it] 28%|██▊       | 95/343 [02:50<07:48,  1.89s/it] 28%|██▊       | 96/343 [02:52<07:12,  1.75s/it] 28%|██▊       | 97/343 [02:53<07:21,  1.80s/it] 29%|██▊       | 98/343 [02:54<05:25,  1.33s/it] 29%|██▉       | 99/343 [02:56<06:12,  1.53s/it] 29%|██▉       | 100/343 [02:57<06:16,  1.55s/it] 29%|██▉       | 101/343 [02:59<06:54,  1.71s/it] 30%|██▉       | 102/343 [03:01<07:01,  1.75s/it] 30%|███       | 103/343 [03:03<06:52,  1.72s/it] 30%|███       | 104/343 [03:05<06:57,  1.75s/it] 31%|███       | 105/343 [03:07<07:25,  1.87s/it] 31%|███       | 106/343 [03:09<07:58,  2.02s/it] 31%|███       | 107/343 [03:11<07:57,  2.02s/it] 31%|███▏      | 108/343 [03:13<07:52,  2.01s/it] 32%|███▏      | 109/343 [03:15<07:29,  1.92s/it] 32%|███▏      | 110/343 [03:16<07:00,  1.81s/it] 32%|███▏      | 111/343 [03:18<06:57,  1.80s/it] 33%|███▎      | 112/343 [03:21<08:33,  2.22s/it] 33%|███▎      | 113/343 [03:23<07:41,  2.01s/it] 33%|███▎      | 114/343 [03:25<07:16,  1.91s/it] 34%|███▎      | 115/343 [03:26<07:12,  1.90s/it] 34%|███▍      | 116/343 [03:28<06:49,  1.80s/it] 34%|███▍      | 117/343 [03:30<07:14,  1.92s/it] 34%|███▍      | 118/343 [03:32<07:14,  1.93s/it] 35%|███▍      | 119/343 [03:34<07:30,  2.01s/it] 35%|███▍      | 120/343 [03:36<07:18,  1.97s/it] 35%|███▌      | 121/343 [03:38<07:07,  1.93s/it] 36%|███▌      | 122/343 [03:40<06:59,  1.90s/it] 36%|███▌      | 123/343 [03:42<07:14,  1.97s/it] 36%|███▌      | 124/343 [03:44<07:15,  1.99s/it] 36%|███▋      | 125/343 [03:46<07:13,  1.99s/it] 37%|███▋      | 126/343 [03:48<06:51,  1.90s/it] 37%|███▋      | 127/343 [03:50<06:41,  1.86s/it] 37%|███▋      | 128/343 [03:51<06:40,  1.86s/it] 38%|███▊      | 129/343 [03:53<06:43,  1.88s/it] 38%|███▊      | 130/343 [03:55<06:49,  1.92s/it] 38%|███▊      | 131/343 [03:57<06:37,  1.87s/it] 38%|███▊      | 132/343 [03:59<06:22,  1.81s/it] 39%|███▉      | 133/343 [04:01<07:14,  2.07s/it] 39%|███▉      | 134/343 [04:03<06:59,  2.01s/it] 39%|███▉      | 135/343 [04:05<06:36,  1.91s/it] 40%|███▉      | 136/343 [04:06<06:09,  1.78s/it] 40%|███▉      | 137/343 [04:09<07:02,  2.05s/it] 40%|████      | 138/343 [04:11<06:36,  1.93s/it] 41%|████      | 139/343 [04:13<06:26,  1.89s/it] 41%|████      | 140/343 [04:15<06:36,  1.95s/it] 41%|████      | 141/343 [04:17<06:27,  1.92s/it] 41%|████▏     | 142/343 [04:18<06:10,  1.84s/it] 42%|████▏     | 143/343 [04:20<06:15,  1.88s/it] 42%|████▏     | 144/343 [04:22<06:36,  1.99s/it] 42%|████▏     | 145/343 [04:24<06:29,  1.97s/it] 43%|████▎     | 146/343 [04:26<06:16,  1.91s/it] 43%|████▎     | 147/343 [04:28<05:56,  1.82s/it] 43%|████▎     | 148/343 [04:30<06:17,  1.93s/it] 43%|████▎     | 149/343 [04:32<06:18,  1.95s/it] 44%|████▎     | 150/343 [04:34<06:33,  2.04s/it] 44%|████▍     | 151/343 [04:36<06:37,  2.07s/it] 44%|████▍     | 152/343 [04:38<06:16,  1.97s/it] 45%|████▍     | 153/343 [04:40<06:32,  2.06s/it] 45%|████▍     | 154/343 [04:42<06:15,  1.99s/it] 45%|████▌     | 155/343 [04:44<06:03,  1.93s/it] 45%|████▌     | 156/343 [04:46<05:56,  1.91s/it] 46%|████▌     | 157/343 [04:48<06:03,  1.96s/it] 46%|████▌     | 158/343 [04:50<06:14,  2.03s/it] 46%|████▋     | 159/343 [04:52<05:49,  1.90s/it] 47%|████▋     | 160/343 [04:54<05:47,  1.90s/it] 47%|████▋     | 161/343 [04:56<05:52,  1.94s/it] 47%|████▋     | 162/343 [04:58<06:00,  1.99s/it] 48%|████▊     | 163/343 [04:59<05:47,  1.93s/it] 48%|████▊     | 164/343 [05:02<06:04,  2.04s/it] 48%|████▊     | 165/343 [05:04<05:53,  1.99s/it] 48%|████▊     | 166/343 [05:06<05:52,  1.99s/it] 49%|████▊     | 167/343 [05:07<05:40,  1.94s/it] 49%|████▉     | 168/343 [05:10<05:58,  2.05s/it] 49%|████▉     | 169/343 [05:12<05:43,  1.98s/it] 50%|████▉     | 170/343 [05:14<05:42,  1.98s/it] 50%|████▉     | 171/343 [05:15<05:23,  1.88s/it] 50%|█████     | 172/343 [05:17<05:03,  1.78s/it] 50%|█████     | 173/343 [05:18<04:50,  1.71s/it] 51%|█████     | 174/343 [05:20<04:43,  1.68s/it] 51%|█████     | 175/343 [05:21<04:37,  1.65s/it] 51%|█████▏    | 176/343 [05:23<04:45,  1.71s/it] 52%|█████▏    | 177/343 [05:25<05:00,  1.81s/it] 52%|█████▏    | 178/343 [05:27<04:59,  1.82s/it] 52%|█████▏    | 179/343 [05:29<05:06,  1.87s/it] 52%|█████▏    | 180/343 [05:31<04:46,  1.76s/it] 53%|█████▎    | 181/343 [05:33<05:11,  1.92s/it] 53%|█████▎    | 182/343 [05:35<05:17,  1.97s/it] 53%|█████▎    | 183/343 [05:37<04:50,  1.82s/it] 54%|█████▎    | 184/343 [05:38<04:44,  1.79s/it] 54%|█████▍    | 185/343 [05:40<04:39,  1.77s/it] 54%|█████▍    | 186/343 [05:41<04:22,  1.67s/it] 55%|█████▍    | 187/343 [05:43<04:27,  1.71s/it] 55%|█████▍    | 188/343 [05:45<04:35,  1.78s/it] 55%|█████▌    | 189/343 [05:47<04:39,  1.81s/it] 55%|█████▌    | 190/343 [05:49<04:48,  1.89s/it] 56%|█████▌    | 191/343 [05:51<04:42,  1.86s/it] 56%|█████▌    | 192/343 [05:53<04:31,  1.80s/it] 56%|█████▋    | 193/343 [05:55<04:40,  1.87s/it] 57%|█████▋    | 194/343 [05:57<04:49,  1.94s/it] 57%|█████▋    | 195/343 [05:59<04:42,  1.91s/it] 57%|█████▋    | 196/343 [06:00<04:39,  1.90s/it] 57%|█████▋    | 197/343 [06:03<04:46,  1.96s/it] 58%|█████▊    | 198/343 [06:05<04:47,  1.98s/it] 58%|█████▊    | 199/343 [06:07<04:48,  2.00s/it] 58%|█████▊    | 200/343 [06:09<04:45,  1.99s/it] 59%|█████▊    | 201/343 [06:10<04:33,  1.93s/it] 59%|█████▉    | 202/343 [06:13<05:06,  2.17s/it] 59%|█████▉    | 203/343 [06:15<05:00,  2.14s/it] 59%|█████▉    | 204/343 [06:18<05:05,  2.20s/it] 60%|█████▉    | 205/343 [06:20<05:05,  2.21s/it] 60%|██████    | 206/343 [06:22<04:50,  2.12s/it] 60%|██████    | 207/343 [06:24<04:39,  2.05s/it] 61%|██████    | 208/343 [06:26<04:35,  2.04s/it] 61%|██████    | 209/343 [06:27<04:23,  1.97s/it] 61%|██████    | 210/343 [06:29<04:15,  1.92s/it] 62%|██████▏   | 211/343 [06:31<04:06,  1.87s/it] 62%|██████▏   | 212/343 [06:33<04:29,  2.06s/it] 62%|██████▏   | 213/343 [06:35<04:09,  1.92s/it] 62%|██████▏   | 214/343 [06:37<04:17,  2.00s/it] 63%|██████▎   | 215/343 [06:39<04:05,  1.92s/it] 63%|██████▎   | 216/343 [06:41<04:02,  1.91s/it] 63%|██████▎   | 217/343 [06:43<03:54,  1.86s/it] 64%|██████▎   | 218/343 [06:45<03:56,  1.90s/it] 64%|██████▍   | 219/343 [06:47<04:10,  2.02s/it] 64%|██████▍   | 220/343 [06:48<03:50,  1.88s/it] 64%|██████▍   | 221/343 [06:50<03:51,  1.90s/it] 65%|██████▍   | 222/343 [06:52<03:45,  1.86s/it] 65%|██████▌   | 223/343 [06:54<03:40,  1.83s/it] 65%|██████▌   | 224/343 [06:56<03:36,  1.82s/it] 66%|██████▌   | 225/343 [06:58<03:46,  1.92s/it] 66%|██████▌   | 226/343 [07:00<03:36,  1.85s/it] 66%|██████▌   | 227/343 [07:02<03:40,  1.90s/it] 66%|██████▋   | 228/343 [07:04<03:45,  1.96s/it] 67%|██████▋   | 229/343 [07:05<03:28,  1.83s/it] 67%|██████▋   | 230/343 [07:07<03:26,  1.83s/it] 67%|██████▋   | 231/343 [07:09<03:37,  1.94s/it] 68%|██████▊   | 232/343 [07:11<03:33,  1.92s/it] 68%|██████▊   | 233/343 [07:14<03:58,  2.17s/it] 68%|██████▊   | 234/343 [07:16<03:49,  2.11s/it] 69%|██████▊   | 235/343 [07:18<03:47,  2.11s/it] 69%|██████▉   | 236/343 [07:20<03:42,  2.08s/it] 69%|██████▉   | 237/343 [07:22<03:32,  2.00s/it] 69%|██████▉   | 238/343 [07:23<03:22,  1.93s/it] 70%|██████▉   | 239/343 [07:26<03:25,  1.97s/it] 70%|██████▉   | 240/343 [07:28<03:36,  2.11s/it] 70%|███████   | 241/343 [07:30<03:33,  2.09s/it] 71%|███████   | 242/343 [07:33<03:45,  2.23s/it] 71%|███████   | 243/343 [07:35<03:46,  2.27s/it] 71%|███████   | 244/343 [07:37<03:29,  2.12s/it] 71%|███████▏  | 245/343 [07:38<03:17,  2.02s/it] 72%|███████▏  | 246/343 [07:40<03:05,  1.91s/it] 72%|███████▏  | 247/343 [07:43<03:18,  2.07s/it] 72%|███████▏  | 248/343 [07:44<03:02,  1.92s/it] 73%|███████▎  | 249/343 [07:46<02:52,  1.84s/it] 73%|███████▎  | 250/343 [07:48<02:51,  1.84s/it] 73%|███████▎  | 251/343 [07:50<02:53,  1.88s/it] 73%|███████▎  | 252/343 [07:52<03:02,  2.00s/it] 74%|███████▍  | 253/343 [07:54<02:59,  1.99s/it] 74%|███████▍  | 254/343 [07:56<02:51,  1.93s/it] 74%|███████▍  | 255/343 [07:58<02:56,  2.01s/it] 75%|███████▍  | 256/343 [07:59<02:44,  1.89s/it] 75%|███████▍  | 257/343 [08:01<02:35,  1.81s/it] 75%|███████▌  | 258/343 [08:03<02:29,  1.76s/it] 76%|███████▌  | 259/343 [08:05<02:30,  1.79s/it] 76%|███████▌  | 260/343 [08:06<02:21,  1.70s/it] 76%|███████▌  | 261/343 [08:08<02:22,  1.73s/it] 76%|███████▋  | 262/343 [08:10<02:23,  1.77s/it] 77%|███████▋  | 263/343 [08:11<02:20,  1.75s/it] 77%|███████▋  | 264/343 [08:13<02:19,  1.77s/it] 77%|███████▋  | 265/343 [08:15<02:22,  1.83s/it] 78%|███████▊  | 266/343 [08:17<02:24,  1.87s/it] 78%|███████▊  | 267/343 [08:19<02:19,  1.84s/it] 78%|███████▊  | 268/343 [08:21<02:16,  1.83s/it] 78%|███████▊  | 269/343 [08:22<02:12,  1.79s/it] 79%|███████▊  | 270/343 [08:24<02:13,  1.83s/it] 79%|███████▉  | 271/343 [08:26<02:03,  1.71s/it] 79%|███████▉  | 272/343 [08:28<02:05,  1.77s/it] 80%|███████▉  | 273/343 [08:30<02:12,  1.89s/it] 80%|███████▉  | 274/343 [08:32<02:11,  1.90s/it] 80%|████████  | 275/343 [08:34<02:14,  1.97s/it] 80%|████████  | 276/343 [08:36<02:12,  1.97s/it] 81%|████████  | 277/343 [08:38<02:09,  1.96s/it] 81%|████████  | 278/343 [08:40<02:01,  1.86s/it] 81%|████████▏ | 279/343 [08:41<01:59,  1.86s/it] 82%|████████▏ | 280/343 [08:43<01:51,  1.76s/it] 82%|████████▏ | 281/343 [08:45<01:55,  1.86s/it] 82%|████████▏ | 282/343 [08:47<01:56,  1.90s/it] 83%|████████▎ | 283/343 [08:49<01:51,  1.86s/it] 83%|████████▎ | 284/343 [08:50<01:46,  1.81s/it] 83%|████████▎ | 285/343 [08:52<01:39,  1.72s/it] 83%|████████▎ | 286/343 [08:53<01:34,  1.66s/it] 84%|████████▎ | 287/343 [08:55<01:36,  1.73s/it] 84%|████████▍ | 288/343 [08:57<01:33,  1.71s/it] 84%|████████▍ | 289/343 [08:59<01:38,  1.82s/it] 85%|████████▍ | 290/343 [09:01<01:31,  1.73s/it] 85%|████████▍ | 291/343 [09:03<01:33,  1.80s/it] 85%|████████▌ | 292/343 [09:04<01:31,  1.80s/it] 85%|████████▌ | 293/343 [09:06<01:25,  1.71s/it] 86%|████████▌ | 294/343 [09:08<01:30,  1.84s/it] 86%|████████▌ | 295/343 [09:10<01:25,  1.78s/it] 86%|████████▋ | 296/343 [09:11<01:20,  1.71s/it] 87%|████████▋ | 297/343 [09:13<01:22,  1.80s/it] 87%|████████▋ | 298/343 [09:15<01:25,  1.89s/it] 87%|████████▋ | 299/343 [09:17<01:22,  1.87s/it] 87%|████████▋ | 300/343 [09:19<01:19,  1.86s/it] 88%|████████▊ | 301/343 [09:21<01:15,  1.81s/it] 88%|████████▊ | 302/343 [09:22<01:11,  1.75s/it] 88%|████████▊ | 303/343 [09:24<01:07,  1.68s/it] 89%|████████▊ | 304/343 [09:25<00:54,  1.40s/it] 89%|████████▉ | 305/343 [09:27<00:59,  1.56s/it] 89%|████████▉ | 306/343 [09:28<00:59,  1.61s/it] 90%|████████▉ | 307/343 [09:30<01:02,  1.72s/it] 90%|████████▉ | 308/343 [09:32<01:00,  1.74s/it] 90%|█████████ | 309/343 [09:34<00:58,  1.71s/it] 90%|█████████ | 310/343 [09:36<00:58,  1.76s/it] 91%|█████████ | 311/343 [09:38<01:03,  1.97s/it] 91%|█████████ | 312/343 [09:40<01:01,  1.99s/it] 91%|█████████▏| 313/343 [09:42<00:59,  1.97s/it] 92%|█████████▏| 314/343 [09:44<00:58,  2.03s/it] 92%|█████████▏| 315/343 [09:46<00:55,  1.97s/it] 92%|█████████▏| 316/343 [09:48<00:53,  1.98s/it] 92%|█████████▏| 317/343 [09:50<00:50,  1.96s/it] 93%|█████████▎| 318/343 [09:51<00:45,  1.84s/it] 93%|█████████▎| 319/343 [09:54<00:46,  1.95s/it] 93%|█████████▎| 320/343 [09:56<00:47,  2.05s/it] 94%|█████████▎| 321/343 [09:58<00:42,  1.95s/it] 94%|█████████▍| 322/343 [10:00<00:41,  1.97s/it] 94%|█████████▍| 323/343 [10:02<00:39,  2.00s/it] 94%|█████████▍| 324/343 [10:03<00:36,  1.90s/it] 95%|█████████▍| 325/343 [10:06<00:39,  2.19s/it] 95%|█████████▌| 326/343 [10:08<00:37,  2.19s/it] 95%|█████████▌| 327/343 [10:09<00:25,  1.61s/it] 96%|█████████▌| 328/343 [10:11<00:27,  1.85s/it] 96%|█████████▌| 329/343 [10:13<00:25,  1.83s/it] 96%|█████████▌| 330/343 [10:15<00:23,  1.81s/it] 97%|█████████▋| 331/343 [10:17<00:22,  1.86s/it] 97%|█████████▋| 332/343 [10:19<00:21,  1.93s/it] 97%|█████████▋| 333/343 [10:21<00:18,  1.89s/it] 97%|█████████▋| 334/343 [10:22<00:16,  1.86s/it] 98%|█████████▊| 335/343 [10:24<00:15,  1.92s/it] 98%|█████████▊| 336/343 [10:26<00:12,  1.84s/it] 98%|█████████▊| 337/343 [10:28<00:10,  1.83s/it] 99%|█████████▊| 338/343 [10:30<00:08,  1.79s/it] 99%|█████████▉| 339/343 [10:32<00:07,  1.95s/it] 99%|█████████▉| 340/343 [10:34<00:05,  1.93s/it] 99%|█████████▉| 341/343 [10:34<00:02,  1.43s/it]100%|█████████▉| 342/343 [10:36<00:01,  1.70s/it]100%|██████████| 343/343 [10:38<00:00,  1.69s/it]100%|██████████| 343/343 [10:40<00:00,  1.87s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 337
调用obs
  0%|          | 0/337 [00:00<?, ?it/s]  0%|          | 1/337 [00:01<07:34,  1.35s/it]  1%|          | 2/337 [00:02<05:24,  1.03it/s]  1%|          | 3/337 [00:02<05:17,  1.05it/s]  1%|          | 4/337 [00:04<06:12,  1.12s/it]  1%|▏         | 5/337 [00:05<06:45,  1.22s/it]  2%|▏         | 6/337 [00:06<06:39,  1.21s/it]  2%|▏         | 7/337 [00:09<08:15,  1.50s/it]  2%|▏         | 8/337 [00:10<07:50,  1.43s/it]  3%|▎         | 9/337 [00:11<07:37,  1.40s/it]  3%|▎         | 10/337 [00:12<07:16,  1.33s/it]  3%|▎         | 11/337 [00:14<07:10,  1.32s/it]  4%|▎         | 12/337 [00:15<07:02,  1.30s/it]  4%|▍         | 13/337 [00:16<06:48,  1.26s/it]  4%|▍         | 14/337 [00:18<07:09,  1.33s/it]  4%|▍         | 15/337 [00:19<06:51,  1.28s/it]  5%|▍         | 16/337 [00:20<06:52,  1.28s/it]  5%|▌         | 17/337 [00:21<06:57,  1.31s/it]  5%|▌         | 18/337 [00:23<06:49,  1.28s/it]  6%|▌         | 19/337 [00:24<07:09,  1.35s/it]  6%|▌         | 20/337 [00:25<07:01,  1.33s/it]  6%|▌         | 21/337 [00:27<07:35,  1.44s/it]  7%|▋         | 22/337 [00:29<07:50,  1.49s/it]  7%|▋         | 23/337 [00:30<07:19,  1.40s/it]  7%|▋         | 24/337 [00:31<07:21,  1.41s/it]  7%|▋         | 25/337 [00:33<07:03,  1.36s/it]  8%|▊         | 26/337 [00:34<06:32,  1.26s/it]  8%|▊         | 27/337 [00:36<08:32,  1.65s/it]  8%|▊         | 28/337 [00:38<08:02,  1.56s/it]  9%|▊         | 29/337 [00:39<07:26,  1.45s/it]  9%|▉         | 30/337 [00:40<07:30,  1.47s/it]  9%|▉         | 31/337 [00:42<07:33,  1.48s/it]  9%|▉         | 32/337 [00:43<07:02,  1.38s/it] 10%|▉         | 33/337 [00:44<06:43,  1.33s/it] 10%|█         | 34/337 [00:45<05:49,  1.15s/it] 10%|█         | 35/337 [00:46<05:21,  1.06s/it] 11%|█         | 36/337 [00:47<05:37,  1.12s/it] 11%|█         | 37/337 [00:48<06:02,  1.21s/it] 11%|█▏        | 38/337 [00:50<06:07,  1.23s/it] 12%|█▏        | 39/337 [00:51<06:34,  1.32s/it] 12%|█▏        | 40/337 [00:53<06:55,  1.40s/it] 12%|█▏        | 41/337 [00:54<07:06,  1.44s/it] 12%|█▏        | 42/337 [00:55<06:36,  1.35s/it] 13%|█▎        | 43/337 [00:57<06:42,  1.37s/it] 13%|█▎        | 44/337 [00:58<06:31,  1.34s/it] 13%|█▎        | 45/337 [01:01<08:10,  1.68s/it] 14%|█▎        | 46/337 [01:02<07:50,  1.62s/it] 14%|█▍        | 47/337 [01:04<07:35,  1.57s/it] 14%|█▍        | 48/337 [01:05<07:35,  1.58s/it] 15%|█▍        | 49/337 [01:06<07:13,  1.51s/it] 15%|█▍        | 50/337 [01:08<06:49,  1.43s/it] 15%|█▌        | 51/337 [01:08<05:07,  1.07s/it] 15%|█▌        | 52/337 [01:09<05:37,  1.18s/it] 16%|█▌        | 53/337 [01:11<05:44,  1.21s/it] 16%|█▌        | 54/337 [01:12<06:01,  1.28s/it] 16%|█▋        | 55/337 [01:13<05:52,  1.25s/it] 17%|█▋        | 56/337 [01:15<06:11,  1.32s/it] 17%|█▋        | 57/337 [01:16<06:17,  1.35s/it] 17%|█▋        | 58/337 [01:17<05:46,  1.24s/it] 18%|█▊        | 59/337 [01:18<05:37,  1.21s/it] 18%|█▊        | 60/337 [01:20<05:41,  1.23s/it] 18%|█▊        | 61/337 [01:21<05:46,  1.25s/it] 18%|█▊        | 62/337 [01:22<05:58,  1.31s/it] 19%|█▊        | 63/337 [01:24<06:09,  1.35s/it] 19%|█▉        | 64/337 [01:26<07:03,  1.55s/it] 19%|█▉        | 65/337 [01:28<07:19,  1.62s/it] 20%|█▉        | 66/337 [01:29<07:02,  1.56s/it] 20%|█▉        | 67/337 [01:30<06:38,  1.48s/it] 20%|██        | 68/337 [01:31<06:01,  1.34s/it] 21%|██        | 70/337 [01:33<04:45,  1.07s/it] 21%|██        | 71/337 [01:34<04:32,  1.03s/it] 21%|██▏       | 72/337 [01:35<04:42,  1.07s/it] 22%|██▏       | 74/337 [01:36<03:48,  1.15it/s] 22%|██▏       | 75/337 [01:36<03:05,  1.41it/s] 23%|██▎       | 76/337 [01:37<03:32,  1.23it/s] 23%|██▎       | 77/337 [01:38<03:23,  1.28it/s] 23%|██▎       | 78/337 [01:40<04:14,  1.02it/s] 23%|██▎       | 79/337 [01:41<04:21,  1.01s/it] 24%|██▎       | 80/337 [01:42<04:40,  1.09s/it] 24%|██▍       | 81/337 [01:43<04:54,  1.15s/it] 24%|██▍       | 82/337 [01:45<05:14,  1.23s/it] 25%|██▍       | 83/337 [01:46<05:17,  1.25s/it] 25%|██▍       | 84/337 [01:47<04:42,  1.12s/it] 25%|██▌       | 85/337 [01:48<05:00,  1.19s/it] 26%|██▌       | 86/337 [01:49<04:54,  1.17s/it] 26%|██▌       | 87/337 [01:51<04:59,  1.20s/it] 26%|██▌       | 88/337 [01:52<05:18,  1.28s/it] 26%|██▋       | 89/337 [01:53<05:27,  1.32s/it] 27%|██▋       | 90/337 [01:55<05:30,  1.34s/it] 27%|██▋       | 91/337 [01:56<05:27,  1.33s/it] 27%|██▋       | 92/337 [01:57<05:22,  1.32s/it] 28%|██▊       | 93/337 [01:59<05:17,  1.30s/it] 28%|██▊       | 94/337 [02:00<05:16,  1.30s/it] 28%|██▊       | 95/337 [02:01<05:23,  1.34s/it] 28%|██▊       | 96/337 [02:03<05:15,  1.31s/it] 29%|██▉       | 97/337 [02:03<04:34,  1.14s/it] 29%|██▉       | 98/337 [02:05<04:51,  1.22s/it] 29%|██▉       | 99/337 [02:06<04:36,  1.16s/it] 30%|██▉       | 100/337 [02:07<04:48,  1.22s/it] 30%|██▉       | 101/337 [02:09<04:59,  1.27s/it] 30%|███       | 102/337 [02:09<04:14,  1.08s/it] 31%|███       | 103/337 [02:10<04:28,  1.15s/it] 31%|███       | 104/337 [02:11<04:15,  1.10s/it] 31%|███       | 105/337 [02:13<04:24,  1.14s/it] 31%|███▏      | 106/337 [02:14<04:23,  1.14s/it] 32%|███▏      | 107/337 [02:15<04:26,  1.16s/it] 32%|███▏      | 108/337 [02:16<04:27,  1.17s/it] 32%|███▏      | 109/337 [02:17<04:08,  1.09s/it] 33%|███▎      | 110/337 [02:19<04:29,  1.19s/it] 33%|███▎      | 111/337 [02:20<04:36,  1.23s/it] 33%|███▎      | 112/337 [02:21<04:31,  1.21s/it] 34%|███▎      | 113/337 [02:22<04:36,  1.24s/it] 34%|███▍      | 114/337 [02:23<04:16,  1.15s/it] 34%|███▍      | 115/337 [02:26<05:50,  1.58s/it] 34%|███▍      | 116/337 [02:27<05:30,  1.50s/it] 35%|███▍      | 117/337 [02:29<05:22,  1.46s/it] 35%|███▌      | 118/337 [02:30<05:06,  1.40s/it] 35%|███▌      | 119/337 [02:31<04:20,  1.19s/it] 36%|███▌      | 120/337 [02:32<04:21,  1.21s/it] 36%|███▌      | 121/337 [02:33<04:27,  1.24s/it] 36%|███▌      | 122/337 [02:34<04:30,  1.26s/it] 37%|███▋      | 124/337 [02:36<03:39,  1.03s/it] 37%|███▋      | 125/337 [02:37<03:51,  1.09s/it] 37%|███▋      | 126/337 [02:38<03:58,  1.13s/it] 38%|███▊      | 127/337 [02:40<04:16,  1.22s/it] 38%|███▊      | 128/337 [02:41<04:16,  1.23s/it] 38%|███▊      | 129/337 [02:44<05:42,  1.65s/it] 39%|███▊      | 130/337 [02:45<05:27,  1.58s/it] 39%|███▉      | 131/337 [02:47<05:07,  1.49s/it] 39%|███▉      | 132/337 [02:48<04:59,  1.46s/it] 39%|███▉      | 133/337 [02:50<05:53,  1.73s/it] 40%|███▉      | 134/337 [02:52<05:21,  1.58s/it] 40%|████      | 135/337 [02:52<04:21,  1.29s/it] 40%|████      | 136/337 [02:53<03:45,  1.12s/it] 41%|████      | 137/337 [02:54<04:07,  1.24s/it] 41%|████      | 138/337 [02:56<04:26,  1.34s/it] 41%|████      | 139/337 [02:57<03:50,  1.16s/it] 42%|████▏     | 140/337 [02:58<03:48,  1.16s/it] 42%|████▏     | 141/337 [02:59<04:06,  1.26s/it] 42%|████▏     | 142/337 [03:00<03:59,  1.23s/it] 42%|████▏     | 143/337 [03:02<04:01,  1.24s/it] 43%|████▎     | 144/337 [03:03<03:52,  1.21s/it] 43%|████▎     | 145/337 [03:04<03:32,  1.11s/it] 43%|████▎     | 146/337 [03:05<03:42,  1.17s/it] 44%|████▎     | 147/337 [03:06<03:47,  1.20s/it] 44%|████▍     | 148/337 [03:07<03:36,  1.15s/it] 44%|████▍     | 149/337 [03:08<03:16,  1.04s/it] 45%|████▍     | 150/337 [03:09<03:14,  1.04s/it] 45%|████▍     | 151/337 [03:10<03:13,  1.04s/it] 45%|████▌     | 152/337 [03:11<03:23,  1.10s/it] 45%|████▌     | 153/337 [03:13<03:32,  1.16s/it] 46%|████▌     | 154/337 [03:14<03:40,  1.21s/it] 46%|████▌     | 155/337 [03:16<03:53,  1.28s/it] 46%|████▋     | 156/337 [03:17<03:51,  1.28s/it] 47%|████▋     | 157/337 [03:18<03:58,  1.32s/it] 47%|████▋     | 158/337 [03:19<03:33,  1.19s/it] 47%|████▋     | 159/337 [03:21<03:41,  1.24s/it] 47%|████▋     | 160/337 [03:22<03:39,  1.24s/it] 48%|████▊     | 161/337 [03:23<03:48,  1.30s/it] 48%|████▊     | 162/337 [03:24<03:30,  1.20s/it] 48%|████▊     | 163/337 [03:26<03:50,  1.33s/it] 49%|████▊     | 164/337 [03:27<03:48,  1.32s/it] 49%|████▉     | 165/337 [03:28<03:45,  1.31s/it] 49%|████▉     | 166/337 [03:30<03:35,  1.26s/it] 50%|████▉     | 167/337 [03:31<03:43,  1.32s/it] 50%|████▉     | 168/337 [03:33<03:59,  1.42s/it] 50%|█████     | 169/337 [03:34<03:47,  1.36s/it] 50%|█████     | 170/337 [03:36<04:04,  1.46s/it] 51%|█████     | 171/337 [03:37<04:03,  1.47s/it] 51%|█████▏    | 173/337 [03:38<03:02,  1.11s/it] 52%|█████▏    | 174/337 [03:40<03:11,  1.17s/it] 52%|█████▏    | 175/337 [03:41<03:09,  1.17s/it] 52%|█████▏    | 176/337 [03:42<03:15,  1.22s/it] 53%|█████▎    | 177/337 [03:44<03:17,  1.24s/it] 53%|█████▎    | 178/337 [03:45<03:30,  1.32s/it] 53%|█████▎    | 179/337 [03:47<03:35,  1.36s/it] 53%|█████▎    | 180/337 [03:48<03:59,  1.53s/it] 54%|█████▎    | 181/337 [03:50<03:49,  1.47s/it] 54%|█████▍    | 182/337 [03:51<03:49,  1.48s/it] 54%|█████▍    | 183/337 [03:53<03:37,  1.41s/it] 55%|█████▍    | 184/337 [03:54<03:34,  1.40s/it] 55%|█████▍    | 185/337 [03:55<03:27,  1.37s/it] 55%|█████▌    | 186/337 [03:57<03:25,  1.36s/it] 55%|█████▌    | 187/337 [03:58<03:27,  1.38s/it] 56%|█████▌    | 188/337 [03:59<03:17,  1.33s/it] 56%|█████▌    | 189/337 [04:01<03:19,  1.35s/it] 56%|█████▋    | 190/337 [04:02<03:13,  1.32s/it] 57%|█████▋    | 191/337 [04:03<03:10,  1.31s/it] 57%|█████▋    | 192/337 [04:04<03:11,  1.32s/it] 57%|█████▋    | 193/337 [04:05<02:54,  1.21s/it] 58%|█████▊    | 194/337 [04:07<03:14,  1.36s/it] 58%|█████▊    | 195/337 [04:08<02:55,  1.24s/it] 58%|█████▊    | 196/337 [04:09<02:53,  1.23s/it] 58%|█████▊    | 197/337 [04:11<03:01,  1.30s/it] 59%|█████▉    | 198/337 [04:13<03:21,  1.45s/it] 59%|█████▉    | 199/337 [04:14<02:58,  1.29s/it] 59%|█████▉    | 200/337 [04:14<02:29,  1.09s/it] 60%|█████▉    | 201/337 [04:15<02:35,  1.14s/it] 60%|█████▉    | 202/337 [04:16<02:17,  1.02s/it] 60%|██████    | 203/337 [04:18<02:30,  1.13s/it] 61%|██████    | 204/337 [04:19<02:34,  1.16s/it] 61%|██████    | 205/337 [04:20<02:22,  1.08s/it] 61%|██████    | 206/337 [04:21<02:28,  1.13s/it] 61%|██████▏   | 207/337 [04:22<02:37,  1.21s/it] 62%|██████▏   | 208/337 [04:24<02:43,  1.27s/it] 62%|██████▏   | 209/337 [04:24<02:24,  1.13s/it] 62%|██████▏   | 210/337 [04:25<02:06,  1.01it/s] 63%|██████▎   | 211/337 [04:26<02:07,  1.01s/it] 63%|██████▎   | 212/337 [04:27<02:07,  1.02s/it] 63%|██████▎   | 213/337 [04:29<02:18,  1.12s/it] 64%|██████▍   | 215/337 [04:30<01:48,  1.12it/s] 64%|██████▍   | 216/337 [04:31<01:55,  1.05it/s] 64%|██████▍   | 217/337 [04:32<02:04,  1.04s/it] 65%|██████▍   | 218/337 [04:33<01:56,  1.03it/s] 65%|██████▍   | 219/337 [04:34<02:07,  1.08s/it] 65%|██████▌   | 220/337 [04:36<02:21,  1.21s/it] 66%|██████▌   | 221/337 [04:37<02:02,  1.05s/it] 66%|██████▌   | 222/337 [04:38<02:07,  1.11s/it] 66%|██████▌   | 223/337 [04:39<02:04,  1.09s/it] 66%|██████▋   | 224/337 [04:40<01:55,  1.02s/it] 67%|██████▋   | 225/337 [04:41<02:07,  1.13s/it] 67%|██████▋   | 226/337 [04:42<02:06,  1.14s/it] 67%|██████▋   | 227/337 [04:44<02:15,  1.23s/it] 68%|██████▊   | 228/337 [04:45<02:06,  1.16s/it] 68%|██████▊   | 229/337 [04:47<02:29,  1.38s/it] 68%|██████▊   | 230/337 [04:48<02:23,  1.34s/it] 69%|██████▊   | 231/337 [04:49<02:23,  1.35s/it] 69%|██████▉   | 232/337 [04:51<02:20,  1.33s/it] 69%|██████▉   | 233/337 [04:52<02:15,  1.30s/it] 69%|██████▉   | 234/337 [04:53<02:12,  1.28s/it] 70%|██████▉   | 235/337 [04:54<02:07,  1.25s/it] 70%|███████   | 236/337 [04:56<02:11,  1.30s/it] 70%|███████   | 237/337 [04:57<02:10,  1.31s/it] 71%|███████   | 238/337 [04:58<02:06,  1.28s/it] 71%|███████   | 239/337 [04:59<02:00,  1.23s/it] 71%|███████   | 240/337 [05:00<01:51,  1.15s/it] 72%|███████▏  | 241/337 [05:01<01:28,  1.08it/s] 72%|███████▏  | 242/337 [05:02<01:39,  1.04s/it] 72%|███████▏  | 243/337 [05:03<01:39,  1.06s/it] 72%|███████▏  | 244/337 [05:04<01:39,  1.07s/it] 73%|███████▎  | 245/337 [05:05<01:35,  1.04s/it] 73%|███████▎  | 246/337 [05:06<01:25,  1.07it/s] 73%|███████▎  | 247/337 [05:07<01:31,  1.01s/it] 74%|███████▎  | 248/337 [05:08<01:42,  1.15s/it] 74%|███████▍  | 249/337 [05:10<01:52,  1.28s/it] 74%|███████▍  | 250/337 [05:10<01:21,  1.07it/s] 74%|███████▍  | 251/337 [05:11<01:28,  1.03s/it] 75%|███████▍  | 252/337 [05:13<01:31,  1.08s/it] 75%|███████▌  | 253/337 [05:14<01:32,  1.10s/it] 75%|███████▌  | 254/337 [05:15<01:32,  1.12s/it] 76%|███████▌  | 255/337 [05:16<01:20,  1.01it/s] 76%|███████▌  | 256/337 [05:17<01:25,  1.05s/it] 76%|███████▋  | 257/337 [05:18<01:26,  1.08s/it] 77%|███████▋  | 258/337 [05:19<01:27,  1.10s/it] 77%|███████▋  | 259/337 [05:20<01:30,  1.16s/it] 77%|███████▋  | 260/337 [05:21<01:24,  1.10s/it] 77%|███████▋  | 261/337 [05:23<01:30,  1.19s/it] 78%|███████▊  | 262/337 [05:24<01:22,  1.10s/it] 78%|███████▊  | 263/337 [05:25<01:25,  1.16s/it] 78%|███████▊  | 264/337 [05:26<01:25,  1.17s/it] 79%|███████▊  | 265/337 [05:27<01:22,  1.14s/it] 79%|███████▉  | 266/337 [05:28<01:23,  1.17s/it] 79%|███████▉  | 267/337 [05:30<01:26,  1.23s/it] 80%|███████▉  | 268/337 [05:31<01:24,  1.23s/it] 80%|███████▉  | 269/337 [05:32<01:22,  1.22s/it] 80%|████████  | 270/337 [05:33<01:15,  1.13s/it] 80%|████████  | 271/337 [05:34<01:17,  1.18s/it] 81%|████████  | 272/337 [05:36<01:15,  1.17s/it] 81%|████████  | 273/337 [05:37<01:20,  1.26s/it] 81%|████████▏ | 274/337 [05:38<01:18,  1.25s/it] 82%|████████▏ | 275/337 [05:40<01:18,  1.26s/it] 82%|████████▏ | 276/337 [05:41<01:19,  1.31s/it] 82%|████████▏ | 277/337 [05:42<01:14,  1.25s/it] 82%|████████▏ | 278/337 [05:43<01:15,  1.27s/it] 83%|████████▎ | 279/337 [05:45<01:18,  1.35s/it] 83%|████████▎ | 280/337 [05:46<01:09,  1.23s/it] 83%|████████▎ | 281/337 [05:47<01:08,  1.23s/it] 84%|████████▎ | 282/337 [05:48<01:09,  1.26s/it] 84%|████████▍ | 283/337 [05:50<01:07,  1.24s/it] 84%|████████▍ | 284/337 [05:51<01:07,  1.28s/it] 85%|████████▍ | 285/337 [05:52<01:01,  1.19s/it] 85%|████████▍ | 286/337 [05:53<01:00,  1.18s/it] 85%|████████▌ | 287/337 [05:54<00:56,  1.13s/it] 85%|████████▌ | 288/337 [05:55<00:56,  1.16s/it] 86%|████████▌ | 289/337 [05:57<00:58,  1.21s/it] 86%|████████▌ | 290/337 [05:58<00:55,  1.18s/it] 86%|████████▋ | 291/337 [05:59<00:52,  1.15s/it] 87%|████████▋ | 292/337 [06:00<00:52,  1.16s/it] 87%|████████▋ | 293/337 [06:02<00:53,  1.23s/it] 87%|████████▋ | 294/337 [06:03<00:52,  1.23s/it] 88%|████████▊ | 295/337 [06:04<00:48,  1.15s/it] 88%|████████▊ | 296/337 [06:05<00:46,  1.12s/it] 88%|████████▊ | 297/337 [06:08<01:08,  1.71s/it] 88%|████████▊ | 298/337 [06:09<00:58,  1.49s/it] 89%|████████▊ | 299/337 [06:10<00:57,  1.52s/it] 89%|████████▉ | 300/337 [06:12<00:54,  1.48s/it] 89%|████████▉ | 301/337 [06:12<00:41,  1.15s/it] 90%|████████▉ | 302/337 [06:13<00:40,  1.16s/it] 90%|████████▉ | 303/337 [06:15<00:39,  1.15s/it] 90%|█████████ | 304/337 [06:16<00:37,  1.15s/it] 91%|█████████ | 305/337 [06:17<00:37,  1.17s/it] 91%|█████████ | 306/337 [06:18<00:36,  1.17s/it] 91%|█████████ | 307/337 [06:19<00:36,  1.22s/it] 91%|█████████▏| 308/337 [06:20<00:30,  1.06s/it] 92%|█████████▏| 309/337 [06:21<00:31,  1.13s/it] 92%|█████████▏| 310/337 [06:23<00:32,  1.21s/it] 92%|█████████▏| 311/337 [06:23<00:26,  1.03s/it] 93%|█████████▎| 312/337 [06:24<00:24,  1.01it/s] 93%|█████████▎| 313/337 [06:26<00:26,  1.12s/it] 93%|█████████▎| 314/337 [06:27<00:26,  1.14s/it] 93%|█████████▎| 315/337 [06:28<00:24,  1.12s/it] 94%|█████████▍| 316/337 [06:29<00:24,  1.17s/it] 94%|█████████▍| 317/337 [06:31<00:24,  1.20s/it] 94%|█████████▍| 318/337 [06:31<00:21,  1.13s/it] 95%|█████████▍| 319/337 [06:33<00:22,  1.27s/it] 95%|█████████▍| 320/337 [06:36<00:28,  1.67s/it] 95%|█████████▌| 321/337 [06:37<00:24,  1.56s/it] 96%|█████████▌| 322/337 [06:38<00:21,  1.45s/it] 96%|█████████▌| 323/337 [06:39<00:18,  1.29s/it] 96%|█████████▌| 324/337 [06:40<00:16,  1.24s/it] 96%|█████████▋| 325/337 [06:41<00:14,  1.20s/it] 97%|█████████▋| 326/337 [06:43<00:13,  1.26s/it] 97%|█████████▋| 327/337 [06:44<00:13,  1.37s/it] 97%|█████████▋| 328/337 [06:46<00:12,  1.35s/it] 98%|█████████▊| 329/337 [06:47<00:10,  1.30s/it] 98%|█████████▊| 330/337 [06:49<00:10,  1.43s/it] 98%|█████████▊| 331/337 [06:50<00:07,  1.29s/it] 99%|█████████▊| 332/337 [06:52<00:08,  1.62s/it] 99%|█████████▉| 333/337 [06:53<00:05,  1.43s/it] 99%|█████████▉| 334/337 [06:54<00:03,  1.28s/it] 99%|█████████▉| 335/337 [06:55<00:02,  1.18s/it]100%|█████████▉| 336/337 [06:56<00:01,  1.13s/it]100%|██████████| 337/337 [06:56<00:00,  1.00it/s]100%|██████████| 337/337 [06:56<00:00,  1.24s/it]
invalid api type, one_api_str:{'domain': '媒体', 'action': '搜索', 'mediatype': '视频', 'actors': '李现', 'channel': '电影', 'apiname': 'todrequest'}
有效obs数量 336
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-09/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 336 / 336
  0%|          | 0/336 [00:00<?, ?it/s]  0%|          | 1/336 [00:11<1:05:13, 11.68s/it]  1%|          | 3/336 [00:13<19:37,  3.53s/it]    1%|          | 4/336 [00:16<20:10,  3.65s/it]  2%|▏         | 6/336 [00:19<13:19,  2.42s/it]  2%|▏         | 7/336 [00:19<09:59,  1.82s/it]  2%|▏         | 8/336 [00:23<12:51,  2.35s/it]  3%|▎         | 9/336 [00:25<13:24,  2.46s/it]  3%|▎         | 11/336 [00:29<12:12,  2.26s/it]  4%|▎         | 12/336 [00:34<15:06,  2.80s/it]  4%|▍         | 13/336 [00:36<14:31,  2.70s/it]  4%|▍         | 14/336 [00:40<16:32,  3.08s/it]  4%|▍         | 15/336 [00:41<13:23,  2.50s/it]  5%|▍         | 16/336 [00:46<15:58,  3.00s/it]  5%|▌         | 17/336 [00:50<17:21,  3.27s/it]  5%|▌         | 18/336 [00:52<15:39,  2.95s/it]  6%|▌         | 19/336 [00:53<12:40,  2.40s/it]  6%|▌         | 20/336 [00:54<11:22,  2.16s/it]  6%|▋         | 21/336 [00:56<10:27,  1.99s/it]  7%|▋         | 22/336 [00:57<08:20,  1.59s/it]  7%|▋         | 23/336 [00:58<08:06,  1.55s/it]  7%|▋         | 24/336 [01:02<11:19,  2.18s/it]  7%|▋         | 25/336 [01:02<08:22,  1.61s/it]  8%|▊         | 26/336 [01:06<11:24,  2.21s/it]  8%|▊         | 28/336 [01:09<09:57,  1.94s/it]  9%|▊         | 29/336 [01:10<09:07,  1.78s/it]  9%|▉         | 30/336 [01:12<08:42,  1.71s/it]  9%|▉         | 31/336 [01:16<12:35,  2.48s/it] 10%|▉         | 33/336 [01:21<11:57,  2.37s/it] 10%|█         | 35/336 [01:25<11:28,  2.29s/it] 11%|█         | 36/336 [01:26<10:20,  2.07s/it] 11%|█         | 37/336 [01:29<11:26,  2.29s/it] 12%|█▏        | 39/336 [01:35<12:28,  2.52s/it] 12%|█▏        | 41/336 [01:39<11:05,  2.26s/it] 13%|█▎        | 43/336 [01:42<10:20,  2.12s/it] 13%|█▎        | 45/336 [01:46<09:47,  2.02s/it] 14%|█▎        | 46/336 [01:46<08:13,  1.70s/it] 14%|█▍        | 47/336 [01:51<11:12,  2.33s/it] 15%|█▍        | 49/336 [01:55<10:26,  2.18s/it] 15%|█▍        | 50/336 [01:56<08:48,  1.85s/it] 15%|█▌        | 51/336 [01:57<08:45,  1.84s/it] 15%|█▌        | 52/336 [02:02<11:34,  2.45s/it] 16%|█▌        | 53/336 [02:04<11:31,  2.44s/it] 16%|█▌        | 54/336 [02:06<10:20,  2.20s/it] 16%|█▋        | 55/336 [02:09<11:37,  2.48s/it] 17%|█▋        | 56/336 [02:10<10:10,  2.18s/it] 17%|█▋        | 57/336 [02:12<09:09,  1.97s/it] 17%|█▋        | 58/336 [02:14<09:07,  1.97s/it] 18%|█▊        | 59/336 [02:19<13:02,  2.82s/it] 18%|█▊        | 60/336 [02:19<10:18,  2.24s/it] 18%|█▊        | 61/336 [02:25<15:28,  3.38s/it] 18%|█▊        | 62/336 [02:27<12:45,  2.79s/it] 19%|█▉        | 63/336 [02:30<12:53,  2.83s/it] 19%|█▉        | 64/336 [02:34<14:22,  3.17s/it] 20%|█▉        | 66/336 [02:39<13:39,  3.03s/it] 20%|██        | 68/336 [02:41<09:19,  2.09s/it] 21%|██        | 69/336 [02:42<08:18,  1.87s/it] 21%|██        | 70/336 [02:47<11:29,  2.59s/it] 21%|██        | 71/336 [02:47<09:19,  2.11s/it] 21%|██▏       | 72/336 [02:50<09:31,  2.16s/it] 22%|██▏       | 73/336 [02:54<11:31,  2.63s/it] 22%|██▏       | 74/336 [02:57<12:44,  2.92s/it] 22%|██▏       | 75/336 [02:57<09:14,  2.12s/it] 23%|██▎       | 76/336 [03:00<09:29,  2.19s/it] 23%|██▎       | 78/336 [03:12<17:08,  3.98s/it] 24%|██▍       | 81/336 [03:12<08:52,  2.09s/it] 24%|██▍       | 82/336 [03:17<10:34,  2.50s/it] 25%|██▍       | 83/336 [03:17<08:50,  2.09s/it] 25%|██▌       | 84/336 [03:21<10:22,  2.47s/it] 25%|██▌       | 85/336 [03:22<08:56,  2.14s/it] 26%|██▌       | 86/336 [03:25<09:55,  2.38s/it] 26%|██▌       | 87/336 [03:27<09:18,  2.24s/it] 26%|██▌       | 88/336 [03:29<08:54,  2.15s/it] 26%|██▋       | 89/336 [03:32<09:42,  2.36s/it] 27%|██▋       | 91/336 [03:36<08:40,  2.12s/it] 28%|██▊       | 93/336 [03:40<08:23,  2.07s/it] 28%|██▊       | 94/336 [03:44<10:06,  2.51s/it] 28%|██▊       | 95/336 [03:47<10:46,  2.68s/it] 29%|██▊       | 96/336 [03:49<10:24,  2.60s/it] 29%|██▉       | 97/336 [03:50<08:19,  2.09s/it] 29%|██▉       | 98/336 [03:51<07:23,  1.86s/it] 29%|██▉       | 99/336 [03:54<08:04,  2.05s/it] 30%|██▉       | 100/336 [03:54<06:37,  1.69s/it] 30%|███       | 101/336 [03:59<09:20,  2.38s/it] 31%|███       | 103/336 [04:02<08:25,  2.17s/it] 31%|███       | 104/336 [04:04<07:34,  1.96s/it] 31%|███▏      | 105/336 [04:09<11:14,  2.92s/it] 32%|███▏      | 107/336 [04:10<06:58,  1.83s/it] 32%|███▏      | 108/336 [04:13<08:14,  2.17s/it] 33%|███▎      | 110/336 [04:17<07:55,  2.10s/it] 33%|███▎      | 111/336 [04:18<06:58,  1.86s/it] 33%|███▎      | 112/336 [04:23<09:24,  2.52s/it] 34%|███▎      | 113/336 [04:27<10:24,  2.80s/it] 34%|███▍      | 115/336 [04:28<07:10,  1.95s/it] 35%|███▍      | 116/336 [04:33<09:36,  2.62s/it] 35%|███▌      | 118/336 [04:34<06:24,  1.76s/it] 35%|███▌      | 119/336 [04:37<07:46,  2.15s/it] 36%|███▌      | 120/336 [04:40<08:01,  2.23s/it] 36%|███▌      | 121/336 [04:41<06:36,  1.84s/it] 36%|███▋      | 122/336 [04:42<05:52,  1.65s/it] 37%|███▋      | 123/336 [04:44<06:51,  1.93s/it] 37%|███▋      | 124/336 [04:46<06:17,  1.78s/it] 37%|███▋      | 125/336 [04:48<06:54,  1.97s/it] 38%|███▊      | 126/336 [04:51<07:46,  2.22s/it] 38%|███▊      | 127/336 [04:52<06:10,  1.78s/it] 38%|███▊      | 128/336 [04:58<10:56,  3.15s/it] 39%|███▊      | 130/336 [04:59<06:27,  1.88s/it] 39%|███▉      | 131/336 [05:02<07:30,  2.20s/it] 39%|███▉      | 132/336 [05:05<08:26,  2.48s/it] 40%|███▉      | 134/336 [05:06<05:20,  1.59s/it] 40%|████      | 135/336 [05:11<08:00,  2.39s/it] 40%|████      | 136/336 [05:11<06:03,  1.82s/it] 41%|████      | 137/336 [05:16<08:32,  2.58s/it] 41%|████      | 138/336 [05:20<09:31,  2.89s/it] 42%|████▏     | 140/336 [05:22<07:03,  2.16s/it] 42%|████▏     | 141/336 [05:24<06:59,  2.15s/it] 42%|████▏     | 142/336 [05:28<08:01,  2.48s/it] 43%|████▎     | 143/336 [05:30<07:24,  2.30s/it] 43%|████▎     | 144/336 [05:31<06:15,  1.96s/it] 43%|████▎     | 145/336 [05:34<07:11,  2.26s/it] 43%|████▎     | 146/336 [05:34<05:43,  1.81s/it] 44%|████▍     | 147/336 [05:38<07:18,  2.32s/it] 44%|████▍     | 149/336 [05:43<07:25,  2.38s/it] 45%|████▍     | 151/336 [05:44<05:10,  1.68s/it] 45%|████▌     | 152/336 [05:49<07:14,  2.36s/it] 46%|████▌     | 153/336 [05:49<05:53,  1.93s/it] 46%|████▌     | 154/336 [05:51<05:36,  1.85s/it] 46%|████▌     | 155/336 [05:55<07:04,  2.35s/it] 46%|████▋     | 156/336 [05:56<06:32,  2.18s/it] 47%|████▋     | 157/336 [05:57<05:07,  1.72s/it] 47%|████▋     | 158/336 [06:00<06:00,  2.03s/it] 47%|████▋     | 159/336 [06:07<10:20,  3.51s/it] 48%|████▊     | 161/336 [06:08<06:06,  2.10s/it] 48%|████▊     | 162/336 [06:10<06:32,  2.26s/it] 49%|████▊     | 163/336 [06:12<05:58,  2.07s/it] 49%|████▉     | 164/336 [06:15<06:25,  2.24s/it] 49%|████▉     | 166/336 [06:20<06:50,  2.42s/it] 50%|████▉     | 167/336 [06:22<06:21,  2.26s/it] 50%|█████     | 168/336 [06:24<06:22,  2.28s/it] 50%|█████     | 169/336 [06:25<05:24,  1.94s/it] 51%|█████     | 170/336 [06:28<06:00,  2.17s/it] 51%|█████     | 172/336 [06:32<06:00,  2.20s/it] 52%|█████▏    | 174/336 [06:34<04:38,  1.72s/it] 52%|█████▏    | 175/336 [06:38<05:46,  2.15s/it] 53%|█████▎    | 177/336 [06:41<05:00,  1.89s/it] 53%|█████▎    | 178/336 [06:44<05:47,  2.20s/it] 53%|█████▎    | 179/336 [06:46<05:25,  2.08s/it] 54%|█████▎    | 180/336 [06:48<05:20,  2.06s/it] 54%|█████▍    | 182/336 [06:52<05:12,  2.03s/it] 54%|█████▍    | 183/336 [06:57<06:56,  2.72s/it] 55%|█████▍    | 184/336 [06:59<06:25,  2.53s/it] 55%|█████▌    | 185/336 [07:03<07:07,  2.83s/it] 55%|█████▌    | 186/336 [07:07<07:57,  3.18s/it] 56%|█████▌    | 188/336 [07:10<06:10,  2.50s/it] 56%|█████▋    | 189/336 [07:11<05:06,  2.09s/it] 57%|█████▋    | 190/336 [07:16<07:20,  3.02s/it] 57%|█████▋    | 192/336 [07:21<06:28,  2.70s/it] 58%|█████▊    | 194/336 [07:22<04:26,  1.88s/it] 58%|█████▊    | 195/336 [07:26<05:29,  2.34s/it] 58%|█████▊    | 196/336 [07:27<04:50,  2.08s/it] 59%|█████▊    | 197/336 [07:32<06:23,  2.76s/it] 59%|█████▉    | 199/336 [07:34<04:23,  1.93s/it] 60%|█████▉    | 200/336 [07:36<04:21,  1.92s/it] 60%|█████▉    | 201/336 [07:41<06:30,  2.89s/it] 60%|██████    | 203/336 [07:43<04:22,  1.97s/it] 61%|██████    | 204/336 [07:49<06:40,  3.04s/it] 61%|██████▏   | 206/336 [07:52<04:57,  2.29s/it] 62%|██████▏   | 207/336 [07:56<05:46,  2.69s/it] 62%|██████▏   | 209/336 [07:57<04:01,  1.90s/it] 62%|██████▎   | 210/336 [07:58<03:41,  1.76s/it] 63%|██████▎   | 211/336 [07:59<03:22,  1.62s/it] 63%|██████▎   | 212/336 [08:05<05:09,  2.49s/it] 64%|██████▎   | 214/336 [08:09<04:45,  2.34s/it] 64%|██████▍   | 216/336 [08:13<04:27,  2.23s/it] 65%|██████▍   | 217/336 [08:14<03:51,  1.95s/it] 65%|██████▍   | 218/336 [08:17<04:14,  2.16s/it] 65%|██████▌   | 219/336 [08:21<05:20,  2.74s/it] 66%|██████▌   | 221/336 [08:25<04:40,  2.44s/it] 66%|██████▋   | 223/336 [08:28<03:57,  2.10s/it] 67%|██████▋   | 224/336 [08:30<03:53,  2.09s/it] 67%|██████▋   | 225/336 [08:32<03:32,  1.91s/it] 67%|██████▋   | 226/336 [08:39<05:53,  3.21s/it] 68%|██████▊   | 228/336 [08:42<04:45,  2.64s/it] 68%|██████▊   | 229/336 [08:43<03:52,  2.17s/it] 68%|██████▊   | 230/336 [08:44<03:23,  1.92s/it] 69%|██████▉   | 231/336 [08:49<04:47,  2.74s/it] 69%|██████▉   | 232/336 [08:50<03:39,  2.11s/it] 69%|██████▉   | 233/336 [08:55<05:18,  3.09s/it] 70%|██████▉   | 235/336 [09:00<04:49,  2.87s/it] 71%|███████   | 237/336 [09:03<03:45,  2.28s/it] 71%|███████   | 239/336 [09:05<03:01,  1.87s/it] 72%|███████▏  | 241/336 [09:09<02:53,  1.83s/it] 72%|███████▏  | 243/336 [09:15<03:29,  2.25s/it] 73%|███████▎  | 245/336 [09:18<03:00,  1.98s/it] 73%|███████▎  | 246/336 [09:21<03:10,  2.12s/it] 74%|███████▎  | 247/336 [09:24<03:30,  2.36s/it] 74%|███████▍  | 249/336 [09:31<03:59,  2.75s/it] 75%|███████▍  | 251/336 [09:35<03:32,  2.50s/it] 75%|███████▌  | 253/336 [09:39<03:21,  2.42s/it] 76%|███████▌  | 255/336 [09:45<03:24,  2.52s/it] 76%|███████▋  | 257/336 [09:47<02:39,  2.02s/it] 77%|███████▋  | 258/336 [09:50<02:59,  2.31s/it] 77%|███████▋  | 259/336 [09:51<02:35,  2.02s/it] 77%|███████▋  | 260/336 [09:52<02:13,  1.75s/it] 78%|███████▊  | 261/336 [09:53<02:01,  1.62s/it] 78%|███████▊  | 262/336 [09:55<02:03,  1.67s/it] 78%|███████▊  | 263/336 [09:57<02:14,  1.84s/it] 79%|███████▉  | 265/336 [10:00<01:59,  1.69s/it] 79%|███████▉  | 266/336 [10:09<04:00,  3.44s/it] 80%|████████  | 269/336 [10:10<01:55,  1.73s/it] 80%|████████  | 270/336 [10:13<02:16,  2.07s/it] 81%|████████  | 272/336 [10:17<02:14,  2.10s/it] 82%|████████▏ | 274/336 [10:23<02:21,  2.29s/it] 82%|████████▏ | 276/336 [10:25<01:51,  1.86s/it] 82%|████████▏ | 277/336 [10:26<01:49,  1.86s/it] 83%|████████▎ | 278/336 [10:29<01:59,  2.07s/it] 83%|████████▎ | 279/336 [10:30<01:38,  1.73s/it] 83%|████████▎ | 280/336 [10:34<02:07,  2.28s/it] 84%|████████▎ | 281/336 [10:35<01:46,  1.94s/it] 84%|████████▍ | 282/336 [10:40<02:34,  2.87s/it] 85%|████████▍ | 284/336 [10:44<02:05,  2.42s/it] 85%|████████▍ | 285/336 [10:45<01:53,  2.22s/it] 85%|████████▌ | 286/336 [10:47<01:40,  2.01s/it] 85%|████████▌ | 287/336 [10:48<01:29,  1.83s/it] 86%|████████▌ | 288/336 [10:53<02:03,  2.58s/it] 86%|████████▋ | 290/336 [10:55<01:25,  1.86s/it] 87%|████████▋ | 291/336 [10:59<01:51,  2.47s/it] 87%|████████▋ | 292/336 [11:02<01:50,  2.50s/it] 87%|████████▋ | 293/336 [11:03<01:29,  2.08s/it] 88%|████████▊ | 294/336 [11:04<01:24,  2.02s/it] 88%|████████▊ | 295/336 [11:06<01:18,  1.92s/it] 88%|████████▊ | 296/336 [11:07<01:06,  1.66s/it] 88%|████████▊ | 297/336 [11:08<00:57,  1.47s/it] 89%|████████▊ | 298/336 [11:12<01:27,  2.31s/it] 89%|████████▉ | 299/336 [11:13<01:08,  1.85s/it] 89%|████████▉ | 300/336 [11:14<00:52,  1.47s/it] 90%|████████▉ | 301/336 [11:17<01:12,  2.07s/it] 90%|████████▉ | 302/336 [11:19<01:07,  1.98s/it] 90%|█████████ | 303/336 [11:21<01:03,  1.93s/it] 90%|█████████ | 304/336 [11:22<00:56,  1.75s/it] 91%|█████████ | 305/336 [11:25<01:03,  2.04s/it] 91%|█████████ | 306/336 [11:27<01:04,  2.16s/it] 91%|█████████▏| 307/336 [11:30<01:10,  2.42s/it] 92%|█████████▏| 308/336 [11:35<01:30,  3.22s/it] 92%|█████████▏| 310/336 [11:36<00:49,  1.90s/it] 93%|█████████▎| 311/336 [11:39<00:53,  2.15s/it] 93%|█████████▎| 312/336 [11:44<01:10,  2.95s/it] 94%|█████████▍| 315/336 [11:46<00:35,  1.71s/it] 94%|█████████▍| 316/336 [11:47<00:32,  1.61s/it] 94%|█████████▍| 317/336 [11:49<00:32,  1.70s/it] 95%|█████████▍| 318/336 [11:53<00:37,  2.08s/it] 95%|█████████▍| 319/336 [11:56<00:39,  2.31s/it] 95%|█████████▌| 320/336 [11:56<00:29,  1.85s/it] 96%|█████████▌| 321/336 [11:58<00:28,  1.88s/it] 96%|█████████▌| 322/336 [11:59<00:20,  1.50s/it] 96%|█████████▌| 323/336 [12:01<00:22,  1.77s/it] 96%|█████████▋| 324/336 [12:01<00:15,  1.32s/it] 97%|█████████▋| 325/336 [12:05<00:21,  1.92s/it] 97%|█████████▋| 327/336 [12:10<00:20,  2.25s/it] 98%|█████████▊| 329/336 [12:14<00:15,  2.26s/it] 98%|█████████▊| 330/336 [12:16<00:12,  2.11s/it] 99%|█████████▊| 331/336 [12:17<00:09,  1.94s/it] 99%|█████████▉| 332/336 [12:20<00:08,  2.02s/it] 99%|█████████▉| 333/336 [12:21<00:05,  1.83s/it] 99%|█████████▉| 334/336 [12:22<00:03,  1.64s/it]100%|█████████▉| 335/336 [12:23<00:01,  1.43s/it]100%|██████████| 336/336 [12:28<00:00,  2.58s/it]100%|██████████| 336/336 [12:28<00:00,  2.23s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-10-11 22:33:07 
[INFO] duration: 33 min 
[2024-10-12 14:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-10/prod/2024-10-10_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-12 14:00:01
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:106: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:302: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Arguments: Namespace(api_url='http://172.24.139.210:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-10/prod/2024-10-10_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-10
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-10/prod/2024-10-10_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-10/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-10/prod/2024-10-10_rule_labeled.csv.gpt_labeled.csv
raw log len: 16
时效人设任务型query 数量： 0
unique queries len: 11
调用API
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:01<00:04,  1.97it/s] 27%|██▋       | 3/11 [00:03<00:10,  1.33s/it] 36%|███▋      | 4/11 [00:05<00:10,  1.53s/it] 45%|████▌     | 5/11 [00:07<00:09,  1.59s/it] 55%|█████▍    | 6/11 [00:08<00:08,  1.67s/it] 64%|██████▎   | 7/11 [00:10<00:07,  1.79s/it] 73%|███████▎  | 8/11 [00:12<00:05,  1.67s/it] 82%|████████▏ | 9/11 [00:14<00:03,  1.69s/it] 91%|█████████ | 10/11 [00:14<00:01,  1.25s/it]100%|██████████| 11/11 [00:16<00:00,  1.38s/it]100%|██████████| 11/11 [00:17<00:00,  1.61s/it]
Error occurred: 'arguments'
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 9
调用obs
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:10,  1.25s/it] 22%|██▏       | 2/9 [00:02<00:09,  1.35s/it] 33%|███▎      | 3/9 [00:03<00:07,  1.33s/it] 44%|████▍     | 4/9 [00:05<00:06,  1.23s/it] 56%|█████▌    | 5/9 [00:05<00:04,  1.13s/it] 67%|██████▋   | 6/9 [00:07<00:03,  1.22s/it] 78%|███████▊  | 7/9 [00:08<00:02,  1.20s/it] 89%|████████▉ | 8/9 [00:10<00:01,  1.31s/it]100%|██████████| 9/9 [00:12<00:00,  1.52s/it]100%|██████████| 9/9 [00:12<00:00,  1.34s/it]
有效obs数量 9
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-10/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 9 / 9
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:34,  4.34s/it] 22%|██▏       | 2/9 [00:04<00:13,  1.86s/it] 33%|███▎      | 3/9 [00:07<00:14,  2.43s/it] 44%|████▍     | 4/9 [00:08<00:08,  1.75s/it] 56%|█████▌    | 5/9 [00:12<00:10,  2.67s/it] 78%|███████▊  | 7/9 [00:18<00:05,  2.91s/it]100%|██████████| 9/9 [00:25<00:00,  3.14s/it]100%|██████████| 9/9 [00:25<00:00,  2.86s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-10-12 14:03:17 
[INFO] duration: 3 min 
[2024-10-13 14:00:01] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-11/prod/2024-10-11_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-13 14:00:01
/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py:106: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  filter_df['task_name'] = np.select(task_conditions, task_choices, default='正常数据')
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:302: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Arguments: Namespace(api_url='http://172.24.139.210:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-11/prod/2024-10-11_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-11
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-11/prod/2024-10-11_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-11/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-11/prod/2024-10-11_rule_labeled.csv.gpt_labeled.csv
raw log len: 153
时效人设任务型query 数量： 0
unique queries len: 31
调用API
  0%|          | 0/31 [00:00<?, ?it/s]  6%|▋         | 2/31 [00:01<00:24,  1.16it/s] 10%|▉         | 3/31 [00:03<00:32,  1.18s/it] 13%|█▎        | 4/31 [00:05<00:41,  1.53s/it] 16%|█▌        | 5/31 [00:07<00:42,  1.63s/it] 19%|█▉        | 6/31 [00:09<00:48,  1.96s/it] 23%|██▎       | 7/31 [00:12<00:53,  2.23s/it] 26%|██▌       | 8/31 [00:12<00:36,  1.60s/it] 29%|██▉       | 9/31 [00:14<00:36,  1.65s/it] 32%|███▏      | 10/31 [00:16<00:33,  1.60s/it] 35%|███▌      | 11/31 [00:17<00:32,  1.65s/it] 39%|███▊      | 12/31 [00:19<00:31,  1.66s/it] 42%|████▏     | 13/31 [00:21<00:29,  1.65s/it] 45%|████▌     | 14/31 [00:22<00:28,  1.68s/it] 48%|████▊     | 15/31 [00:24<00:27,  1.71s/it] 52%|█████▏    | 16/31 [00:27<00:29,  1.99s/it] 55%|█████▍    | 17/31 [00:29<00:27,  1.93s/it] 58%|█████▊    | 18/31 [00:31<00:28,  2.15s/it] 61%|██████▏   | 19/31 [00:33<00:24,  2.06s/it] 65%|██████▍   | 20/31 [00:35<00:21,  2.00s/it] 68%|██████▊   | 21/31 [00:37<00:19,  1.92s/it] 71%|███████   | 22/31 [00:39<00:16,  1.88s/it] 74%|███████▍  | 23/31 [00:40<00:14,  1.81s/it] 77%|███████▋  | 24/31 [00:43<00:14,  2.06s/it] 81%|████████  | 25/31 [00:45<00:11,  1.93s/it] 84%|████████▍ | 26/31 [00:47<00:10,  2.03s/it] 87%|████████▋ | 27/31 [00:49<00:07,  1.98s/it] 90%|█████████ | 28/31 [00:49<00:04,  1.45s/it] 94%|█████████▎| 29/31 [00:51<00:03,  1.59s/it] 97%|█████████▋| 30/31 [00:52<00:01,  1.59s/it]100%|██████████| 31/31 [00:54<00:00,  1.59s/it]100%|██████████| 31/31 [00:56<00:00,  1.83s/it]
Error occurred: invalid syntax (<unknown>, line 1)
Error occurred: invalid syntax (<unknown>, line 1)
有效api数量 29
调用obs
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:02<01:10,  2.52s/it]  7%|▋         | 2/29 [00:04<00:52,  1.95s/it] 10%|█         | 3/29 [00:04<00:37,  1.44s/it] 14%|█▍        | 4/29 [00:06<00:36,  1.48s/it] 17%|█▋        | 5/29 [00:09<00:47,  1.96s/it] 21%|██        | 6/29 [00:12<00:51,  2.24s/it] 24%|██▍       | 7/29 [00:13<00:44,  2.01s/it] 28%|██▊       | 8/29 [00:15<00:39,  1.90s/it] 31%|███       | 9/29 [00:16<00:36,  1.81s/it] 34%|███▍      | 10/29 [00:18<00:32,  1.72s/it] 38%|███▊      | 11/29 [00:20<00:30,  1.71s/it] 41%|████▏     | 12/29 [00:21<00:28,  1.66s/it] 45%|████▍     | 13/29 [00:22<00:24,  1.56s/it] 48%|████▊     | 14/29 [00:25<00:26,  1.77s/it] 52%|█████▏    | 15/29 [00:26<00:22,  1.64s/it] 55%|█████▌    | 16/29 [00:27<00:18,  1.42s/it] 59%|█████▊    | 17/29 [00:29<00:17,  1.49s/it] 62%|██████▏   | 18/29 [00:29<00:13,  1.27s/it] 66%|██████▌   | 19/29 [00:31<00:13,  1.32s/it] 69%|██████▉   | 20/29 [00:32<00:11,  1.32s/it] 72%|███████▏  | 21/29 [00:33<00:10,  1.32s/it] 76%|███████▌  | 22/29 [00:35<00:10,  1.52s/it] 79%|███████▉  | 23/29 [00:37<00:08,  1.49s/it] 83%|████████▎ | 24/29 [00:39<00:07,  1.58s/it] 86%|████████▌ | 25/29 [00:40<00:06,  1.54s/it] 90%|████████▉ | 26/29 [00:41<00:04,  1.38s/it] 93%|█████████▎| 27/29 [00:42<00:02,  1.33s/it] 97%|█████████▋| 28/29 [00:44<00:01,  1.39s/it]100%|██████████| 29/29 [00:46<00:00,  1.56s/it]100%|██████████| 29/29 [00:46<00:00,  1.60s/it]
有效obs数量 29
Saved chunk 1 to /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-11/extension/single_True_rag_True/split_data/chunk_1.csv
Regenerating missing GPT-4 file for split data file: chunk_1.csv
Reading oneshot prompt from: /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt
Reading oneshot prompt done.
Building prompts for dataframe entries.
Calling GPT-4 API
剩余case 29 / 29
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:09<04:24,  9.43s/it]  7%|▋         | 2/29 [00:12<02:31,  5.61s/it] 10%|█         | 3/29 [00:12<01:23,  3.22s/it] 14%|█▍        | 4/29 [00:16<01:24,  3.38s/it] 17%|█▋        | 5/29 [00:23<01:49,  4.58s/it] 24%|██▍       | 7/29 [00:24<01:00,  2.74s/it] 28%|██▊       | 8/29 [00:26<00:50,  2.38s/it] 31%|███       | 9/29 [00:30<00:54,  2.72s/it] 34%|███▍      | 10/29 [00:30<00:40,  2.12s/it] 38%|███▊      | 11/29 [00:33<00:44,  2.45s/it] 45%|████▍     | 13/29 [00:37<00:33,  2.10s/it] 48%|████▊     | 14/29 [00:39<00:30,  2.05s/it] 52%|█████▏    | 15/29 [00:40<00:26,  1.87s/it] 55%|█████▌    | 16/29 [00:44<00:31,  2.41s/it] 59%|█████▊    | 17/29 [00:46<00:26,  2.25s/it] 62%|██████▏   | 18/29 [00:48<00:26,  2.41s/it] 66%|██████▌   | 19/29 [00:51<00:24,  2.41s/it] 69%|██████▉   | 20/29 [00:53<00:20,  2.27s/it] 72%|███████▏  | 21/29 [00:56<00:19,  2.49s/it] 76%|███████▌  | 22/29 [00:57<00:14,  2.02s/it] 79%|███████▉  | 23/29 [01:01<00:15,  2.55s/it] 86%|████████▌ | 25/29 [01:03<00:07,  1.89s/it] 90%|████████▉ | 26/29 [01:04<00:05,  1.74s/it] 93%|█████████▎| 27/29 [01:10<00:05,  2.77s/it]100%|██████████| 29/29 [01:10<00:00,  1.69s/it]100%|██████████| 29/29 [01:10<00:00,  2.44s/it]
Parsing GPT-4 response
All GPT-4 files are generated and valid. Total files: 1
[INFO] end_time: 2024-10-13 14:05:13 
[INFO] duration: 5 min 
[2024-10-14 14:00:02] /mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/shells/run_crontab_distillation_log_extension_single_rag.sh:56  /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-12/prod/2024-10-12_rule_labeled.csv.gpt_labeled.csv is ready.
[INFO] begin_time: 2024-10-14 14:00:02
Traceback (most recent call last):
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'taskformer-model-13b-input'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 115, in get_distillation_data
    df = df[~df['taskformer-model-13b-input'].isna()]
             ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: 'taskformer-model-13b-input'
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/transformers/configuration_utils.py:302: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
/opt/conda/envs/rhm_env/lib/python3.11/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Arguments: Namespace(api_url='http://172.24.139.210:16073/ligpt_with_api/search', embedding_model_path='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/bge-base-zh', is_single_flag=True, is_rag_flag=True, model_url='https://rhm-gpt4.fc.chj.cloud/gpt4o/conversation', model_name='gpt4o', prompt_path='/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/conf/generation_prompts/generation_单轮RAG日志蒸馏.txt', input_file='/mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-12/prod/2024-10-12_rule_labeled.csv.gpt_labeled.csv', base_output_path='/mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/')
Processing distillation data for date: 2024-10-12
Input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-12/prod/2024-10-12_rule_labeled.csv.gpt_labeled.csv
Output folder: /mnt/pfs-guan-ssai/nlu/renhuimin/data/log_distillation/2024-10-12/extension/single_True_rag_True
Reading input file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-12/prod/2024-10-12_rule_labeled.csv.gpt_labeled.csv
Exception occurred while processing file: /mnt/pfs-guan-ssai/nlu/wangxiaoyuan/online-data/2024-10-12/prod/2024-10-12_rule_labeled.csv.gpt_labeled.csv
raw log len: 158
时效人设任务型query 数量： 0
Traceback (most recent call last):
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 211, in <module>
    distillator.get_distillation_data(args.input_file)
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/get_extension_log_distillation.py", line 136, in get_distillation_data
    unique_queries_with_metadata = DataFilter.get_unique_query(clean_queries_with_metadata, batch_size=64, BGE_MODEL_PATH=self.config['embedding_model_path'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/pfs-guan-ssai/nlu/renhuimin/rag_tool/src/pipeline_periodic/data_processing.py", line 204, in get_unique_query
    embeddings = np.vstack(all_embeddings)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/rhm_env/lib/python3.11/site-packages/numpy/core/shape_base.py", line 289, in vstack
    return _nx.concatenate(arrs, 0, dtype=dtype, casting=casting)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: need at least one array to concatenate
[INFO] end_time: 2024-10-14 14:00:16 
[INFO] duration: 0 min 
